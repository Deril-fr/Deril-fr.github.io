import{r as d}from"./removeDuplicates-4a376775.js";import{c as u,d as p}from"./index-5f784a6f.js";import{D as S,O as h,K as y,U as A}from"./vendor-7c7bf4c4.js";async function D(e){let i=await O(!1);i.find(t=>t.id===e.id&&t.lang===e.lang)&&(i=i.filter(t=>t.id!==e.id||t.lang!==e.lang)),i.push(e),localStorage.setItem("animeList",JSON.stringify(d(i)))}function U(e,i,t){const r=localStorage.getItem("animeList");return(r?JSON.parse(r):[]).find(s=>s.id===e&&s.episode===i&&s.lang===t)}async function O(e=!0){const i=localStorage.getItem("animeList");let t=[];if(e){const m=u.currentUser;if(m){const s=S(p,"users",m.uid),g=await h(s);if(g){const a=g.data();if(a)if(i){if(a.animeList&&a.animeList.length>0){let l=JSON.parse(i),o=!1;if(l.length!==a.animeList.length)o=!0;else for(let c=0;c<a.animeList.length;c++){const n=a.animeList[c],f=l.find(L=>L.id===n.id&&L.lang===n.lang);if(f&&(f.episode!==n.episode||f.time!==n.time)){o=!0;break}}o&&y(s,{animeList:l})}}else t=a.animeList?a.animeList:[],localStorage.setItem("animeList",JSON.stringify(t));else i&&A(s,{animeList:JSON.parse(i)})}}}return i?JSON.parse(i):t}export{O as a,U as g,D as s};
