import{r as d}from"./removeDuplicates-4a376775.js";import{c as u,d as p}from"./index-1e948081.js";import{D as h,O as S,U as A,K as y}from"./vendor-7c7bf4c4.js";async function D(t){let i=await O(!1);i.find(e=>e.id===t.id&&e.lang===t.lang)&&(i=i.filter(e=>e.id!==t.id||e.lang!==t.lang)),i.push(t),localStorage.setItem("animeList",JSON.stringify(d(i)))}function U(t,i,e){const r=localStorage.getItem("animeList");return(r?JSON.parse(r):[]).find(n=>n.id===t&&n.episode===i&&n.lang===e)}async function O(t=!0){const i=localStorage.getItem("animeList");let e=[];if(t){const m=u.currentUser;if(m){const n=h(p,"users",m.uid),l=await S(n);if(l&&A(n,{animeList:localStorage.getItem("animeList")}),l){const a=l.data();if(a&&i)if(a.animeList&&a.animeList.length>0){let o=JSON.parse(i),c=!1;if(o.length!==a.animeList.length)c=!0;else for(let f=0;f<a.animeList.length;f++){const s=a.animeList[f],g=o.find(L=>L.id===s.id&&L.lang===s.lang);if(g&&(g.episode!==s.episode||g.time!==s.time)){c=!0;break}}c&&y(n,{animeList:o})}else e=a.animeList?a.animeList:[]}}}return i?JSON.parse(i):e}export{O as a,U as g,D as s};
