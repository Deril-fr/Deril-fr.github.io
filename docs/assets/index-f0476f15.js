import{r as A,d as N,c,a as w,u as g,b as S,o as u,e as o,f as C,g as L,t as p,h as b,F as R,i as E,j as O,k as I,l as F,m as M}from"./vendor-1b0155cd.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerpolicy&&(i.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?i.credentials="include":e.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(e){if(e.ep)return;e.ep=!0;const i=t(e);fetch(e.href,i)}})();const _=A({vf:[],vostfr:[],all:[]}),P={class:"bg-zinc-900 text-white min-h-screen px-10"},T={key:0,class:"w-screen h-screen grid justify-items-center items-center"},U=o("div",{class:"bg-red-900 bg-opacity-50 p-5 rounded"},[o("h1",null,[C("L'extension "),o("span",{class:"text-red-500"},"Allow CORS"),C(" est requise pour utiliser notre site web")])],-1),B=[U],D={key:1},H={data(){return{isNoCorsInstalled:!1}},methods:{loadAnimesAndCheckCors:async function(){_.vf=await(await fetch("https://neko-sama.fr/animes-search-vf.json")).json(),_.vostfr=await(await fetch("https://neko-sama.fr/animes-search-vostfr.json")).json(),this.isNoCorsInstalled=!0}},async mounted(){await this.loadAnimesAndCheckCors();let n=_.vf.map(t=>(t.lang="vf",t)),s=_.vostfr.map(t=>(t.lang="vostfr",t));_.all=[...n,...s]}},J=N({...H,__name:"App",setup(n){return(s,t)=>{const r=L("RouterView");return u(),c("main",P,[s.isNoCorsInstalled==!1?(u(),c("div",T,B)):w("",!0),s.isNoCorsInstalled&&g(_).all.length>0?(u(),c("div",D,[S(r)])):w("",!0)])}}}),q={props:{anime:Object}},x=(n,s)=>{const t=n.__vccOpts||n;for(const[r,e]of s)t[r]=e;return t},K={key:0,class:"bg-red-500 p-3 rounded absolute"},W=["src"],z={class:"mt-5 grid"},G={class:"text-lg font-bold whitespace-nowrap text-ellipsis overflow-hidden"};function Q(n,s,t,r,e,i){var a,h,d,f,l;return u(),c("div",{class:"w-full",onClick:s[0]||(s[0]=v=>{var m,y;return n.$router.push("/anime/"+((m=t.anime)==null?void 0:m.lang)+"/"+((y=t.anime)==null?void 0:y.id))})},[((a=t.anime)==null?void 0:a.lang)=="vf"?(u(),c("p",K,"VF")):w("",!0),o("img",{class:"w-full rounded object-cover aspect-[9/13]",src:(h=t.anime)==null?void 0:h.url_image,alt:""},null,8,W),o("div",z,[o("h5",G,p((d=t.anime)==null?void 0:d.title),1),o("h6",null,p((f=t.anime)==null?void 0:f.start_date_year)+" - "+p((l=t.anime)==null?void 0:l.nb_eps),1)])])}const X=x(q,[["render",Q]]);function Y(n,s){const t=[];for(let r=0;r<n.length;r+=s)t.push(n.slice(r,r+s));return t}const Z={key:0},ee={class:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-6 gap-10"},te={class:"flex justify-between py-5"},se=N({__name:"HomeView",setup(n){let s=b(Y(_.all,30)),t=b(0);function r(e){if(console.log(e),scrollTo(0,0),e==-1){t.value=s.value.length-1;return}if(e==s.value.length){t.value=0;return}t.value=e}return(e,i)=>g(s)?(u(),c("section",Z,[o("div",ee,[(u(!0),c(R,null,E(g(s).at(g(t)),a=>(u(),c("div",{key:a.id},[S(X,{anime:a},null,8,["anime"])]))),128))]),o("div",te,[o("button",{onClick:i[0]||(i[0]=a=>r(g(t)-1))},"prev"),o("p",null,p(g(t)+1)+"/"+p(g(s).length),1),o("button",{onClick:i[1]||(i[1]=a=>r(g(t)+1))},"next")])])):w("",!0)}});async function ne(n){var v,m,y,$,k;const s=await(await fetch(n)).text(),t=(v=/(else {\n(.*)video\[0] = ')(.*)(';)/gm.exec(s))==null?void 0:v[3],r=await(await fetch(t)).text();let e=(m=/(https:\/\/www\.pstream\.net\/u\/player-script.*)(" type)/gm.exec(r))==null?void 0:m[1],i="https://www.pstream.net";if(e||(e=(y=/(https:\/\/veestream\.net\/u\/player-script.*)(" type)/gm.exec(r))==null?void 0:y[1],i="https://veestream.net"),e||(e=($=/(https:\/\/fusevideo\.net\/u\/player-script.*)(" type)/gm.exec(r))==null?void 0:$[1],i="https://fusevideo.net"),!e)return!1;const a=await(await fetch(e)).text(),h=(k=/e.parseJSON\(atob\(t\).slice\(2\)\)\}\(\"([^;]*)"\),/gm.exec(a))==null?void 0:k[1],d=JSON.parse(atob(h).slice(2)),f=d.mmmmmmmmmmmmmmmmmmmm,l=d.subtitlesvtt;return{uri:f,subtitles:l,baseurl:i}}function oe(n){return new DOMParser().parseFromString(n,"text/html").body.textContent||""}function re(n){return Number(n.replace("Ep. ",""))}async function V(n){var f,l;const t=await(await fetch("https://neko-sama.fr"+n)).text(),r=/var episodes = (.+)\;/gm.exec(t);let e=[],i="",a="";r&&(e=JSON.parse(r[1]).map(m=>({episode:re(m.episode.toString()),time:m.time,title:m.title,url:m.url,url_image:m.url_image})));const h=(f=/(<div class="synopsis">\n<p>\n)(.*)/gm.exec(t))==null?void 0:f[2];h&&(i=h);const d=(l=/(<div id="head" style="background-image: url\()(.*)(\);)/gm.exec(t))==null?void 0:l[2];return d&&(a=d),{synopsis:oe(i.replace("<br/>",`
`).replace("<br />",`
`).replace("<br>",`
`)),episodes:e,coverURL:a}}const ie={data(){return{animeId:this.$router.currentRoute.value.params.id,language:this.$router.currentRoute.value.params.lang,anime:void 0,datas:void 0}},async beforeMount(){var n;if(this.language!="vf"&&this.language!="vostfr")return this.$router.push("/");this.anime=_[this.language].find(s=>s.id.toString()===this.animeId),this.datas=await V((n=this.anime)==null?void 0:n.url)}},ae={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-10"},le={class:"flex flex-col"},ce=["src"],ue={class:"mt-5"},de={class:"text-lg font-bold whitespace-nowrap text-ellipsis overflow-hidden"},me={class:"flex flex-col"},pe=o("h1",{class:"text-2xl font-bold"},"Synopsis",-1),he={class:"mt-5"},fe={class:"mt-5"},_e=o("h1",{class:"text-2xl font-bold"},"Episodes",-1),ge={class:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-10"},ve=["onClick"],ye=["src"],we={class:"mt-5 grid"},be={class:"text-lg font-bold whitespace-nowrap text-ellipsis overflow-hidden"};function xe(n,s,t,r,e,i){var a,h,d,f;return e.anime&&((a=e.datas)!=null&&a.coverURL)?(u(),c("div",ae,[o("div",le,[o("img",{class:"w-full rounded object-cover aspect-[13/9]",src:(h=e.datas)==null?void 0:h.coverURL,alt:""},null,8,ce),o("div",ue,[o("h5",de,p(e.anime.title),1),o("h6",null,p(e.anime.start_date_year)+" - "+p(e.anime.nb_eps),1)])]),o("div",me,[pe,o("p",he,p((d=e.datas)==null?void 0:d.synopsis),1),o("div",fe,[_e,o("div",ge,[(u(!0),c(R,null,E((f=e.datas)==null?void 0:f.episodes,l=>(u(),c("div",{key:l.episode},[o("div",{class:"w-full",onClick:v=>e.anime&&n.$router.push("/anime/"+e.language+"/"+e.anime.id+"/episode/"+l.episode)},[o("img",{class:"w-full rounded object-cover aspect-[13/9]",src:l.url_image,alt:""},null,8,ye),o("div",we,[o("h5",be,p(l.title),1),o("h6",null,"Ep. "+p(l.episode),1)])],8,ve)]))),128))])])])])):w("",!0)}const $e=x(ie,[["render",xe]]),ke={data(){return{currentEpisode:this.$router.currentRoute.value.params.episode,language:this.$router.currentRoute.value.params.lang,animeId:this.$router.currentRoute.value.params.id,video:b()}},async mounted(){if(this.language!="vf"&&this.language!="vostfr")return this.$router.push("/");let n=_[this.language].find(e=>e.id.toString()===this.animeId);if(!n)return this.$router.push("/");let t=(await V(n.url)).episodes.find(e=>e.episode.toString()==this.currentEpisode);if(!t)return this.$router.push("/");let r=await ne("https://neko-sama.fr"+t.url);if(!r)return this.$router.push("/");if(this.video={mp4:!1,uri:r.uri,available:!0,baseurl:r.baseurl},this.video&&this.video.available){let e=new O;e.loadSource(this.video.uri),e.attachMedia(this.$refs.player),console.log(this.$refs.player)}}},Ce={ref:"player",controls:"",class:"w-full h-full"};function Ne(n,s,t,r,e,i){return u(),c("div",null,[o("video",Ce,null,512)])}const Se=x(ke,[["render",Ne]]),Re=I({history:F("/"),routes:[{path:"/",name:"home",component:se},{path:"/anime/:lang/:id",name:"anime",component:$e},{path:"/anime/:lang/:id/episode/:episode",name:"episode",component:Se}]});const j=M(J);j.use(Re);j.mount("#app");
