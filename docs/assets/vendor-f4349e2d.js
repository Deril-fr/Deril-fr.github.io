function eu(e,t){const r=Object.create(null),i=e.split(",");for(let u=0;u<i.length;u++)r[i[u]]=!0;return t?u=>!!r[u.toLowerCase()]:u=>!!r[u]}function tu(e){if(pt(e)){const t={};for(let r=0;r<e.length;r++){const i=e[r],u=Zt(i)?H0(i):tu(i);if(u)for(const d in u)t[d]=u[d]}return t}else{if(Zt(e))return e;if(Kt(e))return e}}const F0=/;(?![^(]*\))/g,B0=/:([^]+)/,U0=/\/\*.*?\*\//gs;function H0(e){const t={};return e.replace(U0,"").split(F0).forEach(r=>{if(r){const i=r.split(B0);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function ru(e){let t="";if(Zt(e))t=e;else if(pt(e))for(let r=0;r<e.length;r++){const i=ru(e[r]);i&&(t+=i+" ")}else if(Kt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const G0="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",K0=eu(G0);function af(e){return!!e||e===""}const vA=e=>Zt(e)?e:e==null?"":pt(e)||Kt(e)&&(e.toString===cf||!yt(e.toString))?JSON.stringify(e,of,2):String(e),of=(e,t)=>t&&t.__v_isRef?of(e,t.value):ti(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[i,u])=>(r[`${i} =>`]=u,r),{})}:uf(t)?{[`Set(${t.size})`]:[...t.values()]}:Kt(t)&&!pt(t)&&!ff(t)?String(t):t,Bt={},ei=[],Nr=()=>{},Y0=()=>!1,V0=/^on[^a-z]/,Js=e=>V0.test(e),nu=e=>e.startsWith("onUpdate:"),or=Object.assign,iu=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},j0=Object.prototype.hasOwnProperty,Dt=(e,t)=>j0.call(e,t),pt=Array.isArray,ti=e=>ea(e)==="[object Map]",uf=e=>ea(e)==="[object Set]",yt=e=>typeof e=="function",Zt=e=>typeof e=="string",su=e=>typeof e=="symbol",Kt=e=>e!==null&&typeof e=="object",lf=e=>Kt(e)&&yt(e.then)&&yt(e.catch),cf=Object.prototype.toString,ea=e=>cf.call(e),q0=e=>ea(e).slice(8,-1),ff=e=>ea(e)==="[object Object]",au=e=>Zt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Rs=eu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ta=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},W0=/-(\w)/g,jr=ta(e=>e.replace(W0,(t,r)=>r?r.toUpperCase():"")),X0=/\B([A-Z])/g,gi=ta(e=>e.replace(X0,"-$1").toLowerCase()),ra=ta(e=>e.charAt(0).toUpperCase()+e.slice(1)),oo=ta(e=>e?`on${ra(e)}`:""),Wi=(e,t)=>!Object.is(e,t),Ds=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},Fs=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},Bs=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Nl;const Q0=()=>Nl||(Nl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Br;class z0{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Br,!t&&Br&&(this.index=(Br.scopes||(Br.scopes=[])).push(this)-1)}run(t){if(this.active){const r=Br;try{return Br=this,t()}finally{Br=r}}}on(){Br=this}off(){Br=this.parent}stop(t){if(this.active){let r,i;for(r=0,i=this.effects.length;r<i;r++)this.effects[r].stop();for(r=0,i=this.cleanups.length;r<i;r++)this.cleanups[r]();if(this.scopes)for(r=0,i=this.scopes.length;r<i;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!t){const u=this.parent.scopes.pop();u&&u!==this&&(this.parent.scopes[this.index]=u,u.index=this.index)}this.parent=void 0,this.active=!1}}}function $0(e,t=Br){t&&t.active&&t.effects.push(e)}const ou=e=>{const t=new Set(e);return t.w=0,t.n=0,t},df=e=>(e.w&En)>0,hf=e=>(e.n&En)>0,Z0=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=En},J0=e=>{const{deps:t}=e;if(t.length){let r=0;for(let i=0;i<t.length;i++){const u=t[i];df(u)&&!hf(u)?u.delete(e):t[r++]=u,u.w&=~En,u.n&=~En}t.length=r}},Lo=new WeakMap;let ki=0,En=1;const Ro=30;let Rr;const Pn=Symbol(""),Do=Symbol("");class uu{constructor(t,r=null,i){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,$0(this,i)}run(){if(!this.active)return this.fn();let t=Rr,r=gn;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Rr,Rr=this,gn=!0,En=1<<++ki,ki<=Ro?Z0(this):Ol(this),this.fn()}finally{ki<=Ro&&J0(this),En=1<<--ki,Rr=this.parent,gn=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Rr===this?this.deferStop=!0:this.active&&(Ol(this),this.onStop&&this.onStop(),this.active=!1)}}function Ol(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let gn=!0;const gf=[];function mi(){gf.push(gn),gn=!1}function pi(){const e=gf.pop();gn=e===void 0?!0:e}function Er(e,t,r){if(gn&&Rr){let i=Lo.get(e);i||Lo.set(e,i=new Map);let u=i.get(r);u||i.set(r,u=ou()),mf(u)}}function mf(e,t){let r=!1;ki<=Ro?hf(e)||(e.n|=En,r=!df(e)):r=!e.has(Rr),r&&(e.add(Rr),Rr.deps.push(e))}function nn(e,t,r,i,u,d){const T=Lo.get(e);if(!T)return;let A=[];if(t==="clear")A=[...T.values()];else if(r==="length"&&pt(e)){const y=Bs(i);T.forEach((S,I)=>{(I==="length"||I>=y)&&A.push(S)})}else switch(r!==void 0&&A.push(T.get(r)),t){case"add":pt(e)?au(r)&&A.push(T.get("length")):(A.push(T.get(Pn)),ti(e)&&A.push(T.get(Do)));break;case"delete":pt(e)||(A.push(T.get(Pn)),ti(e)&&A.push(T.get(Do)));break;case"set":ti(e)&&A.push(T.get(Pn));break}if(A.length===1)A[0]&&No(A[0]);else{const y=[];for(const S of A)S&&y.push(...S);No(ou(y))}}function No(e,t){const r=pt(e)?e:[...e];for(const i of r)i.computed&&xl(i);for(const i of r)i.computed||xl(i)}function xl(e,t){(e!==Rr||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const eg=eu("__proto__,__v_isRef,__isVue"),pf=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(su)),tg=lu(),rg=lu(!1,!0),ng=lu(!0),kl=ig();function ig(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const i=kt(this);for(let d=0,T=this.length;d<T;d++)Er(i,"get",d+"");const u=i[t](...r);return u===-1||u===!1?i[t](...r.map(kt)):u}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){mi();const i=kt(this)[t].apply(this,r);return pi(),i}}),e}function lu(e=!1,t=!1){return function(i,u,d){if(u==="__v_isReactive")return!e;if(u==="__v_isReadonly")return e;if(u==="__v_isShallow")return t;if(u==="__v_raw"&&d===(e?t?bg:yf:t?bf:vf).get(i))return i;const T=pt(i);if(!e&&T&&Dt(kl,u))return Reflect.get(kl,u,d);const A=Reflect.get(i,u,d);return(su(u)?pf.has(u):eg(u))||(e||Er(i,"get",u),t)?A:ir(A)?T&&au(u)?A:A.value:Kt(A)?e?Af(A):is(A):A}}const sg=Ef(),ag=Ef(!0);function Ef(e=!1){return function(r,i,u,d){let T=r[i];if(oi(T)&&ir(T)&&!ir(u))return!1;if(!e&&(!Us(u)&&!oi(u)&&(T=kt(T),u=kt(u)),!pt(r)&&ir(T)&&!ir(u)))return T.value=u,!0;const A=pt(r)&&au(i)?Number(i)<r.length:Dt(r,i),y=Reflect.set(r,i,u,d);return r===kt(d)&&(A?Wi(u,T)&&nn(r,"set",i,u):nn(r,"add",i,u)),y}}function og(e,t){const r=Dt(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&r&&nn(e,"delete",t,void 0),i}function ug(e,t){const r=Reflect.has(e,t);return(!su(t)||!pf.has(t))&&Er(e,"has",t),r}function lg(e){return Er(e,"iterate",pt(e)?"length":Pn),Reflect.ownKeys(e)}const Tf={get:tg,set:sg,deleteProperty:og,has:ug,ownKeys:lg},cg={get:ng,set(e,t){return!0},deleteProperty(e,t){return!0}},fg=or({},Tf,{get:rg,set:ag}),cu=e=>e,na=e=>Reflect.getPrototypeOf(e);function Es(e,t,r=!1,i=!1){e=e.__v_raw;const u=kt(e),d=kt(t);r||(t!==d&&Er(u,"get",t),Er(u,"get",d));const{has:T}=na(u),A=i?cu:r?hu:Xi;if(T.call(u,t))return A(e.get(t));if(T.call(u,d))return A(e.get(d));e!==u&&e.get(t)}function Ts(e,t=!1){const r=this.__v_raw,i=kt(r),u=kt(e);return t||(e!==u&&Er(i,"has",e),Er(i,"has",u)),e===u?r.has(e):r.has(e)||r.has(u)}function vs(e,t=!1){return e=e.__v_raw,!t&&Er(kt(e),"iterate",Pn),Reflect.get(e,"size",e)}function Pl(e){e=kt(e);const t=kt(this);return na(t).has.call(t,e)||(t.add(e),nn(t,"add",e,e)),this}function wl(e,t){t=kt(t);const r=kt(this),{has:i,get:u}=na(r);let d=i.call(r,e);d||(e=kt(e),d=i.call(r,e));const T=u.call(r,e);return r.set(e,t),d?Wi(t,T)&&nn(r,"set",e,t):nn(r,"add",e,t),this}function Ml(e){const t=kt(this),{has:r,get:i}=na(t);let u=r.call(t,e);u||(e=kt(e),u=r.call(t,e)),i&&i.call(t,e);const d=t.delete(e);return u&&nn(t,"delete",e,void 0),d}function Fl(){const e=kt(this),t=e.size!==0,r=e.clear();return t&&nn(e,"clear",void 0,void 0),r}function bs(e,t){return function(i,u){const d=this,T=d.__v_raw,A=kt(T),y=t?cu:e?hu:Xi;return!e&&Er(A,"iterate",Pn),T.forEach((S,I)=>i.call(u,y(S),y(I),d))}}function ys(e,t,r){return function(...i){const u=this.__v_raw,d=kt(u),T=ti(d),A=e==="entries"||e===Symbol.iterator&&T,y=e==="keys"&&T,S=u[e](...i),I=r?cu:t?hu:Xi;return!t&&Er(d,"iterate",y?Do:Pn),{next(){const{value:C,done:b}=S.next();return b?{value:C,done:b}:{value:A?[I(C[0]),I(C[1])]:I(C),done:b}},[Symbol.iterator](){return this}}}}function un(e){return function(...t){return e==="delete"?!1:this}}function dg(){const e={get(d){return Es(this,d)},get size(){return vs(this)},has:Ts,add:Pl,set:wl,delete:Ml,clear:Fl,forEach:bs(!1,!1)},t={get(d){return Es(this,d,!1,!0)},get size(){return vs(this)},has:Ts,add:Pl,set:wl,delete:Ml,clear:Fl,forEach:bs(!1,!0)},r={get(d){return Es(this,d,!0)},get size(){return vs(this,!0)},has(d){return Ts.call(this,d,!0)},add:un("add"),set:un("set"),delete:un("delete"),clear:un("clear"),forEach:bs(!0,!1)},i={get(d){return Es(this,d,!0,!0)},get size(){return vs(this,!0)},has(d){return Ts.call(this,d,!0)},add:un("add"),set:un("set"),delete:un("delete"),clear:un("clear"),forEach:bs(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(d=>{e[d]=ys(d,!1,!1),r[d]=ys(d,!0,!1),t[d]=ys(d,!1,!0),i[d]=ys(d,!0,!0)}),[e,r,t,i]}const[hg,gg,mg,pg]=dg();function fu(e,t){const r=t?e?pg:mg:e?gg:hg;return(i,u,d)=>u==="__v_isReactive"?!e:u==="__v_isReadonly"?e:u==="__v_raw"?i:Reflect.get(Dt(r,u)&&u in i?r:i,u,d)}const Eg={get:fu(!1,!1)},Tg={get:fu(!1,!0)},vg={get:fu(!0,!1)},vf=new WeakMap,bf=new WeakMap,yf=new WeakMap,bg=new WeakMap;function yg(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ag(e){return e.__v_skip||!Object.isExtensible(e)?0:yg(q0(e))}function is(e){return oi(e)?e:du(e,!1,Tf,Eg,vf)}function _g(e){return du(e,!1,fg,Tg,bf)}function Af(e){return du(e,!0,cg,vg,yf)}function du(e,t,r,i,u){if(!Kt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const d=u.get(e);if(d)return d;const T=Ag(e);if(T===0)return e;const A=new Proxy(e,T===2?i:r);return u.set(e,A),A}function ri(e){return oi(e)?ri(e.__v_raw):!!(e&&e.__v_isReactive)}function oi(e){return!!(e&&e.__v_isReadonly)}function Us(e){return!!(e&&e.__v_isShallow)}function _f(e){return ri(e)||oi(e)}function kt(e){const t=e&&e.__v_raw;return t?kt(t):e}function Sf(e){return Fs(e,"__v_skip",!0),e}const Xi=e=>Kt(e)?is(e):e,hu=e=>Kt(e)?Af(e):e;function If(e){gn&&Rr&&(e=kt(e),mf(e.dep||(e.dep=ou())))}function Cf(e,t){e=kt(e),e.dep&&No(e.dep)}function ir(e){return!!(e&&e.__v_isRef===!0)}function Sg(e){return Lf(e,!1)}function Ig(e){return Lf(e,!0)}function Lf(e,t){return ir(e)?e:new Cg(e,t)}class Cg{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:kt(t),this._value=r?t:Xi(t)}get value(){return If(this),this._value}set value(t){const r=this.__v_isShallow||Us(t)||oi(t);t=r?t:kt(t),Wi(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:Xi(t),Cf(this))}}function ni(e){return ir(e)?e.value:e}const Lg={get:(e,t,r)=>ni(Reflect.get(e,t,r)),set:(e,t,r,i)=>{const u=e[t];return ir(u)&&!ir(r)?(u.value=r,!0):Reflect.set(e,t,r,i)}};function Rf(e){return ri(e)?e:new Proxy(e,Lg)}var Df;class Rg{constructor(t,r,i,u){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[Df]=!1,this._dirty=!0,this.effect=new uu(t,()=>{this._dirty||(this._dirty=!0,Cf(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!u,this.__v_isReadonly=i}get value(){const t=kt(this);return If(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Df="__v_isReadonly";function Dg(e,t,r=!1){let i,u;const d=yt(e);return d?(i=e,u=Nr):(i=e.get,u=e.set),new Rg(i,u,d||!u,r)}function mn(e,t,r,i){let u;try{u=i?e(...i):e()}catch(d){ia(d,t,r)}return u}function Or(e,t,r,i){if(yt(e)){const d=mn(e,t,r,i);return d&&lf(d)&&d.catch(T=>{ia(T,t,r)}),d}const u=[];for(let d=0;d<e.length;d++)u.push(Or(e[d],t,r,i));return u}function ia(e,t,r,i=!0){const u=t?t.vnode:null;if(t){let d=t.parent;const T=t.proxy,A=r;for(;d;){const S=d.ec;if(S){for(let I=0;I<S.length;I++)if(S[I](e,T,A)===!1)return}d=d.parent}const y=t.appContext.config.errorHandler;if(y){mn(y,null,10,[e,T,A]);return}}Ng(e,r,u,i)}function Ng(e,t,r,i=!0){console.error(e)}let Qi=!1,Oo=!1;const nr=[];let Gr=0;const ii=[];let Jr=null,Rn=0;const Nf=Promise.resolve();let gu=null;function Of(e){const t=gu||Nf;return e?t.then(this?e.bind(this):e):t}function Og(e){let t=Gr+1,r=nr.length;for(;t<r;){const i=t+r>>>1;zi(nr[i])<e?t=i+1:r=i}return t}function mu(e){(!nr.length||!nr.includes(e,Qi&&e.allowRecurse?Gr+1:Gr))&&(e.id==null?nr.push(e):nr.splice(Og(e.id),0,e),xf())}function xf(){!Qi&&!Oo&&(Oo=!0,gu=Nf.then(Pf))}function xg(e){const t=nr.indexOf(e);t>Gr&&nr.splice(t,1)}function kg(e){pt(e)?ii.push(...e):(!Jr||!Jr.includes(e,e.allowRecurse?Rn+1:Rn))&&ii.push(e),xf()}function Bl(e,t=Qi?Gr+1:0){for(;t<nr.length;t++){const r=nr[t];r&&r.pre&&(nr.splice(t,1),t--,r())}}function kf(e){if(ii.length){const t=[...new Set(ii)];if(ii.length=0,Jr){Jr.push(...t);return}for(Jr=t,Jr.sort((r,i)=>zi(r)-zi(i)),Rn=0;Rn<Jr.length;Rn++)Jr[Rn]();Jr=null,Rn=0}}const zi=e=>e.id==null?1/0:e.id,Pg=(e,t)=>{const r=zi(e)-zi(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function Pf(e){Oo=!1,Qi=!0,nr.sort(Pg);const t=Nr;try{for(Gr=0;Gr<nr.length;Gr++){const r=nr[Gr];r&&r.active!==!1&&mn(r,null,14)}}finally{Gr=0,nr.length=0,kf(),Qi=!1,gu=null,(nr.length||ii.length)&&Pf()}}function wg(e,t,...r){if(e.isUnmounted)return;const i=e.vnode.props||Bt;let u=r;const d=t.startsWith("update:"),T=d&&t.slice(7);if(T&&T in i){const I=`${T==="modelValue"?"model":T}Modifiers`,{number:C,trim:b}=i[I]||Bt;b&&(u=r.map(R=>Zt(R)?R.trim():R)),C&&(u=r.map(Bs))}let A,y=i[A=oo(t)]||i[A=oo(jr(t))];!y&&d&&(y=i[A=oo(gi(t))]),y&&Or(y,e,6,u);const S=i[A+"Once"];if(S){if(!e.emitted)e.emitted={};else if(e.emitted[A])return;e.emitted[A]=!0,Or(S,e,6,u)}}function wf(e,t,r=!1){const i=t.emitsCache,u=i.get(e);if(u!==void 0)return u;const d=e.emits;let T={},A=!1;if(!yt(e)){const y=S=>{const I=wf(S,t,!0);I&&(A=!0,or(T,I))};!r&&t.mixins.length&&t.mixins.forEach(y),e.extends&&y(e.extends),e.mixins&&e.mixins.forEach(y)}return!d&&!A?(Kt(e)&&i.set(e,null),null):(pt(d)?d.forEach(y=>T[y]=null):or(T,d),Kt(e)&&i.set(e,T),T)}function sa(e,t){return!e||!Js(t)?!1:(t=t.slice(2).replace(/Once$/,""),Dt(e,t[0].toLowerCase()+t.slice(1))||Dt(e,gi(t))||Dt(e,t))}let yr=null,Mf=null;function Hs(e){const t=yr;return yr=e,Mf=e&&e.type.__scopeId||null,t}function Mg(e,t=yr,r){if(!t||e._n)return e;const i=(...u)=>{i._d&&Wl(-1);const d=Hs(t);let T;try{T=e(...u)}finally{Hs(d),i._d&&Wl(1)}return T};return i._n=!0,i._c=!0,i._d=!0,i}function uo(e){const{type:t,vnode:r,proxy:i,withProxy:u,props:d,propsOptions:[T],slots:A,attrs:y,emit:S,render:I,renderCache:C,data:b,setupState:R,ctx:P,inheritAttrs:ce}=e;let J,ie;const fe=Hs(e);try{if(r.shapeFlag&4){const de=u||i;J=Hr(I.call(de,de,C,d,R,b,P)),ie=y}else{const de=t;J=Hr(de.length>1?de(d,{attrs:y,slots:A,emit:S}):de(d,null)),ie=t.props?y:Fg(y)}}catch(de){Mi.length=0,ia(de,e,1),J=mr(Mn)}let Q=J;if(ie&&ce!==!1){const de=Object.keys(ie),{shapeFlag:oe}=Q;de.length&&oe&7&&(T&&de.some(nu)&&(ie=Bg(ie,T)),Q=ui(Q,ie))}return r.dirs&&(Q=ui(Q),Q.dirs=Q.dirs?Q.dirs.concat(r.dirs):r.dirs),r.transition&&(Q.transition=r.transition),J=Q,Hs(fe),J}const Fg=e=>{let t;for(const r in e)(r==="class"||r==="style"||Js(r))&&((t||(t={}))[r]=e[r]);return t},Bg=(e,t)=>{const r={};for(const i in e)(!nu(i)||!(i.slice(9)in t))&&(r[i]=e[i]);return r};function Ug(e,t,r){const{props:i,children:u,component:d}=e,{props:T,children:A,patchFlag:y}=t,S=d.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&y>=0){if(y&1024)return!0;if(y&16)return i?Ul(i,T,S):!!T;if(y&8){const I=t.dynamicProps;for(let C=0;C<I.length;C++){const b=I[C];if(T[b]!==i[b]&&!sa(S,b))return!0}}}else return(u||A)&&(!A||!A.$stable)?!0:i===T?!1:i?T?Ul(i,T,S):!0:!!T;return!1}function Ul(e,t,r){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let u=0;u<i.length;u++){const d=i[u];if(t[d]!==e[d]&&!sa(r,d))return!0}return!1}function Hg({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const Gg=e=>e.__isSuspense;function Kg(e,t){t&&t.pendingBranch?pt(e)?t.effects.push(...e):t.effects.push(e):kg(e)}function Ns(e,t){if(tr){let r=tr.provides;const i=tr.parent&&tr.parent.provides;i===r&&(r=tr.provides=Object.create(i)),r[e]=t}}function tn(e,t,r=!1){const i=tr||yr;if(i){const u=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(u&&e in u)return u[e];if(arguments.length>1)return r&&yt(t)?t.call(i.proxy):t}}const As={};function Os(e,t,r){return Ff(e,t,r)}function Ff(e,t,{immediate:r,deep:i,flush:u,onTrack:d,onTrigger:T}=Bt){const A=tr;let y,S=!1,I=!1;if(ir(e)?(y=()=>e.value,S=Us(e)):ri(e)?(y=()=>e,i=!0):pt(e)?(I=!0,S=e.some(Q=>ri(Q)||Us(Q)),y=()=>e.map(Q=>{if(ir(Q))return Q.value;if(ri(Q))return xn(Q);if(yt(Q))return mn(Q,A,2)})):yt(e)?t?y=()=>mn(e,A,2):y=()=>{if(!(A&&A.isUnmounted))return C&&C(),Or(e,A,3,[b])}:y=Nr,t&&i){const Q=y;y=()=>xn(Q())}let C,b=Q=>{C=ie.onStop=()=>{mn(Q,A,4)}},R;if(Zi)if(b=Nr,t?r&&Or(t,A,3,[y(),I?[]:void 0,b]):y(),u==="sync"){const Q=Bm();R=Q.__watcherHandles||(Q.__watcherHandles=[])}else return Nr;let P=I?new Array(e.length).fill(As):As;const ce=()=>{if(ie.active)if(t){const Q=ie.run();(i||S||(I?Q.some((de,oe)=>Wi(de,P[oe])):Wi(Q,P)))&&(C&&C(),Or(t,A,3,[Q,P===As?void 0:I&&P[0]===As?[]:P,b]),P=Q)}else ie.run()};ce.allowRecurse=!!t;let J;u==="sync"?J=ce:u==="post"?J=()=>fr(ce,A&&A.suspense):(ce.pre=!0,A&&(ce.id=A.uid),J=()=>mu(ce));const ie=new uu(y,J);t?r?ce():P=ie.run():u==="post"?fr(ie.run.bind(ie),A&&A.suspense):ie.run();const fe=()=>{ie.stop(),A&&A.scope&&iu(A.scope.effects,ie)};return R&&R.push(fe),fe}function Yg(e,t,r){const i=this.proxy,u=Zt(e)?e.includes(".")?Bf(i,e):()=>i[e]:e.bind(i,i);let d;yt(t)?d=t:(d=t.handler,r=t);const T=tr;li(this);const A=Ff(u,d.bind(i),r);return T?li(T):wn(),A}function Bf(e,t){const r=t.split(".");return()=>{let i=e;for(let u=0;u<r.length&&i;u++)i=i[r[u]];return i}}function xn(e,t){if(!Kt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),ir(e))xn(e.value,t);else if(pt(e))for(let r=0;r<e.length;r++)xn(e[r],t);else if(uf(e)||ti(e))e.forEach(r=>{xn(r,t)});else if(ff(e))for(const r in e)xn(e[r],t);return e}function Uf(e){return yt(e)?{setup:e,name:e.name}:e}const xs=e=>!!e.type.__asyncLoader,Hf=e=>e.type.__isKeepAlive;function Vg(e,t){Gf(e,"a",t)}function jg(e,t){Gf(e,"da",t)}function Gf(e,t,r=tr){const i=e.__wdc||(e.__wdc=()=>{let u=r;for(;u;){if(u.isDeactivated)return;u=u.parent}return e()});if(aa(t,i,r),r){let u=r.parent;for(;u&&u.parent;)Hf(u.parent.vnode)&&qg(i,t,r,u),u=u.parent}}function qg(e,t,r,i){const u=aa(t,e,i,!0);Kf(()=>{iu(i[t],u)},r)}function aa(e,t,r=tr,i=!1){if(r){const u=r[e]||(r[e]=[]),d=t.__weh||(t.__weh=(...T)=>{if(r.isUnmounted)return;mi(),li(r);const A=Or(t,r,e,T);return wn(),pi(),A});return i?u.unshift(d):u.push(d),d}}const sn=e=>(t,r=tr)=>(!Zi||e==="sp")&&aa(e,(...i)=>t(...i),r),Wg=sn("bm"),Xg=sn("m"),Qg=sn("bu"),zg=sn("u"),$g=sn("bum"),Kf=sn("um"),Zg=sn("sp"),Jg=sn("rtg"),em=sn("rtc");function tm(e,t=tr){aa("ec",e,t)}function bA(e,t){const r=yr;if(r===null)return e;const i=la(r)||r.proxy,u=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[T,A,y,S=Bt]=t[d];T&&(yt(T)&&(T={mounted:T,updated:T}),T.deep&&xn(A),u.push({dir:T,instance:i,value:A,oldValue:void 0,arg:y,modifiers:S}))}return e}function Sn(e,t,r,i){const u=e.dirs,d=t&&t.dirs;for(let T=0;T<u.length;T++){const A=u[T];d&&(A.oldValue=d[T].value);let y=A.dir[i];y&&(mi(),Or(y,r,8,[e.el,A,e,t]),pi())}}const Yf="components",rm="directives";function yA(e,t){return Vf(Yf,e,!0,t)||e}const nm=Symbol();function AA(e){return Vf(rm,e)}function Vf(e,t,r=!0,i=!1){const u=yr||tr;if(u){const d=u.type;if(e===Yf){const A=wm(d,!1);if(A&&(A===t||A===jr(t)||A===ra(jr(t))))return d}const T=Hl(u[e]||d[e],t)||Hl(u.appContext[e],t);return!T&&i?d:T}}function Hl(e,t){return e&&(e[t]||e[jr(t)]||e[ra(jr(t))])}function _A(e,t,r,i){let u;const d=r&&r[i];if(pt(e)||Zt(e)){u=new Array(e.length);for(let T=0,A=e.length;T<A;T++)u[T]=t(e[T],T,void 0,d&&d[T])}else if(typeof e=="number"){u=new Array(e);for(let T=0;T<e;T++)u[T]=t(T+1,T,void 0,d&&d[T])}else if(Kt(e))if(e[Symbol.iterator])u=Array.from(e,(T,A)=>t(T,A,void 0,d&&d[A]));else{const T=Object.keys(e);u=new Array(T.length);for(let A=0,y=T.length;A<y;A++){const S=T[A];u[A]=t(e[S],S,A,d&&d[A])}}else u=[];return r&&(r[i]=u),u}const xo=e=>e?rd(e)?la(e)||e.proxy:xo(e.parent):null,wi=or(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>xo(e.parent),$root:e=>xo(e.root),$emit:e=>e.emit,$options:e=>pu(e),$forceUpdate:e=>e.f||(e.f=()=>mu(e.update)),$nextTick:e=>e.n||(e.n=Of.bind(e.proxy)),$watch:e=>Yg.bind(e)}),lo=(e,t)=>e!==Bt&&!e.__isScriptSetup&&Dt(e,t),im={get({_:e},t){const{ctx:r,setupState:i,data:u,props:d,accessCache:T,type:A,appContext:y}=e;let S;if(t[0]!=="$"){const R=T[t];if(R!==void 0)switch(R){case 1:return i[t];case 2:return u[t];case 4:return r[t];case 3:return d[t]}else{if(lo(i,t))return T[t]=1,i[t];if(u!==Bt&&Dt(u,t))return T[t]=2,u[t];if((S=e.propsOptions[0])&&Dt(S,t))return T[t]=3,d[t];if(r!==Bt&&Dt(r,t))return T[t]=4,r[t];ko&&(T[t]=0)}}const I=wi[t];let C,b;if(I)return t==="$attrs"&&Er(e,"get",t),I(e);if((C=A.__cssModules)&&(C=C[t]))return C;if(r!==Bt&&Dt(r,t))return T[t]=4,r[t];if(b=y.config.globalProperties,Dt(b,t))return b[t]},set({_:e},t,r){const{data:i,setupState:u,ctx:d}=e;return lo(u,t)?(u[t]=r,!0):i!==Bt&&Dt(i,t)?(i[t]=r,!0):Dt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(d[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:i,appContext:u,propsOptions:d}},T){let A;return!!r[T]||e!==Bt&&Dt(e,T)||lo(t,T)||(A=d[0])&&Dt(A,T)||Dt(i,T)||Dt(wi,T)||Dt(u.config.globalProperties,T)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Dt(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let ko=!0;function sm(e){const t=pu(e),r=e.proxy,i=e.ctx;ko=!1,t.beforeCreate&&Gl(t.beforeCreate,e,"bc");const{data:u,computed:d,methods:T,watch:A,provide:y,inject:S,created:I,beforeMount:C,mounted:b,beforeUpdate:R,updated:P,activated:ce,deactivated:J,beforeDestroy:ie,beforeUnmount:fe,destroyed:Q,unmounted:de,render:oe,renderTracked:se,renderTriggered:ae,errorCaptured:we,serverPrefetch:Ue,expose:Je,inheritAttrs:ue,components:w,directives:z,filters:H}=t;if(S&&am(S,i,null,e.appContext.config.unwrapInjectedRef),T)for(const ve in T){const pe=T[ve];yt(pe)&&(i[ve]=pe.bind(r))}if(u){const ve=u.call(r,r);Kt(ve)&&(e.data=is(ve))}if(ko=!0,d)for(const ve in d){const pe=d[ve],We=yt(pe)?pe.bind(r,r):yt(pe.get)?pe.get.bind(r,r):Nr,Ze=!yt(pe)&&yt(pe.set)?pe.set.bind(r):Nr,Qe=br({get:We,set:Ze});Object.defineProperty(i,ve,{enumerable:!0,configurable:!0,get:()=>Qe.value,set:Ve=>Qe.value=Ve})}if(A)for(const ve in A)jf(A[ve],i,r,ve);if(y){const ve=yt(y)?y.call(r):y;Reflect.ownKeys(ve).forEach(pe=>{Ns(pe,ve[pe])})}I&&Gl(I,e,"c");function Re(ve,pe){pt(pe)?pe.forEach(We=>ve(We.bind(r))):pe&&ve(pe.bind(r))}if(Re(Wg,C),Re(Xg,b),Re(Qg,R),Re(zg,P),Re(Vg,ce),Re(jg,J),Re(tm,we),Re(em,se),Re(Jg,ae),Re($g,fe),Re(Kf,de),Re(Zg,Ue),pt(Je))if(Je.length){const ve=e.exposed||(e.exposed={});Je.forEach(pe=>{Object.defineProperty(ve,pe,{get:()=>r[pe],set:We=>r[pe]=We})})}else e.exposed||(e.exposed={});oe&&e.render===Nr&&(e.render=oe),ue!=null&&(e.inheritAttrs=ue),w&&(e.components=w),z&&(e.directives=z)}function am(e,t,r=Nr,i=!1){pt(e)&&(e=Po(e));for(const u in e){const d=e[u];let T;Kt(d)?"default"in d?T=tn(d.from||u,d.default,!0):T=tn(d.from||u):T=tn(d),ir(T)&&i?Object.defineProperty(t,u,{enumerable:!0,configurable:!0,get:()=>T.value,set:A=>T.value=A}):t[u]=T}}function Gl(e,t,r){Or(pt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,r)}function jf(e,t,r,i){const u=i.includes(".")?Bf(r,i):()=>r[i];if(Zt(e)){const d=t[e];yt(d)&&Os(u,d)}else if(yt(e))Os(u,e.bind(r));else if(Kt(e))if(pt(e))e.forEach(d=>jf(d,t,r,i));else{const d=yt(e.handler)?e.handler.bind(r):t[e.handler];yt(d)&&Os(u,d,e)}}function pu(e){const t=e.type,{mixins:r,extends:i}=t,{mixins:u,optionsCache:d,config:{optionMergeStrategies:T}}=e.appContext,A=d.get(t);let y;return A?y=A:!u.length&&!r&&!i?y=t:(y={},u.length&&u.forEach(S=>Gs(y,S,T,!0)),Gs(y,t,T)),Kt(t)&&d.set(t,y),y}function Gs(e,t,r,i=!1){const{mixins:u,extends:d}=t;d&&Gs(e,d,r,!0),u&&u.forEach(T=>Gs(e,T,r,!0));for(const T in t)if(!(i&&T==="expose")){const A=om[T]||r&&r[T];e[T]=A?A(e[T],t[T]):t[T]}return e}const om={data:Kl,props:Ln,emits:Ln,methods:Ln,computed:Ln,beforeCreate:ar,created:ar,beforeMount:ar,mounted:ar,beforeUpdate:ar,updated:ar,beforeDestroy:ar,beforeUnmount:ar,destroyed:ar,unmounted:ar,activated:ar,deactivated:ar,errorCaptured:ar,serverPrefetch:ar,components:Ln,directives:Ln,watch:lm,provide:Kl,inject:um};function Kl(e,t){return t?e?function(){return or(yt(e)?e.call(this,this):e,yt(t)?t.call(this,this):t)}:t:e}function um(e,t){return Ln(Po(e),Po(t))}function Po(e){if(pt(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function ar(e,t){return e?[...new Set([].concat(e,t))]:t}function Ln(e,t){return e?or(or(Object.create(null),e),t):t}function lm(e,t){if(!e)return t;if(!t)return e;const r=or(Object.create(null),e);for(const i in t)r[i]=ar(e[i],t[i]);return r}function cm(e,t,r,i=!1){const u={},d={};Fs(d,ua,1),e.propsDefaults=Object.create(null),qf(e,t,u,d);for(const T in e.propsOptions[0])T in u||(u[T]=void 0);r?e.props=i?u:_g(u):e.type.props?e.props=u:e.props=d,e.attrs=d}function fm(e,t,r,i){const{props:u,attrs:d,vnode:{patchFlag:T}}=e,A=kt(u),[y]=e.propsOptions;let S=!1;if((i||T>0)&&!(T&16)){if(T&8){const I=e.vnode.dynamicProps;for(let C=0;C<I.length;C++){let b=I[C];if(sa(e.emitsOptions,b))continue;const R=t[b];if(y)if(Dt(d,b))R!==d[b]&&(d[b]=R,S=!0);else{const P=jr(b);u[P]=wo(y,A,P,R,e,!1)}else R!==d[b]&&(d[b]=R,S=!0)}}}else{qf(e,t,u,d)&&(S=!0);let I;for(const C in A)(!t||!Dt(t,C)&&((I=gi(C))===C||!Dt(t,I)))&&(y?r&&(r[C]!==void 0||r[I]!==void 0)&&(u[C]=wo(y,A,C,void 0,e,!0)):delete u[C]);if(d!==A)for(const C in d)(!t||!Dt(t,C))&&(delete d[C],S=!0)}S&&nn(e,"set","$attrs")}function qf(e,t,r,i){const[u,d]=e.propsOptions;let T=!1,A;if(t)for(let y in t){if(Rs(y))continue;const S=t[y];let I;u&&Dt(u,I=jr(y))?!d||!d.includes(I)?r[I]=S:(A||(A={}))[I]=S:sa(e.emitsOptions,y)||(!(y in i)||S!==i[y])&&(i[y]=S,T=!0)}if(d){const y=kt(r),S=A||Bt;for(let I=0;I<d.length;I++){const C=d[I];r[C]=wo(u,y,C,S[C],e,!Dt(S,C))}}return T}function wo(e,t,r,i,u,d){const T=e[r];if(T!=null){const A=Dt(T,"default");if(A&&i===void 0){const y=T.default;if(T.type!==Function&&yt(y)){const{propsDefaults:S}=u;r in S?i=S[r]:(li(u),i=S[r]=y.call(null,t),wn())}else i=y}T[0]&&(d&&!A?i=!1:T[1]&&(i===""||i===gi(r))&&(i=!0))}return i}function Wf(e,t,r=!1){const i=t.propsCache,u=i.get(e);if(u)return u;const d=e.props,T={},A=[];let y=!1;if(!yt(e)){const I=C=>{y=!0;const[b,R]=Wf(C,t,!0);or(T,b),R&&A.push(...R)};!r&&t.mixins.length&&t.mixins.forEach(I),e.extends&&I(e.extends),e.mixins&&e.mixins.forEach(I)}if(!d&&!y)return Kt(e)&&i.set(e,ei),ei;if(pt(d))for(let I=0;I<d.length;I++){const C=jr(d[I]);Yl(C)&&(T[C]=Bt)}else if(d)for(const I in d){const C=jr(I);if(Yl(C)){const b=d[I],R=T[C]=pt(b)||yt(b)?{type:b}:Object.assign({},b);if(R){const P=ql(Boolean,R.type),ce=ql(String,R.type);R[0]=P>-1,R[1]=ce<0||P<ce,(P>-1||Dt(R,"default"))&&A.push(C)}}}const S=[T,A];return Kt(e)&&i.set(e,S),S}function Yl(e){return e[0]!=="$"}function Vl(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function jl(e,t){return Vl(e)===Vl(t)}function ql(e,t){return pt(t)?t.findIndex(r=>jl(r,e)):yt(t)&&jl(t,e)?0:-1}const Xf=e=>e[0]==="_"||e==="$stable",Eu=e=>pt(e)?e.map(Hr):[Hr(e)],dm=(e,t,r)=>{if(t._n)return t;const i=Mg((...u)=>Eu(t(...u)),r);return i._c=!1,i},Qf=(e,t,r)=>{const i=e._ctx;for(const u in e){if(Xf(u))continue;const d=e[u];if(yt(d))t[u]=dm(u,d,i);else if(d!=null){const T=Eu(d);t[u]=()=>T}}},zf=(e,t)=>{const r=Eu(t);e.slots.default=()=>r},hm=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=kt(t),Fs(t,"_",r)):Qf(t,e.slots={})}else e.slots={},t&&zf(e,t);Fs(e.slots,ua,1)},gm=(e,t,r)=>{const{vnode:i,slots:u}=e;let d=!0,T=Bt;if(i.shapeFlag&32){const A=t._;A?r&&A===1?d=!1:(or(u,t),!r&&A===1&&delete u._):(d=!t.$stable,Qf(t,u)),T=t}else t&&(zf(e,t),T={default:1});if(d)for(const A in u)!Xf(A)&&!(A in T)&&delete u[A]};function $f(){return{app:null,config:{isNativeTag:Y0,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let mm=0;function pm(e,t){return function(i,u=null){yt(i)||(i=Object.assign({},i)),u!=null&&!Kt(u)&&(u=null);const d=$f(),T=new Set;let A=!1;const y=d.app={_uid:mm++,_component:i,_props:u,_container:null,_context:d,_instance:null,version:Um,get config(){return d.config},set config(S){},use(S,...I){return T.has(S)||(S&&yt(S.install)?(T.add(S),S.install(y,...I)):yt(S)&&(T.add(S),S(y,...I))),y},mixin(S){return d.mixins.includes(S)||d.mixins.push(S),y},component(S,I){return I?(d.components[S]=I,y):d.components[S]},directive(S,I){return I?(d.directives[S]=I,y):d.directives[S]},mount(S,I,C){if(!A){const b=mr(i,u);return b.appContext=d,I&&t?t(b,S):e(b,S,C),A=!0,y._container=S,S.__vue_app__=y,la(b.component)||b.component.proxy}},unmount(){A&&(e(null,y._container),delete y._container.__vue_app__)},provide(S,I){return d.provides[S]=I,y}};return y}}function Mo(e,t,r,i,u=!1){if(pt(e)){e.forEach((b,R)=>Mo(b,t&&(pt(t)?t[R]:t),r,i,u));return}if(xs(i)&&!u)return;const d=i.shapeFlag&4?la(i.component)||i.component.proxy:i.el,T=u?null:d,{i:A,r:y}=e,S=t&&t.r,I=A.refs===Bt?A.refs={}:A.refs,C=A.setupState;if(S!=null&&S!==y&&(Zt(S)?(I[S]=null,Dt(C,S)&&(C[S]=null)):ir(S)&&(S.value=null)),yt(y))mn(y,A,12,[T,I]);else{const b=Zt(y),R=ir(y);if(b||R){const P=()=>{if(e.f){const ce=b?Dt(C,y)?C[y]:I[y]:y.value;u?pt(ce)&&iu(ce,d):pt(ce)?ce.includes(d)||ce.push(d):b?(I[y]=[d],Dt(C,y)&&(C[y]=I[y])):(y.value=[d],e.k&&(I[e.k]=y.value))}else b?(I[y]=T,Dt(C,y)&&(C[y]=T)):R&&(y.value=T,e.k&&(I[e.k]=T))};T?(P.id=-1,fr(P,r)):P()}}}const fr=Kg;function Em(e){return Tm(e)}function Tm(e,t){const r=Q0();r.__VUE__=!0;const{insert:i,remove:u,patchProp:d,createElement:T,createText:A,createComment:y,setText:S,setElementText:I,parentNode:C,nextSibling:b,setScopeId:R=Nr,insertStaticContent:P}=e,ce=(N,O,V,re=null,me=null,Ne=null,Me=!1,ke=null,Be=!!O.dynamicChildren)=>{if(N===O)return;N&&!Ri(N,O)&&(re=q(N),Ve(N,me,Ne,!0),N=null),O.patchFlag===-2&&(Be=!1,O.dynamicChildren=null);const{type:Ce,ref:ze,shapeFlag:He}=O;switch(Ce){case oa:J(N,O,V,re);break;case Mn:ie(N,O,V,re);break;case ks:N==null&&fe(O,V,re,Me);break;case en:w(N,O,V,re,me,Ne,Me,ke,Be);break;default:He&1?oe(N,O,V,re,me,Ne,Me,ke,Be):He&6?z(N,O,V,re,me,Ne,Me,ke,Be):(He&64||He&128)&&Ce.process(N,O,V,re,me,Ne,Me,ke,Be,Ae)}ze!=null&&me&&Mo(ze,N&&N.ref,Ne,O||N,!O)},J=(N,O,V,re)=>{if(N==null)i(O.el=A(O.children),V,re);else{const me=O.el=N.el;O.children!==N.children&&S(me,O.children)}},ie=(N,O,V,re)=>{N==null?i(O.el=y(O.children||""),V,re):O.el=N.el},fe=(N,O,V,re)=>{[N.el,N.anchor]=P(N.children,O,V,re,N.el,N.anchor)},Q=({el:N,anchor:O},V,re)=>{let me;for(;N&&N!==O;)me=b(N),i(N,V,re),N=me;i(O,V,re)},de=({el:N,anchor:O})=>{let V;for(;N&&N!==O;)V=b(N),u(N),N=V;u(O)},oe=(N,O,V,re,me,Ne,Me,ke,Be)=>{Me=Me||O.type==="svg",N==null?se(O,V,re,me,Ne,Me,ke,Be):Ue(N,O,me,Ne,Me,ke,Be)},se=(N,O,V,re,me,Ne,Me,ke)=>{let Be,Ce;const{type:ze,props:He,shapeFlag:Ge,transition:et,dirs:nt}=N;if(Be=N.el=T(N.type,Ne,He&&He.is,He),Ge&8?I(Be,N.children):Ge&16&&we(N.children,Be,null,re,me,Ne&&ze!=="foreignObject",Me,ke),nt&&Sn(N,null,re,"created"),He){for(const dt in He)dt!=="value"&&!Rs(dt)&&d(Be,dt,null,He[dt],Ne,N.children,re,me,$);"value"in He&&d(Be,"value",null,He.value),(Ce=He.onVnodeBeforeMount)&&Fr(Ce,re,N)}ae(Be,N,N.scopeId,Me,re),nt&&Sn(N,null,re,"beforeMount");const ft=(!me||me&&!me.pendingBranch)&&et&&!et.persisted;ft&&et.beforeEnter(Be),i(Be,O,V),((Ce=He&&He.onVnodeMounted)||ft||nt)&&fr(()=>{Ce&&Fr(Ce,re,N),ft&&et.enter(Be),nt&&Sn(N,null,re,"mounted")},me)},ae=(N,O,V,re,me)=>{if(V&&R(N,V),re)for(let Ne=0;Ne<re.length;Ne++)R(N,re[Ne]);if(me){let Ne=me.subTree;if(O===Ne){const Me=me.vnode;ae(N,Me,Me.scopeId,Me.slotScopeIds,me.parent)}}},we=(N,O,V,re,me,Ne,Me,ke,Be=0)=>{for(let Ce=Be;Ce<N.length;Ce++){const ze=N[Ce]=ke?dn(N[Ce]):Hr(N[Ce]);ce(null,ze,O,V,re,me,Ne,Me,ke)}},Ue=(N,O,V,re,me,Ne,Me)=>{const ke=O.el=N.el;let{patchFlag:Be,dynamicChildren:Ce,dirs:ze}=O;Be|=N.patchFlag&16;const He=N.props||Bt,Ge=O.props||Bt;let et;V&&In(V,!1),(et=Ge.onVnodeBeforeUpdate)&&Fr(et,V,O,N),ze&&Sn(O,N,V,"beforeUpdate"),V&&In(V,!0);const nt=me&&O.type!=="foreignObject";if(Ce?Je(N.dynamicChildren,Ce,ke,V,re,nt,Ne):Me||pe(N,O,ke,null,V,re,nt,Ne,!1),Be>0){if(Be&16)ue(ke,O,He,Ge,V,re,me);else if(Be&2&&He.class!==Ge.class&&d(ke,"class",null,Ge.class,me),Be&4&&d(ke,"style",He.style,Ge.style,me),Be&8){const ft=O.dynamicProps;for(let dt=0;dt<ft.length;dt++){const Et=ft[dt],Ft=He[Et],te=Ge[Et];(te!==Ft||Et==="value")&&d(ke,Et,Ft,te,me,N.children,V,re,$)}}Be&1&&N.children!==O.children&&I(ke,O.children)}else!Me&&Ce==null&&ue(ke,O,He,Ge,V,re,me);((et=Ge.onVnodeUpdated)||ze)&&fr(()=>{et&&Fr(et,V,O,N),ze&&Sn(O,N,V,"updated")},re)},Je=(N,O,V,re,me,Ne,Me)=>{for(let ke=0;ke<O.length;ke++){const Be=N[ke],Ce=O[ke],ze=Be.el&&(Be.type===en||!Ri(Be,Ce)||Be.shapeFlag&70)?C(Be.el):V;ce(Be,Ce,ze,null,re,me,Ne,Me,!0)}},ue=(N,O,V,re,me,Ne,Me)=>{if(V!==re){if(V!==Bt)for(const ke in V)!Rs(ke)&&!(ke in re)&&d(N,ke,V[ke],null,Me,O.children,me,Ne,$);for(const ke in re){if(Rs(ke))continue;const Be=re[ke],Ce=V[ke];Be!==Ce&&ke!=="value"&&d(N,ke,Ce,Be,Me,O.children,me,Ne,$)}"value"in re&&d(N,"value",V.value,re.value)}},w=(N,O,V,re,me,Ne,Me,ke,Be)=>{const Ce=O.el=N?N.el:A(""),ze=O.anchor=N?N.anchor:A("");let{patchFlag:He,dynamicChildren:Ge,slotScopeIds:et}=O;et&&(ke=ke?ke.concat(et):et),N==null?(i(Ce,V,re),i(ze,V,re),we(O.children,V,ze,me,Ne,Me,ke,Be)):He>0&&He&64&&Ge&&N.dynamicChildren?(Je(N.dynamicChildren,Ge,V,me,Ne,Me,ke),(O.key!=null||me&&O===me.subTree)&&Zf(N,O,!0)):pe(N,O,V,ze,me,Ne,Me,ke,Be)},z=(N,O,V,re,me,Ne,Me,ke,Be)=>{O.slotScopeIds=ke,N==null?O.shapeFlag&512?me.ctx.activate(O,V,re,Me,Be):H(O,V,re,me,Ne,Me,Be):Te(N,O,Be)},H=(N,O,V,re,me,Ne,Me)=>{const ke=N.component=Nm(N,re,me);if(Hf(N)&&(ke.ctx.renderer=Ae),Om(ke),ke.asyncDep){if(me&&me.registerDep(ke,Re),!N.el){const Be=ke.subTree=mr(Mn);ie(null,Be,O,V)}return}Re(ke,N,O,V,me,Ne,Me)},Te=(N,O,V)=>{const re=O.component=N.component;if(Ug(N,O,V))if(re.asyncDep&&!re.asyncResolved){ve(re,O,V);return}else re.next=O,xg(re.update),re.update();else O.el=N.el,re.vnode=O},Re=(N,O,V,re,me,Ne,Me)=>{const ke=()=>{if(N.isMounted){let{next:ze,bu:He,u:Ge,parent:et,vnode:nt}=N,ft=ze,dt;In(N,!1),ze?(ze.el=nt.el,ve(N,ze,Me)):ze=nt,He&&Ds(He),(dt=ze.props&&ze.props.onVnodeBeforeUpdate)&&Fr(dt,et,ze,nt),In(N,!0);const Et=uo(N),Ft=N.subTree;N.subTree=Et,ce(Ft,Et,C(Ft.el),q(Ft),N,me,Ne),ze.el=Et.el,ft===null&&Hg(N,Et.el),Ge&&fr(Ge,me),(dt=ze.props&&ze.props.onVnodeUpdated)&&fr(()=>Fr(dt,et,ze,nt),me)}else{let ze;const{el:He,props:Ge}=O,{bm:et,m:nt,parent:ft}=N,dt=xs(O);if(In(N,!1),et&&Ds(et),!dt&&(ze=Ge&&Ge.onVnodeBeforeMount)&&Fr(ze,ft,O),In(N,!0),He&&Ie){const Et=()=>{N.subTree=uo(N),Ie(He,N.subTree,N,me,null)};dt?O.type.__asyncLoader().then(()=>!N.isUnmounted&&Et()):Et()}else{const Et=N.subTree=uo(N);ce(null,Et,V,re,N,me,Ne),O.el=Et.el}if(nt&&fr(nt,me),!dt&&(ze=Ge&&Ge.onVnodeMounted)){const Et=O;fr(()=>Fr(ze,ft,Et),me)}(O.shapeFlag&256||ft&&xs(ft.vnode)&&ft.vnode.shapeFlag&256)&&N.a&&fr(N.a,me),N.isMounted=!0,O=V=re=null}},Be=N.effect=new uu(ke,()=>mu(Ce),N.scope),Ce=N.update=()=>Be.run();Ce.id=N.uid,In(N,!0),Ce()},ve=(N,O,V)=>{O.component=N;const re=N.vnode.props;N.vnode=O,N.next=null,fm(N,O.props,re,V),gm(N,O.children,V),mi(),Bl(),pi()},pe=(N,O,V,re,me,Ne,Me,ke,Be=!1)=>{const Ce=N&&N.children,ze=N?N.shapeFlag:0,He=O.children,{patchFlag:Ge,shapeFlag:et}=O;if(Ge>0){if(Ge&128){Ze(Ce,He,V,re,me,Ne,Me,ke,Be);return}else if(Ge&256){We(Ce,He,V,re,me,Ne,Me,ke,Be);return}}et&8?(ze&16&&$(Ce,me,Ne),He!==Ce&&I(V,He)):ze&16?et&16?Ze(Ce,He,V,re,me,Ne,Me,ke,Be):$(Ce,me,Ne,!0):(ze&8&&I(V,""),et&16&&we(He,V,re,me,Ne,Me,ke,Be))},We=(N,O,V,re,me,Ne,Me,ke,Be)=>{N=N||ei,O=O||ei;const Ce=N.length,ze=O.length,He=Math.min(Ce,ze);let Ge;for(Ge=0;Ge<He;Ge++){const et=O[Ge]=Be?dn(O[Ge]):Hr(O[Ge]);ce(N[Ge],et,V,null,me,Ne,Me,ke,Be)}Ce>ze?$(N,me,Ne,!0,!1,He):we(O,V,re,me,Ne,Me,ke,Be,He)},Ze=(N,O,V,re,me,Ne,Me,ke,Be)=>{let Ce=0;const ze=O.length;let He=N.length-1,Ge=ze-1;for(;Ce<=He&&Ce<=Ge;){const et=N[Ce],nt=O[Ce]=Be?dn(O[Ce]):Hr(O[Ce]);if(Ri(et,nt))ce(et,nt,V,null,me,Ne,Me,ke,Be);else break;Ce++}for(;Ce<=He&&Ce<=Ge;){const et=N[He],nt=O[Ge]=Be?dn(O[Ge]):Hr(O[Ge]);if(Ri(et,nt))ce(et,nt,V,null,me,Ne,Me,ke,Be);else break;He--,Ge--}if(Ce>He){if(Ce<=Ge){const et=Ge+1,nt=et<ze?O[et].el:re;for(;Ce<=Ge;)ce(null,O[Ce]=Be?dn(O[Ce]):Hr(O[Ce]),V,nt,me,Ne,Me,ke,Be),Ce++}}else if(Ce>Ge)for(;Ce<=He;)Ve(N[Ce],me,Ne,!0),Ce++;else{const et=Ce,nt=Ce,ft=new Map;for(Ce=nt;Ce<=Ge;Ce++){const U=O[Ce]=Be?dn(O[Ce]):Hr(O[Ce]);U.key!=null&&ft.set(U.key,Ce)}let dt,Et=0;const Ft=Ge-nt+1;let te=!1,W=0;const D=new Array(Ft);for(Ce=0;Ce<Ft;Ce++)D[Ce]=0;for(Ce=et;Ce<=He;Ce++){const U=N[Ce];if(Et>=Ft){Ve(U,me,Ne,!0);continue}let X;if(U.key!=null)X=ft.get(U.key);else for(dt=nt;dt<=Ge;dt++)if(D[dt-nt]===0&&Ri(U,O[dt])){X=dt;break}X===void 0?Ve(U,me,Ne,!0):(D[X-nt]=Ce+1,X>=W?W=X:te=!0,ce(U,O[X],V,null,me,Ne,Me,ke,Be),Et++)}const G=te?vm(D):ei;for(dt=G.length-1,Ce=Ft-1;Ce>=0;Ce--){const U=nt+Ce,X=O[U],ee=U+1<ze?O[U+1].el:re;D[Ce]===0?ce(null,X,V,ee,me,Ne,Me,ke,Be):te&&(dt<0||Ce!==G[dt]?Qe(X,V,ee,2):dt--)}}},Qe=(N,O,V,re,me=null)=>{const{el:Ne,type:Me,transition:ke,children:Be,shapeFlag:Ce}=N;if(Ce&6){Qe(N.component.subTree,O,V,re);return}if(Ce&128){N.suspense.move(O,V,re);return}if(Ce&64){Me.move(N,O,V,Ae);return}if(Me===en){i(Ne,O,V);for(let He=0;He<Be.length;He++)Qe(Be[He],O,V,re);i(N.anchor,O,V);return}if(Me===ks){Q(N,O,V);return}if(re!==2&&Ce&1&&ke)if(re===0)ke.beforeEnter(Ne),i(Ne,O,V),fr(()=>ke.enter(Ne),me);else{const{leave:He,delayLeave:Ge,afterLeave:et}=ke,nt=()=>i(Ne,O,V),ft=()=>{He(Ne,()=>{nt(),et&&et()})};Ge?Ge(Ne,nt,ft):ft()}else i(Ne,O,V)},Ve=(N,O,V,re=!1,me=!1)=>{const{type:Ne,props:Me,ref:ke,children:Be,dynamicChildren:Ce,shapeFlag:ze,patchFlag:He,dirs:Ge}=N;if(ke!=null&&Mo(ke,null,V,N,!0),ze&256){O.ctx.deactivate(N);return}const et=ze&1&&Ge,nt=!xs(N);let ft;if(nt&&(ft=Me&&Me.onVnodeBeforeUnmount)&&Fr(ft,O,N),ze&6)B(N.component,V,re);else{if(ze&128){N.suspense.unmount(V,re);return}et&&Sn(N,null,O,"beforeUnmount"),ze&64?N.type.remove(N,O,V,me,Ae,re):Ce&&(Ne!==en||He>0&&He&64)?$(Ce,O,V,!1,!0):(Ne===en&&He&384||!me&&ze&16)&&$(Be,O,V),re&&lt(N)}(nt&&(ft=Me&&Me.onVnodeUnmounted)||et)&&fr(()=>{ft&&Fr(ft,O,N),et&&Sn(N,null,O,"unmounted")},V)},lt=N=>{const{type:O,el:V,anchor:re,transition:me}=N;if(O===en){At(V,re);return}if(O===ks){de(N);return}const Ne=()=>{u(V),me&&!me.persisted&&me.afterLeave&&me.afterLeave()};if(N.shapeFlag&1&&me&&!me.persisted){const{leave:Me,delayLeave:ke}=me,Be=()=>Me(V,Ne);ke?ke(N.el,Ne,Be):Be()}else Ne()},At=(N,O)=>{let V;for(;N!==O;)V=b(N),u(N),N=V;u(O)},B=(N,O,V)=>{const{bum:re,scope:me,update:Ne,subTree:Me,um:ke}=N;re&&Ds(re),me.stop(),Ne&&(Ne.active=!1,Ve(Me,N,O,V)),ke&&fr(ke,O),fr(()=>{N.isUnmounted=!0},O),O&&O.pendingBranch&&!O.isUnmounted&&N.asyncDep&&!N.asyncResolved&&N.suspenseId===O.pendingId&&(O.deps--,O.deps===0&&O.resolve())},$=(N,O,V,re=!1,me=!1,Ne=0)=>{for(let Me=Ne;Me<N.length;Me++)Ve(N[Me],O,V,re,me)},q=N=>N.shapeFlag&6?q(N.component.subTree):N.shapeFlag&128?N.suspense.next():b(N.anchor||N.el),ge=(N,O,V)=>{N==null?O._vnode&&Ve(O._vnode,null,null,!0):ce(O._vnode||null,N,O,null,null,null,V),Bl(),kf(),O._vnode=N},Ae={p:ce,um:Ve,m:Qe,r:lt,mt:H,mc:we,pc:pe,pbc:Je,n:q,o:e};let xe,Ie;return t&&([xe,Ie]=t(Ae)),{render:ge,hydrate:xe,createApp:pm(ge,xe)}}function In({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function Zf(e,t,r=!1){const i=e.children,u=t.children;if(pt(i)&&pt(u))for(let d=0;d<i.length;d++){const T=i[d];let A=u[d];A.shapeFlag&1&&!A.dynamicChildren&&((A.patchFlag<=0||A.patchFlag===32)&&(A=u[d]=dn(u[d]),A.el=T.el),r||Zf(T,A)),A.type===oa&&(A.el=T.el)}}function vm(e){const t=e.slice(),r=[0];let i,u,d,T,A;const y=e.length;for(i=0;i<y;i++){const S=e[i];if(S!==0){if(u=r[r.length-1],e[u]<S){t[i]=u,r.push(i);continue}for(d=0,T=r.length-1;d<T;)A=d+T>>1,e[r[A]]<S?d=A+1:T=A;S<e[r[d]]&&(d>0&&(t[i]=r[d-1]),r[d]=i)}}for(d=r.length,T=r[d-1];d-- >0;)r[d]=T,T=t[T];return r}const bm=e=>e.__isTeleport,en=Symbol(void 0),oa=Symbol(void 0),Mn=Symbol(void 0),ks=Symbol(void 0),Mi=[];let Dr=null;function ym(e=!1){Mi.push(Dr=e?null:[])}function Am(){Mi.pop(),Dr=Mi[Mi.length-1]||null}let $i=1;function Wl(e){$i+=e}function Jf(e){return e.dynamicChildren=$i>0?Dr||ei:null,Am(),$i>0&&Dr&&Dr.push(e),e}function SA(e,t,r,i,u,d){return Jf(td(e,t,r,i,u,d,!0))}function _m(e,t,r,i,u){return Jf(mr(e,t,r,i,u,!0))}function Fo(e){return e?e.__v_isVNode===!0:!1}function Ri(e,t){return e.type===t.type&&e.key===t.key}const ua="__vInternal",ed=({key:e})=>e??null,Ps=({ref:e,ref_key:t,ref_for:r})=>e!=null?Zt(e)||ir(e)||yt(e)?{i:yr,r:e,k:t,f:!!r}:e:null;function td(e,t=null,r=null,i=0,u=null,d=e===en?0:1,T=!1,A=!1){const y={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&ed(t),ref:t&&Ps(t),scopeId:Mf,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:i,dynamicProps:u,dynamicChildren:null,appContext:null,ctx:yr};return A?(Tu(y,r),d&128&&e.normalize(y)):r&&(y.shapeFlag|=Zt(r)?8:16),$i>0&&!T&&Dr&&(y.patchFlag>0||d&6)&&y.patchFlag!==32&&Dr.push(y),y}const mr=Sm;function Sm(e,t=null,r=null,i=0,u=null,d=!1){if((!e||e===nm)&&(e=Mn),Fo(e)){const A=ui(e,t,!0);return r&&Tu(A,r),$i>0&&!d&&Dr&&(A.shapeFlag&6?Dr[Dr.indexOf(e)]=A:Dr.push(A)),A.patchFlag|=-2,A}if(Mm(e)&&(e=e.__vccOpts),t){t=Im(t);let{class:A,style:y}=t;A&&!Zt(A)&&(t.class=ru(A)),Kt(y)&&(_f(y)&&!pt(y)&&(y=or({},y)),t.style=tu(y))}const T=Zt(e)?1:Gg(e)?128:bm(e)?64:Kt(e)?4:yt(e)?2:0;return td(e,t,r,i,u,T,d,!0)}function Im(e){return e?_f(e)||ua in e?or({},e):e:null}function ui(e,t,r=!1){const{props:i,ref:u,patchFlag:d,children:T}=e,A=t?Lm(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:A,key:A&&ed(A),ref:t&&t.ref?r&&u?pt(u)?u.concat(Ps(t)):[u,Ps(t)]:Ps(t):u,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:T,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==en?d===-1?16:d|16:d,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ui(e.ssContent),ssFallback:e.ssFallback&&ui(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx}}function Cm(e=" ",t=0){return mr(oa,null,e,t)}function IA(e,t){const r=mr(ks,null,e);return r.staticCount=t,r}function CA(e="",t=!1){return t?(ym(),_m(Mn,null,e)):mr(Mn,null,e)}function Hr(e){return e==null||typeof e=="boolean"?mr(Mn):pt(e)?mr(en,null,e.slice()):typeof e=="object"?dn(e):mr(oa,null,String(e))}function dn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ui(e)}function Tu(e,t){let r=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(pt(t))r=16;else if(typeof t=="object")if(i&65){const u=t.default;u&&(u._c&&(u._d=!1),Tu(e,u()),u._c&&(u._d=!0));return}else{r=32;const u=t._;!u&&!(ua in t)?t._ctx=yr:u===3&&yr&&(yr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else yt(t)?(t={default:t,_ctx:yr},r=32):(t=String(t),i&64?(r=16,t=[Cm(t)]):r=8);e.children=t,e.shapeFlag|=r}function Lm(...e){const t={};for(let r=0;r<e.length;r++){const i=e[r];for(const u in i)if(u==="class")t.class!==i.class&&(t.class=ru([t.class,i.class]));else if(u==="style")t.style=tu([t.style,i.style]);else if(Js(u)){const d=t[u],T=i[u];T&&d!==T&&!(pt(d)&&d.includes(T))&&(t[u]=d?[].concat(d,T):T)}else u!==""&&(t[u]=i[u])}return t}function Fr(e,t,r,i=null){Or(e,t,7,[r,i])}const Rm=$f();let Dm=0;function Nm(e,t,r){const i=e.type,u=(t?t.appContext:e.appContext)||Rm,d={uid:Dm++,vnode:e,type:i,parent:t,appContext:u,root:null,next:null,subTree:null,effect:null,update:null,scope:new z0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(u.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Wf(i,u),emitsOptions:wf(i,u),emit:null,emitted:null,propsDefaults:Bt,inheritAttrs:i.inheritAttrs,ctx:Bt,data:Bt,props:Bt,attrs:Bt,slots:Bt,refs:Bt,setupState:Bt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=t?t.root:d,d.emit=wg.bind(null,d),e.ce&&e.ce(d),d}let tr=null;const li=e=>{tr=e,e.scope.on()},wn=()=>{tr&&tr.scope.off(),tr=null};function rd(e){return e.vnode.shapeFlag&4}let Zi=!1;function Om(e,t=!1){Zi=t;const{props:r,children:i}=e.vnode,u=rd(e);cm(e,r,u,t),hm(e,i);const d=u?xm(e,t):void 0;return Zi=!1,d}function xm(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=Sf(new Proxy(e.ctx,im));const{setup:i}=r;if(i){const u=e.setupContext=i.length>1?Pm(e):null;li(e),mi();const d=mn(i,e,0,[e.props,u]);if(pi(),wn(),lf(d)){if(d.then(wn,wn),t)return d.then(T=>{Xl(e,T,t)}).catch(T=>{ia(T,e,0)});e.asyncDep=d}else Xl(e,d,t)}else nd(e,t)}function Xl(e,t,r){yt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Kt(t)&&(e.setupState=Rf(t)),nd(e,r)}let Ql;function nd(e,t,r){const i=e.type;if(!e.render){if(!t&&Ql&&!i.render){const u=i.template||pu(e).template;if(u){const{isCustomElement:d,compilerOptions:T}=e.appContext.config,{delimiters:A,compilerOptions:y}=i,S=or(or({isCustomElement:d,delimiters:A},T),y);i.render=Ql(u,S)}}e.render=i.render||Nr}li(e),mi(),sm(e),pi(),wn()}function km(e){return new Proxy(e.attrs,{get(t,r){return Er(e,"get","$attrs"),t[r]}})}function Pm(e){const t=i=>{e.exposed=i||{}};let r;return{get attrs(){return r||(r=km(e))},slots:e.slots,emit:e.emit,expose:t}}function la(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Rf(Sf(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in wi)return wi[r](e)},has(t,r){return r in t||r in wi}}))}function wm(e,t=!0){return yt(e)?e.displayName||e.name:e.name||t&&e.__name}function Mm(e){return yt(e)&&"__vccOpts"in e}const br=(e,t)=>Dg(e,t,Zi);function id(e,t,r){const i=arguments.length;return i===2?Kt(t)&&!pt(t)?Fo(t)?mr(e,null,[t]):mr(e,t):mr(e,null,t):(i>3?r=Array.prototype.slice.call(arguments,2):i===3&&Fo(r)&&(r=[r]),mr(e,t,r))}const Fm=Symbol(""),Bm=()=>tn(Fm),Um="3.2.45",Hm="http://www.w3.org/2000/svg",Dn=typeof document<"u"?document:null,zl=Dn&&Dn.createElement("template"),Gm={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,i)=>{const u=t?Dn.createElementNS(Hm,e):Dn.createElement(e,r?{is:r}:void 0);return e==="select"&&i&&i.multiple!=null&&u.setAttribute("multiple",i.multiple),u},createText:e=>Dn.createTextNode(e),createComment:e=>Dn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Dn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,i,u,d){const T=r?r.previousSibling:t.lastChild;if(u&&(u===d||u.nextSibling))for(;t.insertBefore(u.cloneNode(!0),r),!(u===d||!(u=u.nextSibling)););else{zl.innerHTML=i?`<svg>${e}</svg>`:e;const A=zl.content;if(i){const y=A.firstChild;for(;y.firstChild;)A.appendChild(y.firstChild);A.removeChild(y)}t.insertBefore(A,r)}return[T?T.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function Km(e,t,r){const i=e._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function Ym(e,t,r){const i=e.style,u=Zt(r);if(r&&!u){for(const d in r)Bo(i,d,r[d]);if(t&&!Zt(t))for(const d in t)r[d]==null&&Bo(i,d,"")}else{const d=i.display;u?t!==r&&(i.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=d)}}const $l=/\s*!important$/;function Bo(e,t,r){if(pt(r))r.forEach(i=>Bo(e,t,i));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const i=Vm(e,t);$l.test(r)?e.setProperty(gi(i),r.replace($l,""),"important"):e[i]=r}}const Zl=["Webkit","Moz","ms"],co={};function Vm(e,t){const r=co[t];if(r)return r;let i=jr(t);if(i!=="filter"&&i in e)return co[t]=i;i=ra(i);for(let u=0;u<Zl.length;u++){const d=Zl[u]+i;if(d in e)return co[t]=d}return t}const Jl="http://www.w3.org/1999/xlink";function jm(e,t,r,i,u){if(i&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(Jl,t.slice(6,t.length)):e.setAttributeNS(Jl,t,r);else{const d=K0(t);r==null||d&&!af(r)?e.removeAttribute(t):e.setAttribute(t,d?"":r)}}function qm(e,t,r,i,u,d,T){if(t==="innerHTML"||t==="textContent"){i&&T(i,u,d),e[t]=r??"";return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const y=r??"";(e.value!==y||e.tagName==="OPTION")&&(e.value=y),r==null&&e.removeAttribute(t);return}let A=!1;if(r===""||r==null){const y=typeof e[t];y==="boolean"?r=af(r):r==null&&y==="string"?(r="",A=!0):y==="number"&&(r=0,A=!0)}try{e[t]=r}catch{}A&&e.removeAttribute(t)}function $n(e,t,r,i){e.addEventListener(t,r,i)}function Wm(e,t,r,i){e.removeEventListener(t,r,i)}function Xm(e,t,r,i,u=null){const d=e._vei||(e._vei={}),T=d[t];if(i&&T)T.value=i;else{const[A,y]=Qm(t);if(i){const S=d[t]=Zm(i,u);$n(e,A,S,y)}else T&&(Wm(e,A,T,y),d[t]=void 0)}}const ec=/(?:Once|Passive|Capture)$/;function Qm(e){let t;if(ec.test(e)){t={};let i;for(;i=e.match(ec);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):gi(e.slice(2)),t]}let fo=0;const zm=Promise.resolve(),$m=()=>fo||(zm.then(()=>fo=0),fo=Date.now());function Zm(e,t){const r=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=r.attached)return;Or(Jm(i,r.value),t,5,[i])};return r.value=e,r.attached=$m(),r}function Jm(e,t){if(pt(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(i=>u=>!u._stopped&&i&&i(u))}else return t}const tc=/^on[a-z]/,ep=(e,t,r,i,u=!1,d,T,A,y)=>{t==="class"?Km(e,i,u):t==="style"?Ym(e,r,i):Js(t)?nu(t)||Xm(e,t,r,i,T):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):tp(e,t,i,u))?qm(e,t,i,d,T,A,y):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),jm(e,t,i,u))};function tp(e,t,r,i){return i?!!(t==="innerHTML"||t==="textContent"||t in e&&tc.test(t)&&yt(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||tc.test(t)&&Zt(r)?!1:t in e}const rc=e=>{const t=e.props["onUpdate:modelValue"]||!1;return pt(t)?r=>Ds(t,r):t};function rp(e){e.target.composing=!0}function nc(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const LA={created(e,{modifiers:{lazy:t,trim:r,number:i}},u){e._assign=rc(u);const d=i||u.props&&u.props.type==="number";$n(e,t?"change":"input",T=>{if(T.target.composing)return;let A=e.value;r&&(A=A.trim()),d&&(A=Bs(A)),e._assign(A)}),r&&$n(e,"change",()=>{e.value=e.value.trim()}),t||($n(e,"compositionstart",rp),$n(e,"compositionend",nc),$n(e,"change",nc))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:i,number:u}},d){if(e._assign=rc(d),e.composing||document.activeElement===e&&e.type!=="range"&&(r||i&&e.value.trim()===t||(u||e.type==="number")&&Bs(e.value)===t))return;const T=t??"";e.value!==T&&(e.value=T)}},np=or({patchProp:ep},Gm);let ic;function ip(){return ic||(ic=Em(np))}const RA=(...e)=>{const t=ip().createApp(...e),{mount:r}=t;return t.mount=i=>{const u=sp(i);if(!u)return;const d=t._component;!yt(d)&&!d.render&&!d.template&&(d.template=u.innerHTML),u.innerHTML="";const T=r(u,!1,u instanceof SVGElement);return u instanceof Element&&(u.removeAttribute("v-cloak"),u.setAttribute("data-v-app","")),T},t};function sp(e){return Zt(e)?document.querySelector(e):e}var Ur=(e=>(e.LOADING="loading",e.LOADED="loaded",e.ERROR="error",e))(Ur||{});const ap=typeof window<"u"&&window!==null,op=fp(),up=Object.prototype.propertyIsEnumerable,sc=Object.getOwnPropertySymbols;function Fi(e){return typeof e=="function"||toString.call(e)==="[object Object]"}function lp(e){return typeof e=="object"?e===null:typeof e!="function"}function cp(e){return e!=="__proto__"&&e!=="constructor"&&e!=="prototype"}function fp(){return ap&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?("isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),!0):!1}function dp(e,...t){if(!Fi(e))throw new TypeError("expected the first argument to be an object");if(t.length===0||typeof Symbol!="function"||typeof sc!="function")return e;for(const r of t){const i=sc(r);for(const u of i)up.call(r,u)&&(e[u]=r[u])}return e}function sd(e,...t){let r=0;for(lp(e)&&(e=t[r++]),e||(e={});r<t.length;r++)if(Fi(t[r])){for(const i of Object.keys(t[r]))cp(i)&&(Fi(e[i])&&Fi(t[r][i])?sd(e[i],t[r][i]):e[i]=t[r][i]);dp(e,t[r])}return e}const ac="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",hp="",gp={rootMargin:"0px",threshold:0},Xn="data-lazy-timeout-id";class mp{constructor(t){this.options={loading:ac,error:hp,observerOptions:gp,log:!0,lifecycle:{}},this._images=new WeakMap,this.config(t)}config(t={}){sd(this.options,t)}mount(t,r){if(!t)return;const{src:i,loading:u,error:d,lifecycle:T,delay:A}=this._valueFormatter(typeof r=="string"?r:r.value);this._lifecycle(Ur.LOADING,T,t),t.setAttribute("src",u||ac),op||(this.loadImages(t,i,d,T),this._log(()=>{throw new Error("Not support IntersectionObserver!")})),this._initIntersectionObserver(t,i,d,T,A)}update(t,r){var A;if(!t)return;(A=this._realObserver(t))==null||A.unobserve(t);const{src:i,error:u,lifecycle:d,delay:T}=this._valueFormatter(typeof r=="string"?r:r.value);this._initIntersectionObserver(t,i,u,d,T)}unmount(t){var r;t&&((r=this._realObserver(t))==null||r.unobserve(t),this._images.delete(t))}loadImages(t,r,i,u){this._setImageSrc(t,r,i,u)}_setImageSrc(t,r,i,u){t.tagName.toLowerCase()==="img"?(r&&t.getAttribute("src")!==r&&t.setAttribute("src",r),this._listenImageStatus(t,()=>{this._lifecycle(Ur.LOADED,u,t)},()=>{var d;t.onload=null,this._lifecycle(Ur.ERROR,u,t),(d=this._realObserver(t))==null||d.disconnect(),i&&t.getAttribute("src")!==i&&t.setAttribute("src",i),this._log(()=>{throw new Error(`Image failed to load!And failed src was: ${r} `)})})):t.style.backgroundImage=`url('${r}')`}_initIntersectionObserver(t,r,i,u,d){var A;const T=this.options.observerOptions;this._images.set(t,new IntersectionObserver(y=>{Array.prototype.forEach.call(y,S=>{d&&d>0?this._delayedIntersectionCallback(t,S,d,r,i,u):this._intersectionCallback(t,S,r,i,u)})},T)),(A=this._realObserver(t))==null||A.observe(t)}_intersectionCallback(t,r,i,u,d){var T;r.isIntersecting&&((T=this._realObserver(t))==null||T.unobserve(r.target),this._setImageSrc(t,i,u,d))}_delayedIntersectionCallback(t,r,i,u,d,T){if(r.isIntersecting){if(r.target.hasAttribute(Xn))return;const A=setTimeout(()=>{this._intersectionCallback(t,r,u,d,T),r.target.removeAttribute(Xn)},i);r.target.setAttribute(Xn,String(A))}else r.target.hasAttribute(Xn)&&(clearTimeout(Number(r.target.getAttribute(Xn))),r.target.removeAttribute(Xn))}_listenImageStatus(t,r,i){t.onload=r,t.onerror=i}_valueFormatter(t){let r=t,i=this.options.loading,u=this.options.error,d=this.options.lifecycle,T=this.options.delay;return Fi(t)&&(r=t.src,i=t.loading||this.options.loading,u=t.error||this.options.error,d=t.lifecycle||this.options.lifecycle,T=t.delay||this.options.delay),{src:r,loading:i,error:u,lifecycle:d,delay:T}}_log(t){this.options.log&&t()}_lifecycle(t,r,i){switch(t){case Ur.LOADING:i==null||i.setAttribute("lazy",Ur.LOADING),r!=null&&r.loading&&r.loading(i);break;case Ur.LOADED:i==null||i.setAttribute("lazy",Ur.LOADED),r!=null&&r.loaded&&r.loaded(i);break;case Ur.ERROR:i==null||i.setAttribute("lazy",Ur.ERROR),r!=null&&r.error&&r.error(i);break}}_realObserver(t){return this._images.get(t)}}const DA={install(e,t){const r=new mp(t);e.config.globalProperties.$Lazyload=r,e.provide("Lazyload",r),e.directive("lazy",{mounted:r.mount.bind(r),updated:r.update.bind(r),unmounted:r.unmount.bind(r)})}};/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Zn=typeof window<"u";function pp(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Pt=Object.assign;function ho(e,t){const r={};for(const i in t){const u=t[i];r[i]=xr(u)?u.map(e):e(u)}return r}const Bi=()=>{},xr=Array.isArray,Ep=/\/$/,Tp=e=>e.replace(Ep,"");function go(e,t,r="/"){let i,u={},d="",T="";const A=t.indexOf("#");let y=t.indexOf("?");return A<y&&A>=0&&(y=-1),y>-1&&(i=t.slice(0,y),d=t.slice(y+1,A>-1?A:t.length),u=e(d)),A>-1&&(i=i||t.slice(0,A),T=t.slice(A,t.length)),i=Ap(i??t,r),{fullPath:i+(d&&"?")+d+T,path:i,query:u,hash:T}}function vp(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function oc(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function bp(e,t,r){const i=t.matched.length-1,u=r.matched.length-1;return i>-1&&i===u&&ci(t.matched[i],r.matched[u])&&ad(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function ci(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function ad(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!yp(e[r],t[r]))return!1;return!0}function yp(e,t){return xr(e)?uc(e,t):xr(t)?uc(t,e):e===t}function uc(e,t){return xr(t)?e.length===t.length&&e.every((r,i)=>r===t[i]):e.length===1&&e[0]===t}function Ap(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),i=e.split("/");let u=r.length-1,d,T;for(d=0;d<i.length;d++)if(T=i[d],T!==".")if(T==="..")u>1&&u--;else break;return r.slice(0,u).join("/")+"/"+i.slice(d-(d===i.length?1:0)).join("/")}var Ji;(function(e){e.pop="pop",e.push="push"})(Ji||(Ji={}));var Ui;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Ui||(Ui={}));function _p(e){if(!e)if(Zn){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Tp(e)}const Sp=/^[^#]+#/;function Ip(e,t){return e.replace(Sp,"#")+t}function Cp(e,t){const r=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-r.left-(t.left||0),top:i.top-r.top-(t.top||0)}}const ca=()=>({left:window.pageXOffset,top:window.pageYOffset});function Lp(e){let t;if("el"in e){const r=e.el,i=typeof r=="string"&&r.startsWith("#"),u=typeof r=="string"?i?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!u)return;t=Cp(u,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function lc(e,t){return(history.state?history.state.position-t:-1)+e}const Uo=new Map;function Rp(e,t){Uo.set(e,t)}function Dp(e){const t=Uo.get(e);return Uo.delete(e),t}let Np=()=>location.protocol+"//"+location.host;function od(e,t){const{pathname:r,search:i,hash:u}=t,d=e.indexOf("#");if(d>-1){let A=u.includes(e.slice(d))?e.slice(d).length:1,y=u.slice(A);return y[0]!=="/"&&(y="/"+y),oc(y,"")}return oc(r,e)+i+u}function Op(e,t,r,i){let u=[],d=[],T=null;const A=({state:b})=>{const R=od(e,location),P=r.value,ce=t.value;let J=0;if(b){if(r.value=R,t.value=b,T&&T===P){T=null;return}J=ce?b.position-ce.position:0}else i(R);u.forEach(ie=>{ie(r.value,P,{delta:J,type:Ji.pop,direction:J?J>0?Ui.forward:Ui.back:Ui.unknown})})};function y(){T=r.value}function S(b){u.push(b);const R=()=>{const P=u.indexOf(b);P>-1&&u.splice(P,1)};return d.push(R),R}function I(){const{history:b}=window;b.state&&b.replaceState(Pt({},b.state,{scroll:ca()}),"")}function C(){for(const b of d)b();d=[],window.removeEventListener("popstate",A),window.removeEventListener("beforeunload",I)}return window.addEventListener("popstate",A),window.addEventListener("beforeunload",I),{pauseListeners:y,listen:S,destroy:C}}function cc(e,t,r,i=!1,u=!1){return{back:e,current:t,forward:r,replaced:i,position:window.history.length,scroll:u?ca():null}}function xp(e){const{history:t,location:r}=window,i={value:od(e,r)},u={value:t.state};u.value||d(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function d(y,S,I){const C=e.indexOf("#"),b=C>-1?(r.host&&document.querySelector("base")?e:e.slice(C))+y:Np()+e+y;try{t[I?"replaceState":"pushState"](S,"",b),u.value=S}catch(R){console.error(R),r[I?"replace":"assign"](b)}}function T(y,S){const I=Pt({},t.state,cc(u.value.back,y,u.value.forward,!0),S,{position:u.value.position});d(y,I,!0),i.value=y}function A(y,S){const I=Pt({},u.value,t.state,{forward:y,scroll:ca()});d(I.current,I,!0);const C=Pt({},cc(i.value,y,null),{position:I.position+1},S);d(y,C,!1),i.value=y}return{location:i,state:u,push:A,replace:T}}function NA(e){e=_p(e);const t=xp(e),r=Op(e,t.state,t.location,t.replace);function i(d,T=!0){T||r.pauseListeners(),history.go(d)}const u=Pt({location:"",base:e,go:i,createHref:Ip.bind(null,e)},t,r);return Object.defineProperty(u,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(u,"state",{enumerable:!0,get:()=>t.state.value}),u}function kp(e){return typeof e=="string"||e&&typeof e=="object"}function ud(e){return typeof e=="string"||typeof e=="symbol"}const ln={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},ld=Symbol("");var fc;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(fc||(fc={}));function fi(e,t){return Pt(new Error,{type:e,[ld]:!0},t)}function $r(e,t){return e instanceof Error&&ld in e&&(t==null||!!(e.type&t))}const dc="[^/]+?",Pp={sensitive:!1,strict:!1,start:!0,end:!0},wp=/[.+*?^${}()[\]/\\]/g;function Mp(e,t){const r=Pt({},Pp,t),i=[];let u=r.start?"^":"";const d=[];for(const S of e){const I=S.length?[]:[90];r.strict&&!S.length&&(u+="/");for(let C=0;C<S.length;C++){const b=S[C];let R=40+(r.sensitive?.25:0);if(b.type===0)C||(u+="/"),u+=b.value.replace(wp,"\\$&"),R+=40;else if(b.type===1){const{value:P,repeatable:ce,optional:J,regexp:ie}=b;d.push({name:P,repeatable:ce,optional:J});const fe=ie||dc;if(fe!==dc){R+=10;try{new RegExp(`(${fe})`)}catch(de){throw new Error(`Invalid custom RegExp for param "${P}" (${fe}): `+de.message)}}let Q=ce?`((?:${fe})(?:/(?:${fe}))*)`:`(${fe})`;C||(Q=J&&S.length<2?`(?:/${Q})`:"/"+Q),J&&(Q+="?"),u+=Q,R+=20,J&&(R+=-8),ce&&(R+=-20),fe===".*"&&(R+=-50)}I.push(R)}i.push(I)}if(r.strict&&r.end){const S=i.length-1;i[S][i[S].length-1]+=.7000000000000001}r.strict||(u+="/?"),r.end?u+="$":r.strict&&(u+="(?:/|$)");const T=new RegExp(u,r.sensitive?"":"i");function A(S){const I=S.match(T),C={};if(!I)return null;for(let b=1;b<I.length;b++){const R=I[b]||"",P=d[b-1];C[P.name]=R&&P.repeatable?R.split("/"):R}return C}function y(S){let I="",C=!1;for(const b of e){(!C||!I.endsWith("/"))&&(I+="/"),C=!1;for(const R of b)if(R.type===0)I+=R.value;else if(R.type===1){const{value:P,repeatable:ce,optional:J}=R,ie=P in S?S[P]:"";if(xr(ie)&&!ce)throw new Error(`Provided param "${P}" is an array but it is not repeatable (* or + modifiers)`);const fe=xr(ie)?ie.join("/"):ie;if(!fe)if(J)b.length<2&&(I.endsWith("/")?I=I.slice(0,-1):C=!0);else throw new Error(`Missing required param "${P}"`);I+=fe}}return I||"/"}return{re:T,score:i,keys:d,parse:A,stringify:y}}function Fp(e,t){let r=0;for(;r<e.length&&r<t.length;){const i=t[r]-e[r];if(i)return i;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function Bp(e,t){let r=0;const i=e.score,u=t.score;for(;r<i.length&&r<u.length;){const d=Fp(i[r],u[r]);if(d)return d;r++}if(Math.abs(u.length-i.length)===1){if(hc(i))return 1;if(hc(u))return-1}return u.length-i.length}function hc(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Up={type:0,value:""},Hp=/[a-zA-Z0-9_]/;function Gp(e){if(!e)return[[]];if(e==="/")return[[Up]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(R){throw new Error(`ERR (${r})/"${S}": ${R}`)}let r=0,i=r;const u=[];let d;function T(){d&&u.push(d),d=[]}let A=0,y,S="",I="";function C(){S&&(r===0?d.push({type:0,value:S}):r===1||r===2||r===3?(d.length>1&&(y==="*"||y==="+")&&t(`A repeatable param (${S}) must be alone in its segment. eg: '/:ids+.`),d.push({type:1,value:S,regexp:I,repeatable:y==="*"||y==="+",optional:y==="*"||y==="?"})):t("Invalid state to consume buffer"),S="")}function b(){S+=y}for(;A<e.length;){if(y=e[A++],y==="\\"&&r!==2){i=r,r=4;continue}switch(r){case 0:y==="/"?(S&&C(),T()):y===":"?(C(),r=1):b();break;case 4:b(),r=i;break;case 1:y==="("?r=2:Hp.test(y)?b():(C(),r=0,y!=="*"&&y!=="?"&&y!=="+"&&A--);break;case 2:y===")"?I[I.length-1]=="\\"?I=I.slice(0,-1)+y:r=3:I+=y;break;case 3:C(),r=0,y!=="*"&&y!=="?"&&y!=="+"&&A--,I="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${S}"`),C(),T(),u}function Kp(e,t,r){const i=Mp(Gp(e.path),r),u=Pt(i,{record:e,parent:t,children:[],alias:[]});return t&&!u.record.aliasOf==!t.record.aliasOf&&t.children.push(u),u}function Yp(e,t){const r=[],i=new Map;t=pc({strict:!1,end:!0,sensitive:!1},t);function u(I){return i.get(I)}function d(I,C,b){const R=!b,P=Vp(I);P.aliasOf=b&&b.record;const ce=pc(t,I),J=[P];if("alias"in I){const Q=typeof I.alias=="string"?[I.alias]:I.alias;for(const de of Q)J.push(Pt({},P,{components:b?b.record.components:P.components,path:de,aliasOf:b?b.record:P}))}let ie,fe;for(const Q of J){const{path:de}=Q;if(C&&de[0]!=="/"){const oe=C.record.path,se=oe[oe.length-1]==="/"?"":"/";Q.path=C.record.path+(de&&se+de)}if(ie=Kp(Q,C,ce),b?b.alias.push(ie):(fe=fe||ie,fe!==ie&&fe.alias.push(ie),R&&I.name&&!mc(ie)&&T(I.name)),P.children){const oe=P.children;for(let se=0;se<oe.length;se++)d(oe[se],ie,b&&b.children[se])}b=b||ie,(ie.record.components&&Object.keys(ie.record.components).length||ie.record.name||ie.record.redirect)&&y(ie)}return fe?()=>{T(fe)}:Bi}function T(I){if(ud(I)){const C=i.get(I);C&&(i.delete(I),r.splice(r.indexOf(C),1),C.children.forEach(T),C.alias.forEach(T))}else{const C=r.indexOf(I);C>-1&&(r.splice(C,1),I.record.name&&i.delete(I.record.name),I.children.forEach(T),I.alias.forEach(T))}}function A(){return r}function y(I){let C=0;for(;C<r.length&&Bp(I,r[C])>=0&&(I.record.path!==r[C].record.path||!cd(I,r[C]));)C++;r.splice(C,0,I),I.record.name&&!mc(I)&&i.set(I.record.name,I)}function S(I,C){let b,R={},P,ce;if("name"in I&&I.name){if(b=i.get(I.name),!b)throw fi(1,{location:I});ce=b.record.name,R=Pt(gc(C.params,b.keys.filter(fe=>!fe.optional).map(fe=>fe.name)),I.params&&gc(I.params,b.keys.map(fe=>fe.name))),P=b.stringify(R)}else if("path"in I)P=I.path,b=r.find(fe=>fe.re.test(P)),b&&(R=b.parse(P),ce=b.record.name);else{if(b=C.name?i.get(C.name):r.find(fe=>fe.re.test(C.path)),!b)throw fi(1,{location:I,currentLocation:C});ce=b.record.name,R=Pt({},C.params,I.params),P=b.stringify(R)}const J=[];let ie=b;for(;ie;)J.unshift(ie.record),ie=ie.parent;return{name:ce,path:P,params:R,matched:J,meta:qp(J)}}return e.forEach(I=>d(I)),{addRoute:d,resolve:S,removeRoute:T,getRoutes:A,getRecordMatcher:u}}function gc(e,t){const r={};for(const i of t)i in e&&(r[i]=e[i]);return r}function Vp(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:jp(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function jp(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const i in e.components)t[i]=typeof r=="boolean"?r:r[i];return t}function mc(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function qp(e){return e.reduce((t,r)=>Pt(t,r.meta),{})}function pc(e,t){const r={};for(const i in e)r[i]=i in t?t[i]:e[i];return r}function cd(e,t){return t.children.some(r=>r===e||cd(e,r))}const fd=/#/g,Wp=/&/g,Xp=/\//g,Qp=/=/g,zp=/\?/g,dd=/\+/g,$p=/%5B/g,Zp=/%5D/g,hd=/%5E/g,Jp=/%60/g,gd=/%7B/g,eE=/%7C/g,md=/%7D/g,tE=/%20/g;function vu(e){return encodeURI(""+e).replace(eE,"|").replace($p,"[").replace(Zp,"]")}function rE(e){return vu(e).replace(gd,"{").replace(md,"}").replace(hd,"^")}function Ho(e){return vu(e).replace(dd,"%2B").replace(tE,"+").replace(fd,"%23").replace(Wp,"%26").replace(Jp,"`").replace(gd,"{").replace(md,"}").replace(hd,"^")}function nE(e){return Ho(e).replace(Qp,"%3D")}function iE(e){return vu(e).replace(fd,"%23").replace(zp,"%3F")}function sE(e){return e==null?"":iE(e).replace(Xp,"%2F")}function Ks(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function aE(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let u=0;u<i.length;++u){const d=i[u].replace(dd," "),T=d.indexOf("="),A=Ks(T<0?d:d.slice(0,T)),y=T<0?null:Ks(d.slice(T+1));if(A in t){let S=t[A];xr(S)||(S=t[A]=[S]),S.push(y)}else t[A]=y}return t}function Ec(e){let t="";for(let r in e){const i=e[r];if(r=nE(r),i==null){i!==void 0&&(t+=(t.length?"&":"")+r);continue}(xr(i)?i.map(d=>d&&Ho(d)):[i&&Ho(i)]).forEach(d=>{d!==void 0&&(t+=(t.length?"&":"")+r,d!=null&&(t+="="+d))})}return t}function oE(e){const t={};for(const r in e){const i=e[r];i!==void 0&&(t[r]=xr(i)?i.map(u=>u==null?null:""+u):i==null?i:""+i)}return t}const uE=Symbol(""),Tc=Symbol(""),bu=Symbol(""),pd=Symbol(""),Go=Symbol("");function Di(){let e=[];function t(i){return e.push(i),()=>{const u=e.indexOf(i);u>-1&&e.splice(u,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function hn(e,t,r,i,u){const d=i&&(i.enterCallbacks[u]=i.enterCallbacks[u]||[]);return()=>new Promise((T,A)=>{const y=C=>{C===!1?A(fi(4,{from:r,to:t})):C instanceof Error?A(C):kp(C)?A(fi(2,{from:t,to:C})):(d&&i.enterCallbacks[u]===d&&typeof C=="function"&&d.push(C),T())},S=e.call(i&&i.instances[u],t,r,y);let I=Promise.resolve(S);e.length<3&&(I=I.then(y)),I.catch(C=>A(C))})}function mo(e,t,r,i){const u=[];for(const d of e)for(const T in d.components){let A=d.components[T];if(!(t!=="beforeRouteEnter"&&!d.instances[T]))if(lE(A)){const S=(A.__vccOpts||A)[t];S&&u.push(hn(S,r,i,d,T))}else{let y=A();u.push(()=>y.then(S=>{if(!S)return Promise.reject(new Error(`Couldn't resolve component "${T}" at "${d.path}"`));const I=pp(S)?S.default:S;d.components[T]=I;const b=(I.__vccOpts||I)[t];return b&&hn(b,r,i,d,T)()}))}}return u}function lE(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function vc(e){const t=tn(bu),r=tn(pd),i=br(()=>t.resolve(ni(e.to))),u=br(()=>{const{matched:y}=i.value,{length:S}=y,I=y[S-1],C=r.matched;if(!I||!C.length)return-1;const b=C.findIndex(ci.bind(null,I));if(b>-1)return b;const R=bc(y[S-2]);return S>1&&bc(I)===R&&C[C.length-1].path!==R?C.findIndex(ci.bind(null,y[S-2])):b}),d=br(()=>u.value>-1&&hE(r.params,i.value.params)),T=br(()=>u.value>-1&&u.value===r.matched.length-1&&ad(r.params,i.value.params));function A(y={}){return dE(y)?t[ni(e.replace)?"replace":"push"](ni(e.to)).catch(Bi):Promise.resolve()}return{route:i,href:br(()=>i.value.href),isActive:d,isExactActive:T,navigate:A}}const cE=Uf({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:vc,setup(e,{slots:t}){const r=is(vc(e)),{options:i}=tn(bu),u=br(()=>({[yc(e.activeClass,i.linkActiveClass,"router-link-active")]:r.isActive,[yc(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const d=t.default&&t.default(r);return e.custom?d:id("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:u.value},d)}}}),fE=cE;function dE(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function hE(e,t){for(const r in t){const i=t[r],u=e[r];if(typeof i=="string"){if(i!==u)return!1}else if(!xr(u)||u.length!==i.length||i.some((d,T)=>d!==u[T]))return!1}return!0}function bc(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const yc=(e,t,r)=>e??t??r,gE=Uf({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const i=tn(Go),u=br(()=>e.route||i.value),d=tn(Tc,0),T=br(()=>{let S=ni(d);const{matched:I}=u.value;let C;for(;(C=I[S])&&!C.components;)S++;return S}),A=br(()=>u.value.matched[T.value]);Ns(Tc,br(()=>T.value+1)),Ns(uE,A),Ns(Go,u);const y=Sg();return Os(()=>[y.value,A.value,e.name],([S,I,C],[b,R,P])=>{I&&(I.instances[C]=S,R&&R!==I&&S&&S===b&&(I.leaveGuards.size||(I.leaveGuards=R.leaveGuards),I.updateGuards.size||(I.updateGuards=R.updateGuards))),S&&I&&(!R||!ci(I,R)||!b)&&(I.enterCallbacks[C]||[]).forEach(ce=>ce(S))},{flush:"post"}),()=>{const S=u.value,I=e.name,C=A.value,b=C&&C.components[I];if(!b)return Ac(r.default,{Component:b,route:S});const R=C.props[I],P=R?R===!0?S.params:typeof R=="function"?R(S):R:null,J=id(b,Pt({},P,t,{onVnodeUnmounted:ie=>{ie.component.isUnmounted&&(C.instances[I]=null)},ref:y}));return Ac(r.default,{Component:J,route:S})||J}}});function Ac(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const mE=gE;function OA(e){const t=Yp(e.routes,e),r=e.parseQuery||aE,i=e.stringifyQuery||Ec,u=e.history,d=Di(),T=Di(),A=Di(),y=Ig(ln);let S=ln;Zn&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const I=ho.bind(null,B=>""+B),C=ho.bind(null,sE),b=ho.bind(null,Ks);function R(B,$){let q,ge;return ud(B)?(q=t.getRecordMatcher(B),ge=$):ge=B,t.addRoute(ge,q)}function P(B){const $=t.getRecordMatcher(B);$&&t.removeRoute($)}function ce(){return t.getRoutes().map(B=>B.record)}function J(B){return!!t.getRecordMatcher(B)}function ie(B,$){if($=Pt({},$||y.value),typeof B=="string"){const N=go(r,B,$.path),O=t.resolve({path:N.path},$),V=u.createHref(N.fullPath);return Pt(N,O,{params:b(O.params),hash:Ks(N.hash),redirectedFrom:void 0,href:V})}let q;if("path"in B)q=Pt({},B,{path:go(r,B.path,$.path).path});else{const N=Pt({},B.params);for(const O in N)N[O]==null&&delete N[O];q=Pt({},B,{params:C(B.params)}),$.params=C($.params)}const ge=t.resolve(q,$),Ae=B.hash||"";ge.params=I(b(ge.params));const xe=vp(i,Pt({},B,{hash:rE(Ae),path:ge.path})),Ie=u.createHref(xe);return Pt({fullPath:xe,hash:Ae,query:i===Ec?oE(B.query):B.query||{}},ge,{redirectedFrom:void 0,href:Ie})}function fe(B){return typeof B=="string"?go(r,B,y.value.path):Pt({},B)}function Q(B,$){if(S!==B)return fi(8,{from:$,to:B})}function de(B){return ae(B)}function oe(B){return de(Pt(fe(B),{replace:!0}))}function se(B){const $=B.matched[B.matched.length-1];if($&&$.redirect){const{redirect:q}=$;let ge=typeof q=="function"?q(B):q;return typeof ge=="string"&&(ge=ge.includes("?")||ge.includes("#")?ge=fe(ge):{path:ge},ge.params={}),Pt({query:B.query,hash:B.hash,params:"path"in ge?{}:B.params},ge)}}function ae(B,$){const q=S=ie(B),ge=y.value,Ae=B.state,xe=B.force,Ie=B.replace===!0,N=se(q);if(N)return ae(Pt(fe(N),{state:typeof N=="object"?Pt({},Ae,N.state):Ae,force:xe,replace:Ie}),$||q);const O=q;O.redirectedFrom=$;let V;return!xe&&bp(i,ge,q)&&(V=fi(16,{to:O,from:ge}),Ze(ge,ge,!0,!1)),(V?Promise.resolve(V):Ue(O,ge)).catch(re=>$r(re)?$r(re,2)?re:We(re):ve(re,O,ge)).then(re=>{if(re){if($r(re,2))return ae(Pt({replace:Ie},fe(re.to),{state:typeof re.to=="object"?Pt({},Ae,re.to.state):Ae,force:xe}),$||O)}else re=ue(O,ge,!0,Ie,Ae);return Je(O,ge,re),re})}function we(B,$){const q=Q(B,$);return q?Promise.reject(q):Promise.resolve()}function Ue(B,$){let q;const[ge,Ae,xe]=pE(B,$);q=mo(ge.reverse(),"beforeRouteLeave",B,$);for(const N of ge)N.leaveGuards.forEach(O=>{q.push(hn(O,B,$))});const Ie=we.bind(null,B,$);return q.push(Ie),Qn(q).then(()=>{q=[];for(const N of d.list())q.push(hn(N,B,$));return q.push(Ie),Qn(q)}).then(()=>{q=mo(Ae,"beforeRouteUpdate",B,$);for(const N of Ae)N.updateGuards.forEach(O=>{q.push(hn(O,B,$))});return q.push(Ie),Qn(q)}).then(()=>{q=[];for(const N of B.matched)if(N.beforeEnter&&!$.matched.includes(N))if(xr(N.beforeEnter))for(const O of N.beforeEnter)q.push(hn(O,B,$));else q.push(hn(N.beforeEnter,B,$));return q.push(Ie),Qn(q)}).then(()=>(B.matched.forEach(N=>N.enterCallbacks={}),q=mo(xe,"beforeRouteEnter",B,$),q.push(Ie),Qn(q))).then(()=>{q=[];for(const N of T.list())q.push(hn(N,B,$));return q.push(Ie),Qn(q)}).catch(N=>$r(N,8)?N:Promise.reject(N))}function Je(B,$,q){for(const ge of A.list())ge(B,$,q)}function ue(B,$,q,ge,Ae){const xe=Q(B,$);if(xe)return xe;const Ie=$===ln,N=Zn?history.state:{};q&&(ge||Ie?u.replace(B.fullPath,Pt({scroll:Ie&&N&&N.scroll},Ae)):u.push(B.fullPath,Ae)),y.value=B,Ze(B,$,q,Ie),We()}let w;function z(){w||(w=u.listen((B,$,q)=>{if(!At.listening)return;const ge=ie(B),Ae=se(ge);if(Ae){ae(Pt(Ae,{replace:!0}),ge).catch(Bi);return}S=ge;const xe=y.value;Zn&&Rp(lc(xe.fullPath,q.delta),ca()),Ue(ge,xe).catch(Ie=>$r(Ie,12)?Ie:$r(Ie,2)?(ae(Ie.to,ge).then(N=>{$r(N,20)&&!q.delta&&q.type===Ji.pop&&u.go(-1,!1)}).catch(Bi),Promise.reject()):(q.delta&&u.go(-q.delta,!1),ve(Ie,ge,xe))).then(Ie=>{Ie=Ie||ue(ge,xe,!1),Ie&&(q.delta&&!$r(Ie,8)?u.go(-q.delta,!1):q.type===Ji.pop&&$r(Ie,20)&&u.go(-1,!1)),Je(ge,xe,Ie)}).catch(Bi)}))}let H=Di(),Te=Di(),Re;function ve(B,$,q){We(B);const ge=Te.list();return ge.length?ge.forEach(Ae=>Ae(B,$,q)):console.error(B),Promise.reject(B)}function pe(){return Re&&y.value!==ln?Promise.resolve():new Promise((B,$)=>{H.add([B,$])})}function We(B){return Re||(Re=!B,z(),H.list().forEach(([$,q])=>B?q(B):$()),H.reset()),B}function Ze(B,$,q,ge){const{scrollBehavior:Ae}=e;if(!Zn||!Ae)return Promise.resolve();const xe=!q&&Dp(lc(B.fullPath,0))||(ge||!q)&&history.state&&history.state.scroll||null;return Of().then(()=>Ae(B,$,xe)).then(Ie=>Ie&&Lp(Ie)).catch(Ie=>ve(Ie,B,$))}const Qe=B=>u.go(B);let Ve;const lt=new Set,At={currentRoute:y,listening:!0,addRoute:R,removeRoute:P,hasRoute:J,getRoutes:ce,resolve:ie,options:e,push:de,replace:oe,go:Qe,back:()=>Qe(-1),forward:()=>Qe(1),beforeEach:d.add,beforeResolve:T.add,afterEach:A.add,onError:Te.add,isReady:pe,install(B){const $=this;B.component("RouterLink",fE),B.component("RouterView",mE),B.config.globalProperties.$router=$,Object.defineProperty(B.config.globalProperties,"$route",{enumerable:!0,get:()=>ni(y)}),Zn&&!Ve&&y.value===ln&&(Ve=!0,de(u.location).catch(Ae=>{}));const q={};for(const Ae in ln)q[Ae]=br(()=>y.value[Ae]);B.provide(bu,$),B.provide(pd,is(q)),B.provide(Go,y);const ge=B.unmount;lt.add(B),B.unmount=function(){lt.delete(B),lt.size<1&&(S=ln,w&&w(),w=null,y.value=ln,Ve=!1,Re=!1),ge()}}};return At}function Qn(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function pE(e,t){const r=[],i=[],u=[],d=Math.max(t.matched.length,e.matched.length);for(let T=0;T<d;T++){const A=t.matched[T];A&&(e.matched.find(S=>ci(S,A))?i.push(A):r.push(A));const y=e.matched[T];y&&(t.matched.find(S=>ci(S,y))||u.push(y))}return[r,i,u]}const yu={xml:!1,decodeEntities:!0},_c={_useHtmlParser2:!0,xmlMode:!0};function Ko(e){return e!=null&&e.xml?typeof e.xml=="boolean"?_c:{..._c,...e.xml}:e??void 0}var Ot;(function(e){e.Root="root",e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"})(Ot||(Ot={}));function EE(e){return e.type===Ot.Tag||e.type===Ot.Script||e.type===Ot.Style}const TE=Ot.Root,vE=Ot.Text,bE=Ot.Directive,yE=Ot.Comment,AE=Ot.Script,_E=Ot.Style,SE=Ot.Tag,IE=Ot.CDATA,CE=Ot.Doctype;class Ed{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(t){this.parent=t}get previousSibling(){return this.prev}set previousSibling(t){this.prev=t}get nextSibling(){return this.next}set nextSibling(t){this.next=t}cloneNode(t=!1){return Ys(this,t)}}class Au extends Ed{constructor(t){super(),this.data=t}get nodeValue(){return this.data}set nodeValue(t){this.data=t}}class es extends Au{constructor(){super(...arguments),this.type=Ot.Text}get nodeType(){return 3}}class _u extends Au{constructor(){super(...arguments),this.type=Ot.Comment}get nodeType(){return 8}}class Su extends Au{constructor(t,r){super(r),this.name=t,this.type=Ot.Directive}get nodeType(){return 1}}class Iu extends Ed{constructor(t){super(),this.children=t}get firstChild(){var t;return(t=this.children[0])!==null&&t!==void 0?t:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(t){this.children=t}}class Td extends Iu{constructor(){super(...arguments),this.type=Ot.CDATA}get nodeType(){return 4}}class Fn extends Iu{constructor(){super(...arguments),this.type=Ot.Root}get nodeType(){return 9}}let Cu=class extends Iu{constructor(t,r,i=[],u=t==="script"?Ot.Script:t==="style"?Ot.Style:Ot.Tag){super(i),this.name=t,this.attribs=r,this.type=u}get nodeType(){return 1}get tagName(){return this.name}set tagName(t){this.name=t}get attributes(){return Object.keys(this.attribs).map(t=>{var r,i;return{name:t,value:this.attribs[t],namespace:(r=this["x-attribsNamespace"])===null||r===void 0?void 0:r[t],prefix:(i=this["x-attribsPrefix"])===null||i===void 0?void 0:i[t]}})}};function ht(e){return EE(e)}function fa(e){return e.type===Ot.CDATA}function Yr(e){return e.type===Ot.Text}function da(e){return e.type===Ot.Comment}function Yo(e){return e.type===Ot.Directive}function Un(e){return e.type===Ot.Root}function Jt(e){return Object.prototype.hasOwnProperty.call(e,"children")}function Ys(e,t=!1){let r;if(Yr(e))r=new es(e.data);else if(da(e))r=new _u(e.data);else if(ht(e)){const i=t?po(e.children):[],u=new Cu(e.name,{...e.attribs},i);i.forEach(d=>d.parent=u),e.namespace!=null&&(u.namespace=e.namespace),e["x-attribsNamespace"]&&(u["x-attribsNamespace"]={...e["x-attribsNamespace"]}),e["x-attribsPrefix"]&&(u["x-attribsPrefix"]={...e["x-attribsPrefix"]}),r=u}else if(fa(e)){const i=t?po(e.children):[],u=new Td(i);i.forEach(d=>d.parent=u),r=u}else if(Un(e)){const i=t?po(e.children):[],u=new Fn(i);i.forEach(d=>d.parent=u),e["x-mode"]&&(u["x-mode"]=e["x-mode"]),r=u}else if(Yo(e)){const i=new Su(e.name,e.data);e["x-name"]!=null&&(i["x-name"]=e["x-name"],i["x-publicId"]=e["x-publicId"],i["x-systemId"]=e["x-systemId"]),r=i}else throw new Error(`Not implemented yet: ${e.type}`);return r.startIndex=e.startIndex,r.endIndex=e.endIndex,e.sourceCodeLocation!=null&&(r.sourceCodeLocation=e.sourceCodeLocation),r}function po(e){const t=e.map(r=>Ys(r,!0));for(let r=1;r<t.length;r++)t[r].prev=t[r-1],t[r-1].next=t[r];return t}const Sc={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};class LE{constructor(t,r,i){this.dom=[],this.root=new Fn(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof r=="function"&&(i=r,r=Sc),typeof t=="object"&&(r=t,t=void 0),this.callback=t??null,this.options=r??Sc,this.elementCB=i??null}onparserinit(t){this.parser=t}onreset(){this.dom=[],this.root=new Fn(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(t){this.handleCallback(t)}onclosetag(){this.lastNode=null;const t=this.tagStack.pop();this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(t)}onopentag(t,r){const i=this.options.xmlMode?Ot.Tag:void 0,u=new Cu(t,r,void 0,i);this.addNode(u),this.tagStack.push(u)}ontext(t){const{lastNode:r}=this;if(r&&r.type===Ot.Text)r.data+=t,this.options.withEndIndices&&(r.endIndex=this.parser.endIndex);else{const i=new es(t);this.addNode(i),this.lastNode=i}}oncomment(t){if(this.lastNode&&this.lastNode.type===Ot.Comment){this.lastNode.data+=t;return}const r=new _u(t);this.addNode(r),this.lastNode=r}oncommentend(){this.lastNode=null}oncdatastart(){const t=new es(""),r=new Td([t]);this.addNode(r),t.parent=r,this.lastNode=t}oncdataend(){this.lastNode=null}onprocessinginstruction(t,r){const i=new Su(t,r);this.addNode(i)}handleCallback(t){if(typeof this.callback=="function")this.callback(t,this.dom);else if(t)throw t}addNode(t){const r=this.tagStack[this.tagStack.length-1],i=r.children[r.children.length-1];this.options.withStartIndices&&(t.startIndex=this.parser.startIndex),this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),r.children.push(t),i&&(t.prev=i,i.next=t),t.parent=r,this.lastNode=null}}const cn=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),RE=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var Eo;const DE=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Ic=(Eo=String.fromCodePoint)!==null&&Eo!==void 0?Eo:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function NE(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=DE.get(e))!==null&&t!==void 0?t:e}var Cc;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.To_LOWER_BIT=32]="To_LOWER_BIT"})(Cc||(Cc={}));var rn;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(rn||(rn={}));function vd(e,t,r,i){const u=(t&rn.BRANCH_LENGTH)>>7,d=t&rn.JUMP_TABLE;if(u===0)return d!==0&&i===d?r:-1;if(d){const y=i-d;return y<0||y>=u?-1:e[r+y]-1}let T=r,A=T+u-1;for(;T<=A;){const y=T+A>>>1,S=e[y];if(S<i)T=y+1;else if(S>i)A=y-1;else return e[y+u]}return-1}const Lc=/["&'<>$\x80-\uFFFF]/g,OE=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),xE=String.prototype.codePointAt!=null?(e,t)=>e.codePointAt(t):(e,t)=>(e.charCodeAt(t)&64512)===55296?(e.charCodeAt(t)-55296)*1024+e.charCodeAt(t+1)-56320+65536:e.charCodeAt(t);function bd(e){let t="",r=0,i;for(;(i=Lc.exec(e))!==null;){const u=i.index,d=e.charCodeAt(u),T=OE.get(d);T!==void 0?(t+=e.substring(r,u)+T,r=u+1):(t+=`${e.substring(r,u)}&#x${xE(e,u).toString(16)};`,r=Lc.lastIndex+=Number((d&64512)===55296))}return t+e.substr(r)}function yd(e,t){return function(i){let u,d=0,T="";for(;u=e.exec(i);)d!==u.index&&(T+=i.substring(d,u.index)),T+=t.get(u[0].charCodeAt(0)),d=u.index+1;return T+i.substring(d)}}const Ad=yd(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),_d=yd(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),kE=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),PE=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),wE=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function ME(e){return e.replace(/"/g,"&quot;")}function FE(e,t){var r;if(!e)return;const i=((r=t.encodeEntities)!==null&&r!==void 0?r:t.decodeEntities)===!1?ME:t.xmlMode||t.encodeEntities!=="utf8"?bd:Ad;return Object.keys(e).map(u=>{var d,T;const A=(d=e[u])!==null&&d!==void 0?d:"";return t.xmlMode==="foreign"&&(u=(T=PE.get(u))!==null&&T!==void 0?T:u),!t.emptyAttrs&&!t.xmlMode&&A===""?u:`${u}="${i(A)}"`}).join(" ")}const Rc=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function ha(e,t={}){const r="length"in e?e:[e];let i="";for(let u=0;u<r.length;u++)i+=BE(r[u],t);return i}function BE(e,t){switch(e.type){case TE:return ha(e.children,t);case CE:case bE:return KE(e);case yE:return jE(e);case IE:return VE(e);case AE:case _E:case SE:return GE(e,t);case vE:return YE(e,t)}}const UE=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),HE=new Set(["svg","math"]);function GE(e,t){var r;t.xmlMode==="foreign"&&(e.name=(r=kE.get(e.name))!==null&&r!==void 0?r:e.name,e.parent&&UE.has(e.parent.name)&&(t={...t,xmlMode:!1})),!t.xmlMode&&HE.has(e.name)&&(t={...t,xmlMode:"foreign"});let i=`<${e.name}`;const u=FE(e.attribs,t);return u&&(i+=` ${u}`),e.children.length===0&&(t.xmlMode?t.selfClosingTags!==!1:t.selfClosingTags&&Rc.has(e.name))?(t.xmlMode||(i+=" "),i+="/>"):(i+=">",e.children.length>0&&(i+=ha(e.children,t)),(t.xmlMode||!Rc.has(e.name))&&(i+=`</${e.name}>`)),i}function KE(e){return`<${e.data}>`}function YE(e,t){var r;let i=e.data||"";return((r=t.encodeEntities)!==null&&r!==void 0?r:t.decodeEntities)!==!1&&!(!t.xmlMode&&e.parent&&wE.has(e.parent.name))&&(i=t.xmlMode||t.encodeEntities!=="utf8"?bd(i):_d(i)),i}function VE(e){return`<![CDATA[${e.children[0].data}]]>`}function jE(e){return`<!--${e.data}-->`}function Sd(e,t){return ha(e,t)}function qE(e,t){return Jt(e)?e.children.map(r=>Sd(r,t)).join(""):""}function ws(e){return Array.isArray(e)?e.map(ws).join(""):ht(e)?e.name==="br"?`
`:ws(e.children):fa(e)?ws(e.children):Yr(e)?e.data:""}function di(e){return Array.isArray(e)?e.map(di).join(""):Jt(e)&&!da(e)?di(e.children):Yr(e)?e.data:""}function Vs(e){return Array.isArray(e)?e.map(Vs).join(""):Jt(e)&&(e.type===Ot.Tag||fa(e))?Vs(e.children):Yr(e)?e.data:""}function ga(e){return Jt(e)?e.children:[]}function Id(e){return e.parent||null}function Cd(e){const t=Id(e);if(t!=null)return ga(t);const r=[e];let{prev:i,next:u}=e;for(;i!=null;)r.unshift(i),{prev:i}=i;for(;u!=null;)r.push(u),{next:u}=u;return r}function WE(e,t){var r;return(r=e.attribs)===null||r===void 0?void 0:r[t]}function XE(e,t){return e.attribs!=null&&Object.prototype.hasOwnProperty.call(e.attribs,t)&&e.attribs[t]!=null}function QE(e){return e.name}function Lu(e){let{next:t}=e;for(;t!==null&&!ht(t);)({next:t}=t);return t}function Ru(e){let{prev:t}=e;for(;t!==null&&!ht(t);)({prev:t}=t);return t}function Hn(e){if(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.parent){const t=e.parent.children;t.splice(t.lastIndexOf(e),1)}}function zE(e,t){const r=t.prev=e.prev;r&&(r.next=t);const i=t.next=e.next;i&&(i.prev=t);const u=t.parent=e.parent;if(u){const d=u.children;d[d.lastIndexOf(e)]=t,e.parent=null}}function $E(e,t){if(Hn(t),t.next=null,t.parent=e,e.children.push(t)>1){const r=e.children[e.children.length-2];r.next=t,t.prev=r}else t.prev=null}function ZE(e,t){Hn(t);const{parent:r}=e,i=e.next;if(t.next=i,t.prev=e,e.next=t,t.parent=r,i){if(i.prev=t,r){const u=r.children;u.splice(u.lastIndexOf(i),0,t)}}else r&&r.children.push(t)}function JE(e,t){if(Hn(t),t.parent=e,t.prev=null,e.children.unshift(t)!==1){const r=e.children[1];r.prev=t,t.next=r}else t.next=null}function eT(e,t){Hn(t);const{parent:r}=e;if(r){const i=r.children;i.splice(i.indexOf(e),0,t)}e.prev&&(e.prev.next=t),t.parent=r,t.prev=e.prev,t.next=e,e.prev=t}function ma(e,t,r=!0,i=1/0){return Array.isArray(t)||(t=[t]),pa(e,t,r,i)}function pa(e,t,r,i){const u=[];for(const d of t){if(e(d)&&(u.push(d),--i<=0))break;if(r&&Jt(d)&&d.children.length>0){const T=pa(e,d.children,r,i);if(u.push(...T),i-=T.length,i<=0)break}}return u}function tT(e,t){return t.find(e)}function Du(e,t,r=!0){let i=null;for(let u=0;u<t.length&&!i;u++){const d=t[u];if(ht(d))e(d)?i=d:r&&d.children.length>0&&(i=Du(e,d.children,!0));else continue}return i}function Ld(e,t){return t.some(r=>ht(r)&&(e(r)||r.children.length>0&&Ld(e,r.children)))}function rT(e,t){var r;const i=[],u=t.filter(ht);let d;for(;d=u.shift();){const T=(r=d.children)===null||r===void 0?void 0:r.filter(ht);T&&T.length>0&&u.unshift(...T),e(d)&&i.push(d)}return i}const js={tag_name(e){return typeof e=="function"?t=>ht(t)&&e(t.name):e==="*"?ht:t=>ht(t)&&t.name===e},tag_type(e){return typeof e=="function"?t=>e(t.type):t=>t.type===e},tag_contains(e){return typeof e=="function"?t=>Yr(t)&&e(t.data):t=>Yr(t)&&t.data===e}};function Rd(e,t){return typeof t=="function"?r=>ht(r)&&t(r.attribs[e]):r=>ht(r)&&r.attribs[e]===t}function nT(e,t){return r=>e(r)||t(r)}function Dd(e){const t=Object.keys(e).map(r=>{const i=e[r];return Object.prototype.hasOwnProperty.call(js,r)?js[r](i):Rd(r,i)});return t.length===0?null:t.reduce(nT)}function iT(e,t){const r=Dd(e);return r?r(t):!0}function sT(e,t,r,i=1/0){const u=Dd(e);return u?ma(u,t,r,i):[]}function aT(e,t,r=!0){return Array.isArray(t)||(t=[t]),Du(Rd("id",e),t,r)}function Ei(e,t,r=!0,i=1/0){return ma(js.tag_name(e),t,r,i)}function oT(e,t,r=!0,i=1/0){return ma(js.tag_type(e),t,r,i)}function uT(e){let t=e.length;for(;--t>=0;){const r=e[t];if(t>0&&e.lastIndexOf(r,t-1)>=0){e.splice(t,1);continue}for(let i=r.parent;i;i=i.parent)if(e.includes(i)){e.splice(t,1);break}}return e}var vr;(function(e){e[e.DISCONNECTED=1]="DISCONNECTED",e[e.PRECEDING=2]="PRECEDING",e[e.FOLLOWING=4]="FOLLOWING",e[e.CONTAINS=8]="CONTAINS",e[e.CONTAINED_BY=16]="CONTAINED_BY"})(vr||(vr={}));function Nd(e,t){const r=[],i=[];if(e===t)return 0;let u=Jt(e)?e:e.parent;for(;u;)r.unshift(u),u=u.parent;for(u=Jt(t)?t:t.parent;u;)i.unshift(u),u=u.parent;const d=Math.min(r.length,i.length);let T=0;for(;T<d&&r[T]===i[T];)T++;if(T===0)return vr.DISCONNECTED;const A=r[T-1],y=A.children,S=r[T],I=i[T];return y.indexOf(S)>y.indexOf(I)?A===t?vr.FOLLOWING|vr.CONTAINED_BY:vr.FOLLOWING:A===e?vr.PRECEDING|vr.CONTAINS:vr.PRECEDING}function Ti(e){return e=e.filter((t,r,i)=>!i.includes(t,r+1)),e.sort((t,r)=>{const i=Nd(t,r);return i&vr.PRECEDING?-1:i&vr.FOLLOWING?1:0}),e}function lT(e){const t=qs(gT,e);return t?t.name==="feed"?cT(t):fT(t):null}function cT(e){var t;const r=e.children,i={type:"atom",items:Ei("entry",r).map(T=>{var A;const{children:y}=T,S={media:Od(y)};dr(S,"id","id",y),dr(S,"title","title",y);const I=(A=qs("link",y))===null||A===void 0?void 0:A.attribs.href;I&&(S.link=I);const C=kn("summary",y)||kn("content",y);C&&(S.description=C);const b=kn("updated",y);return b&&(S.pubDate=new Date(b)),S})};dr(i,"id","id",r),dr(i,"title","title",r);const u=(t=qs("link",r))===null||t===void 0?void 0:t.attribs.href;u&&(i.link=u),dr(i,"description","subtitle",r);const d=kn("updated",r);return d&&(i.updated=new Date(d)),dr(i,"author","email",r,!0),i}function fT(e){var t,r;const i=(r=(t=qs("channel",e.children))===null||t===void 0?void 0:t.children)!==null&&r!==void 0?r:[],u={type:e.name.substr(0,3),id:"",items:Ei("item",e.children).map(T=>{const{children:A}=T,y={media:Od(A)};dr(y,"id","guid",A),dr(y,"title","title",A),dr(y,"link","link",A),dr(y,"description","description",A);const S=kn("pubDate",A);return S&&(y.pubDate=new Date(S)),y})};dr(u,"title","title",i),dr(u,"link","link",i),dr(u,"description","description",i);const d=kn("lastBuildDate",i);return d&&(u.updated=new Date(d)),dr(u,"author","managingEditor",i,!0),u}const dT=["url","type","lang"],hT=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function Od(e){return Ei("media:content",e).map(t=>{const{attribs:r}=t,i={medium:r.medium,isDefault:!!r.isDefault};for(const u of dT)r[u]&&(i[u]=r[u]);for(const u of hT)r[u]&&(i[u]=parseInt(r[u],10));return r.expression&&(i.expression=r.expression),i})}function qs(e,t){return Ei(e,t,!0,1)[0]}function kn(e,t,r=!1){return di(Ei(e,t,r,1)).trim()}function dr(e,t,r,i,u=!1){const d=kn(r,i,u);d&&(e[t]=d)}function gT(e){return e==="rss"||e==="feed"||e==="rdf:RDF"}const Ea=Object.freeze(Object.defineProperty({__proto__:null,get DocumentPosition(){return vr},append:ZE,appendChild:$E,compareDocumentPosition:Nd,existsOne:Ld,filter:ma,find:pa,findAll:rT,findOne:Du,findOneChild:tT,getAttributeValue:WE,getChildren:ga,getElementById:aT,getElements:sT,getElementsByTagName:Ei,getElementsByTagType:oT,getFeed:lT,getInnerHTML:qE,getName:QE,getOuterHTML:Sd,getParent:Id,getSiblings:Cd,getText:ws,hasAttrib:XE,hasChildren:Jt,innerText:Vs,isCDATA:fa,isComment:da,isDocument:Un,isTag:ht,isText:Yr,nextElementSibling:Lu,prepend:eT,prependChild:JE,prevElementSibling:Ru,removeElement:Hn,removeSubsets:uT,replaceElement:zE,testElement:iT,textContent:di,uniqueSort:Ti},Symbol.toStringTag,{value:"Module"}));function xd(e,t,r){return e?e(t??e._root.children,null,void 0,r).toString():""}function mT(e,t){return!t&&typeof e=="object"&&e!=null&&!("length"in e)&&!("type"in e)}function pT(e,t){const r=mT(e)?(t=e,void 0):e,i={...yu,...this===null||this===void 0?void 0:this._options,...Ko(t??{})};return xd(this,r,i)}function ET(e){const t={...this._options,xmlMode:!0};return xd(this,e,t)}function ts(e){const t=e||(this?this.root():[]);let r="";for(let i=0;i<t.length;i++)r+=di(t[i]);return r}function TT(e,t,r=typeof t=="boolean"?t:!1){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(r=t);const i=this.load(e,yu,!1);return r||i("script").remove(),i.root()[0].children.slice()}function vT(){return this(this._root)}function kd(e,t){if(t===e)return!1;let r=t;for(;r&&r!==r.parent;)if(r=r.parent,r===e)return!0;return!1}function bT(e,t){if(!Dc(e)||!Dc(t))return;let r=e.length;const i=+t.length;for(let u=0;u<i;u++)e[r++]=t[u];return e.length=r,e}function Dc(e){if(Array.isArray(e))return!0;if(typeof e!="object"||!Object.prototype.hasOwnProperty.call(e,"length")||typeof e.length!="number"||e.length<0)return!1;for(let t=0;t<e.length;t++)if(!(t in e))return!1;return!0}const yT=Object.freeze(Object.defineProperty({__proto__:null,contains:kd,html:pT,merge:bT,parseHTML:TT,root:vT,text:ts,xml:ET},Symbol.toStringTag,{value:"Module"}));function Vr(e){return e.cheerio!=null}function AT(e){return e.replace(/[_.-](\w|$)/g,(t,r)=>r.toUpperCase())}function _T(e){return e.replace(/[A-Z]/g,"-$&").toLowerCase()}function jt(e,t){const r=e.length;for(let i=0;i<r;i++)t(e[i],i);return e}function Vo(e){const t="length"in e?Array.prototype.map.call(e,i=>Ys(i,!0)):[Ys(e,!0)],r=new Fn(t);return t.forEach(i=>{i.parent=r}),t}var Nn;(function(e){e[e.LowerA=97]="LowerA",e[e.LowerZ=122]="LowerZ",e[e.UpperA=65]="UpperA",e[e.UpperZ=90]="UpperZ",e[e.Exclamation=33]="Exclamation"})(Nn||(Nn={}));function jo(e){const t=e.indexOf("<");if(t<0||t>e.length-3)return!1;const r=e.charCodeAt(t+1);return(r>=Nn.LowerA&&r<=Nn.LowerZ||r>=Nn.UpperA&&r<=Nn.UpperZ||r===Nn.Exclamation)&&e.includes(">",t+2)}const si=Object.prototype.hasOwnProperty,rs=/\s+/,To="data-",Nc={null:null,true:!0,false:!1},Nu=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,ST=/^{[^]*}$|^\[[^]*]$/;function Ws(e,t,r){var i;if(!(!e||!ht(e))){if((i=e.attribs)!==null&&i!==void 0||(e.attribs={}),!t)return e.attribs;if(si.call(e.attribs,t))return!r&&Nu.test(t)?t:e.attribs[t];if(e.name==="option"&&t==="value")return ts(e.children);if(e.name==="input"&&(e.attribs.type==="radio"||e.attribs.type==="checkbox")&&t==="value")return"on"}}function ai(e,t,r){r===null?Pd(e,t):e.attribs[t]=`${r}`}function IT(e,t){if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e!="string")throw new Error("Bad combination of arguments.");return jt(this,(r,i)=>{ht(r)&&ai(r,e,t.call(r,i,r.attribs[e]))})}return jt(this,r=>{ht(r)&&(typeof e=="object"?Object.keys(e).forEach(i=>{const u=e[i];ai(r,i,u)}):ai(r,e,t))})}return arguments.length>1?this:Ws(this[0],e,this.options.xmlMode)}function Oc(e,t,r){return t in e?e[t]:!r&&Nu.test(t)?Ws(e,t,!1)!==void 0:Ws(e,t,r)}function vo(e,t,r,i){t in e?e[t]=r:ai(e,t,!i&&Nu.test(t)?r?"":null:`${r}`)}function CT(e,t){var r;if(typeof e=="string"&&t===void 0){const i=this[0];if(!i||!ht(i))return;switch(e){case"style":{const u=this.css(),d=Object.keys(u);return d.forEach((T,A)=>{u[A]=T}),u.length=d.length,u}case"tagName":case"nodeName":return i.name.toUpperCase();case"href":case"src":{const u=(r=i.attribs)===null||r===void 0?void 0:r[e];return typeof URL<"u"&&(e==="href"&&(i.tagName==="a"||i.name==="link")||e==="src"&&(i.tagName==="img"||i.tagName==="iframe"||i.tagName==="audio"||i.tagName==="video"||i.tagName==="source"))&&u!==void 0&&this.options.baseURI?new URL(u,this.options.baseURI).href:u}case"innerText":return Vs(i);case"textContent":return di(i);case"outerHTML":return this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return Oc(i,e,this.options.xmlMode)}}if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e=="object")throw new Error("Bad combination of arguments.");return jt(this,(i,u)=>{ht(i)&&vo(i,e,t.call(i,u,Oc(i,e,this.options.xmlMode)),this.options.xmlMode)})}return jt(this,i=>{ht(i)&&(typeof e=="object"?Object.keys(e).forEach(u=>{const d=e[u];vo(i,u,d,this.options.xmlMode)}):vo(i,e,t,this.options.xmlMode))})}}function xc(e,t,r){var i;const u=e;(i=u.data)!==null&&i!==void 0||(u.data={}),typeof t=="object"?Object.assign(u.data,t):typeof t=="string"&&r!==void 0&&(u.data[t]=r)}function kc(e,t){let r,i,u;t==null?(r=Object.keys(e.attribs).filter(d=>d.startsWith(To)),i=r.map(d=>AT(d.slice(To.length)))):(r=[To+_T(t)],i=[t]);for(let d=0;d<r.length;++d){const T=r[d],A=i[d];if(si.call(e.attribs,T)&&!si.call(e.data,A)){if(u=e.attribs[T],si.call(Nc,u))u=Nc[u];else if(u===String(Number(u)))u=Number(u);else if(ST.test(u))try{u=JSON.parse(u)}catch{}e.data[A]=u}}return t==null?e.data:u}function LT(e,t){var r;const i=this[0];if(!i||!ht(i))return;const u=i;return(r=u.data)!==null&&r!==void 0||(u.data={}),e?typeof e=="object"||t!==void 0?(jt(this,d=>{ht(d)&&(typeof e=="object"?xc(d,e):xc(d,e,t))}),this):si.call(u.data,e)?u.data[e]:kc(u,e):kc(u)}function RT(e){const t=arguments.length===0,r=this[0];if(!r||!ht(r))return t?void 0:this;switch(r.name){case"textarea":return this.text(e);case"select":{const i=this.find("option:selected");if(!t){if(this.attr("multiple")==null&&typeof e=="object")return this;this.find("option").removeAttr("selected");const u=typeof e!="object"?[e]:e;for(let d=0;d<u.length;d++)this.find(`option[value="${u[d]}"]`).attr("selected","");return this}return this.attr("multiple")?i.toArray().map(u=>ts(u.children)):i.attr("value")}case"input":case"option":return t?this.attr("value"):this.attr("value",e)}}function Pd(e,t){!e.attribs||!si.call(e.attribs,t)||delete e.attribs[t]}function Xs(e){return e?e.trim().split(rs):[]}function DT(e){const t=Xs(e);for(let r=0;r<t.length;r++)jt(this,i=>{ht(i)&&Pd(i,t[r])});return this}function NT(e){return this.toArray().some(t=>{const r=ht(t)&&t.attribs.class;let i=-1;if(r&&e.length)for(;(i=r.indexOf(e,i+1))>-1;){const u=i+e.length;if((i===0||rs.test(r[i-1]))&&(u===r.length||rs.test(r[u])))return!0}return!1})}function wd(e){if(typeof e=="function")return jt(this,(i,u)=>{if(ht(i)){const d=i.attribs.class||"";wd.call([i],e.call(i,u,d))}});if(!e||typeof e!="string")return this;const t=e.split(rs),r=this.length;for(let i=0;i<r;i++){const u=this[i];if(!ht(u))continue;const d=Ws(u,"class",!1);if(!d)ai(u,"class",t.join(" ").trim());else{let T=` ${d} `;for(let A=0;A<t.length;A++){const y=`${t[A]} `;T.includes(` ${y}`)||(T+=y)}ai(u,"class",T.trim())}}return this}function Md(e){if(typeof e=="function")return jt(this,(u,d)=>{ht(u)&&Md.call([u],e.call(u,d,u.attribs.class||""))});const t=Xs(e),r=t.length,i=arguments.length===0;return jt(this,u=>{if(ht(u))if(i)u.attribs.class="";else{const d=Xs(u.attribs.class);let T=!1;for(let A=0;A<r;A++){const y=d.indexOf(t[A]);y>=0&&(d.splice(y,1),T=!0,A--)}T&&(u.attribs.class=d.join(" "))}})}function Fd(e,t){if(typeof e=="function")return jt(this,(T,A)=>{ht(T)&&Fd.call([T],e.call(T,A,T.attribs.class||"",t),t)});if(!e||typeof e!="string")return this;const r=e.split(rs),i=r.length,u=typeof t=="boolean"?t?1:-1:0,d=this.length;for(let T=0;T<d;T++){const A=this[T];if(!ht(A))continue;const y=Xs(A.attribs.class);for(let S=0;S<i;S++){const I=y.indexOf(r[S]);u>=0&&I<0?y.push(r[S]):u<=0&&I>=0&&y.splice(I,1)}A.attribs.class=y.join(" ")}return this}const OT=Object.freeze(Object.defineProperty({__proto__:null,addClass:wd,attr:IT,data:LT,hasClass:NT,prop:CT,removeAttr:DT,removeClass:Md,toggleClass:Fd,val:RT},Symbol.toStringTag,{value:"Module"}));var ut;(function(e){e.Attribute="attribute",e.Pseudo="pseudo",e.PseudoElement="pseudo-element",e.Tag="tag",e.Universal="universal",e.Adjacent="adjacent",e.Child="child",e.Descendant="descendant",e.Parent="parent",e.Sibling="sibling",e.ColumnCombinator="column-combinator"})(ut||(ut={}));var $t;(function(e){e.Any="any",e.Element="element",e.End="end",e.Equals="equals",e.Exists="exists",e.Hyphen="hyphen",e.Not="not",e.Start="start"})($t||($t={}));const Pc=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,xT=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,kT=new Map([[126,$t.Element],[94,$t.Start],[36,$t.End],[42,$t.Any],[33,$t.Not],[124,$t.Hyphen]]),PT=new Set(["has","not","matches","is","where","host","host-context"]);function Hi(e){switch(e.type){case ut.Adjacent:case ut.Child:case ut.Descendant:case ut.Parent:case ut.Sibling:case ut.ColumnCombinator:return!0;default:return!1}}const wT=new Set(["contains","icontains"]);function MT(e,t,r){const i=parseInt(t,16)-65536;return i!==i||r?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,i&1023|56320)}function Ni(e){return e.replace(xT,MT)}function bo(e){return e===39||e===34}function wc(e){return e===32||e===9||e===10||e===12||e===13}function Ta(e){const t=[],r=Bd(t,`${e}`,0);if(r<e.length)throw new Error(`Unmatched selector: ${e.slice(r)}`);return t}function Bd(e,t,r){let i=[];function u(b){const R=t.slice(r+b).match(Pc);if(!R)throw new Error(`Expected name, found ${t.slice(r)}`);const[P]=R;return r+=b+P.length,Ni(P)}function d(b){for(r+=b;r<t.length&&wc(t.charCodeAt(r));)r++}function T(){r+=1;const b=r;let R=1;for(;R>0&&r<t.length;r++)t.charCodeAt(r)===40&&!A(r)?R++:t.charCodeAt(r)===41&&!A(r)&&R--;if(R)throw new Error("Parenthesis not matched");return Ni(t.slice(b,r-1))}function A(b){let R=0;for(;t.charCodeAt(--b)===92;)R++;return(R&1)===1}function y(){if(i.length>0&&Hi(i[i.length-1]))throw new Error("Did not expect successive traversals.")}function S(b){if(i.length>0&&i[i.length-1].type===ut.Descendant){i[i.length-1].type=b;return}y(),i.push({type:b})}function I(b,R){i.push({type:ut.Attribute,name:b,action:R,value:u(1),namespace:null,ignoreCase:"quirks"})}function C(){if(i.length&&i[i.length-1].type===ut.Descendant&&i.pop(),i.length===0)throw new Error("Empty sub-selector");e.push(i)}if(d(0),t.length===r)return r;e:for(;r<t.length;){const b=t.charCodeAt(r);switch(b){case 32:case 9:case 10:case 12:case 13:{(i.length===0||i[0].type!==ut.Descendant)&&(y(),i.push({type:ut.Descendant})),d(1);break}case 62:{S(ut.Child),d(1);break}case 60:{S(ut.Parent),d(1);break}case 126:{S(ut.Sibling),d(1);break}case 43:{S(ut.Adjacent),d(1);break}case 46:{I("class",$t.Element);break}case 35:{I("id",$t.Equals);break}case 91:{d(1);let R,P=null;t.charCodeAt(r)===124?R=u(1):t.startsWith("*|",r)?(P="*",R=u(2)):(R=u(0),t.charCodeAt(r)===124&&t.charCodeAt(r+1)!==61&&(P=R,R=u(1))),d(0);let ce=$t.Exists;const J=kT.get(t.charCodeAt(r));if(J){if(ce=J,t.charCodeAt(r+1)!==61)throw new Error("Expected `=`");d(2)}else t.charCodeAt(r)===61&&(ce=$t.Equals,d(1));let ie="",fe=null;if(ce!=="exists"){if(bo(t.charCodeAt(r))){const oe=t.charCodeAt(r);let se=r+1;for(;se<t.length&&(t.charCodeAt(se)!==oe||A(se));)se+=1;if(t.charCodeAt(se)!==oe)throw new Error("Attribute value didn't end");ie=Ni(t.slice(r+1,se)),r=se+1}else{const oe=r;for(;r<t.length&&(!wc(t.charCodeAt(r))&&t.charCodeAt(r)!==93||A(r));)r+=1;ie=Ni(t.slice(oe,r))}d(0);const de=t.charCodeAt(r)|32;de===115?(fe=!1,d(1)):de===105&&(fe=!0,d(1))}if(t.charCodeAt(r)!==93)throw new Error("Attribute selector didn't terminate");r+=1;const Q={type:ut.Attribute,name:R,action:ce,value:ie,namespace:P,ignoreCase:fe};i.push(Q);break}case 58:{if(t.charCodeAt(r+1)===58){i.push({type:ut.PseudoElement,name:u(2).toLowerCase(),data:t.charCodeAt(r)===40?T():null});continue}const R=u(1).toLowerCase();let P=null;if(t.charCodeAt(r)===40)if(PT.has(R)){if(bo(t.charCodeAt(r+1)))throw new Error(`Pseudo-selector ${R} cannot be quoted`);if(P=[],r=Bd(P,t,r+1),t.charCodeAt(r)!==41)throw new Error(`Missing closing parenthesis in :${R} (${t})`);r+=1}else{if(P=T(),wT.has(R)){const ce=P.charCodeAt(0);ce===P.charCodeAt(P.length-1)&&bo(ce)&&(P=P.slice(1,-1))}P=Ni(P)}i.push({type:ut.Pseudo,name:R,data:P});break}case 44:{C(),i=[],d(1);break}default:{if(t.startsWith("/*",r)){const ce=t.indexOf("*/",r+2);if(ce<0)throw new Error("Comment was not terminated");r=ce+2,i.length===0&&d(0);break}let R=null,P;if(b===42)r+=1,P="*";else if(b===124){if(P="",t.charCodeAt(r+1)===124){S(ut.ColumnCombinator),d(2);break}}else if(Pc.test(t.slice(r)))P=u(0);else break e;t.charCodeAt(r)===124&&t.charCodeAt(r+1)!==124&&(R=P,t.charCodeAt(r+1)===42?(P="*",r+=2):P=u(1)),i.push(P==="*"?{type:ut.Universal,namespace:R}:{type:ut.Tag,name:P,namespace:R})}}}return C(),r}var FT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function BT(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var bt={trueFunc:function(){return!0},falseFunc:function(){return!1}};const Ud=new Map([[ut.Universal,50],[ut.Tag,30],[ut.Attribute,1],[ut.Pseudo,0]]);function Ou(e){return!Ud.has(e.type)}const UT=new Map([[$t.Exists,10],[$t.Equals,8],[$t.Not,7],[$t.Start,6],[$t.End,6],[$t.Any,5]]);function HT(e){const t=e.map(Hd);for(let r=1;r<e.length;r++){const i=t[r];if(!(i<0))for(let u=r-1;u>=0&&i<t[u];u--){const d=e[u+1];e[u+1]=e[u],e[u]=d,t[u+1]=t[u],t[u]=i}}}function Hd(e){var t,r;let i=(t=Ud.get(e.type))!==null&&t!==void 0?t:-1;return e.type===ut.Attribute?(i=(r=UT.get(e.action))!==null&&r!==void 0?r:4,e.action===$t.Equals&&e.name==="id"&&(i=9),e.ignoreCase&&(i>>=1)):e.type===ut.Pseudo&&(e.data?e.name==="has"||e.name==="contains"?i=0:Array.isArray(e.data)?(i=Math.min(...e.data.map(u=>Math.min(...u.map(Hd)))),i<0&&(i=0)):i=2:i=3),i}const GT=/[-[\]{}()*+?.,\\^$|#\s]/g;function Mc(e){return e.replace(GT,"\\$&")}const KT=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function Cn(e,t){return typeof e.ignoreCase=="boolean"?e.ignoreCase:e.ignoreCase==="quirks"?!!t.quirksMode:!t.xmlMode&&KT.has(e.name)}const YT={equals(e,t,r){const{adapter:i}=r,{name:u}=t;let{value:d}=t;return Cn(t,r)?(d=d.toLowerCase(),T=>{const A=i.getAttributeValue(T,u);return A!=null&&A.length===d.length&&A.toLowerCase()===d&&e(T)}):T=>i.getAttributeValue(T,u)===d&&e(T)},hyphen(e,t,r){const{adapter:i}=r,{name:u}=t;let{value:d}=t;const T=d.length;return Cn(t,r)?(d=d.toLowerCase(),function(y){const S=i.getAttributeValue(y,u);return S!=null&&(S.length===T||S.charAt(T)==="-")&&S.substr(0,T).toLowerCase()===d&&e(y)}):function(y){const S=i.getAttributeValue(y,u);return S!=null&&(S.length===T||S.charAt(T)==="-")&&S.substr(0,T)===d&&e(y)}},element(e,t,r){const{adapter:i}=r,{name:u,value:d}=t;if(/\s/.test(d))return bt.falseFunc;const T=new RegExp(`(?:^|\\s)${Mc(d)}(?:$|\\s)`,Cn(t,r)?"i":"");return function(y){const S=i.getAttributeValue(y,u);return S!=null&&S.length>=d.length&&T.test(S)&&e(y)}},exists(e,{name:t},{adapter:r}){return i=>r.hasAttrib(i,t)&&e(i)},start(e,t,r){const{adapter:i}=r,{name:u}=t;let{value:d}=t;const T=d.length;return T===0?bt.falseFunc:Cn(t,r)?(d=d.toLowerCase(),A=>{const y=i.getAttributeValue(A,u);return y!=null&&y.length>=T&&y.substr(0,T).toLowerCase()===d&&e(A)}):A=>{var y;return!!(!((y=i.getAttributeValue(A,u))===null||y===void 0)&&y.startsWith(d))&&e(A)}},end(e,t,r){const{adapter:i}=r,{name:u}=t;let{value:d}=t;const T=-d.length;return T===0?bt.falseFunc:Cn(t,r)?(d=d.toLowerCase(),A=>{var y;return((y=i.getAttributeValue(A,u))===null||y===void 0?void 0:y.substr(T).toLowerCase())===d&&e(A)}):A=>{var y;return!!(!((y=i.getAttributeValue(A,u))===null||y===void 0)&&y.endsWith(d))&&e(A)}},any(e,t,r){const{adapter:i}=r,{name:u,value:d}=t;if(d==="")return bt.falseFunc;if(Cn(t,r)){const T=new RegExp(Mc(d),"i");return function(y){const S=i.getAttributeValue(y,u);return S!=null&&S.length>=d.length&&T.test(S)&&e(y)}}return T=>{var A;return!!(!((A=i.getAttributeValue(T,u))===null||A===void 0)&&A.includes(d))&&e(T)}},not(e,t,r){const{adapter:i}=r,{name:u}=t;let{value:d}=t;return d===""?T=>!!i.getAttributeValue(T,u)&&e(T):Cn(t,r)?(d=d.toLowerCase(),T=>{const A=i.getAttributeValue(T,u);return(A==null||A.length!==d.length||A.toLowerCase()!==d)&&e(T)}):T=>i.getAttributeValue(T,u)!==d&&e(T)}},VT=new Set([9,10,12,13,32]),Fc="0".charCodeAt(0),jT="9".charCodeAt(0);function qT(e){if(e=e.trim().toLowerCase(),e==="even")return[2,0];if(e==="odd")return[2,1];let t=0,r=0,i=d(),u=T();if(t<e.length&&e.charAt(t)==="n"&&(t++,r=i*(u??1),A(),t<e.length?(i=d(),A(),u=T()):i=u=0),u===null||t<e.length)throw new Error(`n-th rule couldn't be parsed ('${e}')`);return[r,i*u];function d(){return e.charAt(t)==="-"?(t++,-1):(e.charAt(t)==="+"&&t++,1)}function T(){const y=t;let S=0;for(;t<e.length&&e.charCodeAt(t)>=Fc&&e.charCodeAt(t)<=jT;)S=S*10+(e.charCodeAt(t)-Fc),t++;return t===y?null:S}function A(){for(;t<e.length&&VT.has(e.charCodeAt(t));)t++}}function WT(e){const t=e[0],r=e[1]-1;if(r<0&&t<=0)return bt.falseFunc;if(t===-1)return d=>d<=r;if(t===0)return d=>d===r;if(t===1)return r<0?bt.trueFunc:d=>d>=r;const i=Math.abs(t),u=(r%i+i)%i;return t>1?d=>d>=r&&d%i===u:d=>d<=r&&d%i===u}function _s(e){return WT(qT(e))}function Ss(e,t){return r=>{const i=t.getParent(r);return i!=null&&t.isTag(i)&&e(r)}}const qo={contains(e,t,{adapter:r}){return function(u){return e(u)&&r.getText(u).includes(t)}},icontains(e,t,{adapter:r}){const i=t.toLowerCase();return function(d){return e(d)&&r.getText(d).toLowerCase().includes(i)}},"nth-child"(e,t,{adapter:r,equals:i}){const u=_s(t);return u===bt.falseFunc?bt.falseFunc:u===bt.trueFunc?Ss(e,r):function(T){const A=r.getSiblings(T);let y=0;for(let S=0;S<A.length&&!i(T,A[S]);S++)r.isTag(A[S])&&y++;return u(y)&&e(T)}},"nth-last-child"(e,t,{adapter:r,equals:i}){const u=_s(t);return u===bt.falseFunc?bt.falseFunc:u===bt.trueFunc?Ss(e,r):function(T){const A=r.getSiblings(T);let y=0;for(let S=A.length-1;S>=0&&!i(T,A[S]);S--)r.isTag(A[S])&&y++;return u(y)&&e(T)}},"nth-of-type"(e,t,{adapter:r,equals:i}){const u=_s(t);return u===bt.falseFunc?bt.falseFunc:u===bt.trueFunc?Ss(e,r):function(T){const A=r.getSiblings(T);let y=0;for(let S=0;S<A.length;S++){const I=A[S];if(i(T,I))break;r.isTag(I)&&r.getName(I)===r.getName(T)&&y++}return u(y)&&e(T)}},"nth-last-of-type"(e,t,{adapter:r,equals:i}){const u=_s(t);return u===bt.falseFunc?bt.falseFunc:u===bt.trueFunc?Ss(e,r):function(T){const A=r.getSiblings(T);let y=0;for(let S=A.length-1;S>=0;S--){const I=A[S];if(i(T,I))break;r.isTag(I)&&r.getName(I)===r.getName(T)&&y++}return u(y)&&e(T)}},root(e,t,{adapter:r}){return i=>{const u=r.getParent(i);return(u==null||!r.isTag(u))&&e(i)}},scope(e,t,r,i){const{equals:u}=r;return!i||i.length===0?qo.root(e,t,r):i.length===1?d=>u(i[0],d)&&e(d):d=>i.includes(d)&&e(d)},hover:yo("isHovered"),visited:yo("isVisited"),active:yo("isActive")};function yo(e){return function(r,i,{adapter:u}){const d=u[e];return typeof d!="function"?bt.falseFunc:function(A){return d(A)&&r(A)}}}const Bc={empty(e,{adapter:t}){return!t.getChildren(e).some(r=>t.isTag(r)||t.getText(r)!=="")},"first-child"(e,{adapter:t,equals:r}){if(t.prevElementSibling)return t.prevElementSibling(e)==null;const i=t.getSiblings(e).find(u=>t.isTag(u));return i!=null&&r(e,i)},"last-child"(e,{adapter:t,equals:r}){const i=t.getSiblings(e);for(let u=i.length-1;u>=0;u--){if(r(e,i[u]))return!0;if(t.isTag(i[u]))break}return!1},"first-of-type"(e,{adapter:t,equals:r}){const i=t.getSiblings(e),u=t.getName(e);for(let d=0;d<i.length;d++){const T=i[d];if(r(e,T))return!0;if(t.isTag(T)&&t.getName(T)===u)break}return!1},"last-of-type"(e,{adapter:t,equals:r}){const i=t.getSiblings(e),u=t.getName(e);for(let d=i.length-1;d>=0;d--){const T=i[d];if(r(e,T))return!0;if(t.isTag(T)&&t.getName(T)===u)break}return!1},"only-of-type"(e,{adapter:t,equals:r}){const i=t.getName(e);return t.getSiblings(e).every(u=>r(e,u)||!t.isTag(u)||t.getName(u)!==i)},"only-child"(e,{adapter:t,equals:r}){return t.getSiblings(e).every(i=>r(e,i)||!t.isTag(i))}};function Uc(e,t,r,i){if(r===null){if(e.length>i)throw new Error(`Pseudo-class :${t} requires an argument`)}else if(e.length===i)throw new Error(`Pseudo-class :${t} doesn't have any arguments`)}const XT={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:`:is(
        :is(button, input, select, textarea, optgroup, option)[disabled],
        optgroup[disabled] > option,
        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)
    )`,enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"},Gd={};function QT(e,t){return e===bt.falseFunc?bt.falseFunc:r=>t.isTag(r)&&e(r)}function Kd(e,t){const r=t.getSiblings(e);if(r.length<=1)return[];const i=r.indexOf(e);return i<0||i===r.length-1?[]:r.slice(i+1).filter(t.isTag)}function Wo(e){return{xmlMode:!!e.xmlMode,lowerCaseAttributeNames:!!e.lowerCaseAttributeNames,lowerCaseTags:!!e.lowerCaseTags,quirksMode:!!e.quirksMode,cacheResults:!!e.cacheResults,pseudos:e.pseudos,adapter:e.adapter,equals:e.equals}}const Ao=(e,t,r,i,u)=>{const d=u(t,Wo(r),i);return d===bt.trueFunc?e:d===bt.falseFunc?bt.falseFunc:T=>d(T)&&e(T)},_o={is:Ao,matches:Ao,where:Ao,not(e,t,r,i,u){const d=u(t,Wo(r),i);return d===bt.falseFunc?e:d===bt.trueFunc?bt.falseFunc:T=>!d(T)&&e(T)},has(e,t,r,i,u){const{adapter:d}=r,T=Wo(r);T.relativeSelector=!0;const A=t.some(I=>I.some(Ou))?[Gd]:void 0,y=u(t,T,A);if(y===bt.falseFunc)return bt.falseFunc;const S=QT(y,d);if(A&&y!==bt.trueFunc){const{shouldTestNextSiblings:I=!1}=y;return C=>{if(!e(C))return!1;A[0]=C;const b=d.getChildren(C),R=I?[...b,...Kd(C,d)]:b;return d.existsOne(S,R)}}return I=>e(I)&&d.existsOne(S,d.getChildren(I))}};function zT(e,t,r,i,u){var d;const{name:T,data:A}=t;if(Array.isArray(A)){if(!(T in _o))throw new Error(`Unknown pseudo-class :${T}(${A})`);return _o[T](e,A,r,i,u)}const y=(d=r.pseudos)===null||d===void 0?void 0:d[T],S=typeof y=="string"?y:XT[T];if(typeof S=="string"){if(A!=null)throw new Error(`Pseudo ${T} doesn't have any arguments`);const I=Ta(S);return _o.is(e,I,r,i,u)}if(typeof y=="function")return Uc(y,T,A,1),I=>y(I,A)&&e(I);if(T in qo)return qo[T](e,A,r,i);if(T in Bc){const I=Bc[T];return Uc(I,T,A,2),C=>I(C,r,A)&&e(C)}throw new Error(`Unknown pseudo-class :${T}`)}function So(e,t){const r=t.getParent(e);return r&&t.isTag(r)?r:null}function $T(e,t,r,i,u){const{adapter:d,equals:T}=r;switch(t.type){case ut.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case ut.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case ut.Attribute:{if(t.namespace!=null)throw new Error("Namespaced attributes are not yet supported by css-select");return(!r.xmlMode||r.lowerCaseAttributeNames)&&(t.name=t.name.toLowerCase()),YT[t.action](e,t,r)}case ut.Pseudo:return zT(e,t,r,i,u);case ut.Tag:{if(t.namespace!=null)throw new Error("Namespaced tag names are not yet supported by css-select");let{name:A}=t;return(!r.xmlMode||r.lowerCaseTags)&&(A=A.toLowerCase()),function(S){return d.getName(S)===A&&e(S)}}case ut.Descendant:{if(r.cacheResults===!1||typeof WeakSet>"u")return function(S){let I=S;for(;I=So(I,d);)if(e(I))return!0;return!1};const A=new WeakSet;return function(S){let I=S;for(;I=So(I,d);)if(!A.has(I)){if(d.isTag(I)&&e(I))return!0;A.add(I)}return!1}}case"_flexibleDescendant":return function(y){let S=y;do if(e(S))return!0;while(S=So(S,d));return!1};case ut.Parent:return function(y){return d.getChildren(y).some(S=>d.isTag(S)&&e(S))};case ut.Child:return function(y){const S=d.getParent(y);return S!=null&&d.isTag(S)&&e(S)};case ut.Sibling:return function(y){const S=d.getSiblings(y);for(let I=0;I<S.length;I++){const C=S[I];if(T(y,C))break;if(d.isTag(C)&&e(C))return!0}return!1};case ut.Adjacent:return d.prevElementSibling?function(y){const S=d.prevElementSibling(y);return S!=null&&e(S)}:function(y){const S=d.getSiblings(y);let I;for(let C=0;C<S.length;C++){const b=S[C];if(T(y,b))break;d.isTag(b)&&(I=b)}return!!I&&e(I)};case ut.Universal:{if(t.namespace!=null&&t.namespace!=="*")throw new Error("Namespaced universal selectors are not yet supported by css-select");return e}}}function Yd(e){return e.type===ut.Pseudo&&(e.name==="scope"||Array.isArray(e.data)&&e.data.some(t=>t.some(Yd)))}const ZT={type:ut.Descendant},JT={type:"_flexibleDescendant"},ev={type:ut.Pseudo,name:"scope",data:null};function tv(e,{adapter:t},r){const i=!!(r!=null&&r.every(u=>{const d=t.isTag(u)&&t.getParent(u);return u===Gd||d&&t.isTag(d)}));for(const u of e){if(!(u.length>0&&Ou(u[0])&&u[0].type!==ut.Descendant))if(i&&!u.some(Yd))u.unshift(ZT);else continue;u.unshift(ev)}}function Vd(e,t,r){var i;e.forEach(HT),r=(i=t.context)!==null&&i!==void 0?i:r;const u=Array.isArray(r),d=r&&(Array.isArray(r)?r:[r]);if(t.relativeSelector!==!1)tv(e,t,d);else if(e.some(y=>y.length>0&&Ou(y[0])))throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled");let T=!1;const A=e.map(y=>{if(y.length>=2){const[S,I]=y;S.type!==ut.Pseudo||S.name!=="scope"||(u&&I.type===ut.Descendant?y[1]=JT:(I.type===ut.Adjacent||I.type===ut.Sibling)&&(T=!0))}return rv(y,t,d)}).reduce(nv,bt.falseFunc);return A.shouldTestNextSiblings=T,A}function rv(e,t,r){var i;return e.reduce((u,d)=>u===bt.falseFunc?bt.falseFunc:$T(u,d,t,r,Vd),(i=t.rootFunc)!==null&&i!==void 0?i:bt.trueFunc)}function nv(e,t){return t===bt.falseFunc||e===bt.trueFunc?e:e===bt.falseFunc||t===bt.trueFunc?t:function(i){return e(i)||t(i)}}const jd=(e,t)=>e===t,iv={adapter:Ea,equals:jd};function sv(e){var t,r,i,u;const d=e??iv;return(t=d.adapter)!==null&&t!==void 0||(d.adapter=Ea),(r=d.equals)!==null&&r!==void 0||(d.equals=(u=(i=d.adapter)===null||i===void 0?void 0:i.equals)!==null&&u!==void 0?u:jd),d}function av(e){return function(r,i,u){const d=sv(i);return e(r,d,u)}}const xu=av(Vd);function qd(e,t,r=!1){return r&&(e=ov(e,t)),Array.isArray(e)?t.removeSubsets(e):t.getChildren(e)}function ov(e,t){const r=Array.isArray(e)?e.slice(0):[e],i=r.length;for(let u=0;u<i;u++){const d=Kd(r[u],t);r.push(...d)}return r}const uv=new Set(["first","last","eq","gt","nth","lt","even","odd"]);function Qs(e){return e.type!=="pseudo"?!1:uv.has(e.name)?!0:e.name==="not"&&Array.isArray(e.data)?e.data.some(t=>t.some(Qs)):!1}function lv(e,t,r){const i=t!=null?parseInt(t,10):NaN;switch(e){case"first":return 1;case"nth":case"eq":return isFinite(i)?i>=0?i+1:1/0:0;case"lt":return isFinite(i)?i>=0?Math.min(i,r):1/0:0;case"gt":return isFinite(i)?1/0:0;case"odd":return 2*r;case"even":return 2*r-1;case"last":case"not":return 1/0}}function cv(e){for(;e.parent;)e=e.parent;return e}function ku(e){const t=[],r=[];for(const i of e)i.some(Qs)?t.push(i):r.push(i);return[r,t]}const fv={type:ut.Universal,namespace:null},dv={type:ut.Pseudo,name:"scope",data:null};function Wd(e,t,r={}){return Xd([e],t,r)}function Xd(e,t,r={}){if(typeof t=="function")return e.some(t);const[i,u]=ku(Ta(t));return i.length>0&&e.some(xu(i,r))||u.some(d=>$d(d,e,r).length>0)}function hv(e,t,r,i){const u=typeof r=="string"?parseInt(r,10):NaN;switch(e){case"first":case"lt":return t;case"last":return t.length>0?[t[t.length-1]]:t;case"nth":case"eq":return isFinite(u)&&Math.abs(u)<t.length?[u<0?t[t.length+u]:t[u]]:[];case"gt":return isFinite(u)?t.slice(u+1):[];case"even":return t.filter((d,T)=>T%2===0);case"odd":return t.filter((d,T)=>T%2===1);case"not":{const d=new Set(zd(r,t,i));return t.filter(T=>!d.has(T))}}}function Qd(e,t,r={}){return zd(Ta(e),t,r)}function zd(e,t,r){if(t.length===0)return[];const[i,u]=ku(e);let d;if(i.length){const T=Qo(t,i,r);if(u.length===0)return T;T.length&&(d=new Set(T))}for(let T=0;T<u.length&&(d==null?void 0:d.size)!==t.length;T++){const A=u[T];if((d?t.filter(I=>ht(I)&&!d.has(I)):t).length===0)break;const S=$d(A,t,r);if(S.length)if(d)S.forEach(I=>d.add(I));else{if(T===u.length-1)return S;d=new Set(S)}}return typeof d<"u"?d.size===t.length?t:t.filter(T=>d.has(T)):[]}function $d(e,t,r){var i;if(e.some(Hi)){const u=(i=r.root)!==null&&i!==void 0?i:cv(t[0]),d={...r,context:t,relativeSelector:!1};return e.push(dv),zs(u,e,d,!0,t.length)}return zs(t,e,r,!1,t.length)}function gv(e,t,r={},i=1/0){if(typeof e=="function")return Zd(t,e);const[u,d]=ku(Ta(e)),T=d.map(A=>zs(t,A,r,!0,i));return u.length&&T.push(Xo(t,u,r,i)),T.length===0?[]:T.length===1?T[0]:Ti(T.reduce((A,y)=>[...A,...y]))}function zs(e,t,r,i,u){const d=t.findIndex(Qs),T=t.slice(0,d),A=t[d],y=t.length-1===d?u:1/0,S=lv(A.name,A.data,y);if(S===0)return[];const C=(T.length===0&&!Array.isArray(e)?ga(e).filter(ht):T.length===0?(Array.isArray(e)?e:[e]).filter(ht):i||T.some(Hi)?Xo(e,[T],r,S):Qo(e,[T],r)).slice(0,S);let b=hv(A.name,C,A.data,r);if(b.length===0||t.length===d+1)return b;const R=t.slice(d+1),P=R.some(Hi);if(P){if(Hi(R[0])){const{type:ce}=R[0];(ce===ut.Sibling||ce===ut.Adjacent)&&(b=qd(b,Ea,!0)),R.unshift(fv)}r={...r,relativeSelector:!1,rootFunc:ce=>b.includes(ce)}}else r.rootFunc&&r.rootFunc!==bt.trueFunc&&(r={...r,rootFunc:bt.trueFunc});return R.some(Qs)?zs(b,R,r,!1,u):P?Xo(b,[R],r,u):Qo(b,[R],r)}function Xo(e,t,r,i){const u=xu(t,r,e);return Zd(e,u,i)}function Zd(e,t,r=1/0){const i=qd(e,Ea,t.shouldTestNextSiblings);return pa(u=>ht(u)&&t(u),i,!0,r)}function Qo(e,t,r){const i=(Array.isArray(e)?e:[e]).filter(ht);if(i.length===0)return i;const u=xu(t,r);return u===bt.trueFunc?i:i.filter(u)}const mv=/^\s*[~+]/;function pv(e){var t;if(!e)return this._make([]);const r=this.toArray();if(typeof e!="string"){const d=Vr(e)?e.toArray():[e];return this._make(d.filter(T=>r.some(A=>kd(A,T))))}const i=mv.test(e)?r:this.children().toArray(),u={context:r,root:(t=this._root)===null||t===void 0?void 0:t[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(gv(e,i,u))}function Pu(e){return function(t,...r){return function(i){var u;let d=e(t,this);return i&&(d=Fu(d,i,this.options.xmlMode,(u=this._root)===null||u===void 0?void 0:u[0])),this._make(this.length>1&&d.length>1?r.reduce((T,A)=>A(T),d):d)}}}const ss=Pu((e,t)=>{const r=[];for(let i=0;i<t.length;i++){const u=e(t[i]);r.push(u)}return new Array().concat(...r)}),wu=Pu((e,t)=>{const r=[];for(let i=0;i<t.length;i++){const u=e(t[i]);u!==null&&r.push(u)}return r});function Mu(e,...t){let r=null;const i=Pu((u,d)=>{const T=[];return jt(d,A=>{for(let y;(y=u(A))&&!(r!=null&&r(y,T.length));A=y)T.push(y)}),T})(e,...t);return function(u,d){r=typeof u=="string"?A=>Wd(A,u,this.options):u?as(u):null;const T=i.call(this,d);return r=null,T}}function vi(e){return Array.from(new Set(e))}const Ev=wu(({parent:e})=>e&&!Un(e)?e:null,vi),Tv=ss(e=>{const t=[];for(;e.parent&&!Un(e.parent);)t.push(e.parent),e=e.parent;return t},Ti,e=>e.reverse()),vv=Mu(({parent:e})=>e&&!Un(e)?e:null,Ti,e=>e.reverse());function bv(e){var t;const r=[];if(!e)return this._make(r);const i={xmlMode:this.options.xmlMode,root:(t=this._root)===null||t===void 0?void 0:t[0]},u=typeof e=="string"?d=>Wd(d,e,i):as(e);return jt(this,d=>{for(;d&&ht(d);){if(u(d,0)){r.includes(d)||r.push(d);break}d=d.parent}}),this._make(r)}const yv=wu(e=>Lu(e)),Av=ss(e=>{const t=[];for(;e.next;)e=e.next,ht(e)&&t.push(e);return t},vi),_v=Mu(e=>Lu(e),vi),Sv=wu(e=>Ru(e)),Iv=ss(e=>{const t=[];for(;e.prev;)e=e.prev,ht(e)&&t.push(e);return t},vi),Cv=Mu(e=>Ru(e),vi),Lv=ss(e=>Cd(e).filter(t=>ht(t)&&t!==e),Ti),Rv=ss(e=>ga(e).filter(ht),vi);function Dv(){const e=this.toArray().reduce((t,r)=>Jt(r)?t.concat(r.children):t,[]);return this._make(e)}function Nv(e){let t=0;const r=this.length;for(;t<r&&e.call(this[t],t,this[t])!==!1;)++t;return this}function Ov(e){let t=[];for(let r=0;r<this.length;r++){const i=this[r],u=e.call(i,r,i);u!=null&&(t=t.concat(u))}return this._make(t)}function as(e){return typeof e=="function"?(t,r)=>e.call(t,r,t):Vr(e)?t=>Array.prototype.includes.call(e,t):function(t){return e===t}}function xv(e){var t;return this._make(Fu(this.toArray(),e,this.options.xmlMode,(t=this._root)===null||t===void 0?void 0:t[0]))}function Fu(e,t,r,i){return typeof t=="string"?Qd(t,e,{xmlMode:r,root:i}):e.filter(as(t))}function kv(e){const t=this.toArray();return typeof e=="string"?Xd(t.filter(ht),e,this.options):e?t.some(as(e)):!1}function Pv(e){let t=this.toArray();if(typeof e=="string"){const r=new Set(Qd(e,t,this.options));t=t.filter(i=>!r.has(i))}else{const r=as(e);t=t.filter((i,u)=>!r(i,u))}return this._make(t)}function wv(e){return this.filter(typeof e=="string"?`:has(${e})`:(t,r)=>this._make(r).find(e).length>0)}function Mv(){return this.length>1?this._make(this[0]):this}function Fv(){return this.length>0?this._make(this[this.length-1]):this}function Bv(e){var t;return e=+e,e===0&&this.length<=1?this:(e<0&&(e=this.length+e),this._make((t=this[e])!==null&&t!==void 0?t:[]))}function Uv(e){return e==null?this.toArray():this[e<0?this.length+e:e]}function Hv(){return Array.prototype.slice.call(this)}function Gv(e){let t,r;return e==null?(t=this.parent().children(),r=this[0]):typeof e=="string"?(t=this._make(e),r=this[0]):(t=this,r=Vr(e)?e[0]:e),Array.prototype.indexOf.call(t,r)}function Kv(e,t){return this._make(Array.prototype.slice.call(this,e,t))}function Yv(){var e;return(e=this.prevObject)!==null&&e!==void 0?e:this._make([])}function Vv(e,t){const r=this._make(e,t),i=Ti([...this.get(),...r.get()]);return this._make(i)}function jv(e){return this.prevObject?this.add(e?this.prevObject.filter(e):this.prevObject):this}const qv=Object.freeze(Object.defineProperty({__proto__:null,add:Vv,addBack:jv,children:Rv,closest:bv,contents:Dv,each:Nv,end:Yv,eq:Bv,filter:xv,filterArray:Fu,find:pv,first:Mv,get:Uv,has:wv,index:Gv,is:kv,last:Fv,map:Ov,next:yv,nextAll:Av,nextUntil:_v,not:Pv,parent:Ev,parents:Tv,parentsUntil:vv,prev:Sv,prevAll:Iv,prevUntil:Cv,siblings:Lv,slice:Kv,toArray:Hv},Symbol.toStringTag,{value:"Module"}));function Wv(e){return function(r,i,u,d){if(typeof Buffer<"u"&&Buffer.isBuffer(r)&&(r=r.toString()),typeof r=="string")return e(r,i,u,d);const T=r;if(!Array.isArray(T)&&Un(T))return T;const A=new Fn([]);return Bn(T,A),A}}function Bn(e,t){const r=Array.isArray(e)?e:[e];t?t.children=r:t=null;for(let i=0;i<r.length;i++){const u=r[i];u.parent&&u.parent.children!==r&&Hn(u),t?(u.prev=r[i-1]||null,u.next=r[i+1]||null):u.prev=u.next=null,u.parent=t}return t}function Xv(e,t){return e==null?[]:Vr(e)?t?Vo(e.get()):e.get():Array.isArray(e)?e.reduce((r,i)=>r.concat(this._makeDomArray(i,t)),[]):typeof e=="string"?this._parse(e,this.options,!1,null).children:t?Vo([e]):[e]}function Jd(e){return function(...t){const r=this.length-1;return jt(this,(i,u)=>{if(!Jt(i))return;const d=typeof t[0]=="function"?t[0].call(i,u,this._render(i.children)):t,T=this._makeDomArray(d,u<r);e(T,i.children,i)})}}function Tn(e,t,r,i,u){var d,T;const A=[t,r,...i],y=t===0?null:e[t-1],S=t+r>=e.length?null:e[t+r];for(let I=0;I<i.length;++I){const C=i[I],b=C.parent;if(b){const P=b.children.indexOf(C);P>-1&&(b.children.splice(P,1),u===b&&t>P&&A[0]--)}C.parent=u,C.prev&&(C.prev.next=(d=C.next)!==null&&d!==void 0?d:null),C.next&&(C.next.prev=(T=C.prev)!==null&&T!==void 0?T:null),C.prev=I===0?y:i[I-1],C.next=I===i.length-1?S:i[I+1]}return y&&(y.next=i[0]),S&&(S.prev=i[i.length-1]),e.splice(...A)}function Qv(e){return(Vr(e)?e:this._make(e)).append(this),this}function zv(e){return(Vr(e)?e:this._make(e)).prepend(this),this}const $v=Jd((e,t,r)=>{Tn(t,t.length,0,e,r)}),Zv=Jd((e,t,r)=>{Tn(t,0,0,e,r)});function eh(e){return function(t){const r=this.length-1,i=this.parents().last();for(let u=0;u<this.length;u++){const d=this[u],T=typeof t=="function"?t.call(d,u,d):typeof t=="string"&&!jo(t)?i.find(t).clone():t,[A]=this._makeDomArray(T,u<r);if(!A||!Jt(A))continue;let y=A,S=0;for(;S<y.children.length;){const I=y.children[S];ht(I)?(y=I,S=0):S++}e(d,y,[A])}return this}}const Jv=eh((e,t,r)=>{const{parent:i}=e;if(!i)return;const u=i.children,d=u.indexOf(e);Bn([e],t),Tn(u,d,0,r,i)}),e1=eh((e,t,r)=>{Jt(e)&&(Bn(e.children,t),Bn(r,e))});function t1(e){return this.parent(e).not("body").each((t,r)=>{this._make(r).replaceWith(r.children)}),this}function r1(e){const t=this[0];if(t){const r=this._make(typeof e=="function"?e.call(t,0,t):e).insertBefore(t);let i;for(let d=0;d<r.length;d++)r[d].type==="tag"&&(i=r[d]);let u=0;for(;i&&u<i.children.length;){const d=i.children[u];d.type==="tag"?(i=d,u=0):u++}i&&this._make(i).append(this)}return this}function n1(...e){const t=this.length-1;return jt(this,(r,i)=>{const{parent:u}=r;if(!Jt(r)||!u)return;const d=u.children,T=d.indexOf(r);if(T<0)return;const A=typeof e[0]=="function"?e[0].call(r,i,this._render(r.children)):e,y=this._makeDomArray(A,i<t);Tn(d,T+1,0,y,u)})}function i1(e){typeof e=="string"&&(e=this._make(e)),this.remove();const t=[];return this._makeDomArray(e).forEach(r=>{const i=this.clone().toArray(),{parent:u}=r;if(!u)return;const d=u.children,T=d.indexOf(r);T<0||(Tn(d,T+1,0,i,u),t.push(...i))}),this._make(t)}function s1(...e){const t=this.length-1;return jt(this,(r,i)=>{const{parent:u}=r;if(!Jt(r)||!u)return;const d=u.children,T=d.indexOf(r);if(T<0)return;const A=typeof e[0]=="function"?e[0].call(r,i,this._render(r.children)):e,y=this._makeDomArray(A,i<t);Tn(d,T,0,y,u)})}function a1(e){const t=this._make(e);this.remove();const r=[];return jt(t,i=>{const u=this.clone().toArray(),{parent:d}=i;if(!d)return;const T=d.children,A=T.indexOf(i);A<0||(Tn(T,A,0,u,d),r.push(...u))}),this._make(r)}function o1(e){const t=e?this.filter(e):this;return jt(t,r=>{Hn(r),r.prev=r.next=r.parent=null}),this}function u1(e){return jt(this,(t,r)=>{const{parent:i}=t;if(!i)return;const u=i.children,d=typeof e=="function"?e.call(t,r,t):e,T=this._makeDomArray(d);Bn(T,null);const A=u.indexOf(t);Tn(u,A,1,T,i),T.includes(t)||(t.parent=t.prev=t.next=null)})}function l1(){return jt(this,e=>{Jt(e)&&(e.children.forEach(t=>{t.next=t.prev=t.parent=null}),e.children.length=0)})}function c1(e){if(e===void 0){const t=this[0];return!t||!Jt(t)?null:this._render(t.children)}return jt(this,t=>{if(!Jt(t))return;t.children.forEach(i=>{i.next=i.prev=i.parent=null});const r=Vr(e)?e.toArray():this._parse(`${e}`,this.options,!1,t).children;Bn(r,t)})}function f1(){return this._render(this)}function d1(e){return e===void 0?ts(this):typeof e=="function"?jt(this,(t,r)=>this._make(t).text(e.call(t,r,ts([t])))):jt(this,t=>{if(!Jt(t))return;t.children.forEach(i=>{i.next=i.prev=i.parent=null});const r=new es(`${e}`);Bn(r,t)})}function h1(){return this._make(Vo(this.get()))}const g1=Object.freeze(Object.defineProperty({__proto__:null,_makeDomArray:Xv,after:n1,append:$v,appendTo:Qv,before:s1,clone:h1,empty:l1,html:c1,insertAfter:i1,insertBefore:a1,prepend:Zv,prependTo:zv,remove:o1,replaceWith:u1,text:d1,toString:f1,unwrap:t1,wrap:Jv,wrapAll:r1,wrapInner:e1},Symbol.toStringTag,{value:"Module"}));function m1(e,t){if(e!=null&&t!=null||typeof e=="object"&&!Array.isArray(e))return jt(this,(r,i)=>{ht(r)&&th(r,e,t,i)});if(this.length!==0)return rh(this[0],e)}function th(e,t,r,i){if(typeof t=="string"){const u=rh(e),d=typeof r=="function"?r.call(e,i,u[t]):r;d===""?delete u[t]:d!=null&&(u[t]=d),e.attribs.style=p1(u)}else typeof t=="object"&&Object.keys(t).forEach((u,d)=>{th(e,u,t[u],d)})}function rh(e,t){if(!e||!ht(e))return;const r=E1(e.attribs.style);if(typeof t=="string")return r[t];if(Array.isArray(t)){const i={};return t.forEach(u=>{r[u]!=null&&(i[u]=r[u])}),i}return r}function p1(e){return Object.keys(e).reduce((t,r)=>`${t}${t?" ":""}${r}: ${e[r]};`,"")}function E1(e){if(e=(e||"").trim(),!e)return{};const t={};let r;for(const i of e.split(";")){const u=i.indexOf(":");if(u<1||u===i.length-1){const d=i.trimEnd();d.length>0&&r!==void 0&&(t[r]+=`;${d}`)}else r=i.slice(0,u).trim(),t[r]=i.slice(u+1).trim()}return t}const T1=Object.freeze(Object.defineProperty({__proto__:null,css:m1},Symbol.toStringTag,{value:"Module"})),Hc="input,select,textarea,keygen",v1=/%20/g,Gc=/\r?\n/g;function b1(){return this.serializeArray().map(r=>`${encodeURIComponent(r.name)}=${encodeURIComponent(r.value)}`).join("&").replace(v1,"+")}function y1(){return this.map((e,t)=>{const r=this._make(t);return ht(t)&&t.name==="form"?r.find(Hc).toArray():r.filter(Hc).toArray()}).filter('[name!=""]:enabled:not(:submit, :button, :image, :reset, :file):matches([checked], :not(:checkbox, :radio))').map((e,t)=>{var r;const i=this._make(t),u=i.attr("name"),d=(r=i.val())!==null&&r!==void 0?r:"";return Array.isArray(d)?d.map(T=>({name:u,value:T.replace(Gc,`\r
`)})):{name:u,value:d.replace(Gc,`\r
`)}}).toArray()}const A1=Object.freeze(Object.defineProperty({__proto__:null,serialize:b1,serializeArray:y1},Symbol.toStringTag,{value:"Module"}));class os{constructor(t,r,i){if(this.length=0,this.options=i,this._root=r,t){for(let u=0;u<t.length;u++)this[u]=t[u];this.length=t.length}}}os.prototype.cheerio="[cheerio object]";os.prototype.splice=Array.prototype.splice;os.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];Object.assign(os.prototype,OT,qv,g1,T1,A1);function _1(e,t){return function r(i,u,d=!0){if(i==null)throw new Error("cheerio.load() expects a string");const T={...yu,...Ko(u)},A=e(i,T,d,null);class y extends os{_make(C,b){const R=S(C,b);return R.prevObject=this,R}_parse(C,b,R,P){return e(C,b,R,P)}_render(C){return t(C,this.options)}}function S(I,C,b=A,R){if(I&&Vr(I))return I;const P={...T,...Ko(R)},ce=typeof b=="string"?[e(b,P,!1,null)]:"length"in b?b:[b],J=Vr(ce)?ce:new y(ce,null,P);if(J._root=J,!I)return new y(void 0,J,P);const ie=typeof I=="string"&&jo(I)?e(I,P,!1,null).children:S1(I)?[I]:Array.isArray(I)?I:void 0,fe=new y(ie,J,P);if(ie)return fe;if(typeof I!="string")throw new Error("Unexpected type of selector");let Q=I;const de=C?typeof C=="string"?jo(C)?new y([e(C,P,!1,null)],J,P):(Q=`${C} ${Q}`,J):Vr(C)?C:new y(Array.isArray(C)?C:[C],J,P):J;return de?de.find(Q):fe}return Object.assign(S,yT,{load:r,_root:A,_options:T,fn:y.prototype,prototype:y.prototype}),S}}function S1(e){return!!e.name||e.type==="root"||e.type==="text"||e.type==="comment"}const I1=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),Gt="";var k;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.NUMBER_SIGN=35]="NUMBER_SIGN",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",e[e.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_F=102]="LATIN_SMALL_F",e[e.LATIN_SMALL_X=120]="LATIN_SMALL_X",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",e[e.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"})(k=k||(k={}));const lr={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function nh(e){return e>=55296&&e<=57343}function C1(e){return e>=56320&&e<=57343}function L1(e,t){return(e-55296)*1024+9216+t}function ih(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function sh(e){return e>=64976&&e<=65007||I1.has(e)}var be;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(be=be||(be={}));const R1=1<<16;class D1{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=R1,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t){const{line:r,col:i,offset:u}=this;return{code:t,startLine:r,endLine:r,startCol:i,endCol:i,startOffset:u,endOffset:u}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const r=this.html.charCodeAt(this.pos+1);if(C1(r))return this.pos++,this._addGap(),L1(t,r)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,k.EOF;return this._err(be.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,r){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=r}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,r){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(r)return this.html.startsWith(t,this.pos);for(let i=0;i<t.length;i++)if((this.html.charCodeAt(this.pos+i)|32)!==t.charCodeAt(i))return!1;return!0}peek(t){const r=this.pos+t;if(r>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,k.EOF;const i=this.html.charCodeAt(r);return i===k.CARRIAGE_RETURN?k.LINE_FEED:i}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,k.EOF;let t=this.html.charCodeAt(this.pos);return t===k.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,k.LINE_FEED):t===k.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,nh(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===k.LINE_FEED||t===k.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){ih(t)?this._err(be.controlCharacterInInputStream):sh(t)&&this._err(be.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var Rt;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(Rt=Rt||(Rt={}));function ah(e,t){for(let r=e.attrs.length-1;r>=0;r--)if(e.attrs[r].name===t)return e.attrs[r].value;return null}var Le;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(Le=Le||(Le={}));var pn;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(pn=pn||(pn={}));var hr;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(hr=hr||(hr={}));var le;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(le=le||(le={}));var m;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SECTION=94]="SECTION",e[e.SELECT=95]="SELECT",e[e.SOURCE=96]="SOURCE",e[e.SMALL=97]="SMALL",e[e.SPAN=98]="SPAN",e[e.STRIKE=99]="STRIKE",e[e.STRONG=100]="STRONG",e[e.STYLE=101]="STYLE",e[e.SUB=102]="SUB",e[e.SUMMARY=103]="SUMMARY",e[e.SUP=104]="SUP",e[e.TABLE=105]="TABLE",e[e.TBODY=106]="TBODY",e[e.TEMPLATE=107]="TEMPLATE",e[e.TEXTAREA=108]="TEXTAREA",e[e.TFOOT=109]="TFOOT",e[e.TD=110]="TD",e[e.TH=111]="TH",e[e.THEAD=112]="THEAD",e[e.TITLE=113]="TITLE",e[e.TR=114]="TR",e[e.TRACK=115]="TRACK",e[e.TT=116]="TT",e[e.U=117]="U",e[e.UL=118]="UL",e[e.SVG=119]="SVG",e[e.VAR=120]="VAR",e[e.WBR=121]="WBR",e[e.XMP=122]="XMP"})(m=m||(m={}));const N1=new Map([[le.A,m.A],[le.ADDRESS,m.ADDRESS],[le.ANNOTATION_XML,m.ANNOTATION_XML],[le.APPLET,m.APPLET],[le.AREA,m.AREA],[le.ARTICLE,m.ARTICLE],[le.ASIDE,m.ASIDE],[le.B,m.B],[le.BASE,m.BASE],[le.BASEFONT,m.BASEFONT],[le.BGSOUND,m.BGSOUND],[le.BIG,m.BIG],[le.BLOCKQUOTE,m.BLOCKQUOTE],[le.BODY,m.BODY],[le.BR,m.BR],[le.BUTTON,m.BUTTON],[le.CAPTION,m.CAPTION],[le.CENTER,m.CENTER],[le.CODE,m.CODE],[le.COL,m.COL],[le.COLGROUP,m.COLGROUP],[le.DD,m.DD],[le.DESC,m.DESC],[le.DETAILS,m.DETAILS],[le.DIALOG,m.DIALOG],[le.DIR,m.DIR],[le.DIV,m.DIV],[le.DL,m.DL],[le.DT,m.DT],[le.EM,m.EM],[le.EMBED,m.EMBED],[le.FIELDSET,m.FIELDSET],[le.FIGCAPTION,m.FIGCAPTION],[le.FIGURE,m.FIGURE],[le.FONT,m.FONT],[le.FOOTER,m.FOOTER],[le.FOREIGN_OBJECT,m.FOREIGN_OBJECT],[le.FORM,m.FORM],[le.FRAME,m.FRAME],[le.FRAMESET,m.FRAMESET],[le.H1,m.H1],[le.H2,m.H2],[le.H3,m.H3],[le.H4,m.H4],[le.H5,m.H5],[le.H6,m.H6],[le.HEAD,m.HEAD],[le.HEADER,m.HEADER],[le.HGROUP,m.HGROUP],[le.HR,m.HR],[le.HTML,m.HTML],[le.I,m.I],[le.IMG,m.IMG],[le.IMAGE,m.IMAGE],[le.INPUT,m.INPUT],[le.IFRAME,m.IFRAME],[le.KEYGEN,m.KEYGEN],[le.LABEL,m.LABEL],[le.LI,m.LI],[le.LINK,m.LINK],[le.LISTING,m.LISTING],[le.MAIN,m.MAIN],[le.MALIGNMARK,m.MALIGNMARK],[le.MARQUEE,m.MARQUEE],[le.MATH,m.MATH],[le.MENU,m.MENU],[le.META,m.META],[le.MGLYPH,m.MGLYPH],[le.MI,m.MI],[le.MO,m.MO],[le.MN,m.MN],[le.MS,m.MS],[le.MTEXT,m.MTEXT],[le.NAV,m.NAV],[le.NOBR,m.NOBR],[le.NOFRAMES,m.NOFRAMES],[le.NOEMBED,m.NOEMBED],[le.NOSCRIPT,m.NOSCRIPT],[le.OBJECT,m.OBJECT],[le.OL,m.OL],[le.OPTGROUP,m.OPTGROUP],[le.OPTION,m.OPTION],[le.P,m.P],[le.PARAM,m.PARAM],[le.PLAINTEXT,m.PLAINTEXT],[le.PRE,m.PRE],[le.RB,m.RB],[le.RP,m.RP],[le.RT,m.RT],[le.RTC,m.RTC],[le.RUBY,m.RUBY],[le.S,m.S],[le.SCRIPT,m.SCRIPT],[le.SECTION,m.SECTION],[le.SELECT,m.SELECT],[le.SOURCE,m.SOURCE],[le.SMALL,m.SMALL],[le.SPAN,m.SPAN],[le.STRIKE,m.STRIKE],[le.STRONG,m.STRONG],[le.STYLE,m.STYLE],[le.SUB,m.SUB],[le.SUMMARY,m.SUMMARY],[le.SUP,m.SUP],[le.TABLE,m.TABLE],[le.TBODY,m.TBODY],[le.TEMPLATE,m.TEMPLATE],[le.TEXTAREA,m.TEXTAREA],[le.TFOOT,m.TFOOT],[le.TD,m.TD],[le.TH,m.TH],[le.THEAD,m.THEAD],[le.TITLE,m.TITLE],[le.TR,m.TR],[le.TRACK,m.TRACK],[le.TT,m.TT],[le.U,m.U],[le.UL,m.UL],[le.SVG,m.SVG],[le.VAR,m.VAR],[le.WBR,m.WBR],[le.XMP,m.XMP]]);function va(e){var t;return(t=N1.get(e))!==null&&t!==void 0?t:m.UNKNOWN}const Ye=m,O1={[Le.HTML]:new Set([Ye.ADDRESS,Ye.APPLET,Ye.AREA,Ye.ARTICLE,Ye.ASIDE,Ye.BASE,Ye.BASEFONT,Ye.BGSOUND,Ye.BLOCKQUOTE,Ye.BODY,Ye.BR,Ye.BUTTON,Ye.CAPTION,Ye.CENTER,Ye.COL,Ye.COLGROUP,Ye.DD,Ye.DETAILS,Ye.DIR,Ye.DIV,Ye.DL,Ye.DT,Ye.EMBED,Ye.FIELDSET,Ye.FIGCAPTION,Ye.FIGURE,Ye.FOOTER,Ye.FORM,Ye.FRAME,Ye.FRAMESET,Ye.H1,Ye.H2,Ye.H3,Ye.H4,Ye.H5,Ye.H6,Ye.HEAD,Ye.HEADER,Ye.HGROUP,Ye.HR,Ye.HTML,Ye.IFRAME,Ye.IMG,Ye.INPUT,Ye.LI,Ye.LINK,Ye.LISTING,Ye.MAIN,Ye.MARQUEE,Ye.MENU,Ye.META,Ye.NAV,Ye.NOEMBED,Ye.NOFRAMES,Ye.NOSCRIPT,Ye.OBJECT,Ye.OL,Ye.P,Ye.PARAM,Ye.PLAINTEXT,Ye.PRE,Ye.SCRIPT,Ye.SECTION,Ye.SELECT,Ye.SOURCE,Ye.STYLE,Ye.SUMMARY,Ye.TABLE,Ye.TBODY,Ye.TD,Ye.TEMPLATE,Ye.TEXTAREA,Ye.TFOOT,Ye.TH,Ye.THEAD,Ye.TITLE,Ye.TR,Ye.TRACK,Ye.UL,Ye.WBR,Ye.XMP]),[Le.MATHML]:new Set([Ye.MI,Ye.MO,Ye.MN,Ye.MS,Ye.MTEXT,Ye.ANNOTATION_XML]),[Le.SVG]:new Set([Ye.TITLE,Ye.FOREIGN_OBJECT,Ye.DESC]),[Le.XLINK]:new Set,[Le.XML]:new Set,[Le.XMLNS]:new Set};function oh(e){return e===Ye.H1||e===Ye.H2||e===Ye.H3||e===Ye.H4||e===Ye.H5||e===Ye.H6}const x1=new Set([le.STYLE,le.SCRIPT,le.XMP,le.IFRAME,le.NOEMBED,le.NOFRAMES,le.PLAINTEXT]);function k1(e,t){return x1.has(e)||t&&e===le.NOSCRIPT}const P1=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);var F;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",e[e.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",e[e.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",e[e.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",e[e.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",e[e.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"})(F||(F={}));const gr={DATA:F.DATA,RCDATA:F.RCDATA,RAWTEXT:F.RAWTEXT,SCRIPT_DATA:F.SCRIPT_DATA,PLAINTEXT:F.PLAINTEXT,CDATA_SECTION:F.CDATA_SECTION};function Gi(e){return e>=k.DIGIT_0&&e<=k.DIGIT_9}function Pi(e){return e>=k.LATIN_CAPITAL_A&&e<=k.LATIN_CAPITAL_Z}function w1(e){return e>=k.LATIN_SMALL_A&&e<=k.LATIN_SMALL_Z}function fn(e){return w1(e)||Pi(e)}function zo(e){return fn(e)||Gi(e)}function uh(e){return e>=k.LATIN_CAPITAL_A&&e<=k.LATIN_CAPITAL_F}function lh(e){return e>=k.LATIN_SMALL_A&&e<=k.LATIN_SMALL_F}function M1(e){return Gi(e)||uh(e)||lh(e)}function Is(e){return e+32}function ch(e){return e===k.SPACE||e===k.LINE_FEED||e===k.TABULATION||e===k.FORM_FEED}function F1(e){return e===k.EQUALS_SIGN||zo(e)}function Kc(e){return ch(e)||e===k.SOLIDUS||e===k.GREATER_THAN_SIGN}let B1=class{constructor(t,r){this.options=t,this.handler=r,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=F.DATA,this.returnState=F.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new D1(r),this.currentLocation=this.getCurrentLocation(-1)}_err(t){var r,i;(i=(r=this.handler).onParseError)===null||i===void 0||i.call(r,this.preprocessor.getError(t))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,r,i){this.active=!0,this.preprocessor.write(t,r),this._runParsingLoop(),this.paused||i==null||i()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume(t){this.consumedAfterSnapshot-=t,this.preprocessor.retreat(t)}_reconsumeInState(t,r){this.state=t,this._callState(r)}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let r=0;r<t;r++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,r){return this.preprocessor.startsWith(t,r)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:Rt.START_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:Rt.END_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:Rt.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:Rt.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,r){this.currentCharacterToken={type:t,chars:r,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,r;const i=this.currentToken;if(ah(i,this.currentAttr.name)===null){if(i.attrs.push(this.currentAttr),i.location&&this.currentLocation){const u=(t=(r=i.location).attrs)!==null&&t!==void 0?t:r.attrs=Object.create(null);u[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(be.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=va(t.tagName),t.type===Rt.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(be.endTagWithAttributes),t.selfClosing&&this._err(be.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case Rt.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case Rt.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case Rt.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:Rt.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,r){if(this.currentCharacterToken)if(this.currentCharacterToken.type!==t)this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();else{this.currentCharacterToken.chars+=r;return}this._createCharacterToken(t,r)}_emitCodePoint(t){const r=ch(t)?Rt.WHITESPACE_CHARACTER:t===k.NULL?Rt.NULL_CHARACTER:Rt.CHARACTER;this._appendCharToCurrentCharacterToken(r,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(Rt.CHARACTER,t)}_matchNamedCharacterReference(t){let r=null,i=0,u=!1;for(let d=0,T=cn[0];d>=0&&(d=vd(cn,T,d+1,t),!(d<0));t=this._consume()){i+=1,T=cn[d];const A=T&rn.VALUE_LENGTH;if(A){const y=(A>>14)-1;if(t!==k.SEMICOLON&&this._isCharacterReferenceInAttribute()&&F1(this.preprocessor.peek(1))?(r=[k.AMPERSAND],d+=y):(r=y===0?[cn[d]&~rn.VALUE_LENGTH]:y===1?[cn[++d]]:[cn[++d],cn[++d]],i=0,u=t!==k.SEMICOLON),y===0){this._consume();break}}}return this._unconsume(i),u&&!this.preprocessor.endOfChunkHit&&this._err(be.missingSemicolonAfterCharacterReference),this._unconsume(1),r}_isCharacterReferenceInAttribute(){return this.returnState===F.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===F.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===F.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case F.DATA:{this._stateData(t);break}case F.RCDATA:{this._stateRcdata(t);break}case F.RAWTEXT:{this._stateRawtext(t);break}case F.SCRIPT_DATA:{this._stateScriptData(t);break}case F.PLAINTEXT:{this._statePlaintext(t);break}case F.TAG_OPEN:{this._stateTagOpen(t);break}case F.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case F.TAG_NAME:{this._stateTagName(t);break}case F.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case F.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case F.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case F.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case F.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case F.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case F.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case F.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case F.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case F.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case F.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case F.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case F.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case F.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case F.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case F.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case F.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case F.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case F.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case F.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case F.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case F.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case F.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case F.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case F.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case F.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case F.BOGUS_COMMENT:{this._stateBogusComment(t);break}case F.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case F.COMMENT_START:{this._stateCommentStart(t);break}case F.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case F.COMMENT:{this._stateComment(t);break}case F.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case F.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case F.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case F.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case F.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case F.COMMENT_END:{this._stateCommentEnd(t);break}case F.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case F.DOCTYPE:{this._stateDoctype(t);break}case F.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case F.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case F.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case F.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case F.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case F.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case F.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case F.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case F.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case F.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case F.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case F.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case F.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case F.CDATA_SECTION:{this._stateCdataSection(t);break}case F.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case F.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case F.CHARACTER_REFERENCE:{this._stateCharacterReference(t);break}case F.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference(t);break}case F.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}case F.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference(t);break}case F.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart(t);break}case F.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference(t);break}case F.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference(t);break}case F.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case k.LESS_THAN_SIGN:{this.state=F.TAG_OPEN;break}case k.AMPERSAND:{this.returnState=F.DATA,this.state=F.CHARACTER_REFERENCE;break}case k.NULL:{this._err(be.unexpectedNullCharacter),this._emitCodePoint(t);break}case k.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case k.AMPERSAND:{this.returnState=F.RCDATA,this.state=F.CHARACTER_REFERENCE;break}case k.LESS_THAN_SIGN:{this.state=F.RCDATA_LESS_THAN_SIGN;break}case k.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Gt);break}case k.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case k.LESS_THAN_SIGN:{this.state=F.RAWTEXT_LESS_THAN_SIGN;break}case k.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Gt);break}case k.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case k.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_LESS_THAN_SIGN;break}case k.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Gt);break}case k.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case k.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Gt);break}case k.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(fn(t))this._createStartTagToken(),this.state=F.TAG_NAME,this._stateTagName(t);else switch(t){case k.EXCLAMATION_MARK:{this.state=F.MARKUP_DECLARATION_OPEN;break}case k.SOLIDUS:{this.state=F.END_TAG_OPEN;break}case k.QUESTION_MARK:{this._err(be.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=F.BOGUS_COMMENT,this._stateBogusComment(t);break}case k.EOF:{this._err(be.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(be.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=F.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(fn(t))this._createEndTagToken(),this.state=F.TAG_NAME,this._stateTagName(t);else switch(t){case k.GREATER_THAN_SIGN:{this._err(be.missingEndTagName),this.state=F.DATA;break}case k.EOF:{this._err(be.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(be.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=F.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:{this.state=F.BEFORE_ATTRIBUTE_NAME;break}case k.SOLIDUS:{this.state=F.SELF_CLOSING_START_TAG;break}case k.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentTagToken();break}case k.NULL:{this._err(be.unexpectedNullCharacter),r.tagName+=Gt;break}case k.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:r.tagName+=String.fromCodePoint(Pi(t)?Is(t):t)}}_stateRcdataLessThanSign(t){t===k.SOLIDUS?this.state=F.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=F.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){fn(t)?(this.state=F.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=F.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const r=this.currentToken;switch(r.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=F.BEFORE_ATTRIBUTE_NAME,!1;case k.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=F.SELF_CLOSING_START_TAG,!1;case k.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=F.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=F.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===k.SOLIDUS?this.state=F.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=F.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){fn(t)?(this.state=F.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=F.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=F.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case k.SOLIDUS:{this.state=F.SCRIPT_DATA_END_TAG_OPEN;break}case k.EXCLAMATION_MARK:{this.state=F.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=F.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){fn(t)?(this.state=F.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=F.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=F.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===k.HYPHEN_MINUS?(this.state=F.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=F.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===k.HYPHEN_MINUS?(this.state=F.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=F.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case k.HYPHEN_MINUS:{this.state=F.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case k.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case k.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Gt);break}case k.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case k.HYPHEN_MINUS:{this.state=F.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case k.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case k.NULL:{this._err(be.unexpectedNullCharacter),this.state=F.SCRIPT_DATA_ESCAPED,this._emitChars(Gt);break}case k.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=F.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case k.HYPHEN_MINUS:{this._emitChars("-");break}case k.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case k.GREATER_THAN_SIGN:{this.state=F.SCRIPT_DATA,this._emitChars(">");break}case k.NULL:{this._err(be.unexpectedNullCharacter),this.state=F.SCRIPT_DATA_ESCAPED,this._emitChars(Gt);break}case k.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=F.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===k.SOLIDUS?this.state=F.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:fn(t)?(this._emitChars("<"),this.state=F.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=F.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){fn(t)?(this.state=F.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=F.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=F.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(lr.SCRIPT,!1)&&Kc(this.preprocessor.peek(lr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<lr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=F.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case k.HYPHEN_MINUS:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case k.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case k.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Gt);break}case k.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case k.HYPHEN_MINUS:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case k.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case k.NULL:{this._err(be.unexpectedNullCharacter),this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(Gt);break}case k.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case k.HYPHEN_MINUS:{this._emitChars("-");break}case k.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case k.GREATER_THAN_SIGN:{this.state=F.SCRIPT_DATA,this._emitChars(">");break}case k.NULL:{this._err(be.unexpectedNullCharacter),this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(Gt);break}case k.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===k.SOLIDUS?(this.state=F.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(lr.SCRIPT,!1)&&Kc(this.preprocessor.peek(lr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<lr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=F.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:break;case k.SOLIDUS:case k.GREATER_THAN_SIGN:case k.EOF:{this.state=F.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case k.EQUALS_SIGN:{this._err(be.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=F.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=F.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:case k.SOLIDUS:case k.GREATER_THAN_SIGN:case k.EOF:{this._leaveAttrName(),this.state=F.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case k.EQUALS_SIGN:{this._leaveAttrName(),this.state=F.BEFORE_ATTRIBUTE_VALUE;break}case k.QUOTATION_MARK:case k.APOSTROPHE:case k.LESS_THAN_SIGN:{this._err(be.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case k.NULL:{this._err(be.unexpectedNullCharacter),this.currentAttr.name+=Gt;break}default:this.currentAttr.name+=String.fromCodePoint(Pi(t)?Is(t):t)}}_stateAfterAttributeName(t){switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:break;case k.SOLIDUS:{this.state=F.SELF_CLOSING_START_TAG;break}case k.EQUALS_SIGN:{this.state=F.BEFORE_ATTRIBUTE_VALUE;break}case k.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentTagToken();break}case k.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=F.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:break;case k.QUOTATION_MARK:{this.state=F.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case k.APOSTROPHE:{this.state=F.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case k.GREATER_THAN_SIGN:{this._err(be.missingAttributeValue),this.state=F.DATA,this.emitCurrentTagToken();break}default:this.state=F.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case k.QUOTATION_MARK:{this.state=F.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case k.AMPERSAND:{this.returnState=F.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=F.CHARACTER_REFERENCE;break}case k.NULL:{this._err(be.unexpectedNullCharacter),this.currentAttr.value+=Gt;break}case k.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case k.APOSTROPHE:{this.state=F.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case k.AMPERSAND:{this.returnState=F.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=F.CHARACTER_REFERENCE;break}case k.NULL:{this._err(be.unexpectedNullCharacter),this.currentAttr.value+=Gt;break}case k.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:{this._leaveAttrValue(),this.state=F.BEFORE_ATTRIBUTE_NAME;break}case k.AMPERSAND:{this.returnState=F.ATTRIBUTE_VALUE_UNQUOTED,this.state=F.CHARACTER_REFERENCE;break}case k.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=F.DATA,this.emitCurrentTagToken();break}case k.NULL:{this._err(be.unexpectedNullCharacter),this.currentAttr.value+=Gt;break}case k.QUOTATION_MARK:case k.APOSTROPHE:case k.LESS_THAN_SIGN:case k.EQUALS_SIGN:case k.GRAVE_ACCENT:{this._err(be.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case k.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:{this._leaveAttrValue(),this.state=F.BEFORE_ATTRIBUTE_NAME;break}case k.SOLIDUS:{this._leaveAttrValue(),this.state=F.SELF_CLOSING_START_TAG;break}case k.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=F.DATA,this.emitCurrentTagToken();break}case k.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this._err(be.missingWhitespaceBetweenAttributes),this.state=F.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case k.GREATER_THAN_SIGN:{const r=this.currentToken;r.selfClosing=!0,this.state=F.DATA,this.emitCurrentTagToken();break}case k.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this._err(be.unexpectedSolidusInTag),this.state=F.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const r=this.currentToken;switch(t){case k.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentComment(r);break}case k.EOF:{this.emitCurrentComment(r),this._emitEOFToken();break}case k.NULL:{this._err(be.unexpectedNullCharacter),r.data+=Gt;break}default:r.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(lr.DASH_DASH,!0)?(this._createCommentToken(lr.DASH_DASH.length+1),this.state=F.COMMENT_START):this._consumeSequenceIfMatch(lr.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(lr.DOCTYPE.length+1),this.state=F.DOCTYPE):this._consumeSequenceIfMatch(lr.CDATA_START,!0)?this.inForeignNode?this.state=F.CDATA_SECTION:(this._err(be.cdataInHtmlContent),this._createCommentToken(lr.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=F.BOGUS_COMMENT):this._ensureHibernation()||(this._err(be.incorrectlyOpenedComment),this._createCommentToken(2),this.state=F.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case k.HYPHEN_MINUS:{this.state=F.COMMENT_START_DASH;break}case k.GREATER_THAN_SIGN:{this._err(be.abruptClosingOfEmptyComment),this.state=F.DATA;const r=this.currentToken;this.emitCurrentComment(r);break}default:this.state=F.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const r=this.currentToken;switch(t){case k.HYPHEN_MINUS:{this.state=F.COMMENT_END;break}case k.GREATER_THAN_SIGN:{this._err(be.abruptClosingOfEmptyComment),this.state=F.DATA,this.emitCurrentComment(r);break}case k.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=F.COMMENT,this._stateComment(t)}}_stateComment(t){const r=this.currentToken;switch(t){case k.HYPHEN_MINUS:{this.state=F.COMMENT_END_DASH;break}case k.LESS_THAN_SIGN:{r.data+="<",this.state=F.COMMENT_LESS_THAN_SIGN;break}case k.NULL:{this._err(be.unexpectedNullCharacter),r.data+=Gt;break}case k.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const r=this.currentToken;switch(t){case k.EXCLAMATION_MARK:{r.data+="!",this.state=F.COMMENT_LESS_THAN_SIGN_BANG;break}case k.LESS_THAN_SIGN:{r.data+="<";break}default:this.state=F.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===k.HYPHEN_MINUS?this.state=F.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=F.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===k.HYPHEN_MINUS?this.state=F.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=F.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==k.GREATER_THAN_SIGN&&t!==k.EOF&&this._err(be.nestedComment),this.state=F.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const r=this.currentToken;switch(t){case k.HYPHEN_MINUS:{this.state=F.COMMENT_END;break}case k.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=F.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const r=this.currentToken;switch(t){case k.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentComment(r);break}case k.EXCLAMATION_MARK:{this.state=F.COMMENT_END_BANG;break}case k.HYPHEN_MINUS:{r.data+="-";break}case k.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--",this.state=F.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const r=this.currentToken;switch(t){case k.HYPHEN_MINUS:{r.data+="--!",this.state=F.COMMENT_END_DASH;break}case k.GREATER_THAN_SIGN:{this._err(be.incorrectlyClosedComment),this.state=F.DATA,this.emitCurrentComment(r);break}case k.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--!",this.state=F.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:{this.state=F.BEFORE_DOCTYPE_NAME;break}case k.GREATER_THAN_SIGN:{this.state=F.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case k.EOF:{this._err(be.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingWhitespaceBeforeDoctypeName),this.state=F.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(Pi(t))this._createDoctypeToken(String.fromCharCode(Is(t))),this.state=F.DOCTYPE_NAME;else switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:break;case k.NULL:{this._err(be.unexpectedNullCharacter),this._createDoctypeToken(Gt),this.state=F.DOCTYPE_NAME;break}case k.GREATER_THAN_SIGN:{this._err(be.missingDoctypeName),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case k.EOF:{this._err(be.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=F.DOCTYPE_NAME}}_stateDoctypeName(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:{this.state=F.AFTER_DOCTYPE_NAME;break}case k.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentDoctype(r);break}case k.NULL:{this._err(be.unexpectedNullCharacter),r.name+=Gt;break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.name+=String.fromCodePoint(Pi(t)?Is(t):t)}}_stateAfterDoctypeName(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:break;case k.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentDoctype(r);break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(lr.PUBLIC,!1)?this.state=F.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(lr.SYSTEM,!1)?this.state=F.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(be.invalidCharacterSequenceAfterDoctypeName),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:{this.state=F.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case k.QUOTATION_MARK:{this._err(be.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=F.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case k.APOSTROPHE:{this._err(be.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=F.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case k.GREATER_THAN_SIGN:{this._err(be.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=F.DATA,this.emitCurrentDoctype(r);break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:break;case k.QUOTATION_MARK:{r.publicId="",this.state=F.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case k.APOSTROPHE:{r.publicId="",this.state=F.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case k.GREATER_THAN_SIGN:{this._err(be.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=F.DATA,this.emitCurrentDoctype(r);break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case k.QUOTATION_MARK:{this.state=F.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case k.NULL:{this._err(be.unexpectedNullCharacter),r.publicId+=Gt;break}case k.GREATER_THAN_SIGN:{this._err(be.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case k.APOSTROPHE:{this.state=F.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case k.NULL:{this._err(be.unexpectedNullCharacter),r.publicId+=Gt;break}case k.GREATER_THAN_SIGN:{this._err(be.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:{this.state=F.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case k.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentDoctype(r);break}case k.QUOTATION_MARK:{this._err(be.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case k.APOSTROPHE:{this._err(be.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:break;case k.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=F.DATA;break}case k.QUOTATION_MARK:{r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case k.APOSTROPHE:{r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:{this.state=F.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case k.QUOTATION_MARK:{this._err(be.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case k.APOSTROPHE:{this._err(be.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case k.GREATER_THAN_SIGN:{this._err(be.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.DATA,this.emitCurrentDoctype(r);break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:break;case k.QUOTATION_MARK:{r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case k.APOSTROPHE:{r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case k.GREATER_THAN_SIGN:{this._err(be.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.DATA,this.emitCurrentDoctype(r);break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case k.QUOTATION_MARK:{this.state=F.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case k.NULL:{this._err(be.unexpectedNullCharacter),r.systemId+=Gt;break}case k.GREATER_THAN_SIGN:{this._err(be.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case k.APOSTROPHE:{this.state=F.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case k.NULL:{this._err(be.unexpectedNullCharacter),r.systemId+=Gt;break}case k.GREATER_THAN_SIGN:{this._err(be.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case k.SPACE:case k.LINE_FEED:case k.TABULATION:case k.FORM_FEED:break;case k.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=F.DATA;break}case k.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const r=this.currentToken;switch(t){case k.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=F.DATA;break}case k.NULL:{this._err(be.unexpectedNullCharacter);break}case k.EOF:{this.emitCurrentDoctype(r),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case k.RIGHT_SQUARE_BRACKET:{this.state=F.CDATA_SECTION_BRACKET;break}case k.EOF:{this._err(be.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===k.RIGHT_SQUARE_BRACKET?this.state=F.CDATA_SECTION_END:(this._emitChars("]"),this.state=F.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case k.GREATER_THAN_SIGN:{this.state=F.DATA;break}case k.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=F.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(t){t===k.NUMBER_SIGN?this.state=F.NUMERIC_CHARACTER_REFERENCE:zo(t)?(this.state=F.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference(t)):(this._flushCodePointConsumedAsCharacterReference(k.AMPERSAND),this._reconsumeInState(this.returnState,t))}_stateNamedCharacterReference(t){const r=this._matchNamedCharacterReference(t);if(!this._ensureHibernation())if(r){for(let i=0;i<r.length;i++)this._flushCodePointConsumedAsCharacterReference(r[i]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(k.AMPERSAND),this.state=F.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand(t){zo(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===k.SEMICOLON&&this._err(be.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,t))}_stateNumericCharacterReference(t){this.charRefCode=0,t===k.LATIN_SMALL_X||t===k.LATIN_CAPITAL_X?this.state=F.HEXADEMICAL_CHARACTER_REFERENCE_START:Gi(t)?(this.state=F.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference(t)):(this._err(be.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(k.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(k.NUMBER_SIGN),this._reconsumeInState(this.returnState,t))}_stateHexademicalCharacterReferenceStart(t){M1(t)?(this.state=F.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference(t)):(this._err(be.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(k.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(k.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState)}_stateHexademicalCharacterReference(t){uh(t)?this.charRefCode=this.charRefCode*16+t-55:lh(t)?this.charRefCode=this.charRefCode*16+t-87:Gi(t)?this.charRefCode=this.charRefCode*16+t-48:t===k.SEMICOLON?this.state=F.NUMERIC_CHARACTER_REFERENCE_END:(this._err(be.missingSemicolonAfterCharacterReference),this.state=F.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateDecimalCharacterReference(t){Gi(t)?this.charRefCode=this.charRefCode*10+t-48:t===k.SEMICOLON?this.state=F.NUMERIC_CHARACTER_REFERENCE_END:(this._err(be.missingSemicolonAfterCharacterReference),this.state=F.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateNumericCharacterReferenceEnd(t){if(this.charRefCode===k.NULL)this._err(be.nullCharacterReference),this.charRefCode=k.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(be.characterReferenceOutsideUnicodeRange),this.charRefCode=k.REPLACEMENT_CHARACTER;else if(nh(this.charRefCode))this._err(be.surrogateCharacterReference),this.charRefCode=k.REPLACEMENT_CHARACTER;else if(sh(this.charRefCode))this._err(be.noncharacterCharacterReference);else if(ih(this.charRefCode)||this.charRefCode===k.CARRIAGE_RETURN){this._err(be.controlCharacterReference);const r=P1.get(this.charRefCode);r!==void 0&&(this.charRefCode=r)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,t)}};const fh=new Set([m.DD,m.DT,m.LI,m.OPTGROUP,m.OPTION,m.P,m.RB,m.RP,m.RT,m.RTC]),Yc=new Set([...fh,m.CAPTION,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]),Cs=new Map([[m.APPLET,Le.HTML],[m.CAPTION,Le.HTML],[m.HTML,Le.HTML],[m.MARQUEE,Le.HTML],[m.OBJECT,Le.HTML],[m.TABLE,Le.HTML],[m.TD,Le.HTML],[m.TEMPLATE,Le.HTML],[m.TH,Le.HTML],[m.ANNOTATION_XML,Le.MATHML],[m.MI,Le.MATHML],[m.MN,Le.MATHML],[m.MO,Le.MATHML],[m.MS,Le.MATHML],[m.MTEXT,Le.MATHML],[m.DESC,Le.SVG],[m.FOREIGN_OBJECT,Le.SVG],[m.TITLE,Le.SVG]]),U1=[m.H1,m.H2,m.H3,m.H4,m.H5,m.H6],H1=[m.TR,m.TEMPLATE,m.HTML],G1=[m.TBODY,m.TFOOT,m.THEAD,m.TEMPLATE,m.HTML],K1=[m.TABLE,m.TEMPLATE,m.HTML],Y1=[m.TD,m.TH];class V1{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,r,i){this.treeAdapter=r,this.handler=i,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=m.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===m.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===Le.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,r){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=r,this.currentTagId=r,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,r,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,r){const i=this._indexOf(t);this.items[i]=r,i===this.stackTop&&(this.current=r)}insertAfter(t,r,i){const u=this._indexOf(t)+1;this.items.splice(u,0,r),this.tagIDs.splice(u,0,i),this.stackTop++,u===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,u===this.stackTop)}popUntilTagNamePopped(t){let r=this.stackTop+1;do r=this.tagIDs.lastIndexOf(t,r-1);while(r>0&&this.treeAdapter.getNamespaceURI(this.items[r])!==Le.HTML);this.shortenToLength(r<0?0:r)}shortenToLength(t){for(;this.stackTop>=t;){const r=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(r,this.stackTop<t)}}popUntilElementPopped(t){const r=this._indexOf(t);this.shortenToLength(r<0?0:r)}popUntilPopped(t,r){const i=this._indexOfTagNames(t,r);this.shortenToLength(i<0?0:i)}popUntilNumberedHeaderPopped(){this.popUntilPopped(U1,Le.HTML)}popUntilTableCellPopped(){this.popUntilPopped(Y1,Le.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,r){for(let i=this.stackTop;i>=0;i--)if(t.includes(this.tagIDs[i])&&this.treeAdapter.getNamespaceURI(this.items[i])===r)return i;return-1}clearBackTo(t,r){const i=this._indexOfTagNames(t,r);this.shortenToLength(i+1)}clearBackToTableContext(){this.clearBackTo(K1,Le.HTML)}clearBackToTableBodyContext(){this.clearBackTo(G1,Le.HTML)}clearBackToTableRowContext(){this.clearBackTo(H1,Le.HTML)}remove(t){const r=this._indexOf(t);r>=0&&(r===this.stackTop?this.pop():(this.items.splice(r,1),this.tagIDs.splice(r,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===m.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const r=this._indexOf(t)-1;return r>=0?this.items[r]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===m.HTML}hasInScope(t){for(let r=this.stackTop;r>=0;r--){const i=this.tagIDs[r],u=this.treeAdapter.getNamespaceURI(this.items[r]);if(i===t&&u===Le.HTML)return!0;if(Cs.get(i)===u)return!1}return!0}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const r=this.tagIDs[t],i=this.treeAdapter.getNamespaceURI(this.items[t]);if(oh(r)&&i===Le.HTML)return!0;if(Cs.get(r)===i)return!1}return!0}hasInListItemScope(t){for(let r=this.stackTop;r>=0;r--){const i=this.tagIDs[r],u=this.treeAdapter.getNamespaceURI(this.items[r]);if(i===t&&u===Le.HTML)return!0;if((i===m.UL||i===m.OL)&&u===Le.HTML||Cs.get(i)===u)return!1}return!0}hasInButtonScope(t){for(let r=this.stackTop;r>=0;r--){const i=this.tagIDs[r],u=this.treeAdapter.getNamespaceURI(this.items[r]);if(i===t&&u===Le.HTML)return!0;if(i===m.BUTTON&&u===Le.HTML||Cs.get(i)===u)return!1}return!0}hasInTableScope(t){for(let r=this.stackTop;r>=0;r--){const i=this.tagIDs[r];if(this.treeAdapter.getNamespaceURI(this.items[r])===Le.HTML){if(i===t)return!0;if(i===m.TABLE||i===m.TEMPLATE||i===m.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--){const r=this.tagIDs[t];if(this.treeAdapter.getNamespaceURI(this.items[t])===Le.HTML){if(r===m.TBODY||r===m.THEAD||r===m.TFOOT)return!0;if(r===m.TABLE||r===m.HTML)return!1}}return!0}hasInSelectScope(t){for(let r=this.stackTop;r>=0;r--){const i=this.tagIDs[r];if(this.treeAdapter.getNamespaceURI(this.items[r])===Le.HTML){if(i===t)return!0;if(i!==m.OPTION&&i!==m.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;fh.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;Yc.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&Yc.has(this.currentTagId);)this.pop()}}const Io=3;var Lr;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(Lr=Lr||(Lr={}));const Vc={type:Lr.Marker};class j1{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,r){const i=[],u=r.length,d=this.treeAdapter.getTagName(t),T=this.treeAdapter.getNamespaceURI(t);for(let A=0;A<this.entries.length;A++){const y=this.entries[A];if(y.type===Lr.Marker)break;const{element:S}=y;if(this.treeAdapter.getTagName(S)===d&&this.treeAdapter.getNamespaceURI(S)===T){const I=this.treeAdapter.getAttrList(S);I.length===u&&i.push({idx:A,attrs:I})}}return i}_ensureNoahArkCondition(t){if(this.entries.length<Io)return;const r=this.treeAdapter.getAttrList(t),i=this._getNoahArkConditionCandidates(t,r);if(i.length<Io)return;const u=new Map(r.map(T=>[T.name,T.value]));let d=0;for(let T=0;T<i.length;T++){const A=i[T];A.attrs.every(y=>u.get(y.name)===y.value)&&(d+=1,d>=Io&&this.entries.splice(A.idx,1))}}insertMarker(){this.entries.unshift(Vc)}pushElement(t,r){this._ensureNoahArkCondition(t),this.entries.unshift({type:Lr.Element,element:t,token:r})}insertElementAfterBookmark(t,r){const i=this.entries.indexOf(this.bookmark);this.entries.splice(i,0,{type:Lr.Element,element:t,token:r})}removeEntry(t){const r=this.entries.indexOf(t);r>=0&&this.entries.splice(r,1)}clearToLastMarker(){const t=this.entries.indexOf(Vc);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){const r=this.entries.find(i=>i.type===Lr.Marker||this.treeAdapter.getTagName(i.element)===t);return r&&r.type===Lr.Element?r:null}getElementEntry(t){return this.entries.find(r=>r.type===Lr.Element&&r.element===t)}}function jc(e){return{nodeName:"#text",value:e,parentNode:null}}const On={createDocument(){return{nodeName:"#document",mode:hr.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,r){return{nodeName:e,tagName:e,attrs:r,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,r){const i=e.childNodes.indexOf(r);e.childNodes.splice(i,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,r,i){const u=e.childNodes.find(d=>d.nodeName==="#documentType");if(u)u.name=t,u.publicId=r,u.systemId=i;else{const d={nodeName:"#documentType",name:t,publicId:r,systemId:i,parentNode:null};On.appendChild(e,d)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const r=e.childNodes[e.childNodes.length-1];if(On.isTextNode(r)){r.value+=t;return}}On.appendChild(e,jc(t))},insertTextBefore(e,t,r){const i=e.childNodes[e.childNodes.indexOf(r)-1];i&&On.isTextNode(i)?i.value+=t:On.insertBefore(e,jc(t),r)},adoptAttributes(e,t){const r=new Set(e.attrs.map(i=>i.name));for(let i=0;i<t.length;i++)r.has(t[i].name)||e.attrs.push(t[i])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},dh="html",q1="about:legacy-compat",W1="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",hh=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],X1=[...hh,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],Q1=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),gh=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],z1=[...gh,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function qc(e,t){return t.some(r=>e.startsWith(r))}function $1(e){return e.name===dh&&e.publicId===null&&(e.systemId===null||e.systemId===q1)}function Z1(e){if(e.name!==dh)return hr.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===W1)return hr.QUIRKS;let{publicId:r}=e;if(r!==null){if(r=r.toLowerCase(),Q1.has(r))return hr.QUIRKS;let i=t===null?X1:hh;if(qc(r,i))return hr.QUIRKS;if(i=t===null?gh:z1,qc(r,i))return hr.LIMITED_QUIRKS}return hr.NO_QUIRKS}const Wc={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},J1="definitionurl",eb="definitionURL",tb=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),rb=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:Le.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:Le.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:Le.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:Le.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:Le.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:Le.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:Le.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:Le.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:Le.XML}],["xml:space",{prefix:"xml",name:"space",namespace:Le.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:Le.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:Le.XMLNS}]]),nb=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),ib=new Set([m.B,m.BIG,m.BLOCKQUOTE,m.BODY,m.BR,m.CENTER,m.CODE,m.DD,m.DIV,m.DL,m.DT,m.EM,m.EMBED,m.H1,m.H2,m.H3,m.H4,m.H5,m.H6,m.HEAD,m.HR,m.I,m.IMG,m.LI,m.LISTING,m.MENU,m.META,m.NOBR,m.OL,m.P,m.PRE,m.RUBY,m.S,m.SMALL,m.SPAN,m.STRONG,m.STRIKE,m.SUB,m.SUP,m.TABLE,m.TT,m.U,m.UL,m.VAR]);function sb(e){const t=e.tagID;return t===m.FONT&&e.attrs.some(({name:i})=>i===pn.COLOR||i===pn.SIZE||i===pn.FACE)||ib.has(t)}function mh(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===J1){e.attrs[t].name=eb;break}}function ph(e){for(let t=0;t<e.attrs.length;t++){const r=tb.get(e.attrs[t].name);r!=null&&(e.attrs[t].name=r)}}function Bu(e){for(let t=0;t<e.attrs.length;t++){const r=rb.get(e.attrs[t].name);r&&(e.attrs[t].prefix=r.prefix,e.attrs[t].name=r.name,e.attrs[t].namespace=r.namespace)}}function ab(e){const t=nb.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=va(e.tagName))}function ob(e,t){return t===Le.MATHML&&(e===m.MI||e===m.MO||e===m.MN||e===m.MS||e===m.MTEXT)}function ub(e,t,r){if(t===Le.MATHML&&e===m.ANNOTATION_XML){for(let i=0;i<r.length;i++)if(r[i].name===pn.ENCODING){const u=r[i].value.toLowerCase();return u===Wc.TEXT_HTML||u===Wc.APPLICATION_XML}}return t===Le.SVG&&(e===m.FOREIGN_OBJECT||e===m.DESC||e===m.TITLE)}function lb(e,t,r,i){return(!i||i===Le.HTML)&&ub(e,t,r)||(!i||i===Le.MATHML)&&ob(e,t)}const cb="hidden",fb=8,db=3;var Y;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(Y||(Y={}));const hb={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},Eh=new Set([m.TABLE,m.TBODY,m.TFOOT,m.THEAD,m.TR]),Xc={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:On,onParseError:null};let Th=class{constructor(t,r,i=null,u=null){this.fragmentContext=i,this.scriptHandler=u,this.currentToken=null,this.stopped=!1,this.insertionMode=Y.INITIAL,this.originalInsertionMode=Y.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...Xc,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=r??this.treeAdapter.createDocument(),this.tokenizer=new B1(this.options,this),this.activeFormattingElements=new j1(this.treeAdapter),this.fragmentContextID=i?va(this.treeAdapter.getTagName(i)):m.UNKNOWN,this._setContextModes(i??this.document,this.fragmentContextID),this.openElements=new V1(this.document,this.treeAdapter,this)}static parse(t,r){const i=new this(r);return i.tokenizer.write(t,!0),i.document}static getFragmentParser(t,r){const i={...Xc,...r};t??(t=i.treeAdapter.createElement(le.TEMPLATE,Le.HTML,[]));const u=i.treeAdapter.createElement("documentmock",Le.HTML,[]),d=new this(i,u,t);return d.fragmentContextID===m.TEMPLATE&&d.tmplInsertionModeStack.unshift(Y.IN_TEMPLATE),d._initTokenizerForFragmentParsing(),d._insertFakeRootElement(),d._resetInsertionMode(),d._findFormInFragmentContext(),d}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,r),r}_err(t,r,i){var u;if(!this.onParseError)return;const d=(u=t.location)!==null&&u!==void 0?u:hb,T={code:r,startLine:d.startLine,startCol:d.startCol,startOffset:d.startOffset,endLine:i?d.startLine:d.endLine,endCol:i?d.startCol:d.endCol,endOffset:i?d.startOffset:d.endOffset};this.onParseError(T)}onItemPush(t,r,i){var u,d;(d=(u=this.treeAdapter).onItemPush)===null||d===void 0||d.call(u,t),i&&this.openElements.stackTop>0&&this._setContextModes(t,r)}onItemPop(t,r){var i,u;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(u=(i=this.treeAdapter).onItemPop)===null||u===void 0||u.call(i,t,this.openElements.current),r){let d,T;this.openElements.stackTop===0&&this.fragmentContext?(d=this.fragmentContext,T=this.fragmentContextID):{current:d,currentTagId:T}=this.openElements,this._setContextModes(d,T)}}_setContextModes(t,r){const i=t===this.document||this.treeAdapter.getNamespaceURI(t)===Le.HTML;this.currentNotInHTML=!i,this.tokenizer.inForeignNode=!i&&!this._isIntegrationPoint(r,t)}_switchToTextParsing(t,r){this._insertElement(t,Le.HTML),this.tokenizer.state=r,this.originalInsertionMode=this.insertionMode,this.insertionMode=Y.TEXT}switchToPlaintextParsing(){this.insertionMode=Y.TEXT,this.originalInsertionMode=Y.IN_BODY,this.tokenizer.state=gr.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===le.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==Le.HTML))switch(this.fragmentContextID){case m.TITLE:case m.TEXTAREA:{this.tokenizer.state=gr.RCDATA;break}case m.STYLE:case m.XMP:case m.IFRAME:case m.NOEMBED:case m.NOFRAMES:case m.NOSCRIPT:{this.tokenizer.state=gr.RAWTEXT;break}case m.SCRIPT:{this.tokenizer.state=gr.SCRIPT_DATA;break}case m.PLAINTEXT:{this.tokenizer.state=gr.PLAINTEXT;break}}}_setDocumentType(t){const r=t.name||"",i=t.publicId||"",u=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,r,i,u),t.location){const T=this.treeAdapter.getChildNodes(this.document).find(A=>this.treeAdapter.isDocumentTypeNode(A));T&&this.treeAdapter.setNodeSourceCodeLocation(T,t.location)}}_attachElementToTree(t,r){if(this.options.sourceCodeLocationInfo){const i=r&&{...r,startTag:r};this.treeAdapter.setNodeSourceCodeLocation(t,i)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const i=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(i,t)}}_appendElement(t,r){const i=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(i,t.location)}_insertElement(t,r){const i=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(i,t.location),this.openElements.push(i,t.tagID)}_insertFakeElement(t,r){const i=this.treeAdapter.createElement(t,Le.HTML,[]);this._attachElementToTree(i,null),this.openElements.push(i,r)}_insertTemplate(t){const r=this.treeAdapter.createElement(t.tagName,Le.HTML,t.attrs),i=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(r,i),this._attachElementToTree(r,t.location),this.openElements.push(r,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(le.HTML,Le.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,m.HTML)}_appendCommentNode(t,r){const i=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(r,i),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,t.location)}_insertCharacters(t){let r,i;if(this._shouldFosterParentOnInsertion()?({parent:r,beforeElement:i}=this._findFosterParentingLocation(),i?this.treeAdapter.insertTextBefore(r,t.chars,i):this.treeAdapter.insertText(r,t.chars)):(r=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(r,t.chars)),!t.location)return;const u=this.treeAdapter.getChildNodes(r),d=i?u.lastIndexOf(i):u.length,T=u[d-1];if(this.treeAdapter.getNodeSourceCodeLocation(T)){const{endLine:y,endCol:S,endOffset:I}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(T,{endLine:y,endCol:S,endOffset:I})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(T,t.location)}_adoptNodes(t,r){for(let i=this.treeAdapter.getFirstChild(t);i;i=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(i),this.treeAdapter.appendChild(r,i)}_setEndLocation(t,r){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&r.location){const i=r.location,u=this.treeAdapter.getTagName(t),d=r.type===Rt.END_TAG&&u===r.tagName?{endTag:{...i},endLine:i.endLine,endCol:i.endCol,endOffset:i.endOffset}:{endLine:i.startLine,endCol:i.startCol,endOffset:i.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,d)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let r,i;return this.openElements.stackTop===0&&this.fragmentContext?(r=this.fragmentContext,i=this.fragmentContextID):{current:r,currentTagId:i}=this.openElements,t.tagID===m.SVG&&this.treeAdapter.getTagName(r)===le.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(r)===Le.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===m.MGLYPH||t.tagID===m.MALIGNMARK)&&!this._isIntegrationPoint(i,r,Le.HTML)}_processToken(t){switch(t.type){case Rt.CHARACTER:{this.onCharacter(t);break}case Rt.NULL_CHARACTER:{this.onNullCharacter(t);break}case Rt.COMMENT:{this.onComment(t);break}case Rt.DOCTYPE:{this.onDoctype(t);break}case Rt.START_TAG:{this._processStartTag(t);break}case Rt.END_TAG:{this.onEndTag(t);break}case Rt.EOF:{this.onEof(t);break}case Rt.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,r,i){const u=this.treeAdapter.getNamespaceURI(r),d=this.treeAdapter.getAttrList(r);return lb(t,u,d,i)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const r=this.activeFormattingElements.entries.findIndex(u=>u.type===Lr.Marker||this.openElements.contains(u.element)),i=r<0?t-1:r-1;for(let u=i;u>=0;u--){const d=this.activeFormattingElements.entries[u];this._insertElement(d.token,this.treeAdapter.getNamespaceURI(d.element)),d.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=Y.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(m.P),this.openElements.popUntilTagNamePopped(m.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case m.TR:{this.insertionMode=Y.IN_ROW;return}case m.TBODY:case m.THEAD:case m.TFOOT:{this.insertionMode=Y.IN_TABLE_BODY;return}case m.CAPTION:{this.insertionMode=Y.IN_CAPTION;return}case m.COLGROUP:{this.insertionMode=Y.IN_COLUMN_GROUP;return}case m.TABLE:{this.insertionMode=Y.IN_TABLE;return}case m.BODY:{this.insertionMode=Y.IN_BODY;return}case m.FRAMESET:{this.insertionMode=Y.IN_FRAMESET;return}case m.SELECT:{this._resetInsertionModeForSelect(t);return}case m.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case m.HTML:{this.insertionMode=this.headElement?Y.AFTER_HEAD:Y.BEFORE_HEAD;return}case m.TD:case m.TH:{if(t>0){this.insertionMode=Y.IN_CELL;return}break}case m.HEAD:{if(t>0){this.insertionMode=Y.IN_HEAD;return}break}}this.insertionMode=Y.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let r=t-1;r>0;r--){const i=this.openElements.tagIDs[r];if(i===m.TEMPLATE)break;if(i===m.TABLE){this.insertionMode=Y.IN_SELECT_IN_TABLE;return}}this.insertionMode=Y.IN_SELECT}_isElementCausesFosterParenting(t){return Eh.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const r=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case m.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(r)===Le.HTML)return{parent:this.treeAdapter.getTemplateContent(r),beforeElement:null};break}case m.TABLE:{const i=this.treeAdapter.getParentNode(r);return i?{parent:i,beforeElement:r}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const r=this._findFosterParentingLocation();r.beforeElement?this.treeAdapter.insertBefore(r.parent,t,r.beforeElement):this.treeAdapter.appendChild(r.parent,t)}_isSpecialElement(t,r){const i=this.treeAdapter.getNamespaceURI(t);return O1[i].has(r)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Yy(this,t);return}switch(this.insertionMode){case Y.INITIAL:{Oi(this,t);break}case Y.BEFORE_HTML:{Ki(this,t);break}case Y.BEFORE_HEAD:{Yi(this,t);break}case Y.IN_HEAD:{Vi(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{ji(this,t);break}case Y.AFTER_HEAD:{qi(this,t);break}case Y.IN_BODY:case Y.IN_CAPTION:case Y.IN_CELL:case Y.IN_TEMPLATE:{bh(this,t);break}case Y.TEXT:case Y.IN_SELECT:case Y.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case Y.IN_TABLE:case Y.IN_TABLE_BODY:case Y.IN_ROW:{Co(this,t);break}case Y.IN_TABLE_TEXT:{Ch(this,t);break}case Y.IN_COLUMN_GROUP:{$s(this,t);break}case Y.AFTER_BODY:{Zs(this,t);break}case Y.AFTER_AFTER_BODY:{Ms(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Ky(this,t);return}switch(this.insertionMode){case Y.INITIAL:{Oi(this,t);break}case Y.BEFORE_HTML:{Ki(this,t);break}case Y.BEFORE_HEAD:{Yi(this,t);break}case Y.IN_HEAD:{Vi(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{ji(this,t);break}case Y.AFTER_HEAD:{qi(this,t);break}case Y.TEXT:{this._insertCharacters(t);break}case Y.IN_TABLE:case Y.IN_TABLE_BODY:case Y.IN_ROW:{Co(this,t);break}case Y.IN_COLUMN_GROUP:{$s(this,t);break}case Y.AFTER_BODY:{Zs(this,t);break}case Y.AFTER_AFTER_BODY:{Ms(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){$o(this,t);return}switch(this.insertionMode){case Y.INITIAL:case Y.BEFORE_HTML:case Y.BEFORE_HEAD:case Y.IN_HEAD:case Y.IN_HEAD_NO_SCRIPT:case Y.AFTER_HEAD:case Y.IN_BODY:case Y.IN_TABLE:case Y.IN_CAPTION:case Y.IN_COLUMN_GROUP:case Y.IN_TABLE_BODY:case Y.IN_ROW:case Y.IN_CELL:case Y.IN_SELECT:case Y.IN_SELECT_IN_TABLE:case Y.IN_TEMPLATE:case Y.IN_FRAMESET:case Y.AFTER_FRAMESET:{$o(this,t);break}case Y.IN_TABLE_TEXT:{xi(this,t);break}case Y.AFTER_BODY:{bb(this,t);break}case Y.AFTER_AFTER_BODY:case Y.AFTER_AFTER_FRAMESET:{yb(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case Y.INITIAL:{Ab(this,t);break}case Y.BEFORE_HEAD:case Y.IN_HEAD:case Y.IN_HEAD_NO_SCRIPT:case Y.AFTER_HEAD:{this._err(t,be.misplacedDoctype);break}case Y.IN_TABLE_TEXT:{xi(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,be.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?Vy(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case Y.INITIAL:{Oi(this,t);break}case Y.BEFORE_HTML:{_b(this,t);break}case Y.BEFORE_HEAD:{Ib(this,t);break}case Y.IN_HEAD:{kr(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{Rb(this,t);break}case Y.AFTER_HEAD:{Nb(this,t);break}case Y.IN_BODY:{sr(this,t);break}case Y.IN_TABLE:{hi(this,t);break}case Y.IN_TABLE_TEXT:{xi(this,t);break}case Y.IN_CAPTION:{Cy(this,t);break}case Y.IN_COLUMN_GROUP:{Gu(this,t);break}case Y.IN_TABLE_BODY:{Aa(this,t);break}case Y.IN_ROW:{_a(this,t);break}case Y.IN_CELL:{Dy(this,t);break}case Y.IN_SELECT:{Dh(this,t);break}case Y.IN_SELECT_IN_TABLE:{Oy(this,t);break}case Y.IN_TEMPLATE:{ky(this,t);break}case Y.AFTER_BODY:{wy(this,t);break}case Y.IN_FRAMESET:{My(this,t);break}case Y.AFTER_FRAMESET:{By(this,t);break}case Y.AFTER_AFTER_BODY:{Hy(this,t);break}case Y.AFTER_AFTER_FRAMESET:{Gy(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?jy(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case Y.INITIAL:{Oi(this,t);break}case Y.BEFORE_HTML:{Sb(this,t);break}case Y.BEFORE_HEAD:{Cb(this,t);break}case Y.IN_HEAD:{Lb(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{Db(this,t);break}case Y.AFTER_HEAD:{Ob(this,t);break}case Y.IN_BODY:{ya(this,t);break}case Y.TEXT:{py(this,t);break}case Y.IN_TABLE:{ns(this,t);break}case Y.IN_TABLE_TEXT:{xi(this,t);break}case Y.IN_CAPTION:{Ly(this,t);break}case Y.IN_COLUMN_GROUP:{Ry(this,t);break}case Y.IN_TABLE_BODY:{Zo(this,t);break}case Y.IN_ROW:{Rh(this,t);break}case Y.IN_CELL:{Ny(this,t);break}case Y.IN_SELECT:{Nh(this,t);break}case Y.IN_SELECT_IN_TABLE:{xy(this,t);break}case Y.IN_TEMPLATE:{Py(this,t);break}case Y.AFTER_BODY:{xh(this,t);break}case Y.IN_FRAMESET:{Fy(this,t);break}case Y.AFTER_FRAMESET:{Uy(this,t);break}case Y.AFTER_AFTER_BODY:{Ms(this,t);break}}}onEof(t){switch(this.insertionMode){case Y.INITIAL:{Oi(this,t);break}case Y.BEFORE_HTML:{Ki(this,t);break}case Y.BEFORE_HEAD:{Yi(this,t);break}case Y.IN_HEAD:{Vi(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{ji(this,t);break}case Y.AFTER_HEAD:{qi(this,t);break}case Y.IN_BODY:case Y.IN_TABLE:case Y.IN_CAPTION:case Y.IN_COLUMN_GROUP:case Y.IN_TABLE_BODY:case Y.IN_ROW:case Y.IN_CELL:case Y.IN_SELECT:case Y.IN_SELECT_IN_TABLE:{Sh(this,t);break}case Y.TEXT:{Ey(this,t);break}case Y.IN_TABLE_TEXT:{xi(this,t);break}case Y.IN_TEMPLATE:{Oh(this,t);break}case Y.AFTER_BODY:case Y.IN_FRAMESET:case Y.AFTER_FRAMESET:case Y.AFTER_AFTER_BODY:case Y.AFTER_AFTER_FRAMESET:{Hu(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===k.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case Y.IN_HEAD:case Y.IN_HEAD_NO_SCRIPT:case Y.AFTER_HEAD:case Y.TEXT:case Y.IN_COLUMN_GROUP:case Y.IN_SELECT:case Y.IN_SELECT_IN_TABLE:case Y.IN_FRAMESET:case Y.AFTER_FRAMESET:{this._insertCharacters(t);break}case Y.IN_BODY:case Y.IN_CAPTION:case Y.IN_CELL:case Y.IN_TEMPLATE:case Y.AFTER_BODY:case Y.AFTER_AFTER_BODY:case Y.AFTER_AFTER_FRAMESET:{vh(this,t);break}case Y.IN_TABLE:case Y.IN_TABLE_BODY:case Y.IN_ROW:{Co(this,t);break}case Y.IN_TABLE_TEXT:{Ih(this,t);break}}}};function gb(e,t){let r=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return r?e.openElements.contains(r.element)?e.openElements.hasInScope(t.tagID)||(r=null):(e.activeFormattingElements.removeEntry(r),r=null):_h(e,t),r}function mb(e,t){let r=null,i=e.openElements.stackTop;for(;i>=0;i--){const u=e.openElements.items[i];if(u===t.element)break;e._isSpecialElement(u,e.openElements.tagIDs[i])&&(r=u)}return r||(e.openElements.shortenToLength(i<0?0:i),e.activeFormattingElements.removeEntry(t)),r}function pb(e,t,r){let i=t,u=e.openElements.getCommonAncestor(t);for(let d=0,T=u;T!==r;d++,T=u){u=e.openElements.getCommonAncestor(T);const A=e.activeFormattingElements.getElementEntry(T),y=A&&d>=db;!A||y?(y&&e.activeFormattingElements.removeEntry(A),e.openElements.remove(T)):(T=Eb(e,A),i===t&&(e.activeFormattingElements.bookmark=A),e.treeAdapter.detachNode(i),e.treeAdapter.appendChild(T,i),i=T)}return i}function Eb(e,t){const r=e.treeAdapter.getNamespaceURI(t.element),i=e.treeAdapter.createElement(t.token.tagName,r,t.token.attrs);return e.openElements.replace(t.element,i),t.element=i,i}function Tb(e,t,r){const i=e.treeAdapter.getTagName(t),u=va(i);if(e._isElementCausesFosterParenting(u))e._fosterParentElement(r);else{const d=e.treeAdapter.getNamespaceURI(t);u===m.TEMPLATE&&d===Le.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,r)}}function vb(e,t,r){const i=e.treeAdapter.getNamespaceURI(r.element),{token:u}=r,d=e.treeAdapter.createElement(u.tagName,i,u.attrs);e._adoptNodes(t,d),e.treeAdapter.appendChild(t,d),e.activeFormattingElements.insertElementAfterBookmark(d,u),e.activeFormattingElements.removeEntry(r),e.openElements.remove(r.element),e.openElements.insertAfter(t,d,u.tagID)}function Uu(e,t){for(let r=0;r<fb;r++){const i=gb(e,t);if(!i)break;const u=mb(e,i);if(!u)break;e.activeFormattingElements.bookmark=i;const d=pb(e,u,i.element),T=e.openElements.getCommonAncestor(i.element);e.treeAdapter.detachNode(d),T&&Tb(e,T,d),vb(e,u,i)}}function $o(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function bb(e,t){e._appendCommentNode(t,e.openElements.items[0])}function yb(e,t){e._appendCommentNode(t,e.document)}function Hu(e,t){if(e.stopped=!0,t.location){const r=e.fragmentContext?0:2;for(let i=e.openElements.stackTop;i>=r;i--)e._setEndLocation(e.openElements.items[i],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const i=e.openElements.items[0],u=e.treeAdapter.getNodeSourceCodeLocation(i);if(u&&!u.endTag&&(e._setEndLocation(i,t),e.openElements.stackTop>=1)){const d=e.openElements.items[1],T=e.treeAdapter.getNodeSourceCodeLocation(d);T&&!T.endTag&&e._setEndLocation(d,t)}}}}function Ab(e,t){e._setDocumentType(t);const r=t.forceQuirks?hr.QUIRKS:Z1(t);$1(t)||e._err(t,be.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,r),e.insertionMode=Y.BEFORE_HTML}function Oi(e,t){e._err(t,be.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,hr.QUIRKS),e.insertionMode=Y.BEFORE_HTML,e._processToken(t)}function _b(e,t){t.tagID===m.HTML?(e._insertElement(t,Le.HTML),e.insertionMode=Y.BEFORE_HEAD):Ki(e,t)}function Sb(e,t){const r=t.tagID;(r===m.HTML||r===m.HEAD||r===m.BODY||r===m.BR)&&Ki(e,t)}function Ki(e,t){e._insertFakeRootElement(),e.insertionMode=Y.BEFORE_HEAD,e._processToken(t)}function Ib(e,t){switch(t.tagID){case m.HTML:{sr(e,t);break}case m.HEAD:{e._insertElement(t,Le.HTML),e.headElement=e.openElements.current,e.insertionMode=Y.IN_HEAD;break}default:Yi(e,t)}}function Cb(e,t){const r=t.tagID;r===m.HEAD||r===m.BODY||r===m.HTML||r===m.BR?Yi(e,t):e._err(t,be.endTagWithoutMatchingOpenElement)}function Yi(e,t){e._insertFakeElement(le.HEAD,m.HEAD),e.headElement=e.openElements.current,e.insertionMode=Y.IN_HEAD,e._processToken(t)}function kr(e,t){switch(t.tagID){case m.HTML:{sr(e,t);break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:{e._appendElement(t,Le.HTML),t.ackSelfClosing=!0;break}case m.TITLE:{e._switchToTextParsing(t,gr.RCDATA);break}case m.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,gr.RAWTEXT):(e._insertElement(t,Le.HTML),e.insertionMode=Y.IN_HEAD_NO_SCRIPT);break}case m.NOFRAMES:case m.STYLE:{e._switchToTextParsing(t,gr.RAWTEXT);break}case m.SCRIPT:{e._switchToTextParsing(t,gr.SCRIPT_DATA);break}case m.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=Y.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(Y.IN_TEMPLATE);break}case m.HEAD:{e._err(t,be.misplacedStartTagForHeadElement);break}default:Vi(e,t)}}function Lb(e,t){switch(t.tagID){case m.HEAD:{e.openElements.pop(),e.insertionMode=Y.AFTER_HEAD;break}case m.BODY:case m.BR:case m.HTML:{Vi(e,t);break}case m.TEMPLATE:{Gn(e,t);break}default:e._err(t,be.endTagWithoutMatchingOpenElement)}}function Gn(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==m.TEMPLATE&&e._err(t,be.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,be.endTagWithoutMatchingOpenElement)}function Vi(e,t){e.openElements.pop(),e.insertionMode=Y.AFTER_HEAD,e._processToken(t)}function Rb(e,t){switch(t.tagID){case m.HTML:{sr(e,t);break}case m.BASEFONT:case m.BGSOUND:case m.HEAD:case m.LINK:case m.META:case m.NOFRAMES:case m.STYLE:{kr(e,t);break}case m.NOSCRIPT:{e._err(t,be.nestedNoscriptInHead);break}default:ji(e,t)}}function Db(e,t){switch(t.tagID){case m.NOSCRIPT:{e.openElements.pop(),e.insertionMode=Y.IN_HEAD;break}case m.BR:{ji(e,t);break}default:e._err(t,be.endTagWithoutMatchingOpenElement)}}function ji(e,t){const r=t.type===Rt.EOF?be.openElementsLeftAfterEof:be.disallowedContentInNoscriptInHead;e._err(t,r),e.openElements.pop(),e.insertionMode=Y.IN_HEAD,e._processToken(t)}function Nb(e,t){switch(t.tagID){case m.HTML:{sr(e,t);break}case m.BODY:{e._insertElement(t,Le.HTML),e.framesetOk=!1,e.insertionMode=Y.IN_BODY;break}case m.FRAMESET:{e._insertElement(t,Le.HTML),e.insertionMode=Y.IN_FRAMESET;break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{e._err(t,be.abandonedHeadElementChild),e.openElements.push(e.headElement,m.HEAD),kr(e,t),e.openElements.remove(e.headElement);break}case m.HEAD:{e._err(t,be.misplacedStartTagForHeadElement);break}default:qi(e,t)}}function Ob(e,t){switch(t.tagID){case m.BODY:case m.HTML:case m.BR:{qi(e,t);break}case m.TEMPLATE:{Gn(e,t);break}default:e._err(t,be.endTagWithoutMatchingOpenElement)}}function qi(e,t){e._insertFakeElement(le.BODY,m.BODY),e.insertionMode=Y.IN_BODY,ba(e,t)}function ba(e,t){switch(t.type){case Rt.CHARACTER:{bh(e,t);break}case Rt.WHITESPACE_CHARACTER:{vh(e,t);break}case Rt.COMMENT:{$o(e,t);break}case Rt.START_TAG:{sr(e,t);break}case Rt.END_TAG:{ya(e,t);break}case Rt.EOF:{Sh(e,t);break}}}function vh(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function bh(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function xb(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function kb(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(r,t.attrs))}function Pb(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&r&&(e.treeAdapter.detachNode(r),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,Le.HTML),e.insertionMode=Y.IN_FRAMESET)}function wb(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Le.HTML)}function Mb(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),oh(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,Le.HTML)}function Fb(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Le.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function Bb(e,t){const r=e.openElements.tmplCount>0;(!e.formElement||r)&&(e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Le.HTML),r||(e.formElement=e.openElements.current))}function Ub(e,t){e.framesetOk=!1;const r=t.tagID;for(let i=e.openElements.stackTop;i>=0;i--){const u=e.openElements.tagIDs[i];if(r===m.LI&&u===m.LI||(r===m.DD||r===m.DT)&&(u===m.DD||u===m.DT)){e.openElements.generateImpliedEndTagsWithExclusion(u),e.openElements.popUntilTagNamePopped(u);break}if(u!==m.ADDRESS&&u!==m.DIV&&u!==m.P&&e._isSpecialElement(e.openElements.items[i],u))break}e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Le.HTML)}function Hb(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Le.HTML),e.tokenizer.state=gr.PLAINTEXT}function Gb(e,t){e.openElements.hasInScope(m.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,Le.HTML),e.framesetOk=!1}function Kb(e,t){const r=e.activeFormattingElements.getElementEntryInScopeWithTagName(le.A);r&&(Uu(e,t),e.openElements.remove(r.element),e.activeFormattingElements.removeEntry(r)),e._reconstructActiveFormattingElements(),e._insertElement(t,Le.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Yb(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,Le.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Vb(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(m.NOBR)&&(Uu(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,Le.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function jb(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,Le.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function qb(e,t){e.treeAdapter.getDocumentMode(e.document)!==hr.QUIRKS&&e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Le.HTML),e.framesetOk=!1,e.insertionMode=Y.IN_TABLE}function yh(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,Le.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function Ah(e){const t=ah(e,pn.TYPE);return t!=null&&t.toLowerCase()===cb}function Wb(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,Le.HTML),Ah(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function Xb(e,t){e._appendElement(t,Le.HTML),t.ackSelfClosing=!0}function Qb(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._appendElement(t,Le.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function zb(e,t){t.tagName=le.IMG,t.tagID=m.IMG,yh(e,t)}function $b(e,t){e._insertElement(t,Le.HTML),e.skipNextNewLine=!0,e.tokenizer.state=gr.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=Y.TEXT}function Zb(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,gr.RAWTEXT)}function Jb(e,t){e.framesetOk=!1,e._switchToTextParsing(t,gr.RAWTEXT)}function Qc(e,t){e._switchToTextParsing(t,gr.RAWTEXT)}function ey(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,Le.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===Y.IN_TABLE||e.insertionMode===Y.IN_CAPTION||e.insertionMode===Y.IN_TABLE_BODY||e.insertionMode===Y.IN_ROW||e.insertionMode===Y.IN_CELL?Y.IN_SELECT_IN_TABLE:Y.IN_SELECT}function ty(e,t){e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,Le.HTML)}function ry(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,Le.HTML)}function ny(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(m.RTC),e._insertElement(t,Le.HTML)}function iy(e,t){e._reconstructActiveFormattingElements(),mh(t),Bu(t),t.selfClosing?e._appendElement(t,Le.MATHML):e._insertElement(t,Le.MATHML),t.ackSelfClosing=!0}function sy(e,t){e._reconstructActiveFormattingElements(),ph(t),Bu(t),t.selfClosing?e._appendElement(t,Le.SVG):e._insertElement(t,Le.SVG),t.ackSelfClosing=!0}function zc(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,Le.HTML)}function sr(e,t){switch(t.tagID){case m.I:case m.S:case m.B:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.SMALL:case m.STRIKE:case m.STRONG:{Yb(e,t);break}case m.A:{Kb(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{Mb(e,t);break}case m.P:case m.DL:case m.OL:case m.UL:case m.DIV:case m.DIR:case m.NAV:case m.MAIN:case m.MENU:case m.ASIDE:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.DETAILS:case m.ADDRESS:case m.ARTICLE:case m.SECTION:case m.SUMMARY:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{wb(e,t);break}case m.LI:case m.DD:case m.DT:{Ub(e,t);break}case m.BR:case m.IMG:case m.WBR:case m.AREA:case m.EMBED:case m.KEYGEN:{yh(e,t);break}case m.HR:{Qb(e,t);break}case m.RB:case m.RTC:{ry(e,t);break}case m.RT:case m.RP:{ny(e,t);break}case m.PRE:case m.LISTING:{Fb(e,t);break}case m.XMP:{Zb(e,t);break}case m.SVG:{sy(e,t);break}case m.HTML:{xb(e,t);break}case m.BASE:case m.LINK:case m.META:case m.STYLE:case m.TITLE:case m.SCRIPT:case m.BGSOUND:case m.BASEFONT:case m.TEMPLATE:{kr(e,t);break}case m.BODY:{kb(e,t);break}case m.FORM:{Bb(e,t);break}case m.NOBR:{Vb(e,t);break}case m.MATH:{iy(e,t);break}case m.TABLE:{qb(e,t);break}case m.INPUT:{Wb(e,t);break}case m.PARAM:case m.TRACK:case m.SOURCE:{Xb(e,t);break}case m.IMAGE:{zb(e,t);break}case m.BUTTON:{Gb(e,t);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{jb(e,t);break}case m.IFRAME:{Jb(e,t);break}case m.SELECT:{ey(e,t);break}case m.OPTION:case m.OPTGROUP:{ty(e,t);break}case m.NOEMBED:{Qc(e,t);break}case m.FRAMESET:{Pb(e,t);break}case m.TEXTAREA:{$b(e,t);break}case m.NOSCRIPT:{e.options.scriptingEnabled?Qc(e,t):zc(e,t);break}case m.PLAINTEXT:{Hb(e,t);break}case m.COL:case m.TH:case m.TD:case m.TR:case m.HEAD:case m.FRAME:case m.TBODY:case m.TFOOT:case m.THEAD:case m.CAPTION:case m.COLGROUP:break;default:zc(e,t)}}function ay(e,t){if(e.openElements.hasInScope(m.BODY)&&(e.insertionMode=Y.AFTER_BODY,e.options.sourceCodeLocationInfo)){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e._setEndLocation(r,t)}}function oy(e,t){e.openElements.hasInScope(m.BODY)&&(e.insertionMode=Y.AFTER_BODY,xh(e,t))}function uy(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r))}function ly(e){const t=e.openElements.tmplCount>0,{formElement:r}=e;t||(e.formElement=null),(r||t)&&e.openElements.hasInScope(m.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(m.FORM):r&&e.openElements.remove(r))}function cy(e){e.openElements.hasInButtonScope(m.P)||e._insertFakeElement(le.P,m.P),e._closePElement()}function fy(e){e.openElements.hasInListItemScope(m.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(m.LI),e.openElements.popUntilTagNamePopped(m.LI))}function dy(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.popUntilTagNamePopped(r))}function hy(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function gy(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker())}function my(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(le.BR,m.BR),e.openElements.pop(),e.framesetOk=!1}function _h(e,t){const r=t.tagName,i=t.tagID;for(let u=e.openElements.stackTop;u>0;u--){const d=e.openElements.items[u],T=e.openElements.tagIDs[u];if(i===T&&(i!==m.UNKNOWN||e.treeAdapter.getTagName(d)===r)){e.openElements.generateImpliedEndTagsWithExclusion(i),e.openElements.stackTop>=u&&e.openElements.shortenToLength(u);break}if(e._isSpecialElement(d,T))break}}function ya(e,t){switch(t.tagID){case m.A:case m.B:case m.I:case m.S:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.NOBR:case m.SMALL:case m.STRIKE:case m.STRONG:{Uu(e,t);break}case m.P:{cy(e);break}case m.DL:case m.UL:case m.OL:case m.DIR:case m.DIV:case m.NAV:case m.PRE:case m.MAIN:case m.MENU:case m.ASIDE:case m.BUTTON:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.ADDRESS:case m.ARTICLE:case m.DETAILS:case m.SECTION:case m.SUMMARY:case m.LISTING:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{uy(e,t);break}case m.LI:{fy(e);break}case m.DD:case m.DT:{dy(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{hy(e);break}case m.BR:{my(e);break}case m.BODY:{ay(e,t);break}case m.HTML:{oy(e,t);break}case m.FORM:{ly(e);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{gy(e,t);break}case m.TEMPLATE:{Gn(e,t);break}default:_h(e,t)}}function Sh(e,t){e.tmplInsertionModeStack.length>0?Oh(e,t):Hu(e,t)}function py(e,t){var r;t.tagID===m.SCRIPT&&((r=e.scriptHandler)===null||r===void 0||r.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function Ey(e,t){e._err(t,be.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function Co(e,t){if(Eh.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=Y.IN_TABLE_TEXT,t.type){case Rt.CHARACTER:{Ch(e,t);break}case Rt.WHITESPACE_CHARACTER:{Ih(e,t);break}}else us(e,t)}function Ty(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,Le.HTML),e.insertionMode=Y.IN_CAPTION}function vy(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,Le.HTML),e.insertionMode=Y.IN_COLUMN_GROUP}function by(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(le.COLGROUP,m.COLGROUP),e.insertionMode=Y.IN_COLUMN_GROUP,Gu(e,t)}function yy(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,Le.HTML),e.insertionMode=Y.IN_TABLE_BODY}function Ay(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(le.TBODY,m.TBODY),e.insertionMode=Y.IN_TABLE_BODY,Aa(e,t)}function _y(e,t){e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function Sy(e,t){Ah(t)?e._appendElement(t,Le.HTML):us(e,t),t.ackSelfClosing=!0}function Iy(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,Le.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function hi(e,t){switch(t.tagID){case m.TD:case m.TH:case m.TR:{Ay(e,t);break}case m.STYLE:case m.SCRIPT:case m.TEMPLATE:{kr(e,t);break}case m.COL:{by(e,t);break}case m.FORM:{Iy(e,t);break}case m.TABLE:{_y(e,t);break}case m.TBODY:case m.TFOOT:case m.THEAD:{yy(e,t);break}case m.INPUT:{Sy(e,t);break}case m.CAPTION:{Ty(e,t);break}case m.COLGROUP:{vy(e,t);break}default:us(e,t)}}function ns(e,t){switch(t.tagID){case m.TABLE:{e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode());break}case m.TEMPLATE:{Gn(e,t);break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:us(e,t)}}function us(e,t){const r=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,ba(e,t),e.fosterParentingEnabled=r}function Ih(e,t){e.pendingCharacterTokens.push(t)}function Ch(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function xi(e,t){let r=0;if(e.hasNonWhitespacePendingCharacterToken)for(;r<e.pendingCharacterTokens.length;r++)us(e,e.pendingCharacterTokens[r]);else for(;r<e.pendingCharacterTokens.length;r++)e._insertCharacters(e.pendingCharacterTokens[r]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const Lh=new Set([m.CAPTION,m.COL,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]);function Cy(e,t){const r=t.tagID;Lh.has(r)?e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=Y.IN_TABLE,hi(e,t)):sr(e,t)}function Ly(e,t){const r=t.tagID;switch(r){case m.CAPTION:case m.TABLE:{e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=Y.IN_TABLE,r===m.TABLE&&ns(e,t));break}case m.BODY:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:ya(e,t)}}function Gu(e,t){switch(t.tagID){case m.HTML:{sr(e,t);break}case m.COL:{e._appendElement(t,Le.HTML),t.ackSelfClosing=!0;break}case m.TEMPLATE:{kr(e,t);break}default:$s(e,t)}}function Ry(e,t){switch(t.tagID){case m.COLGROUP:{e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=Y.IN_TABLE);break}case m.TEMPLATE:{Gn(e,t);break}case m.COL:break;default:$s(e,t)}}function $s(e,t){e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=Y.IN_TABLE,e._processToken(t))}function Aa(e,t){switch(t.tagID){case m.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,Le.HTML),e.insertionMode=Y.IN_ROW;break}case m.TH:case m.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(le.TR,m.TR),e.insertionMode=Y.IN_ROW,_a(e,t);break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE,hi(e,t));break}default:hi(e,t)}}function Zo(e,t){const r=t.tagID;switch(t.tagID){case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasInTableScope(r)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE);break}case m.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE,ns(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:case m.TR:break;default:ns(e,t)}}function _a(e,t){switch(t.tagID){case m.TH:case m.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,Le.HTML),e.insertionMode=Y.IN_CELL,e.activeFormattingElements.insertMarker();break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE_BODY,Aa(e,t));break}default:hi(e,t)}}function Rh(e,t){switch(t.tagID){case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE_BODY);break}case m.TABLE:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE_BODY,Zo(e,t));break}case m.TBODY:case m.TFOOT:case m.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(m.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE_BODY,Zo(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:break;default:ns(e,t)}}function Dy(e,t){const r=t.tagID;Lh.has(r)?(e.openElements.hasInTableScope(m.TD)||e.openElements.hasInTableScope(m.TH))&&(e._closeTableCell(),_a(e,t)):sr(e,t)}function Ny(e,t){const r=t.tagID;switch(r){case m.TD:case m.TH:{e.openElements.hasInTableScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=Y.IN_ROW);break}case m.TABLE:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(r)&&(e._closeTableCell(),Rh(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:break;default:ya(e,t)}}function Dh(e,t){switch(t.tagID){case m.HTML:{sr(e,t);break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._insertElement(t,Le.HTML);break}case m.OPTGROUP:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._insertElement(t,Le.HTML);break}case m.INPUT:case m.KEYGEN:case m.TEXTAREA:case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),t.tagID!==m.SELECT&&e._processStartTag(t));break}case m.SCRIPT:case m.TEMPLATE:{kr(e,t);break}}}function Nh(e,t){switch(t.tagID){case m.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===m.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===m.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop();break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop();break}case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode());break}case m.TEMPLATE:{Gn(e,t);break}}}function Oy(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e._processStartTag(t)):Dh(e,t)}function xy(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?e.openElements.hasInTableScope(r)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e.onEndTag(t)):Nh(e,t)}function ky(e,t){switch(t.tagID){case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{kr(e,t);break}case m.CAPTION:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.tmplInsertionModeStack[0]=Y.IN_TABLE,e.insertionMode=Y.IN_TABLE,hi(e,t);break}case m.COL:{e.tmplInsertionModeStack[0]=Y.IN_COLUMN_GROUP,e.insertionMode=Y.IN_COLUMN_GROUP,Gu(e,t);break}case m.TR:{e.tmplInsertionModeStack[0]=Y.IN_TABLE_BODY,e.insertionMode=Y.IN_TABLE_BODY,Aa(e,t);break}case m.TD:case m.TH:{e.tmplInsertionModeStack[0]=Y.IN_ROW,e.insertionMode=Y.IN_ROW,_a(e,t);break}default:e.tmplInsertionModeStack[0]=Y.IN_BODY,e.insertionMode=Y.IN_BODY,sr(e,t)}}function Py(e,t){t.tagID===m.TEMPLATE&&Gn(e,t)}function Oh(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):Hu(e,t)}function wy(e,t){t.tagID===m.HTML?sr(e,t):Zs(e,t)}function xh(e,t){var r;if(t.tagID===m.HTML){if(e.fragmentContext||(e.insertionMode=Y.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===m.HTML){e._setEndLocation(e.openElements.items[0],t);const i=e.openElements.items[1];i&&!(!((r=e.treeAdapter.getNodeSourceCodeLocation(i))===null||r===void 0)&&r.endTag)&&e._setEndLocation(i,t)}}else Zs(e,t)}function Zs(e,t){e.insertionMode=Y.IN_BODY,ba(e,t)}function My(e,t){switch(t.tagID){case m.HTML:{sr(e,t);break}case m.FRAMESET:{e._insertElement(t,Le.HTML);break}case m.FRAME:{e._appendElement(t,Le.HTML),t.ackSelfClosing=!0;break}case m.NOFRAMES:{kr(e,t);break}}}function Fy(e,t){t.tagID===m.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==m.FRAMESET&&(e.insertionMode=Y.AFTER_FRAMESET))}function By(e,t){switch(t.tagID){case m.HTML:{sr(e,t);break}case m.NOFRAMES:{kr(e,t);break}}}function Uy(e,t){t.tagID===m.HTML&&(e.insertionMode=Y.AFTER_AFTER_FRAMESET)}function Hy(e,t){t.tagID===m.HTML?sr(e,t):Ms(e,t)}function Ms(e,t){e.insertionMode=Y.IN_BODY,ba(e,t)}function Gy(e,t){switch(t.tagID){case m.HTML:{sr(e,t);break}case m.NOFRAMES:{kr(e,t);break}}}function Ky(e,t){t.chars=Gt,e._insertCharacters(t)}function Yy(e,t){e._insertCharacters(t),e.framesetOk=!1}function kh(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==Le.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function Vy(e,t){if(sb(t))kh(e),e._startTagOutsideForeignContent(t);else{const r=e._getAdjustedCurrentElement(),i=e.treeAdapter.getNamespaceURI(r);i===Le.MATHML?mh(t):i===Le.SVG&&(ab(t),ph(t)),Bu(t),t.selfClosing?e._appendElement(t,i):e._insertElement(t,i),t.ackSelfClosing=!0}}function jy(e,t){if(t.tagID===m.P||t.tagID===m.BR){kh(e),e._endTagOutsideForeignContent(t);return}for(let r=e.openElements.stackTop;r>0;r--){const i=e.openElements.items[r];if(e.treeAdapter.getNamespaceURI(i)===Le.HTML){e._endTagOutsideForeignContent(t);break}const u=e.treeAdapter.getTagName(i);if(u.toLowerCase()===t.tagName){t.tagName=u,e.openElements.shortenToLength(r);break}}}const qy=new Set([le.AREA,le.BASE,le.BASEFONT,le.BGSOUND,le.BR,le.COL,le.EMBED,le.FRAME,le.HR,le.IMG,le.INPUT,le.KEYGEN,le.LINK,le.META,le.PARAM,le.SOURCE,le.TRACK,le.WBR]);function Wy(e,t){return t.treeAdapter.isElementNode(e)&&t.treeAdapter.getNamespaceURI(e)===Le.HTML&&qy.has(t.treeAdapter.getTagName(e))}const Xy={treeAdapter:On,scriptingEnabled:!0};function Qy(e,t){const r={...Xy,...t};return Ph(e,r)}function zy(e,t){let r="";const i=t.treeAdapter.isElementNode(e)&&t.treeAdapter.getTagName(e)===le.TEMPLATE&&t.treeAdapter.getNamespaceURI(e)===Le.HTML?t.treeAdapter.getTemplateContent(e):e,u=t.treeAdapter.getChildNodes(i);if(u)for(const d of u)r+=Ph(d,t);return r}function Ph(e,t){return t.treeAdapter.isElementNode(e)?$y(e,t):t.treeAdapter.isTextNode(e)?Jy(e,t):t.treeAdapter.isCommentNode(e)?eA(e,t):t.treeAdapter.isDocumentTypeNode(e)?tA(e,t):""}function $y(e,t){const r=t.treeAdapter.getTagName(e);return`<${r}${Zy(e,t)}>${Wy(e,t)?"":`${zy(e,t)}</${r}>`}`}function Zy(e,{treeAdapter:t}){let r="";for(const i of t.getAttrList(e)){if(r+=" ",!i.namespace)r+=i.name;else switch(i.namespace){case Le.XML:{r+=`xml:${i.name}`;break}case Le.XMLNS:{i.name!=="xmlns"&&(r+="xmlns:"),r+=i.name;break}case Le.XLINK:{r+=`xlink:${i.name}`;break}default:r+=`${i.prefix}:${i.name}`}r+=`="${Ad(i.value)}"`}return r}function Jy(e,t){const{treeAdapter:r}=t,i=r.getTextNodeContent(e),u=r.getParentNode(e),d=u&&r.isElementNode(u)&&r.getTagName(u);return d&&r.getNamespaceURI(u)===Le.HTML&&k1(d,t.scriptingEnabled)?i:_d(i)}function eA(e,{treeAdapter:t}){return`<!--${t.getCommentNodeContent(e)}-->`}function tA(e,{treeAdapter:t}){return`<!DOCTYPE ${t.getDocumentTypeNodeName(e)}>`}function rA(e,t){return Th.parse(e,t)}function nA(e,t,r){typeof e=="string"&&(r=t,t=e,e=null);const i=Th.getFragmentParser(e,r);return i.tokenizer.write(t,!0),i.getFragment()}function $c(e){return new es(e)}function Zc(e){const t=e.includes('"')?"'":'"';return t+e+t}function iA(e,t,r){let i="!DOCTYPE ";return e&&(i+=e),t?i+=` PUBLIC ${Zc(t)}`:r&&(i+=" SYSTEM"),r&&(i+=` ${Zc(r)}`),i}const Jn={isCommentNode:da,isElementNode:ht,isTextNode:Yr,createDocument(){const e=new Fn([]);return e["x-mode"]=hr.NO_QUIRKS,e},createDocumentFragment(){return new Fn([])},createElement(e,t,r){const i=Object.create(null),u=Object.create(null),d=Object.create(null);for(let A=0;A<r.length;A++){const y=r[A].name;i[y]=r[A].value,u[y]=r[A].namespace,d[y]=r[A].prefix}const T=new Cu(e,i,[]);return T.namespace=t,T["x-attribsNamespace"]=u,T["x-attribsPrefix"]=d,T},createCommentNode(e){return new _u(e)},appendChild(e,t){const r=e.children[e.children.length-1];r&&(r.next=t,t.prev=r),e.children.push(t),t.parent=e},insertBefore(e,t,r){const i=e.children.indexOf(r),{prev:u}=r;u&&(u.next=t,t.prev=u),r.prev=t,t.next=r,e.children.splice(i,0,t),t.parent=e},setTemplateContent(e,t){Jn.appendChild(e,t)},getTemplateContent(e){return e.children[0]},setDocumentType(e,t,r,i){const u=iA(t,r,i);let d=e.children.find(T=>Yo(T)&&T.name==="!doctype");d?d.data=u??null:(d=new Su("!doctype",u),Jn.appendChild(e,d)),d["x-name"]=t??void 0,d["x-publicId"]=r??void 0,d["x-systemId"]=i??void 0},setDocumentMode(e,t){e["x-mode"]=t},getDocumentMode(e){return e["x-mode"]},detachNode(e){if(e.parent){const t=e.parent.children.indexOf(e),{prev:r,next:i}=e;e.prev=null,e.next=null,r&&(r.next=i),i&&(i.prev=r),e.parent.children.splice(t,1),e.parent=null}},insertText(e,t){const r=e.children[e.children.length-1];r&&Yr(r)?r.data+=t:Jn.appendChild(e,$c(t))},insertTextBefore(e,t,r){const i=e.children[e.children.indexOf(r)-1];i&&Yr(i)?i.data+=t:Jn.insertBefore(e,$c(t),r)},adoptAttributes(e,t){for(let r=0;r<t.length;r++){const i=t[r].name;typeof e.attribs[i]>"u"&&(e.attribs[i]=t[r].value,e["x-attribsNamespace"][i]=t[r].namespace,e["x-attribsPrefix"][i]=t[r].prefix)}},getFirstChild(e){return e.children[0]},getChildNodes(e){return e.children},getParentNode(e){return e.parent},getAttrList(e){return e.attributes},getTagName(e){return e.name},getNamespaceURI(e){return e.namespace},getTextNodeContent(e){return e.data},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){var t;return(t=e["x-name"])!==null&&t!==void 0?t:""},getDocumentTypeNodePublicId(e){var t;return(t=e["x-publicId"])!==null&&t!==void 0?t:""},getDocumentTypeNodeSystemId(e){var t;return(t=e["x-systemId"])!==null&&t!==void 0?t:""},isDocumentTypeNode(e){return Yo(e)&&e.name==="!doctype"},setNodeSourceCodeLocation(e,t){t&&(e.startIndex=t.startOffset,e.endIndex=t.endOffset),e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){t.endOffset!=null&&(e.endIndex=t.endOffset),e.sourceCodeLocation={...e.sourceCodeLocation,...t}}};function sA(e,t,r,i){const u={scriptingEnabled:typeof t.scriptingEnabled=="boolean"?t.scriptingEnabled:!0,treeAdapter:Jn,sourceCodeLocationInfo:t.sourceCodeLocationInfo};return r?rA(e,u):nA(i,e,u)}const aA={treeAdapter:Jn};function oA(e){const t="length"in e?e:[e];for(let i=0;i<t.length;i+=1){const u=t[i];Un(u)&&Array.prototype.splice.call(t,i,1,...u.children)}let r="";for(let i=0;i<t.length;i+=1){const u=t[i];r+=Qy(u,aA)}return r}var rt;(function(e){e[e.Tab=9]="Tab",e[e.NewLine=10]="NewLine",e[e.FormFeed=12]="FormFeed",e[e.CarriageReturn=13]="CarriageReturn",e[e.Space=32]="Space",e[e.ExclamationMark=33]="ExclamationMark",e[e.Num=35]="Num",e[e.Amp=38]="Amp",e[e.SingleQuote=39]="SingleQuote",e[e.DoubleQuote=34]="DoubleQuote",e[e.Dash=45]="Dash",e[e.Slash=47]="Slash",e[e.Zero=48]="Zero",e[e.Nine=57]="Nine",e[e.Semi=59]="Semi",e[e.Lt=60]="Lt",e[e.Eq=61]="Eq",e[e.Gt=62]="Gt",e[e.Questionmark=63]="Questionmark",e[e.UpperA=65]="UpperA",e[e.LowerA=97]="LowerA",e[e.UpperF=70]="UpperF",e[e.LowerF=102]="LowerF",e[e.UpperZ=90]="UpperZ",e[e.LowerZ=122]="LowerZ",e[e.LowerX=120]="LowerX",e[e.OpeningSquareBracket=91]="OpeningSquareBracket"})(rt||(rt={}));var Fe;(function(e){e[e.Text=1]="Text",e[e.BeforeTagName=2]="BeforeTagName",e[e.InTagName=3]="InTagName",e[e.InSelfClosingTag=4]="InSelfClosingTag",e[e.BeforeClosingTagName=5]="BeforeClosingTagName",e[e.InClosingTagName=6]="InClosingTagName",e[e.AfterClosingTagName=7]="AfterClosingTagName",e[e.BeforeAttributeName=8]="BeforeAttributeName",e[e.InAttributeName=9]="InAttributeName",e[e.AfterAttributeName=10]="AfterAttributeName",e[e.BeforeAttributeValue=11]="BeforeAttributeValue",e[e.InAttributeValueDq=12]="InAttributeValueDq",e[e.InAttributeValueSq=13]="InAttributeValueSq",e[e.InAttributeValueNq=14]="InAttributeValueNq",e[e.BeforeDeclaration=15]="BeforeDeclaration",e[e.InDeclaration=16]="InDeclaration",e[e.InProcessingInstruction=17]="InProcessingInstruction",e[e.BeforeComment=18]="BeforeComment",e[e.CDATASequence=19]="CDATASequence",e[e.InSpecialComment=20]="InSpecialComment",e[e.InCommentLike=21]="InCommentLike",e[e.BeforeSpecialS=22]="BeforeSpecialS",e[e.SpecialStartSequence=23]="SpecialStartSequence",e[e.InSpecialTag=24]="InSpecialTag",e[e.BeforeEntity=25]="BeforeEntity",e[e.BeforeNumericEntity=26]="BeforeNumericEntity",e[e.InNamedEntity=27]="InNamedEntity",e[e.InNumericEntity=28]="InNumericEntity",e[e.InHexEntity=29]="InHexEntity"})(Fe||(Fe={}));function Zr(e){return e===rt.Space||e===rt.NewLine||e===rt.Tab||e===rt.FormFeed||e===rt.CarriageReturn}function Ls(e){return e===rt.Slash||e===rt.Gt||Zr(e)}function Jc(e){return e>=rt.Zero&&e<=rt.Nine}function uA(e){return e>=rt.LowerA&&e<=rt.LowerZ||e>=rt.UpperA&&e<=rt.UpperZ}function lA(e){return e>=rt.UpperA&&e<=rt.UpperF||e>=rt.LowerA&&e<=rt.LowerF}var Kr;(function(e){e[e.NoValue=0]="NoValue",e[e.Unquoted=1]="Unquoted",e[e.Single=2]="Single",e[e.Double=3]="Double"})(Kr||(Kr={}));const cr={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])};class cA{constructor({xmlMode:t=!1,decodeEntities:r=!0},i){this.cbs=i,this.state=Fe.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=Fe.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=t,this.decodeEntities=r,this.entityTrie=t?RE:cn}reset(){this.state=Fe.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=Fe.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(t){this.offset+=this.buffer.length,this.buffer=t,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}getIndex(){return this.index}getSectionStart(){return this.sectionStart}stateText(t){t===rt.Lt||!this.decodeEntities&&this.fastForwardTo(rt.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=Fe.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&t===rt.Amp&&(this.state=Fe.BeforeEntity)}stateSpecialStartSequence(t){const r=this.sequenceIndex===this.currentSequence.length;if(!(r?Ls(t):(t|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!r){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=Fe.InTagName,this.stateInTagName(t)}stateInSpecialTag(t){if(this.sequenceIndex===this.currentSequence.length){if(t===rt.Gt||Zr(t)){const r=this.index-this.currentSequence.length;if(this.sectionStart<r){const i=this.index;this.index=r,this.cbs.ontext(this.sectionStart,r),this.index=i}this.isSpecial=!1,this.sectionStart=r+2,this.stateInClosingTagName(t);return}this.sequenceIndex=0}(t|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===cr.TitleEnd?this.decodeEntities&&t===rt.Amp&&(this.state=Fe.BeforeEntity):this.fastForwardTo(rt.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=Number(t===rt.Lt)}stateCDATASequence(t){t===cr.Cdata[this.sequenceIndex]?++this.sequenceIndex===cr.Cdata.length&&(this.state=Fe.InCommentLike,this.currentSequence=cr.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=Fe.InDeclaration,this.stateInDeclaration(t))}fastForwardTo(t){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===t)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(t){t===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===cr.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=Fe.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):t!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(t){return this.xmlMode?!Ls(t):uA(t)}startSpecial(t,r){this.isSpecial=!0,this.currentSequence=t,this.sequenceIndex=r,this.state=Fe.SpecialStartSequence}stateBeforeTagName(t){if(t===rt.ExclamationMark)this.state=Fe.BeforeDeclaration,this.sectionStart=this.index+1;else if(t===rt.Questionmark)this.state=Fe.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(t)){const r=t|32;this.sectionStart=this.index,!this.xmlMode&&r===cr.TitleEnd[2]?this.startSpecial(cr.TitleEnd,3):this.state=!this.xmlMode&&r===cr.ScriptEnd[2]?Fe.BeforeSpecialS:Fe.InTagName}else t===rt.Slash?this.state=Fe.BeforeClosingTagName:(this.state=Fe.Text,this.stateText(t))}stateInTagName(t){Ls(t)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=Fe.BeforeAttributeName,this.stateBeforeAttributeName(t))}stateBeforeClosingTagName(t){Zr(t)||(t===rt.Gt?this.state=Fe.Text:(this.state=this.isTagStartChar(t)?Fe.InClosingTagName:Fe.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(t){(t===rt.Gt||Zr(t))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=Fe.AfterClosingTagName,this.stateAfterClosingTagName(t))}stateAfterClosingTagName(t){(t===rt.Gt||this.fastForwardTo(rt.Gt))&&(this.state=Fe.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(t){t===rt.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=Fe.InSpecialTag,this.sequenceIndex=0):this.state=Fe.Text,this.baseState=this.state,this.sectionStart=this.index+1):t===rt.Slash?this.state=Fe.InSelfClosingTag:Zr(t)||(this.state=Fe.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(t){t===rt.Gt?(this.cbs.onselfclosingtag(this.index),this.state=Fe.Text,this.baseState=Fe.Text,this.sectionStart=this.index+1,this.isSpecial=!1):Zr(t)||(this.state=Fe.BeforeAttributeName,this.stateBeforeAttributeName(t))}stateInAttributeName(t){(t===rt.Eq||Ls(t))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=Fe.AfterAttributeName,this.stateAfterAttributeName(t))}stateAfterAttributeName(t){t===rt.Eq?this.state=Fe.BeforeAttributeValue:t===rt.Slash||t===rt.Gt?(this.cbs.onattribend(Kr.NoValue,this.index),this.state=Fe.BeforeAttributeName,this.stateBeforeAttributeName(t)):Zr(t)||(this.cbs.onattribend(Kr.NoValue,this.index),this.state=Fe.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(t){t===rt.DoubleQuote?(this.state=Fe.InAttributeValueDq,this.sectionStart=this.index+1):t===rt.SingleQuote?(this.state=Fe.InAttributeValueSq,this.sectionStart=this.index+1):Zr(t)||(this.sectionStart=this.index,this.state=Fe.InAttributeValueNq,this.stateInAttributeValueNoQuotes(t))}handleInAttributeValue(t,r){t===r||!this.decodeEntities&&this.fastForwardTo(r)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(r===rt.DoubleQuote?Kr.Double:Kr.Single,this.index),this.state=Fe.BeforeAttributeName):this.decodeEntities&&t===rt.Amp&&(this.baseState=this.state,this.state=Fe.BeforeEntity)}stateInAttributeValueDoubleQuotes(t){this.handleInAttributeValue(t,rt.DoubleQuote)}stateInAttributeValueSingleQuotes(t){this.handleInAttributeValue(t,rt.SingleQuote)}stateInAttributeValueNoQuotes(t){Zr(t)||t===rt.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(Kr.Unquoted,this.index),this.state=Fe.BeforeAttributeName,this.stateBeforeAttributeName(t)):this.decodeEntities&&t===rt.Amp&&(this.baseState=this.state,this.state=Fe.BeforeEntity)}stateBeforeDeclaration(t){t===rt.OpeningSquareBracket?(this.state=Fe.CDATASequence,this.sequenceIndex=0):this.state=t===rt.Dash?Fe.BeforeComment:Fe.InDeclaration}stateInDeclaration(t){(t===rt.Gt||this.fastForwardTo(rt.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=Fe.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(t){(t===rt.Gt||this.fastForwardTo(rt.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=Fe.Text,this.sectionStart=this.index+1)}stateBeforeComment(t){t===rt.Dash?(this.state=Fe.InCommentLike,this.currentSequence=cr.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=Fe.InDeclaration}stateInSpecialComment(t){(t===rt.Gt||this.fastForwardTo(rt.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=Fe.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(t){const r=t|32;r===cr.ScriptEnd[3]?this.startSpecial(cr.ScriptEnd,4):r===cr.StyleEnd[3]?this.startSpecial(cr.StyleEnd,4):(this.state=Fe.InTagName,this.stateInTagName(t))}stateBeforeEntity(t){this.entityExcess=1,this.entityResult=0,t===rt.Num?this.state=Fe.BeforeNumericEntity:t===rt.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=Fe.InNamedEntity,this.stateInNamedEntity(t))}stateInNamedEntity(t){if(this.entityExcess+=1,this.trieIndex=vd(this.entityTrie,this.trieCurrent,this.trieIndex+1,t),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];const r=this.trieCurrent&rn.VALUE_LENGTH;if(r){const i=(r>>14)-1;if(!this.allowLegacyEntity()&&t!==rt.Semi)this.trieIndex+=i;else{const u=this.index-this.entityExcess+1;u>this.sectionStart&&this.emitPartial(this.sectionStart,u),this.entityResult=this.trieIndex,this.trieIndex+=i,this.entityExcess=0,this.sectionStart=this.index+1,i===0&&this.emitNamedEntity()}}}emitNamedEntity(){if(this.state=this.baseState,this.entityResult===0)return;switch((this.entityTrie[this.entityResult]&rn.VALUE_LENGTH)>>14){case 1:this.emitCodePoint(this.entityTrie[this.entityResult]&~rn.VALUE_LENGTH);break;case 2:this.emitCodePoint(this.entityTrie[this.entityResult+1]);break;case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}stateBeforeNumericEntity(t){(t|32)===rt.LowerX?(this.entityExcess++,this.state=Fe.InHexEntity):(this.state=Fe.InNumericEntity,this.stateInNumericEntity(t))}emitNumericEntity(t){const r=this.index-this.entityExcess-1;r+2+Number(this.state===Fe.InHexEntity)!==this.index&&(r>this.sectionStart&&this.emitPartial(this.sectionStart,r),this.sectionStart=this.index+Number(t),this.emitCodePoint(NE(this.entityResult))),this.state=this.baseState}stateInNumericEntity(t){t===rt.Semi?this.emitNumericEntity(!0):Jc(t)?(this.entityResult=this.entityResult*10+(t-rt.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)}stateInHexEntity(t){t===rt.Semi?this.emitNumericEntity(!0):Jc(t)?(this.entityResult=this.entityResult*16+(t-rt.Zero),this.entityExcess++):lA(t)?(this.entityResult=this.entityResult*16+((t|32)-rt.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)}allowLegacyEntity(){return!this.xmlMode&&(this.baseState===Fe.Text||this.baseState===Fe.InSpecialTag)}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===Fe.Text||this.state===Fe.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===Fe.InAttributeValueDq||this.state===Fe.InAttributeValueSq||this.state===Fe.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const t=this.buffer.charCodeAt(this.index-this.offset);this.state===Fe.Text?this.stateText(t):this.state===Fe.SpecialStartSequence?this.stateSpecialStartSequence(t):this.state===Fe.InSpecialTag?this.stateInSpecialTag(t):this.state===Fe.CDATASequence?this.stateCDATASequence(t):this.state===Fe.InAttributeValueDq?this.stateInAttributeValueDoubleQuotes(t):this.state===Fe.InAttributeName?this.stateInAttributeName(t):this.state===Fe.InCommentLike?this.stateInCommentLike(t):this.state===Fe.InSpecialComment?this.stateInSpecialComment(t):this.state===Fe.BeforeAttributeName?this.stateBeforeAttributeName(t):this.state===Fe.InTagName?this.stateInTagName(t):this.state===Fe.InClosingTagName?this.stateInClosingTagName(t):this.state===Fe.BeforeTagName?this.stateBeforeTagName(t):this.state===Fe.AfterAttributeName?this.stateAfterAttributeName(t):this.state===Fe.InAttributeValueSq?this.stateInAttributeValueSingleQuotes(t):this.state===Fe.BeforeAttributeValue?this.stateBeforeAttributeValue(t):this.state===Fe.BeforeClosingTagName?this.stateBeforeClosingTagName(t):this.state===Fe.AfterClosingTagName?this.stateAfterClosingTagName(t):this.state===Fe.BeforeSpecialS?this.stateBeforeSpecialS(t):this.state===Fe.InAttributeValueNq?this.stateInAttributeValueNoQuotes(t):this.state===Fe.InSelfClosingTag?this.stateInSelfClosingTag(t):this.state===Fe.InDeclaration?this.stateInDeclaration(t):this.state===Fe.BeforeDeclaration?this.stateBeforeDeclaration(t):this.state===Fe.BeforeComment?this.stateBeforeComment(t):this.state===Fe.InProcessingInstruction?this.stateInProcessingInstruction(t):this.state===Fe.InNamedEntity?this.stateInNamedEntity(t):this.state===Fe.BeforeEntity?this.stateBeforeEntity(t):this.state===Fe.InHexEntity?this.stateInHexEntity(t):this.state===Fe.InNumericEntity?this.stateInNumericEntity(t):this.stateBeforeNumericEntity(t),this.index++}this.cleanup()}finish(){this.state===Fe.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const t=this.buffer.length+this.offset;this.state===Fe.InCommentLike?this.currentSequence===cr.CdataEnd?this.cbs.oncdata(this.sectionStart,t,0):this.cbs.oncomment(this.sectionStart,t,0):this.state===Fe.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===Fe.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===Fe.InTagName||this.state===Fe.BeforeAttributeName||this.state===Fe.BeforeAttributeValue||this.state===Fe.AfterAttributeName||this.state===Fe.InAttributeName||this.state===Fe.InAttributeValueSq||this.state===Fe.InAttributeValueDq||this.state===Fe.InAttributeValueNq||this.state===Fe.InClosingTagName||this.cbs.ontext(this.sectionStart,t)}emitPartial(t,r){this.baseState!==Fe.Text&&this.baseState!==Fe.InSpecialTag?this.cbs.onattribdata(t,r):this.cbs.ontext(t,r)}emitCodePoint(t){this.baseState!==Fe.Text&&this.baseState!==Fe.InSpecialTag?this.cbs.onattribentity(t):this.cbs.ontextentity(t)}}const zn=new Set(["input","option","optgroup","select","button","datalist","textarea"]),wt=new Set(["p"]),ef=new Set(["thead","tbody"]),tf=new Set(["dd","dt"]),rf=new Set(["rt","rp"]),fA=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",wt],["h1",wt],["h2",wt],["h3",wt],["h4",wt],["h5",wt],["h6",wt],["select",zn],["input",zn],["output",zn],["button",zn],["datalist",zn],["textarea",zn],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",tf],["dt",tf],["address",wt],["article",wt],["aside",wt],["blockquote",wt],["details",wt],["div",wt],["dl",wt],["fieldset",wt],["figcaption",wt],["figure",wt],["footer",wt],["form",wt],["header",wt],["hr",wt],["main",wt],["nav",wt],["ol",wt],["pre",wt],["section",wt],["table",wt],["ul",wt],["rt",rf],["rp",rf],["tbody",ef],["tfoot",ef]]),dA=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),nf=new Set(["math","svg"]),sf=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),hA=/\s|\//;class gA{constructor(t,r={}){var i,u,d,T,A;this.options=r,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=t??{},this.lowerCaseTagNames=(i=r.lowerCaseTags)!==null&&i!==void 0?i:!r.xmlMode,this.lowerCaseAttributeNames=(u=r.lowerCaseAttributeNames)!==null&&u!==void 0?u:!r.xmlMode,this.tokenizer=new((d=r.Tokenizer)!==null&&d!==void 0?d:cA)(this.options,this),(A=(T=this.cbs).onparserinit)===null||A===void 0||A.call(T,this)}ontext(t,r){var i,u;const d=this.getSlice(t,r);this.endIndex=r-1,(u=(i=this.cbs).ontext)===null||u===void 0||u.call(i,d),this.startIndex=r}ontextentity(t){var r,i;const u=this.tokenizer.getSectionStart();this.endIndex=u-1,(i=(r=this.cbs).ontext)===null||i===void 0||i.call(r,Ic(t)),this.startIndex=u}isVoidElement(t){return!this.options.xmlMode&&dA.has(t)}onopentagname(t,r){this.endIndex=r;let i=this.getSlice(t,r);this.lowerCaseTagNames&&(i=i.toLowerCase()),this.emitOpenTag(i)}emitOpenTag(t){var r,i,u,d;this.openTagStart=this.startIndex,this.tagname=t;const T=!this.options.xmlMode&&fA.get(t);if(T)for(;this.stack.length>0&&T.has(this.stack[this.stack.length-1]);){const A=this.stack.pop();(i=(r=this.cbs).onclosetag)===null||i===void 0||i.call(r,A,!0)}this.isVoidElement(t)||(this.stack.push(t),nf.has(t)?this.foreignContext.push(!0):sf.has(t)&&this.foreignContext.push(!1)),(d=(u=this.cbs).onopentagname)===null||d===void 0||d.call(u,t),this.cbs.onopentag&&(this.attribs={})}endOpenTag(t){var r,i;this.startIndex=this.openTagStart,this.attribs&&((i=(r=this.cbs).onopentag)===null||i===void 0||i.call(r,this.tagname,this.attribs,t),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(t){this.endIndex=t,this.endOpenTag(!1),this.startIndex=t+1}onclosetag(t,r){var i,u,d,T,A,y;this.endIndex=r;let S=this.getSlice(t,r);if(this.lowerCaseTagNames&&(S=S.toLowerCase()),(nf.has(S)||sf.has(S))&&this.foreignContext.pop(),this.isVoidElement(S))!this.options.xmlMode&&S==="br"&&((u=(i=this.cbs).onopentagname)===null||u===void 0||u.call(i,"br"),(T=(d=this.cbs).onopentag)===null||T===void 0||T.call(d,"br",{},!0),(y=(A=this.cbs).onclosetag)===null||y===void 0||y.call(A,"br",!1));else{const I=this.stack.lastIndexOf(S);if(I!==-1)if(this.cbs.onclosetag){let C=this.stack.length-I;for(;C--;)this.cbs.onclosetag(this.stack.pop(),C!==0)}else this.stack.length=I;else!this.options.xmlMode&&S==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=r+1}onselfclosingtag(t){this.endIndex=t,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=t+1):this.onopentagend(t)}closeCurrentTag(t){var r,i;const u=this.tagname;this.endOpenTag(t),this.stack[this.stack.length-1]===u&&((i=(r=this.cbs).onclosetag)===null||i===void 0||i.call(r,u,!t),this.stack.pop())}onattribname(t,r){this.startIndex=t;const i=this.getSlice(t,r);this.attribname=this.lowerCaseAttributeNames?i.toLowerCase():i}onattribdata(t,r){this.attribvalue+=this.getSlice(t,r)}onattribentity(t){this.attribvalue+=Ic(t)}onattribend(t,r){var i,u;this.endIndex=r,(u=(i=this.cbs).onattribute)===null||u===void 0||u.call(i,this.attribname,this.attribvalue,t===Kr.Double?'"':t===Kr.Single?"'":t===Kr.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(t){const r=t.search(hA);let i=r<0?t:t.substr(0,r);return this.lowerCaseTagNames&&(i=i.toLowerCase()),i}ondeclaration(t,r){this.endIndex=r;const i=this.getSlice(t,r);if(this.cbs.onprocessinginstruction){const u=this.getInstructionName(i);this.cbs.onprocessinginstruction(`!${u}`,`!${i}`)}this.startIndex=r+1}onprocessinginstruction(t,r){this.endIndex=r;const i=this.getSlice(t,r);if(this.cbs.onprocessinginstruction){const u=this.getInstructionName(i);this.cbs.onprocessinginstruction(`?${u}`,`?${i}`)}this.startIndex=r+1}oncomment(t,r,i){var u,d,T,A;this.endIndex=r,(d=(u=this.cbs).oncomment)===null||d===void 0||d.call(u,this.getSlice(t,r-i)),(A=(T=this.cbs).oncommentend)===null||A===void 0||A.call(T),this.startIndex=r+1}oncdata(t,r,i){var u,d,T,A,y,S,I,C,b,R;this.endIndex=r;const P=this.getSlice(t,r-i);this.options.xmlMode||this.options.recognizeCDATA?((d=(u=this.cbs).oncdatastart)===null||d===void 0||d.call(u),(A=(T=this.cbs).ontext)===null||A===void 0||A.call(T,P),(S=(y=this.cbs).oncdataend)===null||S===void 0||S.call(y)):((C=(I=this.cbs).oncomment)===null||C===void 0||C.call(I,`[CDATA[${P}]]`),(R=(b=this.cbs).oncommentend)===null||R===void 0||R.call(b)),this.startIndex=r+1}onend(){var t,r;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let i=this.stack.length;i>0;this.cbs.onclosetag(this.stack[--i],!0));}(r=(t=this.cbs).onend)===null||r===void 0||r.call(t)}reset(){var t,r,i,u;(r=(t=this.cbs).onreset)===null||r===void 0||r.call(t),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(u=(i=this.cbs).onparserinit)===null||u===void 0||u.call(i,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(t){this.reset(),this.end(t)}getSlice(t,r){for(;t-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let i=this.buffers[0].slice(t-this.bufferOffset,r-this.bufferOffset);for(;r-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),i+=this.buffers[0].slice(0,r-this.bufferOffset);return i}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(t){var r,i;if(this.ended){(i=(r=this.cbs).onerror)===null||i===void 0||i.call(r,new Error(".write() after done!"));return}this.buffers.push(t),this.tokenizer.running&&(this.tokenizer.write(t),this.writeIndex++)}end(t){var r,i;if(this.ended){(i=(r=this.cbs).onerror)===null||i===void 0||i.call(r,Error(".end() after done!"));return}t&&this.write(t),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(t){this.write(t)}done(t){this.end(t)}}function mA(e,t){const r=new LE(void 0,t);return new gA(r,t).end(e),r.root}const pA=Wv((e,t,r,i)=>t.xmlMode||t._useHtmlParser2?mA(e,t):sA(e,t,r,i)),EA=_1(pA,(e,t)=>t.xmlMode||t._useHtmlParser2?ha(e,t):oA(e));EA([]);var Jo={},TA={get exports(){return Jo},set exports(e){Jo=e}};(function(e,t){typeof window<"u"&&function(r,i){e.exports=i()}(FT,()=>(()=>{var r={21:(T,A,y)=>{y.r(A),y.d(A,{default:()=>ce});var S=function(){function J(ie,fe){this.subtle=void 0,this.aesIV=void 0,this.subtle=ie,this.aesIV=fe}return J.prototype.decrypt=function(ie,fe){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},fe,ie)},J}(),I=function(){function J(ie,fe){this.subtle=void 0,this.key=void 0,this.subtle=ie,this.key=fe}return J.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},J}(),C=y(145),b=function(){function J(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var ie=J.prototype;return ie.uint8ArrayToUint32Array_=function(fe){for(var Q=new DataView(fe),de=new Uint32Array(4),oe=0;oe<4;oe++)de[oe]=Q.getUint32(4*oe);return de},ie.initTable=function(){var fe=this.sBox,Q=this.invSBox,de=this.subMix,oe=de[0],se=de[1],ae=de[2],we=de[3],Ue=this.invSubMix,Je=Ue[0],ue=Ue[1],w=Ue[2],z=Ue[3],H=new Uint32Array(256),Te=0,Re=0,ve=0;for(ve=0;ve<256;ve++)H[ve]=ve<128?ve<<1:ve<<1^283;for(ve=0;ve<256;ve++){var pe=Re^Re<<1^Re<<2^Re<<3^Re<<4;pe=pe>>>8^255&pe^99,fe[Te]=pe,Q[pe]=Te;var We=H[Te],Ze=H[We],Qe=H[Ze],Ve=257*H[pe]^16843008*pe;oe[Te]=Ve<<24|Ve>>>8,se[Te]=Ve<<16|Ve>>>16,ae[Te]=Ve<<8|Ve>>>24,we[Te]=Ve,Ve=16843009*Qe^65537*Ze^257*We^16843008*Te,Je[pe]=Ve<<24|Ve>>>8,ue[pe]=Ve<<16|Ve>>>16,w[pe]=Ve<<8|Ve>>>24,z[pe]=Ve,Te?(Te=We^H[H[H[Qe^We]]],Re^=H[H[Re]]):Te=Re=1}},ie.expandKey=function(fe){for(var Q=this.uint8ArrayToUint32Array_(fe),de=!0,oe=0;oe<Q.length&&de;)de=Q[oe]===this.key[oe],oe++;if(!de){this.key=Q;var se=this.keySize=Q.length;if(se!==4&&se!==6&&se!==8)throw new Error("Invalid aes key size="+se);var ae,we,Ue,Je,ue=this.ksRows=4*(se+6+1),w=this.keySchedule=new Uint32Array(ue),z=this.invKeySchedule=new Uint32Array(ue),H=this.sBox,Te=this.rcon,Re=this.invSubMix,ve=Re[0],pe=Re[1],We=Re[2],Ze=Re[3];for(ae=0;ae<ue;ae++)ae<se?Ue=w[ae]=Q[ae]:(Je=Ue,ae%se==0?(Je=H[(Je=Je<<8|Je>>>24)>>>24]<<24|H[Je>>>16&255]<<16|H[Je>>>8&255]<<8|H[255&Je],Je^=Te[ae/se|0]<<24):se>6&&ae%se==4&&(Je=H[Je>>>24]<<24|H[Je>>>16&255]<<16|H[Je>>>8&255]<<8|H[255&Je]),w[ae]=Ue=(w[ae-se]^Je)>>>0);for(we=0;we<ue;we++)ae=ue-we,Je=3&we?w[ae]:w[ae-4],z[we]=we<4||ae<=4?Je:ve[H[Je>>>24]]^pe[H[Je>>>16&255]]^We[H[Je>>>8&255]]^Ze[H[255&Je]],z[we]=z[we]>>>0}},ie.networkToHostOrderSwap=function(fe){return fe<<24|(65280&fe)<<8|(16711680&fe)>>8|fe>>>24},ie.decrypt=function(fe,Q,de){for(var oe,se,ae,we,Ue,Je,ue,w,z,H,Te,Re,ve,pe,We=this.keySize+6,Ze=this.invKeySchedule,Qe=this.invSBox,Ve=this.invSubMix,lt=Ve[0],At=Ve[1],B=Ve[2],$=Ve[3],q=this.uint8ArrayToUint32Array_(de),ge=q[0],Ae=q[1],xe=q[2],Ie=q[3],N=new Int32Array(fe),O=new Int32Array(N.length),V=this.networkToHostOrderSwap;Q<N.length;){for(z=V(N[Q]),H=V(N[Q+1]),Te=V(N[Q+2]),Re=V(N[Q+3]),Ue=z^Ze[0],Je=Re^Ze[1],ue=Te^Ze[2],w=H^Ze[3],ve=4,pe=1;pe<We;pe++)oe=lt[Ue>>>24]^At[Je>>16&255]^B[ue>>8&255]^$[255&w]^Ze[ve],se=lt[Je>>>24]^At[ue>>16&255]^B[w>>8&255]^$[255&Ue]^Ze[ve+1],ae=lt[ue>>>24]^At[w>>16&255]^B[Ue>>8&255]^$[255&Je]^Ze[ve+2],we=lt[w>>>24]^At[Ue>>16&255]^B[Je>>8&255]^$[255&ue]^Ze[ve+3],Ue=oe,Je=se,ue=ae,w=we,ve+=4;oe=Qe[Ue>>>24]<<24^Qe[Je>>16&255]<<16^Qe[ue>>8&255]<<8^Qe[255&w]^Ze[ve],se=Qe[Je>>>24]<<24^Qe[ue>>16&255]<<16^Qe[w>>8&255]<<8^Qe[255&Ue]^Ze[ve+1],ae=Qe[ue>>>24]<<24^Qe[w>>16&255]<<16^Qe[Ue>>8&255]<<8^Qe[255&Je]^Ze[ve+2],we=Qe[w>>>24]<<24^Qe[Ue>>16&255]<<16^Qe[Je>>8&255]<<8^Qe[255&ue]^Ze[ve+3],O[Q]=V(oe^ge),O[Q+1]=V(we^Ae),O[Q+2]=V(ae^xe),O[Q+3]=V(se^Ie),ge=z,Ae=H,xe=Te,Ie=Re,Q+=4}return O.buffer},J}(),R=y(93),P=y(63),ce=function(){function J(fe,Q){var de=(Q===void 0?{}:Q).removePKCS7Padding,oe=de===void 0||de;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=fe.enableSoftwareAES,this.removePKCS7Padding=oe,oe)try{var se=self.crypto;se&&(this.subtle=se.subtle||se.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}var ie=J.prototype;return ie.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},ie.isSync=function(){return this.useSoftware},ie.flush=function(){var fe=this.currentResult,Q=this.remainderData;if(!fe||Q)return R.logger.error("[softwareDecrypt] "+(Q?"overflow bytes: "+Q.byteLength:"no result")),this.reset(),null;var de,oe,se,ae=new Uint8Array(fe);return this.reset(),this.removePKCS7Padding?(se=(oe=(de=ae).byteLength)&&new DataView(de.buffer).getUint8(oe-1))?(0,C.sliceUint8)(de,0,oe-se):de:ae},ie.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},ie.decrypt=function(fe,Q,de){var oe=this;return this.useSoftware?new Promise(function(se,ae){oe.softwareDecrypt(new Uint8Array(fe),Q,de);var we=oe.flush();we?se(we.buffer):ae(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(fe),Q,de)},ie.softwareDecrypt=function(fe,Q,de){var oe=this.currentIV,se=this.currentResult,ae=this.remainderData;this.logOnce("JS AES decrypt"),ae&&(fe=(0,P.appendUint8Array)(ae,fe),this.remainderData=null);var we=this.getValidChunk(fe);if(!we.length)return null;oe&&(de=oe);var Ue=this.softwareDecrypter;Ue||(Ue=this.softwareDecrypter=new b),Ue.expandKey(Q);var Je=se;return this.currentResult=Ue.decrypt(we.buffer,0,de),this.currentIV=(0,C.sliceUint8)(we,-16).buffer,Je||null},ie.webCryptoDecrypt=function(fe,Q,de){var oe=this,se=this.subtle;return this.key===Q&&this.fastAesKey||(this.key=Q,this.fastAesKey=new I(se,Q)),this.fastAesKey.expandKey().then(function(ae){return se?(oe.logOnce("WebCrypto AES decrypt"),new S(se,new Uint8Array(de)).decrypt(fe.buffer,ae)):Promise.reject(new Error("web crypto not initialized"))}).catch(function(ae){return R.logger.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+ae.name+": "+ae.message),oe.onWebCryptoError(fe,Q,de)})},ie.onWebCryptoError=function(fe,Q,de){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(fe,Q,de);var oe=this.flush();if(oe)return oe.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},ie.getValidChunk=function(fe){var Q=fe,de=fe.length-fe.length%16;return de!==fe.length&&(Q=(0,C.sliceUint8)(fe,0,de),this.remainderData=(0,C.sliceUint8)(fe,de)),Q},ie.logOnce=function(fe){this.logEnabled&&(R.logger.log("[decrypter]: "+fe),this.logEnabled=!1)},J}()},181:(T,A,y)=>{y.r(A),y.d(A,{canParse:()=>P,decodeFrame:()=>Q,getID3Data:()=>b,getID3Frames:()=>fe,getTimeStamp:()=>ce,isFooter:()=>C,isHeader:()=>I,isTimeStampFrame:()=>J,testables:()=>Ue,utf8ArrayToStr:()=>we});var S,I=function(ue,w){return w+10<=ue.length&&ue[w]===73&&ue[w+1]===68&&ue[w+2]===51&&ue[w+3]<255&&ue[w+4]<255&&ue[w+6]<128&&ue[w+7]<128&&ue[w+8]<128&&ue[w+9]<128},C=function(ue,w){return w+10<=ue.length&&ue[w]===51&&ue[w+1]===68&&ue[w+2]===73&&ue[w+3]<255&&ue[w+4]<255&&ue[w+6]<128&&ue[w+7]<128&&ue[w+8]<128&&ue[w+9]<128},b=function(ue,w){for(var z=w,H=0;I(ue,w);)H+=10,H+=R(ue,w+6),C(ue,w+10)&&(H+=10),w+=H;if(H>0)return ue.subarray(z,z+H)},R=function(ue,w){var z=0;return z=(127&ue[w])<<21,z|=(127&ue[w+1])<<14,(z|=(127&ue[w+2])<<7)|127&ue[w+3]},P=function(ue,w){return I(ue,w)&&R(ue,w+6)+10<=ue.length-w},ce=function(ue){for(var w=fe(ue),z=0;z<w.length;z++){var H=w[z];if(J(H))return ae(H)}},J=function(ue){return ue&&ue.key==="PRIV"&&ue.info==="com.apple.streaming.transportStreamTimestamp"},ie=function(ue){var w=String.fromCharCode(ue[0],ue[1],ue[2],ue[3]),z=R(ue,4);return{type:w,size:z,data:ue.subarray(10,10+z)}},fe=function(ue){for(var w=0,z=[];I(ue,w);){for(var H=R(ue,w+6),Te=(w+=10)+H;w+8<Te;){var Re=ie(ue.subarray(w)),ve=Q(Re);ve&&z.push(ve),w+=Re.size+10}C(ue,w)&&(w+=10)}return z},Q=function(ue){return ue.type==="PRIV"?de(ue):ue.type[0]==="W"?se(ue):oe(ue)},de=function(ue){if(!(ue.size<2)){var w=we(ue.data,!0),z=new Uint8Array(ue.data.subarray(w.length+1));return{key:ue.type,info:w,data:z.buffer}}},oe=function(ue){if(!(ue.size<2)){if(ue.type==="TXXX"){var w=1,z=we(ue.data.subarray(w),!0);w+=z.length+1;var H=we(ue.data.subarray(w));return{key:ue.type,info:z,data:H}}var Te=we(ue.data.subarray(1));return{key:ue.type,data:Te}}},se=function(ue){if(ue.type==="WXXX"){if(ue.size<2)return;var w=1,z=we(ue.data.subarray(w),!0);w+=z.length+1;var H=we(ue.data.subarray(w));return{key:ue.type,info:z,data:H}}var Te=we(ue.data);return{key:ue.type,data:Te}},ae=function(ue){if(ue.data.byteLength===8){var w=new Uint8Array(ue.data),z=1&w[3],H=(w[4]<<23)+(w[5]<<15)+(w[6]<<7)+w[7];return H/=45,z&&(H+=4772185884e-2),Math.round(H)}},we=function(ue,w){w===void 0&&(w=!1);var z=Je();if(z){var H=z.decode(ue);if(w){var Te=H.indexOf("\0");return Te!==-1?H.substring(0,Te):H}return H.replace(/\0/g,"")}for(var Re,ve,pe,We=ue.length,Ze="",Qe=0;Qe<We;){if((Re=ue[Qe++])===0&&w)return Ze;if(Re!==0&&Re!==3)switch(Re>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:Ze+=String.fromCharCode(Re);break;case 12:case 13:ve=ue[Qe++],Ze+=String.fromCharCode((31&Re)<<6|63&ve);break;case 14:ve=ue[Qe++],pe=ue[Qe++],Ze+=String.fromCharCode((15&Re)<<12|(63&ve)<<6|(63&pe)<<0)}}return Ze},Ue={decodeTextFrame:oe};function Je(){return S||self.TextDecoder===void 0||(S=new self.TextDecoder("utf-8")),S}},182:(T,A,y)=>{y.r(A),y.d(A,{default:()=>P});var S=y(544),I=y(851),C=y(93),b=y(729),R=y(973);function P(fe){var Q=new b.EventEmitter,de=function(oe,se){fe.postMessage({event:oe,data:se})};Q.on(I.Events.FRAG_DECRYPTED,de),Q.on(I.Events.ERROR,de),fe.addEventListener("message",function(oe){var se=oe.data;switch(se.cmd){case"init":var ae=JSON.parse(se.config);fe.transmuxer=new S.default(Q,se.typeSupported,ae,se.vendor,se.id),(0,C.enableLogs)(ae.debug,se.id),function(){var ue=function(z){C.logger[z]=function(H){de("workerLog",{logType:z,message:H})}};for(var w in C.logger)ue(w)}(),de("init",null);break;case"configure":fe.transmuxer.configure(se.config);break;case"demux":var we=fe.transmuxer.push(se.data,se.decryptdata,se.chunkMeta,se.state);(0,S.isPromise)(we)?(fe.transmuxer.async=!0,we.then(function(ue){ce(fe,ue)}).catch(function(ue){de(I.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:se.chunkMeta,fatal:!1,error:ue,err:ue,reason:"transmuxer-worker push error"})})):(fe.transmuxer.async=!1,ce(fe,we));break;case"flush":var Ue=se.chunkMeta,Je=fe.transmuxer.flush(Ue);(0,S.isPromise)(Je)||fe.transmuxer.async?((0,S.isPromise)(Je)||(Je=Promise.resolve(Je)),Je.then(function(ue){ie(fe,ue,Ue)}).catch(function(ue){de(I.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:se.chunkMeta,fatal:!1,error:ue,err:ue,reason:"transmuxer-worker flush error"})})):ie(fe,Je,Ue)}})}function ce(fe,Q){if(!((de=Q.remuxResult).audio||de.video||de.text||de.id3||de.initSegment))return!1;var de,oe=[],se=Q.remuxResult,ae=se.audio,we=se.video;return ae&&J(oe,ae),we&&J(oe,we),fe.postMessage({event:"transmuxComplete",data:Q},oe),!0}function J(fe,Q){Q.data1&&fe.push(Q.data1.buffer),Q.data2&&fe.push(Q.data2.buffer)}function ie(fe,Q,de){Q.reduce(function(oe,se){return ce(fe,se)||oe},!1)||fe.postMessage({event:"transmuxComplete",data:Q[0]}),fe.postMessage({event:"flush",data:de})}},544:(T,A,y)=>{y.r(A),y.d(A,{TransmuxConfig:()=>Et,TransmuxState:()=>Ft,default:()=>nt,isPromise:()=>dt});var S=y(851),I=y(973),C=y(21),b=y(965),R=y(181),P=y(856);function ce(te,W){return te===void 0&&(te=""),W===void 0&&(W=9e4),{type:te,id:-1,pid:-1,inputTimeScale:W,sequenceNumber:-1,samples:[],dropped:0}}var J=y(63),ie=y(145),fe=function(){function te(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var W=te.prototype;return W.resetInitSegment=function(D,G,U,X){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},W.resetTimeStamp=function(D){this.initPTS=D,this.resetContiguity()},W.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},W.canParse=function(D,G){return!1},W.appendFrame=function(D,G,U){},W.demux=function(D,G){this.cachedData&&(D=(0,J.appendUint8Array)(this.cachedData,D),this.cachedData=null);var U,X=R.getID3Data(D,0),ee=X?X.length:0,ne=this._audioTrack,ye=this._id3Track,Oe=X?R.getTimeStamp(X):void 0,Pe=D.length;for((this.basePTS===null||this.frameIndex===0&&(0,b.isFiniteNumber)(Oe))&&(this.basePTS=Q(Oe,G,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),X&&X.length>0&&ye.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:X,type:P.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});ee<Pe;){if(this.canParse(D,ee)){var Ke=this.appendFrame(ne,D,ee);Ke?(this.frameIndex++,this.lastPTS=Ke.sample.pts,U=ee+=Ke.length):ee=Pe}else R.canParse(D,ee)?(X=R.getID3Data(D,ee),ye.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:X,type:P.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),U=ee+=X.length):ee++;if(ee===Pe&&U!==Pe){var tt=(0,ie.sliceUint8)(D,U);this.cachedData?this.cachedData=(0,J.appendUint8Array)(this.cachedData,tt):this.cachedData=tt}}return{audioTrack:ne,videoTrack:ce(),id3Track:ye,textTrack:ce()}},W.demuxSampleAes=function(D,G,U){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},W.flush=function(D){var G=this.cachedData;return G&&(this.cachedData=null,this.demux(G,0)),{audioTrack:this._audioTrack,videoTrack:ce(),id3Track:this._id3Track,textTrack:ce()}},W.destroy=function(){},te}(),Q=function(te,W,D){return(0,b.isFiniteNumber)(te)?90*te:9e4*W+(D||0)};const de=fe;var oe=y(93);function se(te,W){return te[W]===255&&(246&te[W+1])==240}function ae(te,W){return 1&te[W+1]?7:9}function we(te,W){return(3&te[W+3])<<11|te[W+4]<<3|(224&te[W+5])>>>5}function Ue(te,W){return W+1<te.length&&se(te,W)}function Je(te,W){if(Ue(te,W)){var D=ae(te,W);if(W+D>=te.length)return!1;var G=we(te,W);if(G<=D)return!1;var U=W+G;return U===te.length||Ue(te,U)}return!1}function ue(te,W,D,G,U){if(!te.samplerate){var X=function(ee,ne,ye,Oe){var Pe,Ke,tt,qe,at=navigator.userAgent.toLowerCase(),gt=Oe,Ct=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Pe=1+((192&ne[ye+2])>>>6);var it=(60&ne[ye+2])>>>2;if(!(it>Ct.length-1))return tt=(1&ne[ye+2])<<2,tt|=(192&ne[ye+3])>>>6,oe.logger.log("manifest codec:"+Oe+", ADTS type:"+Pe+", samplingIndex:"+it),/firefox/i.test(at)?it>=6?(Pe=5,qe=new Array(4),Ke=it-3):(Pe=2,qe=new Array(2),Ke=it):at.indexOf("android")!==-1?(Pe=2,qe=new Array(2),Ke=it):(Pe=5,qe=new Array(4),Oe&&(Oe.indexOf("mp4a.40.29")!==-1||Oe.indexOf("mp4a.40.5")!==-1)||!Oe&&it>=6?Ke=it-3:((Oe&&Oe.indexOf("mp4a.40.2")!==-1&&(it>=6&&tt===1||/vivaldi/i.test(at))||!Oe&&tt===1)&&(Pe=2,qe=new Array(2)),Ke=it)),qe[0]=Pe<<3,qe[0]|=(14&it)>>1,qe[1]|=(1&it)<<7,qe[1]|=tt<<3,Pe===5&&(qe[1]|=(14&Ke)>>1,qe[2]=(1&Ke)<<7,qe[2]|=8,qe[3]=0),{config:qe,samplerate:Ct[it],channelCount:tt,codec:"mp4a.40."+Pe,manifestCodec:gt};ee.trigger(S.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+it})}(W,D,G,U);if(!X)return;te.config=X.config,te.samplerate=X.samplerate,te.channelCount=X.channelCount,te.codec=X.codec,te.manifestCodec=X.manifestCodec,oe.logger.log("parsed codec:"+te.codec+", rate:"+X.samplerate+", channels:"+X.channelCount)}}function w(te){return 9216e4/te}function z(te,W,D,G,U){var X,ee=G+U*w(te.samplerate),ne=function(at,gt){var Ct=ae(at,gt);if(gt+Ct<=at.length){var it=we(at,gt)-Ct;if(it>0)return{headerLength:Ct,frameLength:it}}}(W,D);if(ne){var ye=ne.frameLength,Oe=ne.headerLength,Pe=Oe+ye,Ke=Math.max(0,D+Pe-W.length);Ke?(X=new Uint8Array(Pe-Oe)).set(W.subarray(D+Oe,W.length),0):X=W.subarray(D+Oe,D+Pe);var tt={unit:X,pts:ee};return Ke||te.samples.push(tt),{sample:tt,length:Pe,missing:Ke}}var qe=W.length-D;return(X=new Uint8Array(qe)).set(W.subarray(D,W.length),0),{sample:{unit:X,pts:ee},length:qe,missing:-1}}function H(te,W){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,G){return D.__proto__=G,D},H(te,W)}const Te=function(te){var W,D;function G(X,ee){var ne;return(ne=te.call(this)||this).observer=void 0,ne.config=void 0,ne.observer=X,ne.config=ee,ne}D=te,(W=G).prototype=Object.create(D.prototype),W.prototype.constructor=W,H(W,D);var U=G.prototype;return U.resetInitSegment=function(X,ee,ne,ye){te.prototype.resetInitSegment.call(this,X,ee,ne,ye),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:ee,duration:ye,inputTimeScale:9e4,dropped:0}},G.probe=function(X){if(!X)return!1;for(var ee=(R.getID3Data(X,0)||[]).length,ne=X.length;ee<ne;ee++)if(Je(X,ee))return oe.logger.log("ADTS sync word found !"),!0;return!1},U.canParse=function(X,ee){return function(ne,ye){return function(Oe,Pe){return Pe+5<Oe.length}(ne,ye)&&se(ne,ye)&&we(ne,ye)<=ne.length-ye}(X,ee)},U.appendFrame=function(X,ee,ne){ue(X,this.observer,ee,ne,X.manifestCodec);var ye=z(X,ee,ne,this.basePTS,this.frameIndex);if(ye&&ye.missing===0)return ye},G}(de);var Re=/\/emsg[-/]ID3/i;const ve=function(){function te(D,G){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=G}var W=te.prototype;return W.resetTimeStamp=function(){},W.resetInitSegment=function(D,G,U,X){var ee=this.videoTrack=ce("video",1),ne=this.audioTrack=ce("audio",1),ye=this.txtTrack=ce("text",1);if(this.id3Track=ce("id3",1),this.timeOffset=0,D&&D.byteLength){var Oe=(0,J.parseInitSegment)(D);if(Oe.video){var Pe=Oe.video,Ke=Pe.id,tt=Pe.timescale,qe=Pe.codec;ee.id=Ke,ee.timescale=ye.timescale=tt,ee.codec=qe}if(Oe.audio){var at=Oe.audio,gt=at.id,Ct=at.timescale,it=at.codec;ne.id=gt,ne.timescale=Ct,ne.codec=it}ye.id=J.RemuxerTrackIdConfig.text,ee.sampleDuration=0,ee.duration=ne.duration=X}},W.resetContiguity=function(){},te.probe=function(D){return D=D.length>16384?D.subarray(0,16384):D,(0,J.findBox)(D,["moof"]).length>0},W.demux=function(D,G){this.timeOffset=G;var U=D,X=this.videoTrack,ee=this.txtTrack;if(this.config.progressive){this.remainderData&&(U=(0,J.appendUint8Array)(this.remainderData,D));var ne=(0,J.segmentValidRange)(U);this.remainderData=ne.remainder,X.samples=ne.valid||new Uint8Array}else X.samples=U;var ye=this.extractID3Track(X,G);return ee.samples=(0,J.parseSamples)(G,X),{videoTrack:X,audioTrack:this.audioTrack,id3Track:ye,textTrack:this.txtTrack}},W.flush=function(){var D=this.timeOffset,G=this.videoTrack,U=this.txtTrack;G.samples=this.remainderData||new Uint8Array,this.remainderData=null;var X=this.extractID3Track(G,this.timeOffset);return U.samples=(0,J.parseSamples)(D,G),{videoTrack:G,audioTrack:ce(),id3Track:X,textTrack:ce()}},W.extractID3Track=function(D,G){var U=this.id3Track;if(D.samples.length){var X=(0,J.findBox)(D.samples,["emsg"]);X&&X.forEach(function(ee){var ne=(0,J.parseEmsg)(ee);if(Re.test(ne.schemeIdUri)){var ye=(0,b.isFiniteNumber)(ne.presentationTime)?ne.presentationTime/ne.timeScale:G+ne.presentationTimeDelta/ne.timeScale,Oe=ne.eventDuration===4294967295?Number.POSITIVE_INFINITY:ne.eventDuration/ne.timeScale;Oe<=.001&&(Oe=Number.POSITIVE_INFINITY);var Pe=ne.payload;U.samples.push({data:Pe,len:Pe.byteLength,dts:ye,pts:ye,type:P.MetadataSchema.emsg,duration:Oe})}})}return U},W.demuxSampleAes=function(D,G,U){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},W.destroy=function(){},te}();var pe=null,We=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Ze=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Qe=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Ve=[0,1,1,4];function lt(te,W,D,G,U){if(!(D+24>W.length)){var X=At(W,D);if(X&&D+X.frameLength<=W.length){var ee=G+U*(9e4*X.samplesPerFrame/X.sampleRate),ne={unit:W.subarray(D,D+X.frameLength),pts:ee,dts:ee};return te.config=[],te.channelCount=X.channelCount,te.samplerate=X.sampleRate,te.samples.push(ne),{sample:ne,length:X.frameLength,missing:0}}}}function At(te,W){var D=te[W+1]>>3&3,G=te[W+1]>>1&3,U=te[W+2]>>4&15,X=te[W+2]>>2&3;if(D!==1&&U!==0&&U!==15&&X!==3){var ee=te[W+2]>>1&1,ne=te[W+3]>>6,ye=1e3*We[14*(D===3?3-G:G===3?3:4)+U-1],Oe=Ze[3*(D===3?0:D===2?1:2)+X],Pe=ne===3?1:2,Ke=Qe[D][G],tt=Ve[G],qe=8*Ke*tt,at=Math.floor(Ke*ye/Oe+ee)*tt;if(pe===null){var gt=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);pe=gt?parseInt(gt[1]):0}return pe&&pe<=87&&G===2&&ye>=224e3&&ne===0&&(te[W+3]=128|te[W+3]),{sampleRate:Oe,channelCount:Pe,frameLength:at,samplesPerFrame:qe}}}function B(te,W){return te[W]===255&&(224&te[W+1])==224&&(6&te[W+1])!=0}function $(te,W){return W+1<te.length&&B(te,W)}function q(te,W){if(W+1<te.length&&B(te,W)){var D=At(te,W),G=4;D!=null&&D.frameLength&&(G=D.frameLength);var U=W+G;return U===te.length||$(te,U)}return!1}const ge=function(){function te(D){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=D,this.bytesAvailable=D.byteLength,this.word=0,this.bitsAvailable=0}var W=te.prototype;return W.loadWord=function(){var D=this.data,G=this.bytesAvailable,U=D.byteLength-G,X=new Uint8Array(4),ee=Math.min(4,G);if(ee===0)throw new Error("no bytes available");X.set(D.subarray(U,U+ee)),this.word=new DataView(X.buffer).getUint32(0),this.bitsAvailable=8*ee,this.bytesAvailable-=ee},W.skipBits=function(D){var G;D=Math.min(D,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>D?(this.word<<=D,this.bitsAvailable-=D):(D-=this.bitsAvailable,D-=(G=D>>3)<<3,this.bytesAvailable-=G,this.loadWord(),this.word<<=D,this.bitsAvailable-=D)},W.readBits=function(D){var G=Math.min(this.bitsAvailable,D),U=this.word>>>32-G;if(D>32&&oe.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=G,this.bitsAvailable>0)this.word<<=G;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(G=D-G)>0&&this.bitsAvailable?U<<G|this.readBits(G):U},W.skipLZ=function(){var D;for(D=0;D<this.bitsAvailable;++D)if(this.word&2147483648>>>D)return this.word<<=D,this.bitsAvailable-=D,D;return this.loadWord(),D+this.skipLZ()},W.skipUEG=function(){this.skipBits(1+this.skipLZ())},W.skipEG=function(){this.skipBits(1+this.skipLZ())},W.readUEG=function(){var D=this.skipLZ();return this.readBits(D+1)-1},W.readEG=function(){var D=this.readUEG();return 1&D?1+D>>>1:-1*(D>>>1)},W.readBoolean=function(){return this.readBits(1)===1},W.readUByte=function(){return this.readBits(8)},W.readUShort=function(){return this.readBits(16)},W.readUInt=function(){return this.readBits(32)},W.skipScalingList=function(D){for(var G=8,U=8,X=0;X<D;X++)U!==0&&(U=(G+this.readEG()+256)%256),G=U===0?G:U},W.readSPS=function(){var D,G,U,X=0,ee=0,ne=0,ye=0,Oe=this.readUByte.bind(this),Pe=this.readBits.bind(this),Ke=this.readUEG.bind(this),tt=this.readBoolean.bind(this),qe=this.skipBits.bind(this),at=this.skipEG.bind(this),gt=this.skipUEG.bind(this),Ct=this.skipScalingList.bind(this);Oe();var it=Oe();if(Pe(5),qe(3),Oe(),gt(),it===100||it===110||it===122||it===244||it===44||it===83||it===86||it===118||it===128){var Nt=Ke();if(Nt===3&&qe(1),gt(),gt(),qe(1),tt())for(G=Nt!==3?8:12,U=0;U<G;U++)tt()&&Ct(U<6?16:64)}gt();var er=Ke();if(er===0)Ke();else if(er===1)for(qe(1),at(),at(),D=Ke(),U=0;U<D;U++)at();gt(),qe(1);var Yt=Ke(),Mt=Ke(),qt=Pe(1);qt===0&&qe(1),qe(1),tt()&&(X=Ke(),ee=Ke(),ne=Ke(),ye=Ke());var ot=[1,1];if(tt()&&tt())switch(Oe()){case 1:ot=[1,1];break;case 2:ot=[12,11];break;case 3:ot=[10,11];break;case 4:ot=[16,11];break;case 5:ot=[40,33];break;case 6:ot=[24,11];break;case 7:ot=[20,11];break;case 8:ot=[32,11];break;case 9:ot=[80,33];break;case 10:ot=[18,11];break;case 11:ot=[15,11];break;case 12:ot=[64,33];break;case 13:ot=[160,99];break;case 14:ot=[4,3];break;case 15:ot=[3,2];break;case 16:ot=[2,1];break;case 255:ot=[Oe()<<8|Oe(),Oe()<<8|Oe()]}return{width:Math.ceil(16*(Yt+1)-2*X-2*ee),height:(2-qt)*(Mt+1)*16-(qt?2:4)*(ne+ye),pixelRatio:ot}},W.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},te}(),Ae=function(){function te(D,G,U){this.keyData=void 0,this.decrypter=void 0,this.keyData=U,this.decrypter=new C.default(G,{removePKCS7Padding:!1})}var W=te.prototype;return W.decryptBuffer=function(D){return this.decrypter.decrypt(D,this.keyData.key.buffer,this.keyData.iv.buffer)},W.decryptAacSample=function(D,G,U){var X=this,ee=D[G].unit;if(!(ee.length<=16)){var ne=ee.subarray(16,ee.length-ee.length%16),ye=ne.buffer.slice(ne.byteOffset,ne.byteOffset+ne.length);this.decryptBuffer(ye).then(function(Oe){var Pe=new Uint8Array(Oe);ee.set(Pe,16),X.decrypter.isSync()||X.decryptAacSamples(D,G+1,U)})}},W.decryptAacSamples=function(D,G,U){for(;;G++){if(G>=D.length)return void U();if(!(D[G].unit.length<32||(this.decryptAacSample(D,G,U),this.decrypter.isSync())))return}},W.getAvcEncryptedData=function(D){for(var G=16*Math.floor((D.length-48)/160)+16,U=new Int8Array(G),X=0,ee=32;ee<D.length-16;ee+=160,X+=16)U.set(D.subarray(ee,ee+16),X);return U},W.getAvcDecryptedUnit=function(D,G){for(var U=new Uint8Array(G),X=0,ee=32;ee<D.length-16;ee+=160,X+=16)D.set(U.subarray(X,X+16),ee);return D},W.decryptAvcSample=function(D,G,U,X,ee){var ne=this,ye=(0,J.discardEPB)(ee.data),Oe=this.getAvcEncryptedData(ye);this.decryptBuffer(Oe.buffer).then(function(Pe){ee.data=ne.getAvcDecryptedUnit(ye,Pe),ne.decrypter.isSync()||ne.decryptAvcSamples(D,G,U+1,X)})},W.decryptAvcSamples=function(D,G,U,X){if(D instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;G++,U=0){if(G>=D.length)return void X();for(var ee=D[G].units;!(U>=ee.length);U++){var ne=ee[U];if(!(ne.data.length<=48||ne.type!==1&&ne.type!==5||(this.decryptAvcSample(D,G,U,X,ne),this.decrypter.isSync())))return}}},te}();function xe(){return xe=Object.assign?Object.assign.bind():function(te){for(var W=1;W<arguments.length;W++){var D=arguments[W];for(var G in D)Object.prototype.hasOwnProperty.call(D,G)&&(te[G]=D[G])}return te},xe.apply(this,arguments)}var Ie=188;function N(te,W,D,G){return{key:te,frame:!1,pts:W,dts:D,units:[],debug:G,length:0}}function O(te,W){return(31&te[W+10])<<8|te[W+11]}function V(te,W,D,G){var U={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},X=W+3+((15&te[W+1])<<8|te[W+2])-4;for(W+=12+((15&te[W+10])<<8|te[W+11]);W<X;){var ee=(31&te[W+1])<<8|te[W+2];switch(te[W]){case 207:if(!G){oe.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:U.audio===-1&&(U.audio=ee);break;case 21:U.id3===-1&&(U.id3=ee);break;case 219:if(!G){oe.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:U.avc===-1&&(U.avc=ee);break;case 3:case 4:D.mpeg!==!0&&D.mp3!==!0?oe.logger.log("MPEG audio found, not supported in this browser"):U.audio===-1&&(U.audio=ee,U.segmentCodec="mp3");break;case 36:oe.logger.warn("Unsupported HEVC stream type found")}W+=5+((15&te[W+3])<<8|te[W+4])}return U}function re(te){var W,D,G,U,X,ee=0,ne=te.data;if(!te||te.size===0)return null;for(;ne[0].length<19&&ne.length>1;){var ye=new Uint8Array(ne[0].length+ne[1].length);ye.set(ne[0]),ye.set(ne[1],ne[0].length),ne[0]=ye,ne.splice(1,1)}if(((W=ne[0])[0]<<16)+(W[1]<<8)+W[2]===1){if((D=(W[4]<<8)+W[5])&&D>te.size-6)return null;var Oe=W[7];192&Oe&&(U=536870912*(14&W[9])+4194304*(255&W[10])+16384*(254&W[11])+128*(255&W[12])+(254&W[13])/2,64&Oe?U-(X=536870912*(14&W[14])+4194304*(255&W[15])+16384*(254&W[16])+128*(255&W[17])+(254&W[18])/2)>54e5&&(oe.logger.warn(Math.round((U-X)/9e4)+"s delta between PTS and DTS, align them"),U=X):X=U);var Pe=(G=W[8])+9;if(te.size<=Pe)return null;te.size-=Pe;for(var Ke=new Uint8Array(te.size),tt=0,qe=ne.length;tt<qe;tt++){var at=(W=ne[tt]).byteLength;if(Pe){if(Pe>at){Pe-=at;continue}W=W.subarray(Pe),at-=Pe,Pe=0}Ke.set(W,ee),ee+=at}return D&&(D-=G+3),{data:Ke,pts:U,dts:X,len:D}}return null}function me(te,W){if(te.units.length&&te.frame){if(te.pts===void 0){var D=W.samples,G=D.length;if(!G)return void W.dropped++;var U=D[G-1];te.pts=U.pts,te.dts=U.dts}W.samples.push(te)}te.debug.length&&oe.logger.log(te.pts+"/"+te.dts+":"+te.debug)}const Ne=function(){function te(D,G,U){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=D,this.config=G,this.typeSupported=U}te.probe=function(D){var G=te.syncOffset(D);return G>0&&oe.logger.warn("MPEG2-TS detected but first sync word found @ offset "+G),G!==-1},te.syncOffset=function(D){for(var G=Math.min(940,D.length-376)+1,U=0;U<G;){if(D[U]===71&&D[U+Ie]===71)return U;U++}return-1},te.createTrack=function(D,G){return{container:D==="video"||D==="audio"?"video/mp2t":void 0,type:D,id:J.RemuxerTrackIdConfig[D],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:D==="audio"?G:void 0}};var W=te.prototype;return W.resetInitSegment=function(D,G,U,X){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=te.createTrack("video"),this._audioTrack=te.createTrack("audio",X),this._id3Track=te.createTrack("id3"),this._txtTrack=te.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=G,this.videoCodec=U,this._duration=X},W.resetTimeStamp=function(){},W.resetContiguity=function(){var D=this._audioTrack,G=this._avcTrack,U=this._id3Track;D&&(D.pesData=null),G&&(G.pesData=null),U&&(U.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},W.demux=function(D,G,U,X){var ee;U===void 0&&(U=!1),X===void 0&&(X=!1),U||(this.sampleAes=null);var ne=this._avcTrack,ye=this._audioTrack,Oe=this._id3Track,Pe=this._txtTrack,Ke=ne.pid,tt=ne.pesData,qe=ye.pid,at=Oe.pid,gt=ye.pesData,Ct=Oe.pesData,it=null,Nt=this.pmtParsed,er=this._pmtId,Yt=D.length;if(this.remainderData&&(Yt=(D=(0,J.appendUint8Array)(this.remainderData,D)).length,this.remainderData=null),Yt<Ie&&!X)return this.remainderData=D,{audioTrack:ye,videoTrack:ne,id3Track:Oe,textTrack:Pe};var Mt=Math.max(0,te.syncOffset(D));(Yt-=(Yt-Mt)%Ie)<D.byteLength&&!X&&(this.remainderData=new Uint8Array(D.buffer,Yt,D.buffer.byteLength-Yt));for(var qt=0,ot=Mt;ot<Yt;ot+=Ie)if(D[ot]===71){var ur=!!(64&D[ot+1]),qr=((31&D[ot+1])<<8)+D[ot+2],Vt=void 0;if((48&D[ot+3])>>4>1){if((Vt=ot+5+D[ot+4])===ot+Ie)continue}else Vt=ot+4;switch(qr){case Ke:ur&&(tt&&(ee=re(tt))&&this.parseAVCPES(ne,Pe,ee,!1),tt={data:[],size:0}),tt&&(tt.data.push(D.subarray(Vt,ot+Ie)),tt.size+=ot+Ie-Vt);break;case qe:if(ur){if(gt&&(ee=re(gt)))switch(ye.segmentCodec){case"aac":this.parseAACPES(ye,ee);break;case"mp3":this.parseMPEGPES(ye,ee)}gt={data:[],size:0}}gt&&(gt.data.push(D.subarray(Vt,ot+Ie)),gt.size+=ot+Ie-Vt);break;case at:ur&&(Ct&&(ee=re(Ct))&&this.parseID3PES(Oe,ee),Ct={data:[],size:0}),Ct&&(Ct.data.push(D.subarray(Vt,ot+Ie)),Ct.size+=ot+Ie-Vt);break;case 0:ur&&(Vt+=D[Vt]+1),er=this._pmtId=O(D,Vt);break;case er:ur&&(Vt+=D[Vt]+1);var zt=V(D,Vt,this.typeSupported,U);(Ke=zt.avc)>0&&(ne.pid=Ke),(qe=zt.audio)>0&&(ye.pid=qe,ye.segmentCodec=zt.segmentCodec),(at=zt.id3)>0&&(Oe.pid=at),it===null||Nt||(oe.logger.log("unknown PID '"+it+"' in TS found"),it=null,ot=Mt-188),Nt=this.pmtParsed=!0;break;case 17:case 8191:break;default:it=qr}}else qt++;qt>0&&this.observer.emit(S.Events.ERROR,S.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+qt+" TS packet/s that do not start with 0x47"}),ne.pesData=tt,ye.pesData=gt,Oe.pesData=Ct;var Ar={audioTrack:ye,videoTrack:ne,id3Track:Oe,textTrack:Pe};return X&&this.extractRemainingSamples(Ar),Ar},W.flush=function(){var D,G=this.remainderData;return this.remainderData=null,D=G?this.demux(G,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(D),this.sampleAes?this.decrypt(D,this.sampleAes):D},W.extractRemainingSamples=function(D){var G,U=D.audioTrack,X=D.videoTrack,ee=D.id3Track,ne=D.textTrack,ye=X.pesData,Oe=U.pesData,Pe=ee.pesData;if(ye&&(G=re(ye))?(this.parseAVCPES(X,ne,G,!0),X.pesData=null):X.pesData=ye,Oe&&(G=re(Oe))){switch(U.segmentCodec){case"aac":this.parseAACPES(U,G);break;case"mp3":this.parseMPEGPES(U,G)}U.pesData=null}else Oe!=null&&Oe.size&&oe.logger.log("last AAC PES packet truncated,might overlap between fragments"),U.pesData=Oe;Pe&&(G=re(Pe))?(this.parseID3PES(ee,G),ee.pesData=null):ee.pesData=Pe},W.demuxSampleAes=function(D,G,U){var X=this.demux(D,U,!0,!this.config.progressive),ee=this.sampleAes=new Ae(this.observer,this.config,G);return this.decrypt(X,ee)},W.decrypt=function(D,G){return new Promise(function(U){var X=D.audioTrack,ee=D.videoTrack;X.samples&&X.segmentCodec==="aac"?G.decryptAacSamples(X.samples,0,function(){ee.samples?G.decryptAvcSamples(ee.samples,0,0,function(){U(D)}):U(D)}):ee.samples&&G.decryptAvcSamples(ee.samples,0,0,function(){U(D)})})},W.destroy=function(){this._duration=0},W.parseAVCPES=function(D,G,U,X){var ee,ne=this,ye=this.parseAVCNALu(D,U.data),Oe=this.avcSample,Pe=!1;U.data=null,Oe&&ye.length&&!D.audFound&&(me(Oe,D),Oe=this.avcSample=N(!1,U.pts,U.dts,"")),ye.forEach(function(Ke){switch(Ke.type){case 1:ee=!0,Oe||(Oe=ne.avcSample=N(!0,U.pts,U.dts,"")),Oe.frame=!0;var tt=Ke.data;if(Pe&&tt.length>4){var qe=new ge(tt).readSliceType();qe!==2&&qe!==4&&qe!==7&&qe!==9||(Oe.key=!0)}break;case 5:ee=!0,Oe||(Oe=ne.avcSample=N(!0,U.pts,U.dts,"")),Oe.key=!0,Oe.frame=!0;break;case 6:ee=!0,(0,J.parseSEIMessageFromNALu)(Ke.data,1,U.pts,G.samples);break;case 7:if(ee=!0,Pe=!0,!D.sps){var at=new ge(Ke.data).readSPS();D.width=at.width,D.height=at.height,D.pixelRatio=at.pixelRatio,D.sps=[Ke.data],D.duration=ne._duration;for(var gt=Ke.data.subarray(1,4),Ct="avc1.",it=0;it<3;it++){var Nt=gt[it].toString(16);Nt.length<2&&(Nt="0"+Nt),Ct+=Nt}D.codec=Ct}break;case 8:ee=!0,D.pps||(D.pps=[Ke.data]);break;case 9:ee=!1,D.audFound=!0,Oe&&me(Oe,D),Oe=ne.avcSample=N(!1,U.pts,U.dts,"");break;case 12:ee=!0;break;default:ee=!1,Oe&&(Oe.debug+="unknown NAL "+Ke.type+" ")}Oe&&ee&&Oe.units.push(Ke)}),X&&Oe&&(me(Oe,D),this.avcSample=null)},W.getLastNalUnit=function(D){var G,U,X=this.avcSample;if(X&&X.units.length!==0||(X=D[D.length-1]),(G=X)!==null&&G!==void 0&&G.units){var ee=X.units;U=ee[ee.length-1]}return U},W.parseAVCNALu=function(D,G){var U,X,ee=G.byteLength,ne=D.naluState||0,ye=ne,Oe=[],Pe=0,Ke=-1,tt=0;for(ne===-1&&(Ke=0,tt=31&G[0],ne=0,Pe=1);Pe<ee;)if(U=G[Pe++],ne)if(ne!==1)if(U)if(U===1){if(Ke>=0){var qe={data:G.subarray(Ke,Pe-ne-1),type:tt};Oe.push(qe)}else{var at=this.getLastNalUnit(D.samples);if(at&&(ye&&Pe<=4-ye&&at.state&&(at.data=at.data.subarray(0,at.data.byteLength-ye)),(X=Pe-ne-1)>0)){var gt=new Uint8Array(at.data.byteLength+X);gt.set(at.data,0),gt.set(G.subarray(0,X),at.data.byteLength),at.data=gt,at.state=0}}Pe<ee?(Ke=Pe,tt=31&G[Pe],ne=0):ne=-1}else ne=0;else ne=3;else ne=U?0:2;else ne=U?0:1;if(Ke>=0&&ne>=0){var Ct={data:G.subarray(Ke,ee),type:tt,state:ne};Oe.push(Ct)}if(Oe.length===0){var it=this.getLastNalUnit(D.samples);if(it){var Nt=new Uint8Array(it.data.byteLength+G.byteLength);Nt.set(it.data,0),Nt.set(G,it.data.byteLength),it.data=Nt}}return D.naluState=ne,Oe},W.parseAACPES=function(D,G){var U,X,ee,ne,ye,Oe=0,Pe=this.aacOverFlow,Ke=G.data;if(Pe){this.aacOverFlow=null;var tt=Pe.missing,qe=Pe.sample.unit.byteLength;if(tt===-1){var at=new Uint8Array(qe+Ke.byteLength);at.set(Pe.sample.unit,0),at.set(Ke,qe),Ke=at}else{var gt=qe-tt;Pe.sample.unit.set(Ke.subarray(0,tt),gt),D.samples.push(Pe.sample),Oe=Pe.missing}}for(U=Oe,X=Ke.length;U<X-1&&!Ue(Ke,U);U++);if(U===Oe||(U<X-1?(ee="AAC PES did not start with ADTS header,offset:"+U,ne=!1):(ee="no ADTS header found in AAC PES",ne=!0),oe.logger.warn("parsing error:"+ee),this.observer.emit(S.Events.ERROR,S.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,fatal:ne,reason:ee}),!ne)){if(ue(D,this.observer,Ke,U,this.audioCodec),G.pts!==void 0)ye=G.pts;else{if(!Pe)return void oe.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var Ct=w(D.samplerate);ye=Pe.sample.pts+Ct}for(var it,Nt=0;U<X;){if(U+=(it=z(D,Ke,U,ye,Nt)).length,it.missing){this.aacOverFlow=it;break}for(Nt++;U<X-1&&!Ue(Ke,U);U++);}}},W.parseMPEGPES=function(D,G){var U=G.data,X=U.length,ee=0,ne=0,ye=G.pts;if(ye!==void 0)for(;ne<X;)if($(U,ne)){var Oe=lt(D,U,ne,ye,ee);if(!Oe)break;ne+=Oe.length,ee++}else ne++;else oe.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},W.parseID3PES=function(D,G){if(G.pts!==void 0){var U=xe({},G,{type:this._avcTrack?P.MetadataSchema.emsg:P.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});D.samples.push(U)}else oe.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},te}();function Me(te,W){return Me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,G){return D.__proto__=G,D},Me(te,W)}const ke=function(te){var W,D;function G(){return te.apply(this,arguments)||this}D=te,(W=G).prototype=Object.create(D.prototype),W.prototype.constructor=W,Me(W,D);var U=G.prototype;return U.resetInitSegment=function(X,ee,ne,ye){te.prototype.resetInitSegment.call(this,X,ee,ne,ye),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:ee,duration:ye,inputTimeScale:9e4,dropped:0}},G.probe=function(X){if(!X)return!1;for(var ee=(R.getID3Data(X,0)||[]).length,ne=X.length;ee<ne;ee++)if(q(X,ee))return oe.logger.log("MPEG Audio sync word found !"),!0;return!1},U.canParse=function(X,ee){return function(ne,ye){return B(ne,ye)&&4<=ne.length-ye}(X,ee)},U.appendFrame=function(X,ee,ne){if(this.basePTS!==null)return lt(X,ee,ne,this.basePTS,this.frameIndex)},G}(de);var Be=y(524),Ce=y(923);function ze(te,W){var D=te==null?void 0:te.codec;return D&&D.length>4?D:D==="hvc1"||D==="hev1"?"hvc1.1.c.L120.90":D==="av01"?"av01.0.04M.08":D==="avc1"||W===Ce.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const He=function(){function te(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var W=te.prototype;return W.destroy=function(){},W.resetTimeStamp=function(D){this.initPTS=D,this.lastEndTime=null},W.resetNextTimestamp=function(){this.lastEndTime=null},W.resetInitSegment=function(D,G,U,X){this.audioCodec=G,this.videoCodec=U,this.generateInitSegment((0,J.patchEncyptionData)(D,X)),this.emitInitSegment=!0},W.generateInitSegment=function(D){var G=this.audioCodec,U=this.videoCodec;if(!D||!D.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var X=this.initData=(0,J.parseInitSegment)(D);G||(G=ze(X.audio,Ce.ElementaryStreamTypes.AUDIO)),U||(U=ze(X.video,Ce.ElementaryStreamTypes.VIDEO));var ee={};X.audio&&X.video?ee.audiovideo={container:"video/mp4",codec:G+","+U,initSegment:D,id:"main"}:X.audio?ee.audio={container:"audio/mp4",codec:G,initSegment:D,id:"audio"}:X.video?ee.video={container:"video/mp4",codec:U,initSegment:D,id:"main"}:oe.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=ee},W.remux=function(D,G,U,X,ee){var ne,ye=this.initPTS,Oe=this.lastEndTime,Pe={audio:void 0,video:void 0,text:X,id3:U,initSegment:void 0};(0,b.isFiniteNumber)(Oe)||(Oe=this.lastEndTime=ee||0);var Ke=G.samples;if(!Ke||!Ke.length)return Pe;var tt={initPTS:void 0,timescale:1},qe=this.initData;if(qe&&qe.length||(this.generateInitSegment(Ke),qe=this.initData),!qe||!qe.length)return oe.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),Pe;this.emitInitSegment&&(tt.tracks=this.initTracks,this.emitInitSegment=!1);var at=(0,J.getStartDTS)(qe,Ke);(0,b.isFiniteNumber)(ye)||(this.initPTS=tt.initPTS=ye=at-ee);var gt=(0,J.getDuration)(Ke,qe),Ct=D?at-ye:Oe,it=Ct+gt;(0,J.offsetStartDTS)(qe,Ke,ye),gt>0?this.lastEndTime=it:(oe.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var Nt=!!qe.audio,er=!!qe.video,Yt="";Nt&&(Yt+="audio"),er&&(Yt+="video");var Mt={data1:Ke,startPTS:Ct,startDTS:Ct,endPTS:it,endDTS:it,type:Yt,hasAudio:Nt,hasVideo:er,nb:1,dropped:0};Pe.audio=Mt.type==="audio"?Mt:void 0,Pe.video=Mt.type!=="audio"?Mt:void 0,Pe.initSegment=tt;var qt=(ne=this.initPTS)!=null?ne:0;return Pe.id3=(0,Be.flushTextTrackMetadataCueSamples)(U,ee,qt,qt),X.samples.length&&(Pe.text=(0,Be.flushTextTrackUserdataCueSamples)(X,ee,qt)),Pe},te}();var Ge;try{Ge=self.performance.now.bind(self.performance)}catch{oe.logger.debug("Unable to use Performance API on this environment"),Ge=self.Date.now}var et=[{demux:ve,remux:He},{demux:Ne,remux:Be.default},{demux:Te,remux:Be.default},{demux:ke,remux:Be.default}],nt=function(){function te(D,G,U,X,ee){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=D,this.typeSupported=G,this.config=U,this.vendor=X,this.id=ee}var W=te.prototype;return W.configure=function(D){this.transmuxConfig=D,this.decrypter&&this.decrypter.reset()},W.push=function(D,G,U,X){var ee=this,ne=U.transmuxing;ne.executeStart=Ge();var ye=new Uint8Array(D),Oe=this.currentTransmuxState,Pe=this.transmuxConfig;X&&(this.currentTransmuxState=X);var Ke=X||Oe,tt=Ke.contiguous,qe=Ke.discontinuity,at=Ke.trackSwitch,gt=Ke.accurateTimeOffset,Ct=Ke.timeOffset,it=Ke.initSegmentChange,Nt=Pe.audioCodec,er=Pe.videoCodec,Yt=Pe.defaultInitPts,Mt=Pe.duration,qt=Pe.initSegmentData,ot=function(vn,_r){var Ut=null;return vn.byteLength>0&&_r!=null&&_r.key!=null&&_r.iv!==null&&_r.method!=null&&(Ut=_r),Ut}(ye,G);if(ot&&ot.method==="AES-128"){var ur=this.getDecrypter();if(!ur.isSync())return this.decryptionPromise=ur.webCryptoDecrypt(ye,ot.key.buffer,ot.iv.buffer).then(function(vn){var _r=ee.push(vn,null,U);return ee.decryptionPromise=null,_r}),this.decryptionPromise;var qr=ur.softwareDecrypt(ye,ot.key.buffer,ot.iv.buffer);if(!qr)return ne.executeEnd=Ge(),ft(U);ye=new Uint8Array(qr)}var Vt=this.needsProbing(qe,at);Vt&&this.configureTransmuxer(ye),(qe||at||it||Vt)&&this.resetInitSegment(qt,Nt,er,Mt,G),(qe||it||Vt)&&this.resetInitialTimestamp(Yt),tt||this.resetContiguity();var zt=this.transmux(ye,ot,Ct,gt,U),Ar=this.currentTransmuxState;return Ar.contiguous=!0,Ar.discontinuity=!1,Ar.trackSwitch=!1,ne.executeEnd=Ge(),zt},W.flush=function(D){var G=this,U=D.transmuxing;U.executeStart=Ge();var X=this.decrypter,ee=this.currentTransmuxState,ne=this.decryptionPromise;if(ne)return ne.then(function(){return G.flush(D)});var ye=[],Oe=ee.timeOffset;if(X){var Pe=X.flush();Pe&&ye.push(this.push(Pe,null,D))}var Ke=this.demuxer,tt=this.remuxer;if(!Ke||!tt)return this.observer.emit(S.Events.ERROR,S.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),U.executeEnd=Ge(),[ft(D)];var qe=Ke.flush(Oe);return dt(qe)?qe.then(function(at){return G.flushRemux(ye,at,D),ye}):(this.flushRemux(ye,qe,D),ye)},W.flushRemux=function(D,G,U){var X=G.audioTrack,ee=G.videoTrack,ne=G.id3Track,ye=G.textTrack,Oe=this.currentTransmuxState,Pe=Oe.accurateTimeOffset,Ke=Oe.timeOffset;oe.logger.log("[transmuxer.ts]: Flushed fragment "+U.sn+(U.part>-1?" p: "+U.part:"")+" of level "+U.level);var tt=this.remuxer.remux(X,ee,ne,ye,Ke,Pe,!0,this.id);D.push({remuxResult:tt,chunkMeta:U}),U.transmuxing.executeEnd=Ge()},W.resetInitialTimestamp=function(D){var G=this.demuxer,U=this.remuxer;G&&U&&(G.resetTimeStamp(D),U.resetTimeStamp(D))},W.resetContiguity=function(){var D=this.demuxer,G=this.remuxer;D&&G&&(D.resetContiguity(),G.resetNextTimestamp())},W.resetInitSegment=function(D,G,U,X,ee){var ne=this.demuxer,ye=this.remuxer;ne&&ye&&(ne.resetInitSegment(D,G,U,X),ye.resetInitSegment(D,G,U,ee))},W.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},W.transmux=function(D,G,U,X,ee){return G&&G.method==="SAMPLE-AES"?this.transmuxSampleAes(D,G,U,X,ee):this.transmuxUnencrypted(D,U,X,ee)},W.transmuxUnencrypted=function(D,G,U,X){var ee=this.demuxer.demux(D,G,!1,!this.config.progressive),ne=ee.audioTrack,ye=ee.videoTrack,Oe=ee.id3Track,Pe=ee.textTrack;return{remuxResult:this.remuxer.remux(ne,ye,Oe,Pe,G,U,!1,this.id),chunkMeta:X}},W.transmuxSampleAes=function(D,G,U,X,ee){var ne=this;return this.demuxer.demuxSampleAes(D,G,U).then(function(ye){return{remuxResult:ne.remuxer.remux(ye.audioTrack,ye.videoTrack,ye.id3Track,ye.textTrack,U,X,!1,ne.id),chunkMeta:ee}})},W.configureTransmuxer=function(D){for(var G,U=this.config,X=this.observer,ee=this.typeSupported,ne=this.vendor,ye=0,Oe=et.length;ye<Oe;ye++)if(et[ye].demux.probe(D)){G=et[ye];break}G||(oe.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),G={demux:ve,remux:He});var Pe=this.demuxer,Ke=this.remuxer,tt=G.remux,qe=G.demux;Ke&&Ke instanceof tt||(this.remuxer=new tt(X,U,ee,ne)),Pe&&Pe instanceof qe||(this.demuxer=new qe(X,U,ee),this.probe=qe.probe)},W.needsProbing=function(D,G){return!this.demuxer||!this.remuxer||D||G},W.getDecrypter=function(){var D=this.decrypter;return D||(D=this.decrypter=new C.default(this.config)),D},te}(),ft=function(te){return{remuxResult:{},chunkMeta:te}};function dt(te){return"then"in te&&te.then instanceof Function}var Et=function(te,W,D,G,U){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=te,this.videoCodec=W,this.initSegmentData=D,this.duration=G,this.defaultInitPts=U},Ft=function(te,W,D,G,U,X){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=te,this.contiguous=W,this.accurateTimeOffset=D,this.trackSwitch=G,this.timeOffset=U,this.initSegmentChange=X}},973:(T,A,y)=>{var S,I;y.r(A),y.d(A,{ErrorDetails:()=>I,ErrorTypes:()=>S}),function(C){C.NETWORK_ERROR="networkError",C.MEDIA_ERROR="mediaError",C.KEY_SYSTEM_ERROR="keySystemError",C.MUX_ERROR="muxError",C.OTHER_ERROR="otherError"}(S||(S={})),function(C){C.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",C.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",C.KEY_SYSTEM_NO_SESSION="keySystemNoSession",C.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",C.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",C.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",C.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",C.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",C.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",C.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",C.MANIFEST_LOAD_ERROR="manifestLoadError",C.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",C.MANIFEST_PARSING_ERROR="manifestParsingError",C.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",C.LEVEL_EMPTY_ERROR="levelEmptyError",C.LEVEL_LOAD_ERROR="levelLoadError",C.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",C.LEVEL_SWITCH_ERROR="levelSwitchError",C.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",C.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",C.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",C.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",C.FRAG_LOAD_ERROR="fragLoadError",C.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",C.FRAG_DECRYPT_ERROR="fragDecryptError",C.FRAG_PARSING_ERROR="fragParsingError",C.REMUX_ALLOC_ERROR="remuxAllocError",C.KEY_LOAD_ERROR="keyLoadError",C.KEY_LOAD_TIMEOUT="keyLoadTimeOut",C.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",C.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",C.BUFFER_APPEND_ERROR="bufferAppendError",C.BUFFER_APPENDING_ERROR="bufferAppendingError",C.BUFFER_STALLED_ERROR="bufferStalledError",C.BUFFER_FULL_ERROR="bufferFullError",C.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",C.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",C.INTERNAL_EXCEPTION="internalException",C.INTERNAL_ABORTED="aborted",C.UNKNOWN="unknown"}(I||(I={}))},851:(T,A,y)=>{var S;y.r(A),y.d(A,{Events:()=>S}),function(I){I.MEDIA_ATTACHING="hlsMediaAttaching",I.MEDIA_ATTACHED="hlsMediaAttached",I.MEDIA_DETACHING="hlsMediaDetaching",I.MEDIA_DETACHED="hlsMediaDetached",I.BUFFER_RESET="hlsBufferReset",I.BUFFER_CODECS="hlsBufferCodecs",I.BUFFER_CREATED="hlsBufferCreated",I.BUFFER_APPENDING="hlsBufferAppending",I.BUFFER_APPENDED="hlsBufferAppended",I.BUFFER_EOS="hlsBufferEos",I.BUFFER_FLUSHING="hlsBufferFlushing",I.BUFFER_FLUSHED="hlsBufferFlushed",I.MANIFEST_LOADING="hlsManifestLoading",I.MANIFEST_LOADED="hlsManifestLoaded",I.MANIFEST_PARSED="hlsManifestParsed",I.LEVEL_SWITCHING="hlsLevelSwitching",I.LEVEL_SWITCHED="hlsLevelSwitched",I.LEVEL_LOADING="hlsLevelLoading",I.LEVEL_LOADED="hlsLevelLoaded",I.LEVEL_UPDATED="hlsLevelUpdated",I.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",I.LEVELS_UPDATED="hlsLevelsUpdated",I.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",I.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",I.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",I.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",I.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",I.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",I.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",I.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",I.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",I.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",I.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",I.CUES_PARSED="hlsCuesParsed",I.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",I.INIT_PTS_FOUND="hlsInitPtsFound",I.FRAG_LOADING="hlsFragLoading",I.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",I.FRAG_LOADED="hlsFragLoaded",I.FRAG_DECRYPTED="hlsFragDecrypted",I.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",I.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",I.FRAG_PARSING_METADATA="hlsFragParsingMetadata",I.FRAG_PARSED="hlsFragParsed",I.FRAG_BUFFERED="hlsFragBuffered",I.FRAG_CHANGED="hlsFragChanged",I.FPS_DROP="hlsFpsDrop",I.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",I.ERROR="hlsError",I.DESTROYING="hlsDestroying",I.KEY_LOADING="hlsKeyLoading",I.KEY_LOADED="hlsKeyLoaded",I.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",I.BACK_BUFFER_REACHED="hlsBackBufferReached"}(S||(S={}))},76:(T,A,y)=>{y.r(A),y.d(A,{default:()=>Dl});var S,I=y(945),C=y(965),b=y(851),R=y(973),P=y(93),ce=/^(\d+)x(\d+)$/,J=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,ie=function(){function E(n){for(var s in typeof n=="string"&&(n=E.parseAttrList(n)),n)n.hasOwnProperty(s)&&(this[s]=n[s])}var h=E.prototype;return h.decimalInteger=function(n){var s=parseInt(this[n],10);return s>Number.MAX_SAFE_INTEGER?1/0:s},h.hexadecimalInteger=function(n){if(this[n]){var s=(this[n]||"0x").slice(2);s=(1&s.length?"0":"")+s;for(var o=new Uint8Array(s.length/2),l=0;l<s.length/2;l++)o[l]=parseInt(s.slice(2*l,2*l+2),16);return o}return null},h.hexadecimalIntegerAsNumber=function(n){var s=parseInt(this[n],16);return s>Number.MAX_SAFE_INTEGER?1/0:s},h.decimalFloatingPoint=function(n){return parseFloat(this[n])},h.optionalFloat=function(n,s){var o=this[n];return o?parseFloat(o):s},h.enumeratedString=function(n){return this[n]},h.bool=function(n){return this[n]==="YES"},h.decimalResolution=function(n){var s=ce.exec(this[n]);if(s!==null)return{width:parseInt(s[1],10),height:parseInt(s[2],10)}},E.parseAttrList=function(n){var s,o={};for(J.lastIndex=0;(s=J.exec(n))!==null;){var l=s[2];l.indexOf('"')===0&&l.lastIndexOf('"')===l.length-1&&(l=l.slice(1,-1)),o[s[1]]=l}return o},E}();function fe(){return fe=Object.assign?Object.assign.bind():function(E){for(var h=1;h<arguments.length;h++){var n=arguments[h];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(E[s]=n[s])}return E},fe.apply(this,arguments)}function Q(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}(function(E){E.ID="ID",E.CLASS="CLASS",E.START_DATE="START-DATE",E.DURATION="DURATION",E.END_DATE="END-DATE",E.END_ON_NEXT="END-ON-NEXT",E.PLANNED_DURATION="PLANNED-DURATION",E.SCTE35_OUT="SCTE35-OUT",E.SCTE35_IN="SCTE35-IN"})(S||(S={}));var de=function(){function E(s,o){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,o){var l=o.attr;for(var c in l)if(Object.prototype.hasOwnProperty.call(s,c)&&s[c]!==l[c]){P.logger.warn('DATERANGE tag attribute: "'+c+'" does not match for tags with ID: "'+s.ID+'"'),this._badValueForSameId=c;break}s=fe(new ie({}),l,s)}if(this.attr=s,this._startDate=new Date(s[S.START_DATE]),S.END_DATE in this.attr){var a=new Date(this.attr[S.END_DATE]);(0,C.isFiniteNumber)(a.getTime())&&(this._endDate=a)}}var h,n;return h=E,(n=[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var s=this.duration;return s!==null?new Date(this._startDate.getTime()+1e3*s):null}},{key:"duration",get:function(){if(S.DURATION in this.attr){var s=this.attr.decimalFloatingPoint(S.DURATION);if((0,C.isFiniteNumber)(s))return s}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return S.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(S.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(S.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,C.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}])&&Q(h.prototype,n),Object.defineProperty(h,"prototype",{writable:!1}),E}(),oe=y(923);function se(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}var ae,we,Ue,Je=function(){function E(s){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=s}var h,n;return E.prototype.reloaded=function(s){if(!s)return this.advanced=!0,void(this.updated=!0);var o=this.lastPartSn-s.lastPartSn,l=this.lastPartIndex-s.lastPartIndex;this.updated=this.endSN!==s.endSN||!!l||!!o,this.advanced=this.endSN>s.endSN||o>0||o===0&&l>0,this.updated||this.advanced?this.misses=Math.floor(.6*s.misses):this.misses=s.misses+1,this.availabilityDelay=s.availabilityDelay},h=E,(n=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&(0,C.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var s=this.driftEndTime-this.driftStartTime;return s>0?1e3*(this.driftEnd-this.driftStart)/s:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var s;return(s=this.partList)!==null&&s!==void 0&&s.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var s;return(s=this.fragments)!==null&&s!==void 0&&s.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var s;return(s=this.partList)!==null&&s!==void 0&&s.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var s;return(s=this.partList)!==null&&s!==void 0&&s.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&se(h.prototype,n),Object.defineProperty(h,"prototype",{writable:!1}),E}();function ue(E){return Uint8Array.from(atob(E),function(h){return h.charCodeAt(0)})}function w(E){return Uint8Array.from(unescape(encodeURIComponent(E)),function(h){return h.charCodeAt(0)})}function z(E){switch(E){case we.FAIRPLAY:return ae.FAIRPLAY;case we.PLAYREADY:return ae.PLAYREADY;case we.WIDEVINE:return ae.WIDEVINE;case we.CLEARKEY:return ae.CLEARKEY}}function H(E){switch(E){case ae.FAIRPLAY:return we.FAIRPLAY;case ae.PLAYREADY:return we.PLAYREADY;case ae.WIDEVINE:return we.WIDEVINE;case ae.CLEARKEY:return we.CLEARKEY}}function Te(E){var h=E.drmSystems,n=E.widevineLicenseUrl,s=h?[ae.FAIRPLAY,ae.WIDEVINE,ae.PLAYREADY,ae.CLEARKEY].filter(function(o){return!!h[o]}):[];return!s[ae.WIDEVINE]&&n&&s.push(ae.WIDEVINE),s}(function(E){E.CLEARKEY="org.w3.clearkey",E.FAIRPLAY="com.apple.fps",E.PLAYREADY="com.microsoft.playready",E.WIDEVINE="com.widevine.alpha"})(ae||(ae={})),function(E){E.CLEARKEY="org.w3.clearkey",E.FAIRPLAY="com.apple.streamingkeydelivery",E.PLAYREADY="com.microsoft.playready",E.WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"}(we||(we={})),function(E){E.WIDEVINE="edef8ba979d64acea3c827dcd51d21ed"}(Ue||(Ue={}));var Re=typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null,ve=y(63),pe={},We=function(){function E(n,s,o,l,c){l===void 0&&(l=[1]),c===void 0&&(c=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=n,this.uri=s,this.keyFormat=o,this.keyFormatVersions=l,this.iv=c,this.encrypted=!!n&&n!=="NONE",this.isCommonEncryption=this.encrypted&&n!=="AES-128"}E.clearKeyUriToKeyIdMap=function(){pe={}};var h=E.prototype;return h.isSupported=function(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;switch(this.keyFormat){case"identity":return this.method==="SAMPLE-AES";case we.FAIRPLAY:case we.WIDEVINE:case we.PLAYREADY:case we.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1},h.getDecryptData=function(n){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof n!="number"&&(this.method!=="AES-128"||this.iv||P.logger.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),n=0);var s=function(j){for(var K=new Uint8Array(16),Z=12;Z<16;Z++)K[Z]=j>>8*(15-Z)&255;return K}(n);return new E(this.method,this.uri,"identity",this.keyFormatVersions,s)}var o=function(j){var K,Z,he=j.split(":"),_e=null;if(he[0]==="data"&&he.length===2){var Ee=he[1].split(";"),De=Ee[Ee.length-1].split(",");if(De.length===2){var $e=De[0]==="base64",st=De[1];$e?(Ee.splice(-1,1),_e=ue(st)):(K=w(st).subarray(0,16),(Z=new Uint8Array(16)).set(K,16-K.length),_e=Z)}}return _e}(this.uri);if(o)switch(this.keyFormat){case we.WIDEVINE:this.pssh=o,o.length>=22&&(this.keyId=o.subarray(o.length-22,o.length-6));break;case we.PLAYREADY:var l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=(0,ve.mp4pssh)(l,null,o);var c=new Uint16Array(o.buffer,o.byteOffset,o.byteLength/2),a=String.fromCharCode.apply(null,Array.from(c)),f=a.substring(a.indexOf("<"),a.length),g=new DOMParser().parseFromString(f,"text/xml").getElementsByTagName("KID")[0];if(g){var p=g.childNodes[0]?g.childNodes[0].nodeValue:g.getAttribute("VALUE");if(p){var v=ue(p).subarray(0,16);(function(j){var K=function(Z,he,_e){var Ee=Z[he];Z[he]=Z[_e],Z[_e]=Ee};K(j,0,3),K(j,1,2),K(j,4,5),K(j,6,7)})(v),this.keyId=v}}break;default:var _=o.subarray(0,16);if(_.length!==16){var L=new Uint8Array(16);L.set(_,16-_.length),_=L}this.keyId=_}if(!this.keyId||this.keyId.byteLength!==16){var x=pe[this.uri];if(!x){var M=Object.keys(pe).length%Number.MAX_SAFE_INTEGER;x=new Uint8Array(16),new DataView(x.buffer,12,4).setUint32(0,M),pe[this.uri]=x}this.keyId=x}return this},E}(),Ze={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function Qe(E,h){return MediaSource.isTypeSupported((h||"video")+'/mp4;codecs="'+E+'"')}function Ve(){return Ve=Object.assign?Object.assign.bind():function(E){for(var h=1;h<arguments.length;h++){var n=arguments[h];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(E[s]=n[s])}return E},Ve.apply(this,arguments)}var lt=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+|#EXT-X-SESSION-KEY:([^\n\r]*)[\r\n]+/g,At=/#EXT-X-MEDIA:(.*)/g,B=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),$=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),q=function(){function E(){}return E.findGroup=function(h,n){for(var s=0;s<h.length;s++){var o=h[s];if(o.id===n)return o}},E.convertAVC1ToAVCOTI=function(h){var n=h.split(".");if(n.length>2){var s=n.shift()+".";return(s+=parseInt(n.shift()).toString(16))+("000"+parseInt(n.shift()).toString(16)).slice(-4)}return h},E.resolve=function(h,n){return(0,I.buildAbsoluteURL)(n,h,{alwaysNormalize:!0})},E.parseMasterPlaylist=function(h,n){var s,o=[],l=[],c={},a=[],f=!1;for(lt.lastIndex=0;(s=lt.exec(h))!=null;)if(s[1]){var g,p=new ie(s[1]),v={attrs:p,bitrate:p.decimalInteger("AVERAGE-BANDWIDTH")||p.decimalInteger("BANDWIDTH"),name:p.NAME,url:E.resolve(s[2],n)},_=p.decimalResolution("RESOLUTION");_&&(v.width=_.width,v.height=_.height),Ae((p.CODECS||"").split(/[ ,]+/).filter(function(j){return j}),v),v.videoCodec&&v.videoCodec.indexOf("avc1")!==-1&&(v.videoCodec=E.convertAVC1ToAVCOTI(v.videoCodec)),(g=v.unknownCodecs)!==null&&g!==void 0&&g.length||l.push(v),o.push(v)}else if(s[3]){var L=new ie(s[3]);L["DATA-ID"]&&(f=!0,c[L["DATA-ID"]]=L)}else if(s[4]){var x=s[4],M=ge(x,n);M.encrypted&&M.isSupported()?a.push(M):P.logger.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+x+'"')}return{levels:l.length>0&&l.length<o.length?l:o,sessionData:f?c:null,sessionKeys:a.length?a:null}},E.parseMasterPlaylistMedia=function(h,n,s,o){var l;o===void 0&&(o=[]);var c=[],a=0;for(At.lastIndex=0;(l=At.exec(h))!==null;){var f=new ie(l[1]);if(f.TYPE===s){var g={attrs:f,bitrate:0,id:a++,groupId:f["GROUP-ID"],instreamId:f["INSTREAM-ID"],name:f.NAME||f.LANGUAGE||"",type:s,default:f.bool("DEFAULT"),autoselect:f.bool("AUTOSELECT"),forced:f.bool("FORCED"),lang:f.LANGUAGE,url:f.URI?E.resolve(f.URI,n):""};if(o.length){var p=E.findGroup(o,g.groupId)||o[0];xe(g,p,"audioCodec"),xe(g,p,"textCodec")}c.push(g)}}return c},E.parseLevelPlaylist=function(h,n,s,o,l){var c,a,f,g=new Je(n),p=g.fragments,v=null,_=0,L=0,x=0,M=0,j=null,K=new oe.Fragment(o,n),Z=-1,he=!1;for(B.lastIndex=0,g.m3u8=h;(c=B.exec(h))!==null;){he&&(he=!1,(K=new oe.Fragment(o,n)).start=x,K.sn=_,K.cc=M,K.level=s,v&&(K.initSegment=v,K.rawProgramDateTime=v.rawProgramDateTime,v.rawProgramDateTime=null));var _e=c[1];if(_e){K.duration=parseFloat(_e);var Ee=(" "+c[2]).slice(1);K.title=Ee||null,K.tagList.push(Ee?["INF",_e,Ee]:["INF",_e])}else if(c[3]){if((0,C.isFiniteNumber)(K.duration)){if(K.start=x,f){K.levelkeys=f;var De=g.encryptedFragments;!K.levelkeys||!Object.keys(K.levelkeys).some(function(Cr){return K.levelkeys[Cr].isCommonEncryption})||De.length&&De[De.length-1].levelkeys===f||De.push(K)}K.sn=_,K.level=s,K.cc=M,K.urlId=l,p.push(K),K.relurl=(" "+c[3]).slice(1),Ie(K,j),j=K,x+=K.duration,_++,L=0,he=!0}}else if(c[4]){var $e=(" "+c[4]).slice(1);j?K.setByteRange($e,j):K.setByteRange($e)}else if(c[5])K.rawProgramDateTime=(" "+c[5]).slice(1),K.tagList.push(["PROGRAM-DATE-TIME",K.rawProgramDateTime]),Z===-1&&(Z=p.length);else{if(!(c=c[0].match($))){P.logger.warn("No matches on slow regex match for level playlist!");continue}for(a=1;a<c.length&&c[a]===void 0;a++);var st=(" "+c[a]).slice(1),Se=(" "+c[a+1]).slice(1),Xe=c[a+2]?(" "+c[a+2]).slice(1):"";switch(st){case"PLAYLIST-TYPE":g.type=Se.toUpperCase();break;case"MEDIA-SEQUENCE":_=g.startSN=parseInt(Se);break;case"SKIP":var je=new ie(Se),mt=je.decimalInteger("SKIPPED-SEGMENTS");if((0,C.isFiniteNumber)(mt)){g.skippedSegments=mt;for(var xt=mt;xt--;)p.unshift(null);_+=mt}var Tt=je.enumeratedString("RECENTLY-REMOVED-DATERANGES");Tt&&(g.recentlyRemovedDateranges=Tt.split("	"));break;case"TARGETDURATION":g.targetduration=parseFloat(Se);break;case"VERSION":g.version=parseInt(Se);break;case"EXTM3U":break;case"ENDLIST":g.live=!1;break;case"#":(Se||Xe)&&K.tagList.push(Xe?[Se,Xe]:[Se]);break;case"DISCONTINUITY":M++,K.tagList.push(["DIS"]);break;case"GAP":K.tagList.push([st]);break;case"BITRATE":K.tagList.push([st,Se]);break;case"DATERANGE":var _t=new ie(Se),Lt=new de(_t,g.dateRanges[_t.ID]);Lt.isValid||g.skippedSegments?g.dateRanges[Lt.id]=Lt:P.logger.warn('Ignoring invalid DATERANGE tag: "'+Se+'"'),K.tagList.push(["EXT-X-DATERANGE",Se]);break;case"DISCONTINUITY-SEQUENCE":M=parseInt(Se);break;case"KEY":var Xt=ge(Se,n);if(Xt.isSupported()){if(Xt.method==="NONE"){f=void 0;break}f||(f={}),f[Xt.keyFormat]&&(f=Ve({},f)),f[Xt.keyFormat]=Xt}else P.logger.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+Se+'"');break;case"START":var Wt=new ie(Se).decimalFloatingPoint("TIME-OFFSET");(0,C.isFiniteNumber)(Wt)&&(g.startTimeOffset=Wt);break;case"MAP":var Ht=new ie(Se);if(K.duration){var Qt=new oe.Fragment(o,n);N(Qt,Ht,s,f),v=Qt,K.initSegment=v,v.rawProgramDateTime&&!K.rawProgramDateTime&&(K.rawProgramDateTime=v.rawProgramDateTime)}else N(K,Ht,s,f),v=K,he=!0;break;case"SERVER-CONTROL":var pr=new ie(Se);g.canBlockReload=pr.bool("CAN-BLOCK-RELOAD"),g.canSkipUntil=pr.optionalFloat("CAN-SKIP-UNTIL",0),g.canSkipDateRanges=g.canSkipUntil>0&&pr.bool("CAN-SKIP-DATERANGES"),g.partHoldBack=pr.optionalFloat("PART-HOLD-BACK",0),g.holdBack=pr.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var ao=new ie(Se);g.partTarget=ao.decimalFloatingPoint("PART-TARGET");break;case"PART":var wr=g.partList;wr||(wr=g.partList=[]);var Ii=L>0?wr[wr.length-1]:void 0,Ci=L++,Li=new oe.Part(new ie(Se),K,n,Ci,Ii);wr.push(Li),K.duration+=Li.duration;break;case"PRELOAD-HINT":var ct=new ie(Se);g.preloadHint=ct;break;case"RENDITION-REPORT":var vt=new ie(Se);g.renditionReports=g.renditionReports||[],g.renditionReports.push(vt);break;default:P.logger.warn("line parsed but not handled: "+c)}}}j&&!j.relurl?(p.pop(),x-=j.duration,g.partList&&(g.fragmentHint=j)):g.partList&&(Ie(K,j),K.cc=M,g.fragmentHint=K);var qn=p.length,Qr=p[0],Mr=p[qn-1];if((x+=g.skippedSegments*g.targetduration)>0&&qn&&Mr){g.averagetargetduration=x/qn;var Wn=Mr.sn;g.endSN=Wn!=="initSegment"?Wn:0,g.live||(Mr.endList=!0),Qr&&(g.startCC=Qr.cc)}else g.endSN=0,g.startCC=0;return g.fragmentHint&&(x+=g.fragmentHint.duration),g.totalduration=x,g.endCC=M,Z>0&&function(Cr,zr){for(var an=Cr[zr],Tr=zr;Tr--;){var on=Cr[Tr];if(!on)return;on.programDateTime=an.programDateTime-1e3*on.duration,an=on}}(p,Z),g},E}();function ge(E,h){var n,s,o=new ie(E),l=(n=o.enumeratedString("METHOD"))!=null?n:"",c=o.URI,a=o.hexadecimalInteger("IV"),f=o.enumeratedString("KEYFORMATVERSIONS"),g=(s=o.enumeratedString("KEYFORMAT"))!=null?s:"identity";c&&o.IV&&!a&&P.logger.error("Invalid IV: "+o.IV);var p=c?q.resolve(c,h):"",v=(f||"1").split("/").map(Number).filter(Number.isFinite);return new We(l,p,g,v,a)}function Ae(E,h){["video","audio","text"].forEach(function(n){var s=E.filter(function(l){return function(c,a){var f=Ze[a];return!!f&&f[c.slice(0,4)]===!0}(l,n)});if(s.length){var o=s.filter(function(l){return l.lastIndexOf("avc1",0)===0||l.lastIndexOf("mp4a",0)===0});h[n+"Codec"]=o.length>0?o[0]:s[0],E=E.filter(function(l){return s.indexOf(l)===-1})}}),h.unknownCodecs=E}function xe(E,h,n){var s=h[n];s&&(E[n]=s)}function Ie(E,h){E.rawProgramDateTime?E.programDateTime=Date.parse(E.rawProgramDateTime):h!=null&&h.programDateTime&&(E.programDateTime=h.endProgramDateTime),(0,C.isFiniteNumber)(E.programDateTime)||(E.programDateTime=null,E.rawProgramDateTime=null)}function N(E,h,n,s){E.relurl=h.URI,h.BYTERANGE&&E.setByteRange(h.BYTERANGE),E.level=n,E.sn="initSegment",s&&(E.levelkeys=s),E.initSegment=null}var O=y(308);function V(E,h){var n=E.url;return n!==void 0&&n.indexOf("data:")!==0||(n=h.url),n}const re=function(){function E(n){this.hls=void 0,this.loaders=Object.create(null),this.hls=n,this.registerListeners()}var h=E.prototype;return h.startLoad=function(n){},h.stopLoad=function(){this.destroyInternalLoaders()},h.registerListeners=function(){var n=this.hls;n.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(b.Events.LEVEL_LOADING,this.onLevelLoading,this),n.on(b.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),n.on(b.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},h.unregisterListeners=function(){var n=this.hls;n.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(b.Events.LEVEL_LOADING,this.onLevelLoading,this),n.off(b.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),n.off(b.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},h.createInternalLoader=function(n){var s=this.hls.config,o=s.pLoader,l=s.loader,c=new(o||l)(s);return n.loader=c,this.loaders[n.type]=c,c},h.getInternalLoader=function(n){return this.loaders[n.type]},h.resetInternalLoader=function(n){this.loaders[n]&&delete this.loaders[n]},h.destroyInternalLoaders=function(){for(var n in this.loaders){var s=this.loaders[n];s&&s.destroy(),this.resetInternalLoader(n)}},h.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},h.onManifestLoading=function(n,s){var o=s.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:O.PlaylistContextType.MANIFEST,url:o,deliveryDirectives:null})},h.onLevelLoading=function(n,s){var o=s.id,l=s.level,c=s.url,a=s.deliveryDirectives;this.load({id:o,groupId:null,level:l,responseType:"text",type:O.PlaylistContextType.LEVEL,url:c,deliveryDirectives:a})},h.onAudioTrackLoading=function(n,s){var o=s.id,l=s.groupId,c=s.url,a=s.deliveryDirectives;this.load({id:o,groupId:l,level:null,responseType:"text",type:O.PlaylistContextType.AUDIO_TRACK,url:c,deliveryDirectives:a})},h.onSubtitleTrackLoading=function(n,s){var o=s.id,l=s.groupId,c=s.url,a=s.deliveryDirectives;this.load({id:o,groupId:l,level:null,responseType:"text",type:O.PlaylistContextType.SUBTITLE_TRACK,url:c,deliveryDirectives:a})},h.load=function(n){var s,o,l,c,a,f,g=this.hls.config,p=this.getInternalLoader(n);if(p){var v=p.context;if(v&&v.url===n.url)return void P.logger.trace("[playlist-loader]: playlist request ongoing");P.logger.log("[playlist-loader]: aborting previous loader for type: "+n.type),p.abort()}switch(n.type){case O.PlaylistContextType.MANIFEST:o=g.manifestLoadingMaxRetry,l=g.manifestLoadingTimeOut,c=g.manifestLoadingRetryDelay,a=g.manifestLoadingMaxRetryTimeout;break;case O.PlaylistContextType.LEVEL:case O.PlaylistContextType.AUDIO_TRACK:case O.PlaylistContextType.SUBTITLE_TRACK:o=0,l=g.levelLoadingTimeOut;break;default:o=g.levelLoadingMaxRetry,l=g.levelLoadingTimeOut,c=g.levelLoadingRetryDelay,a=g.levelLoadingMaxRetryTimeout}if(p=this.createInternalLoader(n),(s=n.deliveryDirectives)!==null&&s!==void 0&&s.part&&(n.type===O.PlaylistContextType.LEVEL&&n.level!==null?f=this.hls.levels[n.level].details:n.type===O.PlaylistContextType.AUDIO_TRACK&&n.id!==null?f=this.hls.audioTracks[n.id].details:n.type===O.PlaylistContextType.SUBTITLE_TRACK&&n.id!==null&&(f=this.hls.subtitleTracks[n.id].details),f)){var _=f.partTarget,L=f.targetduration;_&&L&&(l=Math.min(1e3*Math.max(3*_,.8*L),l))}var x={timeout:l,maxRetry:o,retryDelay:c,maxRetryDelay:a,highWaterMark:0},M={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};p.load(n,x,M)},h.loadsuccess=function(n,s,o,l){l===void 0&&(l=null),this.resetInternalLoader(o.type);var c=n.data;c.indexOf("#EXTM3U")===0?(s.parsing.start=performance.now(),c.indexOf("#EXTINF:")>0||c.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(n,s,o,l):this.handleMasterPlaylist(n,s,o,l)):this.handleManifestParsingError(n,o,"no EXTM3U delimiter",l)},h.loaderror=function(n,s,o){o===void 0&&(o=null),this.handleNetworkError(s,o,!1,n)},h.loadtimeout=function(n,s,o){o===void 0&&(o=null),this.handleNetworkError(s,o,!0)},h.handleMasterPlaylist=function(n,s,o,l){var c=this.hls,a=n.data,f=V(n,o),g=q.parseMasterPlaylist(a,f),p=g.levels,v=g.sessionData,_=g.sessionKeys;if(p.length){var L=p.map(function(Z){return{id:Z.attrs.AUDIO,audioCodec:Z.audioCodec}}),x=p.map(function(Z){return{id:Z.attrs.SUBTITLES,textCodec:Z.textCodec}}),M=q.parseMasterPlaylistMedia(a,f,"AUDIO",L),j=q.parseMasterPlaylistMedia(a,f,"SUBTITLES",x),K=q.parseMasterPlaylistMedia(a,f,"CLOSED-CAPTIONS");M.length&&(M.some(function(Z){return!Z.url})||!p[0].audioCodec||p[0].attrs.AUDIO||(P.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),M.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ie({}),bitrate:0,url:""}))),c.trigger(b.Events.MANIFEST_LOADED,{levels:p,audioTracks:M,subtitles:j,captions:K,url:f,stats:s,networkDetails:l,sessionData:v,sessionKeys:_})}else this.handleManifestParsingError(n,o,"no level found in manifest",l)},h.handleTrackOrLevelPlaylist=function(n,s,o,l){var c=this.hls,a=o.id,f=o.level,g=o.type,p=V(n,o),v=(0,C.isFiniteNumber)(a)?a:0,_=(0,C.isFiniteNumber)(f)?f:v,L=function(j){switch(j.type){case O.PlaylistContextType.AUDIO_TRACK:return O.PlaylistLevelType.AUDIO;case O.PlaylistContextType.SUBTITLE_TRACK:return O.PlaylistLevelType.SUBTITLE;default:return O.PlaylistLevelType.MAIN}}(o),x=q.parseLevelPlaylist(n.data,p,_,L,v);if(x.fragments.length){if(g===O.PlaylistContextType.MANIFEST){var M={attrs:new ie({}),bitrate:0,details:x,name:"",url:p};c.trigger(b.Events.MANIFEST_LOADED,{levels:[M],audioTracks:[],url:p,stats:s,networkDetails:l,sessionData:null,sessionKeys:null})}s.parsing.end=performance.now(),o.levelDetails=x,this.handlePlaylistLoaded(n,s,o,l)}else c.trigger(b.Events.ERROR,{type:R.ErrorTypes.NETWORK_ERROR,details:R.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:p,reason:"no fragments found in level",level:typeof o.level=="number"?o.level:void 0})},h.handleManifestParsingError=function(n,s,o,l){this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.NETWORK_ERROR,details:R.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:s.type===O.PlaylistContextType.MANIFEST,url:n.url,reason:o,response:n,context:s,networkDetails:l})},h.handleNetworkError=function(n,s,o,l){o===void 0&&(o=!1),P.logger.warn("[playlist-loader]: A network "+(o?"timeout":"error")+" occurred while loading "+n.type+" level: "+n.level+" id: "+n.id+' group-id: "'+n.groupId+'"');var c=R.ErrorDetails.UNKNOWN,a=!1,f=this.getInternalLoader(n);switch(n.type){case O.PlaylistContextType.MANIFEST:c=o?R.ErrorDetails.MANIFEST_LOAD_TIMEOUT:R.ErrorDetails.MANIFEST_LOAD_ERROR,a=!0;break;case O.PlaylistContextType.LEVEL:c=o?R.ErrorDetails.LEVEL_LOAD_TIMEOUT:R.ErrorDetails.LEVEL_LOAD_ERROR,a=!1;break;case O.PlaylistContextType.AUDIO_TRACK:c=o?R.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:R.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,a=!1;break;case O.PlaylistContextType.SUBTITLE_TRACK:c=o?R.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:R.ErrorDetails.SUBTITLE_LOAD_ERROR,a=!1}f&&this.resetInternalLoader(n.type);var g={type:R.ErrorTypes.NETWORK_ERROR,details:c,fatal:a,url:n.url,loader:f,context:n,networkDetails:s};l&&(g.response=l),this.hls.trigger(b.Events.ERROR,g)},h.handlePlaylistLoaded=function(n,s,o,l){var c=o.type,a=o.level,f=o.id,g=o.groupId,p=o.loader,v=o.levelDetails,_=o.deliveryDirectives;if(v!=null&&v.targetduration){if(p)switch(v.live&&(p.getCacheAge&&(v.ageHeader=p.getCacheAge()||0),p.getCacheAge&&!isNaN(v.ageHeader)||(v.ageHeader=0)),c){case O.PlaylistContextType.MANIFEST:case O.PlaylistContextType.LEVEL:this.hls.trigger(b.Events.LEVEL_LOADED,{details:v,level:a||0,id:f||0,stats:s,networkDetails:l,deliveryDirectives:_});break;case O.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(b.Events.AUDIO_TRACK_LOADED,{details:v,id:f||0,groupId:g||"",stats:s,networkDetails:l,deliveryDirectives:_});break;case O.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(b.Events.SUBTITLE_TRACK_LOADED,{details:v,id:f||0,groupId:g||"",stats:s,networkDetails:l,deliveryDirectives:_})}}else this.handleManifestParsingError(n,o,"invalid target duration",l)},E}();function me(E,h){var n;try{n=new Event("addtrack")}catch{(n=document.createEvent("Event")).initEvent("addtrack",!1,!1)}n.track=E,h.dispatchEvent(n)}function Ne(E,h){var n=E.mode;if(n==="disabled"&&(E.mode="hidden"),E.cues&&!E.cues.getCueById(h.id))try{if(E.addCue(h),!E.cues.getCueById(h.id))throw new Error("addCue is failed for: "+h)}catch(o){P.logger.debug("[texttrack-utils]: "+o);var s=new self.TextTrackCue(h.startTime,h.endTime,h.text);s.id=h.id,E.addCue(s)}n==="disabled"&&(E.mode=n)}function Me(E){var h=E.mode;if(h==="disabled"&&(E.mode="hidden"),E.cues)for(var n=E.cues.length;n--;)E.removeCue(E.cues[n]);h==="disabled"&&(E.mode=h)}function ke(E,h,n,s){var o=E.mode;if(o==="disabled"&&(E.mode="hidden"),E.cues&&E.cues.length>0)for(var l=function(a,f,g){var p=[],v=function(M,j){if(j<M[0].startTime)return 0;var K=M.length-1;if(j>M[K].endTime)return-1;for(var Z=0,he=K;Z<=he;){var _e=Math.floor((he+Z)/2);if(j<M[_e].startTime)he=_e-1;else{if(!(j>M[_e].startTime&&Z<K))return _e;Z=_e+1}}return M[Z].startTime-j<j-M[he].startTime?Z:he}(a,f);if(v>-1)for(var _=v,L=a.length;_<L;_++){var x=a[_];if(x.startTime>=f&&x.endTime<=g)p.push(x);else if(x.startTime>g)return p}return p}(E.cues,h,n),c=0;c<l.length;c++)s&&!s(l[c])||E.removeCue(l[c]);o==="disabled"&&(E.mode=o)}var Be=y(181),Ce=y(856);function ze(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var He=function(){var E=ze();try{new E(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function Ge(E,h){return E.getTime()/1e3-h}const et=function(){function E(n){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=n,this._registerListeners()}var h=E.prototype;return h.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},h._registerListeners=function(){var n=this.hls;n.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(b.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),n.on(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),n.on(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},h._unregisterListeners=function(){var n=this.hls;n.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(b.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),n.off(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),n.off(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},h.onMediaAttached=function(n,s){this.media=s.media},h.onMediaDetaching=function(){this.id3Track&&(Me(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},h.onManifestLoading=function(){this.dateRangeCuesAppended={}},h.createTrack=function(n){var s=this.getID3Track(n.textTracks);return s.mode="hidden",s},h.getID3Track=function(n){if(this.media){for(var s=0;s<n.length;s++){var o=n[s];if(o.kind==="metadata"&&o.label==="id3")return me(o,this.media),o}return this.media.addTextTrack("metadata","id3")}},h.onFragParsingMetadata=function(n,s){if(this.media){var o=this.hls.config,l=o.enableEmsgMetadataCues,c=o.enableID3MetadataCues;if(l||c){var a=s.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var f=ze(),g=0;g<a.length;g++){var p=a[g].type;if((p!==Ce.MetadataSchema.emsg||l)&&c){var v=Be.getID3Frames(a[g].data);if(v){var _=a[g].pts,L=_+a[g].duration;L>He&&(L=He),L-_<=0&&(L=_+.25);for(var x=0;x<v.length;x++){var M=v[x];if(!Be.isTimeStampFrame(M)){this.updateId3CueEnds(_);var j=new f(_,L,"");j.value=M,p&&(j.type=p),this.id3Track.addCue(j)}}}}}}}},h.updateId3CueEnds=function(n){var s,o=(s=this.id3Track)===null||s===void 0?void 0:s.cues;if(o)for(var l=o.length;l--;){var c=o[l];c.startTime<n&&c.endTime===He&&(c.endTime=n)}},h.onBufferFlushing=function(n,s){var o=s.startOffset,l=s.endOffset,c=s.type,a=this.id3Track,f=this.hls;if(f){var g=f.config,p=g.enableEmsgMetadataCues,v=g.enableID3MetadataCues;a&&(p||v)&&ke(a,o,l,c==="audio"?function(_){return _.type===Ce.MetadataSchema.audioId3&&v}:c==="video"?function(_){return _.type===Ce.MetadataSchema.emsg&&p}:function(_){return _.type===Ce.MetadataSchema.audioId3&&v||_.type===Ce.MetadataSchema.emsg&&p})}},h.onLevelUpdated=function(n,s){var o=this,l=s.details;if(this.media&&l.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var c=this.dateRangeCuesAppended,a=this.id3Track,f=l.dateRanges,g=Object.keys(f);if(a)for(var p=Object.keys(c).filter(function(Z){return!g.includes(Z)}),v=function(Z){var he=p[Z];Object.keys(c[he].cues).forEach(function(_e){a.removeCue(c[he].cues[_e])}),delete c[he]},_=p.length;_--;)v(_);var L=l.fragments[l.fragments.length-1];if(g.length!==0&&(0,C.isFiniteNumber)(L==null?void 0:L.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var x=L.programDateTime/1e3-L.start,M=ze(),j=function(Z){var he=g[Z],_e=f[he],Ee=c[he],De=(Ee==null?void 0:Ee.cues)||{},$e=(Ee==null?void 0:Ee.durationKnown)||!1,st=Ge(_e.startDate,x),Se=He,Xe=_e.endDate;if(Xe)Se=Ge(Xe,x),$e=!0;else if(_e.endOnNext&&!$e){var je=g.reduce(function(Wt,Ht){var Qt=f[Ht];return Qt.class===_e.class&&Qt.id!==Ht&&Qt.startDate>_e.startDate&&Wt.push(Qt),Wt},[]).sort(function(Wt,Ht){return Wt.startDate.getTime()-Ht.startDate.getTime()})[0];je&&(Se=Ge(je.startDate,x),$e=!0)}for(var mt,xt=Object.keys(_e.attr),Tt=0;Tt<xt.length;Tt++){var _t=xt[Tt];if(_t!==S.ID&&_t!==S.CLASS&&_t!==S.START_DATE&&_t!==S.DURATION&&_t!==S.END_DATE&&_t!==S.END_ON_NEXT){var Lt=De[_t];if(Lt)$e&&!Ee.durationKnown&&(Lt.endTime=Se);else{var Xt=_e.attr[_t];Lt=new M(st,Se,""),_t!==S.SCTE35_OUT&&_t!==S.SCTE35_IN||(mt=Xt,Xt=Uint8Array.from(mt.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),Lt.value={key:_t,data:Xt},Lt.type=Ce.MetadataSchema.dateRange,o.id3Track.addCue(Lt),De[_t]=Lt}}}c[he]={cues:De,dateRange:_e,durationKnown:$e}},K=0;K<g.length;K++)j(K)}}},E}();function nt(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}var ft=function(){function E(o){var l=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return l.timeupdate()},this.hls=o,this.config=o.config,this.registerListeners()}var h,n,s=E.prototype;return s.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},s.registerListeners=function(){this.hls.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(b.Events.ERROR,this.onError,this)},s.unregisterListeners=function(){this.hls.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(b.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(b.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(b.Events.ERROR,this.onError)},s.onMediaAttached=function(o,l){this.media=l.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},s.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},s.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},s.onLevelUpdated=function(o,l){var c=l.details;this.levelDetails=c,c.advanced&&this.timeupdate(),!c.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},s.onError=function(o,l){l.details===R.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,P.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},s.timeupdate=function(){var o=this.media,l=this.levelDetails;if(o&&l){this.currentTime=o.currentTime;var c=this.computeLatency();if(c!==null){this._latency=c;var a=this.config,f=a.lowLatencyMode,g=a.maxLiveSyncPlaybackRate;if(f&&g!==1){var p=this.targetLatency;if(p!==null){var v=c-p,_=v<Math.min(this.maxLatency,p+l.targetduration);if(l.live&&_&&v>.05&&this.forwardBufferLength>1){var L=Math.min(2,Math.max(1,g)),x=Math.round(2/(1+Math.exp(-.75*v-this.edgeStalled))*20)/20;o.playbackRate=Math.min(L,Math.max(1,x))}else o.playbackRate!==1&&o.playbackRate!==0&&(o.playbackRate=1)}}}}},s.estimateLiveEdge=function(){var o=this.levelDetails;return o===null?null:o.edge+o.age},s.computeLatency=function(){var o=this.estimateLiveEdge();return o===null?null:o-this.currentTime},h=E,(n=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var o=this.config,l=this.levelDetails;return o.liveMaxLatencyDuration!==void 0?o.liveMaxLatencyDuration:l?o.liveMaxLatencyDurationCount*l.targetduration:0}},{key:"targetLatency",get:function(){var o=this.levelDetails;if(o===null)return null;var l=o.holdBack,c=o.partHoldBack,a=o.targetduration,f=this.config,g=f.liveSyncDuration,p=f.liveSyncDurationCount,v=f.lowLatencyMode,_=this.hls.userConfig,L=v&&c||l;(_.liveSyncDuration||_.liveSyncDurationCount||L===0)&&(L=g!==void 0?g:p*a);var x=a;return L+Math.min(1*this.stallCount,x)}},{key:"liveSyncPosition",get:function(){var o=this.estimateLiveEdge(),l=this.targetLatency,c=this.levelDetails;if(o===null||l===null||c===null)return null;var a=c.edge,f=o-l-this.edgeStalled,g=a-c.totalduration,p=a-(this.config.lowLatencyMode&&c.partTarget||c.targetduration);return Math.min(Math.max(g,f),p)}},{key:"drift",get:function(){var o=this.levelDetails;return o===null?1:o.drift}},{key:"edgeStalled",get:function(){var o=this.levelDetails;if(o===null)return 0;var l=3*(this.config.lowLatencyMode&&o.partTarget||o.targetduration);return Math.max(o.age-l,0)}},{key:"forwardBufferLength",get:function(){var o=this.media,l=this.levelDetails;if(!o||!l)return 0;var c=o.buffered.length;return(c?o.buffered.end(c-1):l.edge)-this.currentTime}}])&&nt(h.prototype,n),Object.defineProperty(h,"prototype",{writable:!1}),E}();function dt(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}var Et,Ft=["NONE","TYPE-0","TYPE-1","TYPE-2",null];(function(E){E.No="",E.Yes="YES",E.v2="v2"})(Et||(Et={}));var te=function(){function E(h,n,s){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=h,this.part=n,this.skip=s}return E.prototype.addDirectives=function(h){var n=new self.URL(h);return this.msn!==void 0&&n.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&n.searchParams.set("_HLS_part",this.part.toString()),this.skip&&n.searchParams.set("_HLS_skip",this.skip),n.href},E}(),W=function(){function E(s){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[s.url],this.attrs=s.attrs,this.bitrate=s.bitrate,s.details&&(this.details=s.details),this.id=s.id||0,this.name=s.name,this.width=s.width||0,this.height=s.height||0,this.audioCodec=s.audioCodec,this.videoCodec=s.videoCodec,this.unknownCodecs=s.unknownCodecs,this.codecSet=[s.videoCodec,s.audioCodec].filter(function(o){return o}).join(",").replace(/\.[^.,]+/g,"")}var h,n;return h=E,(n=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(s){var o=s%this.url.length;this._urlId!==o&&(this.details=void 0,this._urlId=o)}}])&&dt(h.prototype,n),Object.defineProperty(h,"prototype",{writable:!1}),E}();function D(){return D=Object.assign?Object.assign.bind():function(E){for(var h=1;h<arguments.length;h++){var n=arguments[h];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(E[s]=n[s])}return E},D.apply(this,arguments)}function G(E,h,n){switch(h){case"audio":E.audioGroupIds||(E.audioGroupIds=[]),E.audioGroupIds.push(n);break;case"text":E.textGroupIds||(E.textGroupIds=[]),E.textGroupIds.push(n)}}function U(E){var h={};E.forEach(function(n){var s=n.groupId||"";n.id=h[s]=h[s]||0,h[s]++})}function X(E,h){var n=h.startPTS;if((0,C.isFiniteNumber)(n)){var s,o=0;h.sn>E.sn?(o=n-E.start,s=E):(o=E.start-n,s=h),s.duration!==o&&(s.duration=o)}else h.sn>E.sn?E.cc===h.cc&&E.minEndPTS?h.start=E.start+(E.minEndPTS-E.start):h.start=E.start+E.duration:h.start=Math.max(E.start-h.duration,0)}function ee(E,h,n,s,o,l){s-n<=0&&(P.logger.warn("Fragment should have a positive duration",h),s=n+h.duration,l=o+h.duration);var c=n,a=s,f=h.startPTS,g=h.endPTS;if((0,C.isFiniteNumber)(f)){var p=Math.abs(f-n);(0,C.isFiniteNumber)(h.deltaPTS)?h.deltaPTS=Math.max(p,h.deltaPTS):h.deltaPTS=p,c=Math.max(n,f),n=Math.min(n,f),o=Math.min(o,h.startDTS),a=Math.min(s,g),s=Math.max(s,g),l=Math.max(l,h.endDTS)}h.duration=s-n;var v=n-h.start;h.start=h.startPTS=n,h.maxStartPTS=c,h.startDTS=o,h.endPTS=s,h.minEndPTS=a,h.endDTS=l;var _,L=h.sn;if(!E||L<E.startSN||L>E.endSN)return 0;var x=L-E.startSN,M=E.fragments;for(M[x]=h,_=x;_>0;_--)X(M[_],M[_-1]);for(_=x;_<M.length-1;_++)X(M[_],M[_+1]);return E.fragmentHint&&X(M[M.length-1],E.fragmentHint),E.PTSKnown=E.alignedSliding=!0,v}function ne(E,h){var n=h.startSN+h.skippedSegments-E.startSN,s=E.fragments;n<0||n>=s.length||ye(h,s[n].start)}function ye(E,h){if(h){for(var n=E.fragments,s=E.skippedSegments;s<n.length;s++)n[s].start+=h;E.fragmentHint&&(E.fragmentHint.start+=h)}}var Oe=function(){function E(n,s){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=P.logger.log.bind(P.logger,s+":"),this.warn=P.logger.warn.bind(P.logger,s+":"),this.hls=n}var h=E.prototype;return h.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},h.onError=function(n,s){!s.fatal||s.type!==R.ErrorTypes.NETWORK_ERROR&&s.type!==R.ErrorTypes.KEY_SYSTEM_ERROR||this.stopLoad()},h.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},h.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.requestScheduled=-1,this.loadPlaylist()},h.stopLoad=function(){this.canLoad=!1,this.clearTimer()},h.switchParams=function(n,s){var o=s==null?void 0:s.renditionReports;if(o)for(var l=0;l<o.length;l++){var c=o[l],a=void 0;try{a=new self.URL(c.URI,s.url).href}catch(v){P.logger.warn("Could not construct new URL for Rendition Report: "+v),a=c.URI||""}if(a===n.slice(-a.length)){var f=parseInt(c["LAST-MSN"])||(s==null?void 0:s.lastPartSn),g=parseInt(c["LAST-PART"])||(s==null?void 0:s.lastPartIndex);if(this.hls.config.lowLatencyMode){var p=Math.min(s.age-s.partTarget,s.targetduration);g>=0&&p>s.partTarget&&(g+=1)}return new te(f,g>=0?g:void 0,Et.No)}}},h.loadPlaylist=function(n){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())},h.shouldLoadTrack=function(n){return this.canLoad&&n&&!!n.url&&(!n.details||n.details.live)},h.playlistLoaded=function(n,s,o){var l=this,c=s.details,a=s.stats,f=self.performance.now(),g=a.loading.first?Math.max(0,f-a.loading.first):0;if(c.advancedDateTime=Date.now()-g,c.live||o!=null&&o.live){if(c.reloaded(o),o&&this.log("live playlist "+n+" "+(c.advanced?"REFRESHED "+c.lastPartSn+"-"+c.lastPartIndex:"MISSED")),o&&c.fragments.length>0&&function(Xe,je){for(var mt=null,xt=Xe.fragments,Tt=xt.length-1;Tt>=0;Tt--){var _t=xt[Tt].initSegment;if(_t){mt=_t;break}}Xe.fragmentHint&&delete Xe.fragmentHint.endPTS;var Lt,Xt,Wt,Ht,Qt,pr=0;if(function(ct,vt,qn){for(var Qr=vt.skippedSegments,Mr=Math.max(ct.startSN,vt.startSN)-vt.startSN,Wn=(ct.fragmentHint?1:0)+(Qr?vt.endSN:Math.min(ct.endSN,vt.endSN))-vt.startSN,Cr=vt.startSN-ct.startSN,zr=vt.fragmentHint?vt.fragments.concat(vt.fragmentHint):vt.fragments,an=ct.fragmentHint?ct.fragments.concat(ct.fragmentHint):ct.fragments,Tr=Mr;Tr<=Wn;Tr++){var on=an[Cr+Tr],ps=zr[Tr];Qr&&!ps&&Tr<Qr&&(ps=vt.fragments[Tr]=on),on&&ps&&qn(on,ps)}}(Xe,je,function(ct,vt){ct.relurl&&(pr=ct.cc-vt.cc),(0,C.isFiniteNumber)(ct.startPTS)&&(0,C.isFiniteNumber)(ct.endPTS)&&(vt.start=vt.startPTS=ct.startPTS,vt.startDTS=ct.startDTS,vt.appendedPTS=ct.appendedPTS,vt.maxStartPTS=ct.maxStartPTS,vt.endPTS=ct.endPTS,vt.endDTS=ct.endDTS,vt.minEndPTS=ct.minEndPTS,vt.duration=ct.endPTS-ct.startPTS,vt.duration&&(Lt=vt),je.PTSKnown=je.alignedSliding=!0),vt.elementaryStreams=ct.elementaryStreams,vt.loader=ct.loader,vt.stats=ct.stats,vt.urlId=ct.urlId,ct.initSegment&&(vt.initSegment=ct.initSegment,mt=ct.initSegment)}),mt&&(je.fragmentHint?je.fragments.concat(je.fragmentHint):je.fragments).forEach(function(ct){var vt;ct.initSegment&&ct.initSegment.relurl!==((vt=mt)===null||vt===void 0?void 0:vt.relurl)||(ct.initSegment=mt)}),je.skippedSegments)if(je.deltaUpdateFailed=je.fragments.some(function(ct){return!ct}),je.deltaUpdateFailed){P.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var ao=je.skippedSegments;ao--;)je.fragments.shift();je.startSN=je.fragments[0].sn,je.startCC=je.fragments[0].cc}else je.canSkipDateRanges&&(je.dateRanges=(Xt=Xe.dateRanges,Wt=je.dateRanges,Ht=je.recentlyRemovedDateranges,Qt=D({},Xt),Ht&&Ht.forEach(function(ct){delete Qt[ct]}),Object.keys(Wt).forEach(function(ct){var vt=new de(Wt[ct].attr,Qt[ct]);vt.isValid?Qt[ct]=vt:P.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(Wt[ct].attr)+'"')}),Qt));var wr=je.fragments;if(pr){P.logger.warn("discontinuity sliding from playlist, take drift into account");for(var Ii=0;Ii<wr.length;Ii++)wr[Ii].cc+=pr}je.skippedSegments&&(je.startCC=je.fragments[0].cc),function(ct,vt,qn){if(ct&&vt)for(var Qr=0,Mr=0,Wn=ct.length;Mr<=Wn;Mr++){var Cr=ct[Mr],zr=vt[Mr+Qr];Cr&&zr&&Cr.index===zr.index&&Cr.fragment.sn===zr.fragment.sn?(an=Cr,(Tr=zr).elementaryStreams=an.elementaryStreams,Tr.stats=an.stats):Qr--}var an,Tr}(Xe.partList,je.partList),Lt?ee(je,Lt,Lt.startPTS,Lt.endPTS,Lt.startDTS,Lt.endDTS):ne(Xe,je),wr.length&&(je.totalduration=je.edge-wr[0].start),je.driftStartTime=Xe.driftStartTime,je.driftStart=Xe.driftStart;var Ci=je.advancedDateTime;if(je.advanced&&Ci){var Li=je.edge;je.driftStart||(je.driftStartTime=Ci,je.driftStart=Li),je.driftEndTime=Ci,je.driftEnd=Li}else je.driftEndTime=Xe.driftEndTime,je.driftEnd=Xe.driftEnd,je.advancedDateTime=Xe.advancedDateTime}(o,c),!this.canLoad||!c.live)return;var p,v=void 0,_=void 0;if(c.canBlockReload&&c.endSN&&c.advanced){var L=this.hls.config.lowLatencyMode,x=c.lastPartSn,M=c.endSN,j=c.lastPartIndex,K=x===M;j!==-1?(v=K?M+1:x,_=K?L?0:j:j+1):v=M+1;var Z=c.age,he=Z+c.ageHeader,_e=Math.min(he-c.partTarget,1.5*c.targetduration);if(_e>0){if(o&&_e>o.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+o.tuneInGoal+" to: "+_e+" with playlist age: "+c.age),_e=0;else{var Ee=Math.floor(_e/c.targetduration);v+=Ee,_!==void 0&&(_+=Math.round(_e%c.targetduration/c.partTarget)),this.log("CDN Tune-in age: "+c.ageHeader+"s last advanced "+Z.toFixed(2)+"s goal: "+_e+" skip sn "+Ee+" to part "+_)}c.tuneInGoal=_e}if(p=this.getDeliveryDirectives(c,s.deliveryDirectives,v,_),L||!K)return void this.loadPlaylist(p)}else p=this.getDeliveryDirectives(c,s.deliveryDirectives,v,_);var De=this.hls.mainForwardBufferInfo,$e=De?De.end-De.len:0,st=function(Xe,je){je===void 0&&(je=1/0);var mt=1e3*Xe.targetduration;if(Xe.updated){var xt=Xe.fragments;if(xt.length&&4*mt>je){var Tt=1e3*xt[xt.length-1].duration;Tt<mt&&(mt=Tt)}}else mt/=2;return Math.round(mt)}(c,1e3*(c.edge-$e));c.updated?f>this.requestScheduled+st&&(this.requestScheduled=a.loading.start):this.requestScheduled=-1,v!==void 0&&c.canBlockReload?this.requestScheduled=a.loading.first+st-(1e3*c.partTarget||1e3):this.requestScheduled=(this.requestScheduled===-1?f:this.requestScheduled)+st;var Se=this.requestScheduled-f;Se=Math.max(0,Se),this.log("reload live playlist "+n+" in "+Math.round(Se)+" ms"),this.timer=self.setTimeout(function(){return l.loadPlaylist(p)},Se)}else this.clearTimer()},h.getDeliveryDirectives=function(n,s,o,l){var c=function(a,f){var g=a.canSkipUntil,p=a.canSkipDateRanges,v=a.endSN;return g&&(f!==void 0?f-v:0)<g?p?Et.v2:Et.Yes:Et.No}(n,o);return s!=null&&s.skip&&n.deltaUpdateFailed&&(o=s.msn,l=s.part,c=Et.No),new te(o,l,c)},h.retryLoadingOrFail=function(n){var s,o=this,l=this.hls.config,c=this.retryCount<l.levelLoadingMaxRetry;if(c)if(this.requestScheduled=-1,this.retryCount++,n.details.indexOf("LoadTimeOut")>-1&&(s=n.context)!==null&&s!==void 0&&s.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+n.details+'"'),this.loadPlaylist();else{var a=Math.min(Math.pow(2,this.retryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return o.loadPlaylist()},a),this.warn("retry playlist loading #"+this.retryCount+" in "+a+' ms after "'+n.details+'"')}else this.warn('cannot recover from error "'+n.details+'"'),this.clearTimer(),n.fatal=!0;return c},E}();function Pe(){return Pe=Object.assign?Object.assign.bind():function(E){for(var h=1;h<arguments.length;h++){var n=arguments[h];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(E[s]=n[s])}return E},Pe.apply(this,arguments)}function Ke(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}function tt(E,h){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},tt(E,h)}var qe,at=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),gt=function(E){var h,n;function s(a){var f;return(f=E.call(this,a,"[level-controller]")||this)._levels=[],f._firstLevel=-1,f._startLevel=void 0,f.currentLevelIndex=-1,f.manualLevelIndex=-1,f.onParsedComplete=void 0,f._registerListeners(),f}n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,tt(h,n);var o,l,c=s.prototype;return c._registerListeners=function(){var a=this.hls;a.on(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this),a.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.on(b.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),a.on(b.Events.FRAG_LOADED,this.onFragLoaded,this),a.on(b.Events.ERROR,this.onError,this)},c._unregisterListeners=function(){var a=this.hls;a.off(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this),a.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.off(b.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),a.off(b.Events.FRAG_LOADED,this.onFragLoaded,this),a.off(b.Events.ERROR,this.onError,this)},c.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,E.prototype.destroy.call(this)},c.startLoad=function(){this._levels.forEach(function(a){a.loadError=0}),E.prototype.startLoad.call(this)},c.onManifestLoaded=function(a,f){var g,p,v=[],_=[],L=[],x={},M=!1,j=!1,K=!1;if(f.levels.forEach(function(Ee){var De=Ee.attrs;M=M||!(!Ee.width||!Ee.height),j=j||!!Ee.videoCodec,K=K||!!Ee.audioCodec,at&&Ee.audioCodec&&Ee.audioCodec.indexOf("mp4a.40.34")!==-1&&(Ee.audioCodec=void 0);var $e=Ee.bitrate+"-"+Ee.attrs.RESOLUTION+"-"+Ee.attrs.CODECS;(p=x[$e])?p.url.push(Ee.url):(p=new W(Ee),x[$e]=p,v.push(p)),De&&(De.AUDIO&&G(p,"audio",De.AUDIO),De.SUBTITLES&&G(p,"text",De.SUBTITLES))}),(M||j)&&K&&(v=v.filter(function(Ee){var De=Ee.videoCodec,$e=Ee.width,st=Ee.height;return!!De||!(!$e||!st)})),v=v.filter(function(Ee){var De=Ee.audioCodec,$e=Ee.videoCodec;return(!De||Qe(De,"audio"))&&(!$e||Qe($e,"video"))}),f.audioTracks&&U(_=f.audioTracks.filter(function(Ee){return!Ee.audioCodec||Qe(Ee.audioCodec,"audio")})),f.subtitles&&U(L=f.subtitles),v.length>0){g=v[0].bitrate,v.sort(function(Ee,De){return Ee.attrs["HDCP-LEVEL"]!==De.attrs["HDCP-LEVEL"]?(Ee.attrs["HDCP-LEVEL"]||"")>(De.attrs["HDCP-LEVEL"]||"")?1:-1:Ee.bitrate!==De.bitrate?Ee.bitrate-De.bitrate:Ee.attrs.SCORE!==De.attrs.SCORE?Ee.attrs.decimalFloatingPoint("SCORE")-De.attrs.decimalFloatingPoint("SCORE"):M&&Ee.height!==De.height?Ee.height-De.height:0}),this._levels=v;for(var Z=0;Z<v.length;Z++)if(v[Z].bitrate===g){this._firstLevel=Z,this.log("manifest loaded, "+v.length+" level(s) found, first bitrate: "+g);break}var he=K&&!j,_e={levels:v,audioTracks:_,subtitleTracks:L,sessionData:f.sessionData,sessionKeys:f.sessionKeys,firstLevel:this._firstLevel,stats:f.stats,audio:K,video:j,altAudio:!he&&_.some(function(Ee){return!!Ee.url})};this.hls.trigger(b.Events.MANIFEST_PARSED,_e),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:f.url,reason:"no level with compatible codecs found in manifest"})},c.onError=function(a,f){var g,p;if(E.prototype.onError.call(this,a,f),!f.fatal){var v=f.context,_=this._levels[this.currentLevelIndex];if(v&&(v.type===O.PlaylistContextType.AUDIO_TRACK&&_.audioGroupIds&&v.groupId===_.audioGroupIds[_.urlId]||v.type===O.PlaylistContextType.SUBTITLE_TRACK&&_.textGroupIds&&v.groupId===_.textGroupIds[_.urlId]))this.redundantFailover(this.currentLevelIndex);else{var L,x=!1,M=!0;switch(f.details){case R.ErrorDetails.FRAG_LOAD_ERROR:case R.ErrorDetails.FRAG_LOAD_TIMEOUT:case R.ErrorDetails.KEY_LOAD_ERROR:case R.ErrorDetails.KEY_LOAD_TIMEOUT:if(f.frag){var j=f.frag.type===O.PlaylistLevelType.MAIN?f.frag.level:this.currentLevelIndex,K=this._levels[j];K?(K.fragmentError++,K.fragmentError>this.hls.config.fragLoadingMaxRetry&&(L=j)):L=j}break;case R.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var Z=_.attrs["HDCP-LEVEL"];Z&&(this.hls.maxHdcpLevel=Ft[Ft.indexOf(Z)-1],this.warn('Restricting playback to HDCP-LEVEL of "'+this.hls.maxHdcpLevel+'" or lower'));case R.ErrorDetails.FRAG_PARSING_ERROR:case R.ErrorDetails.KEY_SYSTEM_NO_SESSION:L=((g=f.frag)===null||g===void 0?void 0:g.type)===O.PlaylistLevelType.MAIN?f.frag.level:this.currentLevelIndex,f.levelRetry=!1;break;case R.ErrorDetails.LEVEL_LOAD_ERROR:case R.ErrorDetails.LEVEL_LOAD_TIMEOUT:v&&(v.deliveryDirectives&&(M=!1),L=v.level),x=!0;break;case R.ErrorDetails.REMUX_ALLOC_ERROR:L=(p=f.level)!=null?p:this.currentLevelIndex,x=!0}L!==void 0&&this.recoverLevel(f,L,x,M)}}},c.recoverLevel=function(a,f,g,p){var v=a.details,_=this._levels[f];if(_.loadError++,g){if(!this.retryLoadingOrFail(a))return void(this.currentLevelIndex=-1);a.levelRetry=!0}if(p){var L=_.url.length;if(L>1&&_.loadError<L)a.levelRetry=!0,this.redundantFailover(f);else if(this.manualLevelIndex===-1){for(var x=-1,M=this._levels,j=M.length;j--;){var K=(j+this.currentLevelIndex)%M.length;if(K!==this.currentLevelIndex&&M[K].loadError===0){x=K;break}}x>-1&&this.currentLevelIndex!==x?(this.warn(v+": switch to "+x),a.levelRetry=!0,this.hls.nextAutoLevel=x):a.levelRetry===!1&&(a.fatal=!0)}}},c.redundantFailover=function(a){var f=this._levels[a],g=f.url.length;if(g>1){var p=(f.urlId+1)%g;this.warn("Switching to redundant URL-id "+p),this._levels.forEach(function(v){v.urlId=p}),this.level=a}},c.onFragLoaded=function(a,f){var g=f.frag;if(g!==void 0&&g.type===O.PlaylistLevelType.MAIN){var p=this._levels[g.level];p!==void 0&&(p.fragmentError=0,p.loadError=0)}},c.onLevelLoaded=function(a,f){var g,p,v=f.level,_=f.details,L=this._levels[v];if(!L)return this.warn("Invalid level index "+v),void((p=f.deliveryDirectives)!==null&&p!==void 0&&p.skip&&(_.deltaUpdateFailed=!0));v===this.currentLevelIndex?(L.fragmentError===0&&(L.loadError=0,this.retryCount=0),this.playlistLoaded(v,f,L.details)):(g=f.deliveryDirectives)!==null&&g!==void 0&&g.skip&&(_.deltaUpdateFailed=!0)},c.onAudioTrackSwitched=function(a,f){var g=this.hls.levels[this.currentLevelIndex];if(g&&g.audioGroupIds){for(var p=-1,v=this.hls.audioTracks[f.id].groupId,_=0;_<g.audioGroupIds.length;_++)if(g.audioGroupIds[_]===v){p=_;break}p!==g.urlId&&(g.urlId=p,this.startLoad())}},c.loadPlaylist=function(a){E.prototype.loadPlaylist.call(this);var f=this.currentLevelIndex,g=this._levels[f];if(this.canLoad&&g&&g.url.length>0){var p=g.urlId,v=g.url[p];if(a)try{v=a.addDirectives(v)}catch(_){this.warn("Could not construct new URL with HLS Delivery Directives: "+_)}this.log("Attempt loading level index "+f+(a?" at sn "+a.msn+" part "+a.part:"")+" with URL-id "+p+" "+v),this.clearTimer(),this.hls.trigger(b.Events.LEVEL_LOADING,{url:v,level:f,id:p,deliveryDirectives:a||null})}},c.removeLevel=function(a,f){var g=function(v,_){return _!==f},p=this._levels.filter(function(v,_){return _!==a||v.url.length>1&&f!==void 0&&(v.url=v.url.filter(g),v.audioGroupIds&&(v.audioGroupIds=v.audioGroupIds.filter(g)),v.textGroupIds&&(v.textGroupIds=v.textGroupIds.filter(g)),v.urlId=0,!0)}).map(function(v,_){var L=v.details;return L!=null&&L.fragments&&L.fragments.forEach(function(x){x.level=_}),v});this._levels=p,this.hls.trigger(b.Events.LEVELS_UPDATED,{levels:p})},o=s,(l=[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(a){var f,g=this._levels;if(g.length!==0&&(this.currentLevelIndex!==a||(f=g[a])===null||f===void 0||!f.details)){if(a<0||a>=g.length){var p=a<0;if(this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.OTHER_ERROR,details:R.ErrorDetails.LEVEL_SWITCH_ERROR,level:a,fatal:p,reason:"invalid level idx"}),p)return;a=Math.min(a,g.length-1)}this.clearTimer();var v=this.currentLevelIndex,_=g[v],L=g[a];this.log("switching to level "+a+" from "+v),this.currentLevelIndex=a;var x=Pe({},L,{level:a,maxBitrate:L.maxBitrate,uri:L.uri,urlId:L.urlId});delete x._urlId,this.hls.trigger(b.Events.LEVEL_SWITCHING,x);var M=L.details;if(!M||M.live){var j=this.switchParams(L.uri,_==null?void 0:_.details);this.loadPlaylist(j)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(a){this.manualLevelIndex=a,this._startLevel===void 0&&(this._startLevel=a),a!==-1&&(this.level=a)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(a){this._firstLevel=a}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var a=this.hls.config.startLevel;return a!==void 0?a:this._firstLevel}return this._startLevel},set:function(a){this._startLevel=a}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(a){this.level=a,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=a)}}])&&Ke(o.prototype,l),Object.defineProperty(o,"prototype",{writable:!1}),s}(Oe);(function(E){E.NOT_LOADED="NOT_LOADED",E.APPENDING="APPENDING",E.PARTIAL="PARTIAL",E.OK="OK"})(qe||(qe={}));var Ct=function(){function E(n){this.activeFragment=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=n,this._registerListeners()}var h=E.prototype;return h._registerListeners=function(){var n=this.hls;n.on(b.Events.BUFFER_APPENDED,this.onBufferAppended,this),n.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this),n.on(b.Events.FRAG_LOADED,this.onFragLoaded,this)},h._unregisterListeners=function(){var n=this.hls;n.off(b.Events.BUFFER_APPENDED,this.onBufferAppended,this),n.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this),n.off(b.Events.FRAG_LOADED,this.onFragLoaded,this)},h.destroy=function(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.activeFragment=this.activeParts=null},h.getAppendedFrag=function(n,s){if(s===O.PlaylistLevelType.MAIN){var o=this.activeFragment,l=this.activeParts;if(!o)return null;if(l)for(var c=l.length;c--;){var a=l[c],f=a?a.end:o.appendedPTS;if(a.start<=n&&f!==void 0&&n<=f)return c>9&&(this.activeParts=l.slice(c-9)),a}else if(o.start<=n&&o.appendedPTS!==void 0&&n<=o.appendedPTS)return o}return this.getBufferedFrag(n,s)},h.getBufferedFrag=function(n,s){for(var o=this.fragments,l=Object.keys(o),c=l.length;c--;){var a=o[l[c]];if((a==null?void 0:a.body.type)===s&&a.buffered){var f=a.body;if(f.start<=n&&n<=f.end)return f}}return null},h.detectEvictedFragments=function(n,s,o){var l=this;this.timeRanges&&(this.timeRanges[n]=s),Object.keys(this.fragments).forEach(function(c){var a=l.fragments[c];if(a)if(a.buffered||a.loaded){var f=a.range[n];f&&f.time.some(function(g){var p=!l.isTimeBuffered(g.startPTS,g.endPTS,s);return p&&l.removeFragment(a.body),p})}else a.body.type===o&&l.removeFragment(a.body)})},h.detectPartialFragments=function(n){var s=this,o=this.timeRanges,l=n.frag,c=n.part;if(o&&l.sn!=="initSegment"){var a=Nt(l),f=this.fragments[a];f&&(Object.keys(o).forEach(function(g){var p=l.elementaryStreams[g];if(p){var v=o[g],_=c!==null||p.partial===!0;f.range[g]=s.getBufferedTimes(l,c,_,v)}}),f.loaded=null,Object.keys(f.range).length?(f.buffered=!0,f.body.endList&&(this.endListFragments[f.body.type]=f)):this.removeFragment(f.body))}},h.fragBuffered=function(n){var s=Nt(n),o=this.fragments[s];o&&(o.loaded=null,o.buffered=!0)},h.getBufferedTimes=function(n,s,o,l){for(var c={time:[],partial:o},a=s?s.start:n.start,f=s?s.end:n.end,g=n.minEndPTS||f,p=n.maxStartPTS||a,v=0;v<l.length;v++){var _=l.start(v)-this.bufferPadding,L=l.end(v)+this.bufferPadding;if(p>=_&&g<=L){c.time.push({startPTS:Math.max(a,l.start(v)),endPTS:Math.min(f,l.end(v))});break}if(a<L&&f>_)c.partial=!0,c.time.push({startPTS:Math.max(a,l.start(v)),endPTS:Math.min(f,l.end(v))});else if(f<=_)break}return c},h.getPartialFragment=function(n){var s,o,l,c=null,a=0,f=this.bufferPadding,g=this.fragments;return Object.keys(g).forEach(function(p){var v=g[p];v&&it(v)&&(o=v.body.start-f,l=v.body.end+f,n>=o&&n<=l&&(s=Math.min(n-o,l-n),a<=s&&(c=v.body,a=s)))}),c},h.isEndListAppended=function(n){var s=this.endListFragments[n];return s!==void 0&&(s.buffered||it(s))},h.getState=function(n){var s=Nt(n),o=this.fragments[s];return o?o.buffered?it(o)?qe.PARTIAL:qe.OK:qe.APPENDING:qe.NOT_LOADED},h.isTimeBuffered=function(n,s,o){for(var l,c,a=0;a<o.length;a++){if(l=o.start(a)-this.bufferPadding,c=o.end(a)+this.bufferPadding,n>=l&&s<=c)return!0;if(s<=l)return!1}return!1},h.onFragLoaded=function(n,s){var o=s.frag,l=s.part;if(o.sn!=="initSegment"&&!o.bitrateTest&&!l){var c=Nt(o);this.fragments[c]={body:o,loaded:s,buffered:!1,range:Object.create(null)}}},h.onBufferAppended=function(n,s){var o=this,l=s.frag,c=s.part,a=s.timeRanges;if(l.type===O.PlaylistLevelType.MAIN)if(this.activeFragment!==l&&(this.activeFragment=l,l.appendedPTS=void 0),c){var f=this.activeParts;f||(this.activeParts=f=[]),f.push(c)}else this.activeParts=null;this.timeRanges=a,Object.keys(a).forEach(function(g){var p=a[g];if(o.detectEvictedFragments(g,p),!c&&l.type===O.PlaylistLevelType.MAIN){var v=l.elementaryStreams[g];if(!v)return;for(var _=0;_<p.length;_++){var L=p.end(_);L<=v.endPTS&&L>v.startPTS?l.appendedPTS=Math.max(L,l.appendedPTS||0):l.appendedPTS=v.endPTS}}})},h.onFragBuffered=function(n,s){this.detectPartialFragments(s)},h.hasFragment=function(n){var s=Nt(n);return!!this.fragments[s]},h.removeFragmentsInRange=function(n,s,o){var l=this;Object.keys(this.fragments).forEach(function(c){var a=l.fragments[c];if(a&&a.buffered){var f=a.body;f.type===o&&f.start<s&&f.end>n&&l.removeFragment(f)}})},h.removeFragment=function(n){var s=Nt(n);n.stats.loaded=0,n.clearElementaryStreamInfo(),n.appendedPTS=void 0,delete this.fragments[s],n.endList&&delete this.endListFragments[n.type]},h.removeAllFragments=function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activeFragment=null,this.activeParts=null},E}();function it(E){var h,n;return E.buffered&&(((h=E.range.video)===null||h===void 0?void 0:h.partial)||((n=E.range.audio)===null||n===void 0?void 0:n.partial))}function Nt(E){return E.type+"_"+E.level+"_"+E.urlId+"_"+E.sn}function er(E){var h=typeof Map=="function"?new Map:void 0;return er=function(n){if(n===null||(s=n,Function.toString.call(s).indexOf("[native code]")===-1))return n;var s;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(h!==void 0){if(h.has(n))return h.get(n);h.set(n,o)}function o(){return Yt(n,arguments,ot(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),qt(o,n)},er(E)}function Yt(E,h,n){return Yt=Mt()?Reflect.construct.bind():function(s,o,l){var c=[null];c.push.apply(c,o);var a=new(Function.bind.apply(s,c));return l&&qt(a,l.prototype),a},Yt.apply(null,arguments)}function Mt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qt(E,h){return qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},qt(E,h)}function ot(E){return ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(h){return h.__proto__||Object.getPrototypeOf(h)},ot(E)}var ur=Math.pow(2,17),qr=function(){function E(n){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=n}var h=E.prototype;return h.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},h.abort=function(){this.loader&&this.loader.abort()},h.load=function(n,s){var o=this,l=n.url;if(!l)return Promise.reject(new zt({type:R.ErrorTypes.NETWORK_ERROR,details:R.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:n,networkDetails:null},"Fragment does not have a "+(l?"part list":"url")));this.abort();var c=this.config,a=c.fLoader,f=c.loader;return new Promise(function(g,p){o.loader&&o.loader.destroy();var v=o.loader=n.loader=a?new a(c):new f(c),_=Vt(n),L={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:n.sn==="initSegment"?1/0:ur};n.stats=v.stats,v.load(_,L,{onSuccess:function(x,M,j,K){o.resetLoader(n,v);var Z=x.data;j.resetIV&&n.decryptdata&&(n.decryptdata.iv=new Uint8Array(Z.slice(0,16)),Z=Z.slice(16)),g({frag:n,part:null,payload:Z,networkDetails:K})},onError:function(x,M,j){o.resetLoader(n,v),p(new zt({type:R.ErrorTypes.NETWORK_ERROR,details:R.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:n,response:x,networkDetails:j}))},onAbort:function(x,M,j){o.resetLoader(n,v),p(new zt({type:R.ErrorTypes.NETWORK_ERROR,details:R.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:n,networkDetails:j}))},onTimeout:function(x,M,j){o.resetLoader(n,v),p(new zt({type:R.ErrorTypes.NETWORK_ERROR,details:R.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:n,networkDetails:j}))},onProgress:function(x,M,j,K){s&&s({frag:n,part:null,payload:j,networkDetails:K})}})})},h.loadPart=function(n,s,o){var l=this;this.abort();var c=this.config,a=c.fLoader,f=c.loader;return new Promise(function(g,p){l.loader&&l.loader.destroy();var v=l.loader=n.loader=a?new a(c):new f(c),_=Vt(n,s),L={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:ur};s.stats=v.stats,v.load(_,L,{onSuccess:function(x,M,j,K){l.resetLoader(n,v),l.updateStatsFromPart(n,s);var Z={frag:n,part:s,payload:x.data,networkDetails:K};o(Z),g(Z)},onError:function(x,M,j){l.resetLoader(n,v),p(new zt({type:R.ErrorTypes.NETWORK_ERROR,details:R.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:n,part:s,response:x,networkDetails:j}))},onAbort:function(x,M,j){n.stats.aborted=s.stats.aborted,l.resetLoader(n,v),p(new zt({type:R.ErrorTypes.NETWORK_ERROR,details:R.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:n,part:s,networkDetails:j}))},onTimeout:function(x,M,j){l.resetLoader(n,v),p(new zt({type:R.ErrorTypes.NETWORK_ERROR,details:R.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:n,part:s,networkDetails:j}))}})})},h.updateStatsFromPart=function(n,s){var o=n.stats,l=s.stats,c=l.total;if(o.loaded+=l.loaded,c){var a=Math.round(n.duration/s.duration),f=Math.min(Math.round(o.loaded/c),a),g=(a-f)*Math.round(o.loaded/f);o.total=o.loaded+g}else o.total=Math.max(o.loaded,o.total);var p=o.loading,v=l.loading;p.start?p.first+=v.first-v.start:(p.start=v.start,p.first=v.first),p.end=v.end},h.resetLoader=function(n,s){n.loader=null,this.loader===s&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),s.destroy()},E}();function Vt(E,h){h===void 0&&(h=null);var n=h||E,s={frag:E,part:h,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},o=n.byteRangeStartOffset,l=n.byteRangeEndOffset;if((0,C.isFiniteNumber)(o)&&(0,C.isFiniteNumber)(l)){var c,a=o,f=l;if(E.sn==="initSegment"&&((c=E.decryptdata)===null||c===void 0?void 0:c.method)==="AES-128"){var g=l-o;g%16&&(f=l+(16-g%16)),o!==0&&(s.resetIV=!0,a=o-16)}s.rangeStart=a,s.rangeEnd=f}return s}var zt=function(E){var h,n;function s(o){for(var l,c=arguments.length,a=new Array(c>1?c-1:0),f=1;f<c;f++)a[f-1]=arguments[f];return(l=E.call.apply(E,[this].concat(a))||this).data=void 0,l.data=o,l}return n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,qt(h,n),s}(er(Error)),Ar=function(){function E(n){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=n}var h=E.prototype;return h.abort=function(){for(var n in this.keyUriToKeyInfo){var s=this.keyUriToKeyInfo[n].loader;s&&s.abort()}},h.detach=function(){for(var n in this.keyUriToKeyInfo){var s=this.keyUriToKeyInfo[n];(s.mediaKeySessionContext||s.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[n]}},h.destroy=function(){for(var n in this.detach(),this.keyUriToKeyInfo){var s=this.keyUriToKeyInfo[n].loader;s&&s.destroy()}this.keyUriToKeyInfo={}},h.createKeyLoadError=function(n,s,o,l){return s===void 0&&(s=R.ErrorDetails.KEY_LOAD_ERROR),new zt({type:R.ErrorTypes.NETWORK_ERROR,details:s,fatal:!1,frag:n,networkDetails:o})},h.loadClear=function(n,s){var o=this;if(this.emeController&&this.config.emeEnabled)for(var l=n.sn,c=n.cc,a=function(g){var p=s[g];if(c<=p.cc&&(l==="initSegment"||l<p.sn))return o.emeController.selectKeySystemFormat(p).then(function(v){p.setKeyFormat(v)}),"break"},f=0;f<s.length&&a(f)!=="break";f++);},h.load=function(n){var s=this;return!n.decryptdata&&n.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(n).then(function(o){return s.loadInternal(n,o)}):this.loadInternal(n)},h.loadInternal=function(n,s){var o,l;s&&n.setKeyFormat(s);var c=n.decryptdata;if(!c){var a=s?"Expected frag.decryptdata to be defined after setting format "+s:"Missing decryption data on fragment in onKeyLoading";return Promise.reject(this.createKeyLoadError(n,R.ErrorDetails.KEY_LOAD_ERROR,null,a))}var f=c.uri;if(!f)return Promise.reject(this.createKeyLoadError(n,R.ErrorDetails.KEY_LOAD_ERROR,null,'Invalid key URI: "'+f+'"'));var g,p=this.keyUriToKeyInfo[f];if((o=p)!==null&&o!==void 0&&o.decryptdata.key)return c.key=p.decryptdata.key,Promise.resolve({frag:n,keyInfo:p});if((l=p)!==null&&l!==void 0&&l.keyLoadPromise)switch((g=p.mediaKeySessionContext)===null||g===void 0?void 0:g.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return p.keyLoadPromise}switch(p=this.keyUriToKeyInfo[f]={decryptdata:c,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},c.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return c.keyFormat==="identity"?this.loadKeyHTTP(p,n):this.loadKeyEME(p,n);case"AES-128":return this.loadKeyHTTP(p,n);default:return Promise.reject(this.createKeyLoadError(n,R.ErrorDetails.KEY_LOAD_ERROR,null,'Key supplied with unsupported METHOD: "'+c.method+'"'))}},h.loadKeyEME=function(n,s){var o={frag:s,keyInfo:n};if(this.emeController&&this.config.emeEnabled){var l=this.emeController.loadKey(o);if(l)return(n.keyLoadPromise=l.then(function(c){return n.mediaKeySessionContext=c,o})).catch(function(c){throw n.keyLoadPromise=null,c})}return Promise.resolve(o)},h.loadKeyHTTP=function(n,s){var o=this,l=this.config,c=new l.loader(l);return s.keyLoader=n.loader=c,n.keyLoadPromise=new Promise(function(a,f){var g={keyInfo:n,frag:s,responseType:"arraybuffer",url:n.decryptdata.uri},p={timeout:l.fragLoadingTimeOut,maxRetry:0,retryDelay:l.fragLoadingRetryDelay,maxRetryDelay:l.fragLoadingMaxRetryTimeout,highWaterMark:0},v={onSuccess:function(_,L,x,M){var j=x.frag,K=x.keyInfo,Z=x.url;if(!j.decryptdata||K!==o.keyUriToKeyInfo[Z])return f(o.createKeyLoadError(j,R.ErrorDetails.KEY_LOAD_ERROR,M,"after key load, decryptdata unset or changed"));K.decryptdata.key=j.decryptdata.key=new Uint8Array(_.data),j.keyLoader=null,K.loader=null,a({frag:j,keyInfo:K})},onError:function(_,L,x){o.resetLoader(L),f(o.createKeyLoadError(s,R.ErrorDetails.KEY_LOAD_ERROR,x))},onTimeout:function(_,L,x){o.resetLoader(L),f(o.createKeyLoadError(s,R.ErrorDetails.KEY_LOAD_TIMEOUT,x))},onAbort:function(_,L,x){o.resetLoader(L),f(o.createKeyLoadError(s,R.ErrorDetails.INTERNAL_ABORTED,x))}};c.load(g,p,v)})},h.resetLoader=function(n){var s=n.frag,o=n.keyInfo,l=n.url,c=o.loader;s.keyLoader===c&&(s.keyLoader=null,o.loader=null),delete this.keyUriToKeyInfo[l],c&&c.destroy()},E}(),vn=function(){function E(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var h=E.prototype;return h.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},h.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},h.onHandlerDestroyed=function(){},h.hasInterval=function(){return!!this._tickInterval},h.hasNextTick=function(){return!!this._tickTimer},h.setInterval=function(n){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,n),!0)},h.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},h.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},h.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},h.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},h.doTick=function(){},E}(),_r={length:0,start:function(){return 0},end:function(){return 0}},Ut=function(){function E(){}return E.isBuffered=function(h,n){try{if(h){for(var s=E.getBuffered(h),o=0;o<s.length;o++)if(n>=s.start(o)&&n<=s.end(o))return!0}}catch{}return!1},E.bufferInfo=function(h,n,s){try{if(h){var o,l=E.getBuffered(h),c=[];for(o=0;o<l.length;o++)c.push({start:l.start(o),end:l.end(o)});return this.bufferedInfo(c,n,s)}}catch{}return{len:0,start:n,end:n,nextStart:void 0}},E.bufferedInfo=function(h,n,s){n=Math.max(0,n),h.sort(function(M,j){return M.start-j.start||j.end-M.end});var o=[];if(s)for(var l=0;l<h.length;l++){var c=o.length;if(c){var a=o[c-1].end;h[l].start-a<s?h[l].end>a&&(o[c-1].end=h[l].end):o.push(h[l])}else o.push(h[l])}else o=h;for(var f,g=0,p=n,v=n,_=0;_<o.length;_++){var L=o[_].start,x=o[_].end;if(n+s>=L&&n<x)p=L,g=(v=x)-n;else if(n+s<L){f=L;break}}return{len:g,start:p||0,end:v||0,nextStart:f}},E.getBuffered=function(h){try{return h.buffered}catch(n){return P.logger.log("failed to get media.buffered",n),_r}},E}(),Sa=function(E,h,n,s,o,l){s===void 0&&(s=0),o===void 0&&(o=-1),l===void 0&&(l=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=E,this.sn=h,this.id=n,this.size=s,this.part=o,this.partial=l};function Ku(E,h){for(var n=null,s=0,o=E.length;s<o;s++){var l=E[s];if(l&&l.cc===h){n=l;break}}return n}function Yu(E,h){if(E){var n=E.start+h;E.start=E.startPTS=n,E.endPTS=n+E.duration}}function Ia(E,h){for(var n=h.fragments,s=0,o=n.length;s<o;s++)Yu(n[s],E);h.fragmentHint&&Yu(h.fragmentHint,E),h.alignedSliding=!0}function Vu(E,h){if(E.hasProgramDateTime&&h.hasProgramDateTime){var n=E.fragments,s=h.fragments;if(n.length&&s.length){var o=s[Math.round(s.length/2)-1],l=Ku(n,o.cc)||n[Math.round(n.length/2)-1],c=o.programDateTime,a=l.programDateTime;c!==null&&a!==null&&Ia((a-c)/1e3-(l.start-o.start),E)}}}const ju=function(E,h){for(var n=0,s=E.length-1,o=null,l=null;n<=s;){var c=h(l=E[o=(n+s)/2|0]);if(c>0)n=o+1;else{if(!(c<0))return l;s=o-1}}return null};function Ca(E,h,n,s){n===void 0&&(n=0),s===void 0&&(s=0);var o=null;if(E?o=h[E.sn-h[0].sn+1]||null:n===0&&h[0].start===0&&(o=h[0]),o&&La(n,s,o)===0)return o;var l=ju(h,La.bind(null,n,s));return!l||l===E&&o?o:l}function La(E,h,n){if(E===void 0&&(E=0),h===void 0&&(h=0),n.start<=E&&n.start+n.duration>E)return 0;var s=Math.min(h,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-s<=E?1:n.start-s>E&&n.start?-1:0}function wh(E,h,n){var s=1e3*Math.min(h,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-s>E}var Mh=y(21);const Fh=function(E){for(var h="",n=E.length,s=0;s<n;s++)h+="["+E.start(s).toFixed(3)+","+E.end(s).toFixed(3)+"]";return h};function Bh(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}function Ra(E,h){return Ra=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Ra(E,h)}var Sr="STOPPED",It="IDLE",qu="KEY_LOADING",Kn="FRAG_LOADING",Yn="FRAG_LOADING_WAITING_RETRY",ls="WAITING_TRACK",Pr="PARSING",bi="PARSED",yi="ENDED",Wr="ERROR",Ai="WAITING_INIT_PTS",Vn="WAITING_LEVEL",Da=function(E){var h,n;function s(a,f,g,p){var v;return(v=E.call(this)||this).hls=void 0,v.fragPrevious=null,v.fragCurrent=null,v.fragmentTracker=void 0,v.transmuxer=null,v._state=Sr,v.media=null,v.mediaBuffer=null,v.config=void 0,v.bitrateTest=!1,v.lastCurrentTime=0,v.nextLoadPosition=0,v.startPosition=0,v.loadedmetadata=!1,v.fragLoadError=0,v.retryDate=0,v.levels=null,v.fragmentLoader=void 0,v.keyLoader=void 0,v.levelLastLoaded=null,v.startFragRequested=!1,v.decrypter=void 0,v.initPTS=[],v.onvseeking=null,v.onvended=null,v.logPrefix="",v.log=void 0,v.warn=void 0,v.logPrefix=p,v.log=P.logger.log.bind(P.logger,p+":"),v.warn=P.logger.warn.bind(P.logger,p+":"),v.hls=a,v.fragmentLoader=new qr(a.config),v.keyLoader=g,v.fragmentTracker=f,v.config=a.config,v.decrypter=new Mh.default(a.config),a.on(b.Events.LEVEL_SWITCHING,v.onLevelSwitching,function(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}(v)),v}n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,Ra(h,n);var o,l,c=s.prototype;return c.doTick=function(){this.onTickEnd()},c.onTickEnd=function(){},c.startLoad=function(a){},c.stopLoad=function(){this.fragmentLoader.abort(),this.keyLoader.abort();var a=this.fragCurrent;a&&(a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Sr},c._streamEnded=function(a,f){if(f.live||a.nextStart||!a.end||!this.media)return!1;var g=f.partList;if(g!=null&&g.length){var p=g[g.length-1];return Ut.isBuffered(this.media,p.start+p.duration/2)}var v=f.fragments[f.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(v)},c.getLevelDetails=function(){var a;if(this.levels&&this.levelLastLoaded!==null)return(a=this.levels[this.levelLastLoaded])===null||a===void 0?void 0:a.details},c.onMediaAttached=function(a,f){var g=this.media=this.mediaBuffer=f.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),g.addEventListener("seeking",this.onvseeking),g.addEventListener("ended",this.onvended);var p=this.config;this.levels&&p.autoStartLoad&&this.state===Sr&&this.startLoad(p.startPosition)},c.onMediaDetaching=function(){var a=this.media;a!=null&&a.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),a&&this.onvseeking&&this.onvended&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},c.onMediaSeeking=function(){var a=this.config,f=this.fragCurrent,g=this.media,p=this.mediaBuffer,v=this.state,_=g?g.currentTime:0,L=Ut.bufferInfo(p||g,_,a.maxBufferHole);if(this.log("media seeking to "+((0,C.isFiniteNumber)(_)?_.toFixed(3):_)+", state: "+v),this.state===yi)this.resetLoadingState();else if(f){var x=a.maxFragLookUpTolerance,M=f.start-x,j=f.start+f.duration+x;if(!L.len||j<L.start||M>L.end){var K=_>j;(_<M||K)&&(K&&f.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),f.abortRequests()),this.resetLoadingState())}}g&&(this.lastCurrentTime=_),this.loadedmetadata||L.len||(this.nextLoadPosition=this.startPosition=_),this.tickImmediate()},c.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},c.onLevelSwitching=function(a,f){this.fragLoadError=0},c.onHandlerDestroying=function(){this.stopLoad(),E.prototype.onHandlerDestroying.call(this)},c.onHandlerDestroyed=function(){this.state=Sr,this.hls.off(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,E.prototype.onHandlerDestroyed.call(this)},c.loadFragment=function(a,f,g){this._loadFragForPlayback(a,f,g)},c._loadFragForPlayback=function(a,f,g){var p=this;this._doFragLoad(a,f,g,function(v){if(p.fragContextChanged(a))return p.warn("Fragment "+a.sn+(v.part?" p: "+v.part.index:"")+" of level "+a.level+" was dropped during download."),void p.fragmentTracker.removeFragment(a);a.stats.chunkCount++,p._handleFragmentLoadProgress(v)}).then(function(v){if(v){p.fragLoadError=0;var _=p.state;p.fragContextChanged(a)?(_===Kn||!p.fragCurrent&&_===Pr)&&(p.fragmentTracker.removeFragment(a),p.state=It):("payload"in v&&(p.log("Loaded fragment "+a.sn+" of level "+a.level),p.hls.trigger(b.Events.FRAG_LOADED,v)),p._handleFragmentLoadComplete(v))}}).catch(function(v){p.state!==Sr&&p.state!==Wr&&(p.warn(v),p.resetFragmentLoading(a))})},c.flushMainBuffer=function(a,f,g){if(g===void 0&&(g=null),a-f){var p={startOffset:a,endOffset:f,type:g};this.fragLoadError=0,this.hls.trigger(b.Events.BUFFER_FLUSHING,p)}},c._loadInitSegment=function(a,f){var g=this;this._doFragLoad(a,f).then(function(p){if(!p||g.fragContextChanged(a)||!g.levels)throw new Error("init load aborted");return p}).then(function(p){var v=g.hls,_=p.payload,L=a.decryptdata;if(_&&_.byteLength>0&&L&&L.key&&L.iv&&L.method==="AES-128"){var x=self.performance.now();return g.decrypter.decrypt(new Uint8Array(_),L.key.buffer,L.iv.buffer).then(function(M){var j=self.performance.now();return v.trigger(b.Events.FRAG_DECRYPTED,{frag:a,payload:M,stats:{tstart:x,tdecrypt:j}}),p.payload=M,p})}return p}).then(function(p){var v=g.fragCurrent,_=g.hls,L=g.levels;if(!L)throw new Error("init load aborted, missing levels");L[a.level].details;var x=a.stats;g.state=It,g.fragLoadError=0,a.data=new Uint8Array(p.payload),x.parsing.start=x.buffering.start=self.performance.now(),x.parsing.end=x.buffering.end=self.performance.now(),p.frag===v&&_.trigger(b.Events.FRAG_BUFFERED,{stats:x,frag:v,part:null,id:a.type}),g.tick()}).catch(function(p){g.state!==Sr&&g.state!==Wr&&(g.warn(p),g.resetFragmentLoading(a))})},c.fragContextChanged=function(a){var f=this.fragCurrent;return!a||!f||a.level!==f.level||a.sn!==f.sn||a.urlId!==f.urlId},c.fragBufferedComplete=function(a,f){var g,p,v=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+a.type+" sn: "+a.sn+(f?" part: "+f.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+a.level+" "+(v?Fh(Ut.getBuffered(v)):"(detached)")),this.state=It,v&&(!this.loadedmetadata&&a.type==O.PlaylistLevelType.MAIN&&v.buffered.length&&((g=this.fragCurrent)===null||g===void 0?void 0:g.sn)===((p=this.fragPrevious)===null||p===void 0?void 0:p.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},c.seekToStartPos=function(){},c._handleFragmentLoadComplete=function(a){var f=this.transmuxer;if(f){var g=a.frag,p=a.part,v=a.partsLoaded,_=!v||v.length===0||v.some(function(x){return!x}),L=new Sa(g.level,g.sn,g.stats.chunkCount+1,0,p?p.index:-1,!_);f.flush(L)}},c._handleFragmentLoadProgress=function(a){},c._doFragLoad=function(a,f,g,p){var v,_=this;if(g===void 0&&(g=null),!this.levels)throw new Error("frag load aborted, missing levels");var L=null;if(!a.encrypted||(v=a.decryptdata)!==null&&v!==void 0&&v.key?!a.encrypted&&f.encryptedFragments.length&&this.keyLoader.loadClear(a,f.encryptedFragments):(this.log("Loading key for "+a.sn+" of ["+f.startSN+"-"+f.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+a.level),this.state=qu,this.fragCurrent=a,L=this.keyLoader.load(a).then(function(Z){if(!_.fragContextChanged(Z.frag))return _.hls.trigger(b.Events.KEY_LOADED,Z),Z}),this.hls.trigger(b.Events.KEY_LOADING,{frag:a}),this.throwIfFragContextChanged("KEY_LOADING")),g=Math.max(a.start,g||0),this.config.lowLatencyMode&&f){var x=f.partList;if(x&&p){g>a.end&&f.fragmentHint&&(a=f.fragmentHint);var M=this.getNextPart(x,a,g);if(M>-1){var j=x[M];return this.log("Loading part sn: "+a.sn+" p: "+j.index+" cc: "+a.cc+" of playlist ["+f.startSN+"-"+f.endSN+"] parts [0-"+M+"-"+(x.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+a.level+", target: "+parseFloat(g.toFixed(3))),this.nextLoadPosition=j.start+j.duration,this.state=Kn,this.hls.trigger(b.Events.FRAG_LOADING,{frag:a,part:x[M],targetBufferTime:g}),this.throwIfFragContextChanged("FRAG_LOADING parts"),L?L.then(function(Z){return!Z||_.fragContextChanged(Z.frag)?null:_.doFragPartsLoad(a,x,M,p)}).catch(function(Z){return _.handleFragLoadError(Z)}):this.doFragPartsLoad(a,x,M,p).catch(function(Z){return _.handleFragLoadError(Z)})}if(!a.url||this.loadedEndOfParts(x,g))return Promise.resolve(null)}}this.log("Loading fragment "+a.sn+" cc: "+a.cc+" "+(f?"of ["+f.startSN+"-"+f.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+a.level+", target: "+parseFloat(g.toFixed(3))),(0,C.isFiniteNumber)(a.sn)&&!this.bitrateTest&&(this.nextLoadPosition=a.start+a.duration),this.state=Kn,this.hls.trigger(b.Events.FRAG_LOADING,{frag:a,targetBufferTime:g}),this.throwIfFragContextChanged("FRAG_LOADING");var K=this.config.progressive;return K&&L?L.then(function(Z){return!Z||_.fragContextChanged(Z==null?void 0:Z.frag)?null:_.fragmentLoader.load(a,p)}).catch(function(Z){return _.handleFragLoadError(Z)}):Promise.all([this.fragmentLoader.load(a,K?p:void 0),L]).then(function(Z){var he=Z[0];return!K&&he&&p&&p(he),he}).catch(function(Z){return _.handleFragLoadError(Z)})},c.throwIfFragContextChanged=function(a){if(this.fragCurrent===null)throw new Error("frag load aborted, context changed in "+a)},c.doFragPartsLoad=function(a,f,g,p){var v=this;return new Promise(function(_,L){var x=[];(function M(j){var K=f[j];v.fragmentLoader.loadPart(a,K,p).then(function(Z){x[K.index]=Z;var he=Z.part;v.hls.trigger(b.Events.FRAG_LOADED,Z);var _e=f[j+1];if(!_e||_e.fragment!==a)return _({frag:a,part:he,partsLoaded:x});M(j+1)}).catch(L)})(g)})},c.handleFragLoadError=function(a){if("data"in a){var f=a.data;a.data&&f.details===R.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(f.frag,f.part):this.hls.trigger(b.Events.ERROR,f)}else this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.OTHER_ERROR,details:R.ErrorDetails.INTERNAL_EXCEPTION,err:a,fatal:!0});return null},c._handleTransmuxerFlush=function(a){var f=this.getCurrentContext(a);if(f&&this.state===Pr){var g=f.frag,p=f.part,v=f.level,_=self.performance.now();g.stats.parsing.end=_,p&&(p.stats.parsing.end=_),this.updateLevelTiming(g,p,v,a.partial)}else this.fragCurrent||this.state===Sr||this.state===Wr||(this.state=It)},c.getCurrentContext=function(a){var f=this.levels,g=a.level,p=a.sn,v=a.part;if(!f||!f[g])return this.warn("Levels object was unset while buffering fragment "+p+" of level "+g+". The current chunk will not be buffered."),null;var _=f[g],L=v>-1?function(M,j,K){if(!M||!M.details)return null;var Z=M.details.partList;if(Z)for(var he=Z.length;he--;){var _e=Z[he];if(_e.index===K&&_e.fragment.sn===j)return _e}return null}(_,p,v):null,x=L?L.fragment:function(M,j,K){if(!M||!M.details)return null;var Z=M.details,he=Z.fragments[j-Z.startSN];return he||((he=Z.fragmentHint)&&he.sn===j?he:j<Z.startSN&&K&&K.sn===j?K:null)}(_,p,this.fragCurrent);return x?{frag:x,part:L,level:_}:null},c.bufferFragmentData=function(a,f,g,p){if(a&&this.state===Pr){var v=a.data1,_=a.data2,L=v;if(v&&_&&(L=(0,ve.appendUint8Array)(v,_)),L&&L.length){var x={type:a.type,frag:f,part:g,chunkMeta:p,parent:f.type,data:L};this.hls.trigger(b.Events.BUFFER_APPENDING,x),a.dropped&&a.independent&&!g&&this.flushBufferGap(f)}}},c.flushBufferGap=function(a){var f=this.media;if(f)if(Ut.isBuffered(f,f.currentTime)){var g=f.currentTime,p=Ut.bufferInfo(f,g,0),v=a.duration,_=Math.min(2*this.config.maxFragLookUpTolerance,.25*v),L=Math.max(Math.min(a.start-_,p.end-_),g+_);a.start-L>_&&this.flushMainBuffer(L,a.start)}else this.flushMainBuffer(0,a.start)},c.getFwdBufferInfo=function(a,f){var g=this.config,p=this.getLoadPosition();if(!(0,C.isFiniteNumber)(p))return null;var v=Ut.bufferInfo(a,p,g.maxBufferHole);if(v.len===0&&v.nextStart!==void 0){var _=this.fragmentTracker.getBufferedFrag(p,f);if(_&&v.nextStart<_.end)return Ut.bufferInfo(a,p,Math.max(v.nextStart,g.maxBufferHole))}return v},c.getMaxBufferLength=function(a){var f,g=this.config;return f=a?Math.max(8*g.maxBufferSize/a,g.maxBufferLength):g.maxBufferLength,Math.min(f,g.maxMaxBufferLength)},c.reduceMaxBufferLength=function(a){var f=this.config,g=a||f.maxBufferLength;return f.maxMaxBufferLength>=g&&(f.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+f.maxMaxBufferLength+"s"),!0)},c.getNextFragment=function(a,f){var g=f.fragments,p=g.length;if(!p)return null;var v,_=this.config,L=g[0].start;if(f.live){var x=_.initialLiveManifestSize;if(p<x)return this.warn("Not enough fragments to start playback (have: "+p+", need: "+x+")"),null;f.PTSKnown||this.startFragRequested||this.startPosition!==-1||(v=this.getInitialLiveFragment(f,g),this.startPosition=v?this.hls.liveSyncPosition||v.start:a)}else a<=L&&(v=g[0]);if(!v){var M=_.lowLatencyMode?f.partEnd:f.fragmentEnd;v=this.getFragmentAtPosition(a,M,f)}return this.mapToInitFragWhenRequired(v)},c.mapToInitFragWhenRequired=function(a){return a==null||!a.initSegment||a!=null&&a.initSegment.data||this.bitrateTest?a:a.initSegment},c.getNextPart=function(a,f,g){for(var p=-1,v=!1,_=!0,L=0,x=a.length;L<x;L++){var M=a[L];if(_=_&&!M.independent,p>-1&&g<M.start)break;var j=M.loaded;j?p=-1:(v||M.independent||_)&&M.fragment===f&&(p=L),v=j}return p},c.loadedEndOfParts=function(a,f){var g=a[a.length-1];return g&&f>g.start&&g.loaded},c.getInitialLiveFragment=function(a,f){var g=this.fragPrevious,p=null;if(g){if(a.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+g.programDateTime),p=function(x,M,j){if(M===null||!Array.isArray(x)||!x.length||!(0,C.isFiniteNumber)(M)||M<(x[0].programDateTime||0)||M>=(x[x.length-1].endProgramDateTime||0))return null;j=j||0;for(var K=0;K<x.length;++K){var Z=x[K];if(wh(M,j,Z))return Z}return null}(f,g.endProgramDateTime,this.config.maxFragLookUpTolerance)),!p){var v=g.sn+1;if(v>=a.startSN&&v<=a.endSN){var _=f[v-a.startSN];g.cc===_.cc&&(p=_,this.log("Live playlist, switching playlist, load frag with next SN: "+p.sn))}p||(p=function(x,M){return ju(x,function(j){return j.cc<M?1:j.cc>M?-1:0})}(f,g.cc),p&&this.log("Live playlist, switching playlist, load frag with same CC: "+p.sn))}}else{var L=this.hls.liveSyncPosition;L!==null&&(p=this.getFragmentAtPosition(L,this.bitrateTest?a.fragmentEnd:a.edge,a))}return p},c.getFragmentAtPosition=function(a,f,g){var p,v=this.config,_=this.fragPrevious,L=g.fragments,x=g.endSN,M=g.fragmentHint,j=v.maxFragLookUpTolerance,K=!!(v.lowLatencyMode&&g.partList&&M);if(K&&M&&!this.bitrateTest&&(L=L.concat(M),x=M.sn),p=a<f?Ca(_,L,a,a>f-j?0:j):L[L.length-1]){var Z=p.sn-g.startSN;if(this.fragmentTracker.getState(p)===qe.OK&&(_=p),_&&p.sn===_.sn&&!K&&_&&p.level===_.level){var he=L[Z+1];p.sn<x&&this.fragmentTracker.getState(he)!==qe.OK?(this.log("SN "+p.sn+" just loaded, load next one: "+he.sn),p=he):p=null}}return p},c.synchronizeToLiveEdge=function(a){var f=this.config,g=this.media;if(g){var p=this.hls.liveSyncPosition,v=g.currentTime,_=a.fragments[0].start,L=a.edge,x=v>=_-f.maxFragLookUpTolerance&&v<=L;if(p!==null&&g.duration>p&&(v<p||!x)){var M=f.liveMaxLatencyDuration!==void 0?f.liveMaxLatencyDuration:f.liveMaxLatencyDurationCount*a.targetduration;(!x&&g.readyState<4||v<L-M)&&(this.loadedmetadata||(this.nextLoadPosition=p),g.readyState&&(this.warn("Playback: "+v.toFixed(3)+" is located too far from the end of live sliding playlist: "+L+", reset currentTime to : "+p.toFixed(3)),g.currentTime=p))}}},c.alignPlaylists=function(a,f){var g=this.levels,p=this.levelLastLoaded,v=this.fragPrevious,_=p!==null?g[p]:null,L=a.fragments.length;if(!L)return this.warn("No fragments in live playlist"),0;var x=a.fragments[0].start,M=!f,j=a.alignedSliding&&(0,C.isFiniteNumber)(x);if(M||!j&&!x){(function(Z,he,_e){he&&(function(Ee,De,$e){if(function(Se,Xe,je){return!(!Xe.details||!(je.endCC>je.startCC||Se&&Se.cc<je.startCC))}(Ee,$e,De)){var st=function(Se,Xe,je){var mt=Se.fragments,xt=Xe.fragments;if(xt.length&&mt.length){var Tt=Ku(mt,xt[0].cc);if(Tt&&(!Tt||Tt.startPTS))return Tt;P.logger.log("No frag in previous level to align on")}else P.logger.log("No fragments to align")}($e.details,De);st&&(0,C.isFiniteNumber)(st.start)&&(P.logger.log("Adjusting PTS using last level due to CC increase within current level "+De.url),Ia(st.start,De))}}(Z,_e,he),!_e.alignedSliding&&he.details&&function(Ee,De){if(De.fragments.length&&Ee.hasProgramDateTime&&De.hasProgramDateTime){var $e=De.fragments[0].programDateTime,st=Ee.fragments[0].programDateTime,Se=(st-$e)/1e3+De.fragments[0].start;Se&&(0,C.isFiniteNumber)(Se)&&(P.logger.log("Adjusting PTS using programDateTime delta "+(st-$e)+"ms, sliding:"+Se.toFixed(3)+" "+Ee.url+" "),Ia(Se,Ee))}}(_e,he.details),_e.alignedSliding||!he.details||_e.skippedSegments||ne(he.details,_e))})(v,_,a);var K=a.fragments[0].start;return this.log("Live playlist sliding: "+K.toFixed(2)+" start-sn: "+(f?f.startSN:"na")+"->"+a.startSN+" prev-sn: "+(v?v.sn:"na")+" fragments: "+L),K}return x},c.waitForCdnTuneIn=function(a){return a.live&&a.canBlockReload&&a.partTarget&&a.tuneInGoal>Math.max(a.partHoldBack,3*a.partTarget)},c.setStartPosition=function(a,f){var g=this.startPosition;if(g<f&&(g=-1),g===-1||this.lastCurrentTime===-1){var p=a.startTimeOffset;(0,C.isFiniteNumber)(p)?(g=f+p,p<0&&(g+=a.totalduration),g=Math.min(Math.max(f,g),f+a.totalduration),this.log("Start time offset "+p+" found in playlist, adjust startPosition to "+g),this.startPosition=g):a.live?g=this.hls.liveSyncPosition||f:this.startPosition=g=0,this.lastCurrentTime=g}this.nextLoadPosition=g},c.getLoadPosition=function(){var a=this.media,f=0;return this.loadedmetadata&&a?f=a.currentTime:this.nextLoadPosition&&(f=this.nextLoadPosition),f},c.handleFragLoadAborted=function(a,f){this.transmuxer&&a.sn!=="initSegment"&&a.stats.aborted&&(this.warn("Fragment "+a.sn+(f?" part"+f.index:"")+" of level "+a.level+" was aborted"),this.resetFragmentLoading(a))},c.resetFragmentLoading=function(a){this.fragCurrent&&(this.fragContextChanged(a)||this.state===Yn)||(this.state=It)},c.onFragmentOrKeyLoadError=function(a,f){if(f.fatal)return this.stopLoad(),void(this.state=Wr);var g=this.config;if(f.chunkMeta){var p=this.getCurrentContext(f.chunkMeta);p&&(f.frag=p.frag,f.levelRetry=!0,this.fragLoadError=g.fragLoadingMaxRetry)}var v=f.frag;if(v&&v.type===a)if(this.fragCurrent,this.fragLoadError+1<=g.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var _=Math.min(Math.pow(2,this.fragLoadError)*g.fragLoadingRetryDelay,g.fragLoadingMaxRetryTimeout);this.warn("Fragment "+v.sn+" of "+a+" "+v.level+" failed to load, retrying in "+_+"ms"),this.retryDate=self.performance.now()+_,this.fragLoadError++,this.state=Yn}else f.levelRetry?(a===O.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=It):(P.logger.error(f.details+" reaches max retry, redispatch as fatal ..."),f.fatal=!0,this.hls.stopLoad(),this.state=Wr)},c.afterBufferFlushed=function(a,f,g){if(a){var p=Ut.getBuffered(a);this.fragmentTracker.detectEvictedFragments(f,p,g),this.state===yi&&this.resetLoadingState()}},c.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=It},c.resetStartWhenNotLoaded=function(a){if(!this.loadedmetadata){this.startFragRequested=!1;var f=this.levels?this.levels[a].details:null;f!=null&&f.live?(this.startPosition=-1,this.setStartPosition(f,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},c.updateLevelTiming=function(a,f,g,p){var v=this,_=g.details;Object.keys(a.elementaryStreams).reduce(function(L,x){var M=a.elementaryStreams[x];if(M){var j=M.endPTS-M.startPTS;if(j<=0)return v.warn("Could not parse fragment "+a.sn+" "+x+" duration reliably ("+j+")"),L||!1;var K=p?0:ee(_,a,M.startPTS,M.endPTS,M.startDTS,M.endDTS);return v.hls.trigger(b.Events.LEVEL_PTS_UPDATED,{details:_,level:g,drift:K,type:x,frag:a,start:M.startPTS,end:M.endPTS}),!0}return L},!1)||(this.warn("Found no media in fragment "+a.sn+" of level "+g.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=bi,this.hls.trigger(b.Events.FRAG_PARSED,{frag:a,part:f})},c.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},o=s,(l=[{key:"state",get:function(){return this._state},set:function(a){var f=this._state;f!==a&&(this._state=a,this.log(f+"->"+a))}}])&&Bh(o.prototype,l),Object.defineProperty(o,"prototype",{writable:!1}),s}(vn);function Na(){return self.MediaSource||self.WebKitMediaSource}function Wu(){return self.SourceBuffer||self.WebKitSourceBuffer}var Oa=function(){var E=ENTRY_MODULE,h={},n=function o(l){var c=h[l];if(c!==void 0)return c.exports;var a=h[l]={exports:{}};return E[l].call(a.exports,a,a.exports,o),a.exports};n.m=E,n.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return n.d(l,{a:l}),l},n.d=function(o,l){for(var c in l)n.o(l,c)&&!n.o(o,c)&&Object.defineProperty(o,c,{enumerable:!0,get:l[c]})},n.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},n.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var s=n(ENTRY_MODULE);return s.default||s}.toString().split("ENTRY_MODULE"),Xu="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function Qu(E){return(E+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function Uh(E,h,n){var s={};s[n]=[];var o=h.toString().replace(/^"[^"]+"/,"function"),l=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||o.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!l)return s;for(var c,a=l[1],f=new RegExp("(\\\\n|\\W)"+Qu(a)+Xu,"g");c=f.exec(o);)c[3]!=="dll-reference"&&s[n].push(c[3]);for(f=new RegExp("\\("+Qu(a)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+Xu,"g");c=f.exec(o);)E[c[2]]||(s[n].push(c[1]),E[c[2]]=y(c[1]).m),s[c[2]]=s[c[2]]||[],s[c[2]].push(c[4]);for(var g,p=Object.keys(s),v=0;v<p.length;v++)for(var _=0;_<s[p[v]].length;_++)g=s[p[v]][_],isNaN(1*g)||(s[p[v]][_]=1*s[p[v]][_]);return s}function Hh(E){return Object.keys(E).reduce(function(h,n){return h||E[n].length>0},!1)}function zu(E,h,n,s){var o=E[s].map(function(l){return'"'+l+'": '+h[s][l].toString().replace(/^"[^"]+"/,"function")}).join(",");return Oa[0]+"{"+o+"}"+Oa[1]+'"'+n+'"'+Oa[2]}var bn=y(544),xa=y(729),Gh=y.n(xa),ka=Na()||{isTypeSupported:function(){return!1}},$u=function(){function E(n,s,o,l){var c=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var a=n.config;this.hls=n,this.id=s,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=o,this.onFlush=l;var f=function(_,L){(L=L||{}).frag=c.frag,L.id=c.id,c.hls.trigger(_,L)};this.observer=new xa.EventEmitter,this.observer.on(b.Events.FRAG_DECRYPTED,f),this.observer.on(b.Events.ERROR,f);var g={mp4:ka.isTypeSupported("video/mp4"),mpeg:ka.isTypeSupported("audio/mpeg"),mp3:ka.isTypeSupported('audio/mp4; codecs="mp3"')},p=navigator.vendor;if(this.useWorker&&typeof Worker<"u"){var v;P.logger.log("demuxing in webworker");try{v=this.worker=function(_,L){L=L||{};var x={main:y.m},M=L.all?{main:Object.keys(x.main)}:function(_e,Ee){for(var De={main:[Ee]},$e={main:[]},st={main:{}};Hh(De);)for(var Se=Object.keys(De),Xe=0;Xe<Se.length;Xe++){var je=Se[Xe],mt=De[je].pop();if(st[je]=st[je]||{},!st[je][mt]&&_e[je][mt]){st[je][mt]=!0,$e[je]=$e[je]||[],$e[je].push(mt);for(var xt=Uh(_e,_e[je][mt],je),Tt=Object.keys(xt),_t=0;_t<Tt.length;_t++)De[Tt[_t]]=De[Tt[_t]]||[],De[Tt[_t]]=De[Tt[_t]].concat(xt[Tt[_t]])}}return $e}(x,_),j="";Object.keys(M).filter(function(_e){return _e!=="main"}).forEach(function(_e){for(var Ee=0;M[_e][Ee];)Ee++;M[_e].push(Ee),x[_e][Ee]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",j=j+"var "+_e+" = ("+zu(M,x,Ee,modules)+`)();
`}),j=j+"new (("+zu(M,x,_,"main")+")())(self);";var K=new window.Blob([j],{type:"text/javascript"}),Z=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(K),he=new window.Worker(Z);return he.objectURL=Z,he}(182),this.onwmsg=this.onWorkerMessage.bind(this),v.addEventListener("message",this.onwmsg),v.onerror=function(_){c.useWorker=!1,P.logger.warn("Exception in webworker, fallback to inline"),c.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.OTHER_ERROR,details:R.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(_.message+"  ("+_.filename+":"+_.lineno+")")})},v.postMessage({cmd:"init",typeSupported:g,vendor:p,id:s,config:JSON.stringify(a)})}catch(_){P.logger.warn("Error in worker:",_),P.logger.error("Error while initializing DemuxerWorker, fallback to inline"),v&&self.URL.revokeObjectURL(v.objectURL),this.transmuxer=new bn.default(this.observer,g,a,p,s),this.worker=null}}else this.transmuxer=new bn.default(this.observer,g,a,p,s)}var h=E.prototype;return h.destroy=function(){var n=this.worker;if(n)n.removeEventListener("message",this.onwmsg),n.terminate(),this.worker=null,this.onwmsg=void 0;else{var s=this.transmuxer;s&&(s.destroy(),this.transmuxer=null)}var o=this.observer;o&&o.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},h.push=function(n,s,o,l,c,a,f,g,p,v){var _,L,x=this;p.transmuxing.start=self.performance.now();var M=this.transmuxer,j=this.worker,K=a?a.start:c.start,Z=c.decryptdata,he=this.frag,_e=!(he&&c.cc===he.cc),Ee=!(he&&p.level===he.level),De=he?p.sn-he.sn:-1,$e=this.part?p.part-this.part.index:-1,st=De===0&&p.id>1&&p.id===(he==null?void 0:he.stats.chunkCount),Se=!Ee&&(De===1||De===0&&($e===1||st&&$e<=0)),Xe=self.performance.now();(Ee||De||c.stats.parsing.start===0)&&(c.stats.parsing.start=Xe),!a||!$e&&Se||(a.stats.parsing.start=Xe);var je=!(he&&((_=c.initSegment)===null||_===void 0?void 0:_.url)===((L=he.initSegment)===null||L===void 0?void 0:L.url)),mt=new bn.TransmuxState(_e,Se,g,Ee,K,je);if(!Se||_e||je){P.logger.log("[transmuxer-interface, "+c.type+"]: Starting new transmux session for sn: "+p.sn+" p: "+p.part+" level: "+p.level+" id: "+p.id+`
        discontinuity: `+_e+`
        trackSwitch: `+Ee+`
        contiguous: `+Se+`
        accurateTimeOffset: `+g+`
        timeOffset: `+K+`
        initSegmentChange: `+je);var xt=new bn.TransmuxConfig(o,l,s,f,v);this.configureTransmuxer(xt)}if(this.frag=c,this.part=a,j)j.postMessage({cmd:"demux",data:n,decryptdata:Z,chunkMeta:p,state:mt},n instanceof ArrayBuffer?[n]:[]);else if(M){var Tt=M.push(n,Z,p,mt);(0,bn.isPromise)(Tt)?(M.async=!0,Tt.then(function(_t){x.handleTransmuxComplete(_t)}).catch(function(_t){x.transmuxerError(_t,p,"transmuxer-interface push error")})):(M.async=!1,this.handleTransmuxComplete(Tt))}},h.flush=function(n){var s=this;n.transmuxing.start=self.performance.now();var o=this.transmuxer,l=this.worker;if(l)l.postMessage({cmd:"flush",chunkMeta:n});else if(o){var c=o.flush(n);(0,bn.isPromise)(c)||o.async?((0,bn.isPromise)(c)||(c=Promise.resolve(c)),c.then(function(a){s.handleFlushResult(a,n)}).catch(function(a){s.transmuxerError(a,n,"transmuxer-interface flush error")})):this.handleFlushResult(c,n)}},h.transmuxerError=function(n,s,o){this.hls&&this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:s,fatal:!1,error:n,err:n,reason:o})},h.handleFlushResult=function(n,s){var o=this;n.forEach(function(l){o.handleTransmuxComplete(l)}),this.onFlush(s)},h.onWorkerMessage=function(n){var s=n.data,o=this.hls;switch(s.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(s.data);break;case"flush":this.onFlush(s.data);break;case"workerLog":P.logger[s.data.logType]&&P.logger[s.data.logType](s.data.message);break;default:s.data=s.data||{},s.data.frag=this.frag,s.data.id=this.id,o.trigger(s.event,s.data)}},h.configureTransmuxer=function(n){var s=this.worker,o=this.transmuxer;s?s.postMessage({cmd:"configure",config:n}):o&&o.configure(n)},h.handleTransmuxComplete=function(n){n.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(n)},E}(),Kh=function(){function E(n,s,o,l){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=n,this.media=s,this.fragmentTracker=o,this.hls=l}var h=E.prototype;return h.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},h.poll=function(n,s){var o=this.config,l=this.media,c=this.stalled;if(l!==null){var a=l.currentTime,f=l.seeking,g=this.seeking&&!f,p=!this.seeking&&f;if(this.seeking=f,a===n){if((p||g)&&(this.stalled=null),!(l.paused&&!f||l.ended||l.playbackRate===0)&&Ut.getBuffered(l).length){var v=Ut.bufferInfo(l,a,0),_=v.len>0,L=v.nextStart||0;if(_||L){if(f){var x=v.len>2,M=!L||s&&s.start<=a||L-a>2&&!this.fragmentTracker.getPartialFragment(a);if(x||M)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var j,K=Math.max(L,v.start||0)-a,Z=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,he=!(Z==null||(j=Z.details)===null||j===void 0)&&j.live?2*Z.details.targetduration:2;if(K>0&&K<=he)return void this._trySkipBufferHole(null)}var _e=self.performance.now();if(c!==null){var Ee=_e-c;if(f||!(Ee>=250)||(this._reportStall(v),this.media)){var De=Ut.bufferInfo(l,a,o.maxBufferHole);this._tryFixBufferStall(De,Ee)}}else this.stalled=_e}}}else if(this.moved=!0,c!==null){if(this.stallReported){var $e=self.performance.now()-c;P.logger.warn("playback not stuck anymore @"+a+", after "+Math.round($e)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}}},h._tryFixBufferStall=function(n,s){var o=this.config,l=this.fragmentTracker,c=this.media;if(c!==null){var a=c.currentTime,f=l.getPartialFragment(a);if(f&&(this._trySkipBufferHole(f)||!this.media))return;n.len>o.maxBufferHole&&s>1e3*o.highBufferWatchdogPeriod&&(P.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},h._reportStall=function(n){var s=this.hls,o=this.media;!this.stallReported&&o&&(this.stallReported=!0,P.logger.warn("Playback stalling at @"+o.currentTime+" due to low buffer ("+JSON.stringify(n)+")"),s.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:n.len}))},h._trySkipBufferHole=function(n){var s=this.config,o=this.hls,l=this.media;if(l===null)return 0;for(var c=l.currentTime,a=0,f=Ut.getBuffered(l),g=0;g<f.length;g++){var p=f.start(g);if(c+s.maxBufferHole>=a&&c<p){var v=Math.max(p+.05,l.currentTime+.1);return P.logger.warn("skipping hole, adjusting currentTime from "+c+" to "+v),this.moved=!0,this.stalled=null,l.currentTime=v,n&&o.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+c+" to "+v,frag:n}),v}a=f.end(g)}return 0},h._tryNudgeBuffer=function(){var n=this.config,s=this.hls,o=this.media,l=this.nudgeRetry;if(o!==null){var c=o.currentTime;if(this.nudgeRetry++,l<n.nudgeMaxRetry){var a=c+(l+1)*n.nudgeOffset;P.logger.warn("Nudging 'currentTime' from "+c+" to "+a),o.currentTime=a,s.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else P.logger.error("Playhead still not moving while enough data buffered @"+c+" after "+n.nudgeMaxRetry+" nudges"),s.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},E}();function Yh(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}function Pa(E,h){return Pa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Pa(E,h)}var Vh=function(E){var h,n;function s(a,f,g){var p;return(p=E.call(this,a,f,g,"[stream-controller]")||this).audioCodecSwap=!1,p.gapController=null,p.level=-1,p._forceStartLoad=!1,p.altAudio=!1,p.audioOnly=!1,p.fragPlaying=null,p.onvplaying=null,p.onvseeked=null,p.fragLastKbps=0,p.couldBacktrack=!1,p.backtrackFragment=null,p.audioCodecSwitch=!1,p.videoBuffer=null,p._registerListeners(),p}n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,Pa(h,n);var o,l,c=s.prototype;return c._registerListeners=function(){var a=this.hls;a.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.on(b.Events.LEVEL_LOADING,this.onLevelLoading,this),a.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.on(b.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),a.on(b.Events.ERROR,this.onError,this),a.on(b.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),a.on(b.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),a.on(b.Events.BUFFER_CREATED,this.onBufferCreated,this),a.on(b.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),a.on(b.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),a.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c._unregisterListeners=function(){var a=this.hls;a.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.off(b.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),a.off(b.Events.ERROR,this.onError,this),a.off(b.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),a.off(b.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),a.off(b.Events.BUFFER_CREATED,this.onBufferCreated,this),a.off(b.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),a.off(b.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),a.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},c.startLoad=function(a){if(this.levels){var f=this.lastCurrentTime,g=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var p=g.startLevel;p===-1&&(g.config.testBandwidth&&this.levels.length>1?(p=0,this.bitrateTest=!0):p=g.nextAutoLevel),this.level=g.nextLoadLevel=p,this.loadedmetadata=!1}f>0&&a===-1&&(this.log("Override startPosition with lastCurrentTime @"+f.toFixed(3)),a=f),this.state=It,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a,this.tick()}else this._forceStartLoad=!0,this.state=Sr},c.stopLoad=function(){this._forceStartLoad=!1,E.prototype.stopLoad.call(this)},c.doTick=function(){switch(this.state){case It:this.doTickIdle();break;case Vn:var a,f=this.levels,g=this.level,p=f==null||(a=f[g])===null||a===void 0?void 0:a.details;if(p&&(!p.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(p))break;this.state=It;break}break;case Yn:var v,_=self.performance.now(),L=this.retryDate;(!L||_>=L||(v=this.media)!==null&&v!==void 0&&v.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=It)}this.onTickEnd()},c.onTickEnd=function(){E.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},c.doTickIdle=function(){var a=this.hls,f=this.levelLastLoaded,g=this.levels,p=this.media,v=a.config,_=a.nextLoadLevel;if(f!==null&&(p||!this.startFragRequested&&v.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&g&&g[_]){var L=g[_],x=this.getMainFwdBufferInfo();if(x!==null){var M=this.getLevelDetails();if(M&&this._streamEnded(x,M)){var j={};return this.altAudio&&(j.type="video"),this.hls.trigger(b.Events.BUFFER_EOS,j),void(this.state=yi)}this.level=a.nextLoadLevel=_;var K=L.details;if(!K||this.state===Vn||K.live&&this.levelLastLoaded!==_)return this.level=_,void(this.state=Vn);if(!(x.len>=this.getMaxBufferLength(L.maxBitrate))){this.backtrackFragment&&this.backtrackFragment.start>x.end&&(this.backtrackFragment=null);var Z=this.backtrackFragment?this.backtrackFragment.start:x.end,he=this.getNextFragment(Z,K);if(this.couldBacktrack&&!this.fragPrevious&&he&&he.sn!=="initSegment"&&this.fragmentTracker.getState(he)!==qe.OK){var _e,Ee=((_e=this.backtrackFragment)!=null?_e:he).sn-K.startSN,De=K.fragments[Ee-1];De&&he.cc===De.cc&&(he=De,this.fragmentTracker.removeFragment(De))}else this.backtrackFragment&&x.len&&(this.backtrackFragment=null);if(he&&this.fragmentTracker.getState(he)===qe.OK&&this.nextLoadPosition>Z){var $e=this.audioOnly&&!this.altAudio?oe.ElementaryStreamTypes.AUDIO:oe.ElementaryStreamTypes.VIDEO,st=($e===oe.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;st&&this.afterBufferFlushed(st,$e,O.PlaylistLevelType.MAIN),he=this.getNextFragment(this.nextLoadPosition,K)}he&&(!he.initSegment||he.initSegment.data||this.bitrateTest||(he=he.initSegment),this.loadFragment(he,K,Z))}}}},c.loadFragment=function(a,f,g){var p,v=this.fragmentTracker.getState(a);this.fragCurrent=a,v===qe.NOT_LOADED?a.sn==="initSegment"?this._loadInitSegment(a,f):this.bitrateTest?(this.log("Fragment "+a.sn+" of level "+a.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(a,f)):(this.startFragRequested=!0,E.prototype.loadFragment.call(this,a,f,g)):v===qe.APPENDING?this.reduceMaxBufferLength(a.duration)&&this.fragmentTracker.removeFragment(a):((p=this.media)===null||p===void 0?void 0:p.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},c.getAppendedFrag=function(a){var f=this.fragmentTracker.getAppendedFrag(a,O.PlaylistLevelType.MAIN);return f&&"fragment"in f?f.fragment:f},c.getBufferedFrag=function(a){return this.fragmentTracker.getBufferedFrag(a,O.PlaylistLevelType.MAIN)},c.followingBufferedFrag=function(a){return a?this.getBufferedFrag(a.end+.5):null},c.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},c.nextLevelSwitch=function(){var a=this.levels,f=this.media;if(f!=null&&f.readyState){var g,p=this.getAppendedFrag(f.currentTime);if(p&&p.start>1&&this.flushMainBuffer(0,p.start-1),!f.paused&&a){var v=a[this.hls.nextLoadLevel],_=this.fragLastKbps;g=_&&this.fragCurrent?this.fragCurrent.duration*v.maxBitrate/(1e3*_)+1:0}else g=0;var L=this.getBufferedFrag(f.currentTime+g);if(L){var x=this.followingBufferedFrag(L);if(x){this.abortCurrentFrag();var M=x.maxStartPTS?x.maxStartPTS:x.start,j=x.duration,K=Math.max(L.end,M+Math.min(Math.max(j-this.config.maxFragLookUpTolerance,.5*j),.75*j));this.flushMainBuffer(K,Number.POSITIVE_INFINITY)}}}},c.abortCurrentFrag=function(){var a=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,a&&a.abortRequests(),this.state){case qu:case Kn:case Yn:case Pr:case bi:this.state=It}this.nextLoadPosition=this.getLoadPosition()},c.flushMainBuffer=function(a,f){E.prototype.flushMainBuffer.call(this,a,f,this.altAudio?"video":null)},c.onMediaAttached=function(a,f){E.prototype.onMediaAttached.call(this,a,f);var g=f.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),g.addEventListener("playing",this.onvplaying),g.addEventListener("seeked",this.onvseeked),this.gapController=new Kh(this.config,g,this.fragmentTracker,this.hls)},c.onMediaDetaching=function(){var a=this.media;a&&this.onvplaying&&this.onvseeked&&(a.removeEventListener("playing",this.onvplaying),a.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),E.prototype.onMediaDetaching.call(this)},c.onMediaPlaying=function(){this.tick()},c.onMediaSeeked=function(){var a=this.media,f=a?a.currentTime:null;(0,C.isFiniteNumber)(f)&&this.log("Media seeked to "+f.toFixed(3)),this.tick()},c.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(b.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},c.onManifestParsed=function(a,f){var g,p,v,_=!1,L=!1;f.levels.forEach(function(x){(g=x.audioCodec)&&(g.indexOf("mp4a.40.2")!==-1&&(_=!0),g.indexOf("mp4a.40.5")!==-1&&(L=!0))}),this.audioCodecSwitch=_&&L&&typeof((v=Wu())==null||(p=v.prototype)===null||p===void 0?void 0:p.changeType)!="function",this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=f.levels,this.startFragRequested=!1},c.onLevelLoading=function(a,f){var g=this.levels;if(g&&this.state===It){var p=g[f.level];(!p.details||p.details.live&&this.levelLastLoaded!==f.level||this.waitForCdnTuneIn(p.details))&&(this.state=Vn)}},c.onLevelLoaded=function(a,f){var g,p=this.levels,v=f.level,_=f.details,L=_.totalduration;if(p){this.log("Level "+v+" loaded ["+_.startSN+","+_.endSN+"], cc ["+_.startCC+", "+_.endCC+"] duration:"+L);var x=this.fragCurrent;!x||this.state!==Kn&&this.state!==Yn||x.level!==f.level&&x.loader&&(this.state=It,this.backtrackFragment=null,x.abortRequests());var M=p[v],j=0;if(_.live||(g=M.details)!==null&&g!==void 0&&g.live){if(_.fragments[0]||(_.deltaUpdateFailed=!0),_.deltaUpdateFailed)return;j=this.alignPlaylists(_,M.details)}if(M.details=_,this.levelLastLoaded=v,this.hls.trigger(b.Events.LEVEL_UPDATED,{details:_,level:v}),this.state===Vn){if(this.waitForCdnTuneIn(_))return;this.state=It}this.startFragRequested?_.live&&this.synchronizeToLiveEdge(_):this.setStartPosition(_,j),this.tick()}else this.warn("Levels were reset while loading level "+v)},c._handleFragmentLoadProgress=function(a){var f,g=a.frag,p=a.part,v=a.payload,_=this.levels;if(_){var L=_[g.level],x=L.details;if(x){var M=L.videoCodec,j=x.PTSKnown||!x.live,K=(f=g.initSegment)===null||f===void 0?void 0:f.data,Z=this._getAudioCodec(L),he=this.transmuxer=this.transmuxer||new $u(this.hls,O.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),_e=p?p.index:-1,Ee=_e!==-1,De=new Sa(g.level,g.sn,g.stats.chunkCount,v.byteLength,_e,Ee),$e=this.initPTS[g.cc];he.push(v,K,Z,M,g,p,x.totalduration,j,De,$e)}else this.warn("Dropping fragment "+g.sn+" of level "+g.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+g.sn+" of level "+g.level+" will not be buffered")},c.onAudioTrackSwitching=function(a,f){var g=this.altAudio,p=!!f.url,v=f.id;if(!p){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var _=this.fragCurrent;_&&(this.log("Switching to main audio track, cancel main fragment load"),_.abortRequests()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var L=this.hls;g&&L.trigger(b.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),L.trigger(b.Events.AUDIO_TRACK_SWITCHED,{id:v})}},c.onAudioTrackSwitched=function(a,f){var g=f.id,p=!!this.hls.audioTracks[g].url;if(p){var v=this.videoBuffer;v&&this.mediaBuffer!==v&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=v)}this.altAudio=p,this.tick()},c.onBufferCreated=function(a,f){var g,p,v=f.tracks,_=!1;for(var L in v){var x=v[L];if(x.id==="main"){if(p=L,g=x,L==="video"){var M=v[L];M&&(this.videoBuffer=M.buffer)}}else _=!0}_&&g?(this.log("Alternate track found, use "+p+".buffered to schedule main fragment loading"),this.mediaBuffer=g.buffer):this.mediaBuffer=this.media},c.onFragBuffered=function(a,f){var g=f.frag,p=f.part;if(!g||g.type===O.PlaylistLevelType.MAIN){if(this.fragContextChanged(g))return this.warn("Fragment "+g.sn+(p?" p: "+p.index:"")+" of level "+g.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===bi&&(this.state=It));var v=p?p.stats:g.stats;this.fragLastKbps=Math.round(8*v.total/(v.buffering.end-v.loading.first)),g.sn!=="initSegment"&&(this.fragPrevious=g),this.fragBufferedComplete(g,p)}},c.onError=function(a,f){if(f.type!==R.ErrorTypes.KEY_SYSTEM_ERROR)switch(f.details){case R.ErrorDetails.FRAG_LOAD_ERROR:case R.ErrorDetails.FRAG_LOAD_TIMEOUT:case R.ErrorDetails.FRAG_PARSING_ERROR:case R.ErrorDetails.KEY_LOAD_ERROR:case R.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(O.PlaylistLevelType.MAIN,f);break;case R.ErrorDetails.LEVEL_LOAD_ERROR:case R.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==Wr&&(f.fatal?(this.warn(""+f.details),this.state=Wr):f.levelRetry||this.state!==Vn||(this.state=It));break;case R.ErrorDetails.BUFFER_FULL_ERROR:if(f.parent==="main"&&(this.state===Pr||this.state===bi)){var g=!0,p=this.getFwdBufferInfo(this.media,O.PlaylistLevelType.MAIN);p&&p.len>.5&&(g=!this.reduceMaxBufferLength(p.len)),g&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(O.PlaylistLevelType.MAIN,f)},c.checkBuffer=function(){var a=this.media,f=this.gapController;if(a&&f&&a.readyState){if(this.loadedmetadata||!Ut.getBuffered(a).length){var g=this.state!==It?this.fragCurrent:null;f.poll(this.lastCurrentTime,g)}this.lastCurrentTime=a.currentTime}},c.onFragLoadEmergencyAborted=function(){this.state=It,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},c.onBufferFlushed=function(a,f){var g=f.type;if(g!==oe.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var p=(g===oe.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(p,g,O.PlaylistLevelType.MAIN)}},c.onLevelsUpdated=function(a,f){this.levels=f.levels},c.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},c.seekToStartPos=function(){var a=this.media;if(a){var f=a.currentTime,g=this.startPosition;if(g>=0&&f<g){if(a.seeking)return void this.log("could not seek to "+g+", already seeking at "+f);var p=Ut.getBuffered(a),v=(p.length?p.start(0):0)-g;v>0&&(v<this.config.maxBufferHole||v<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+v+" to match buffer start"),g+=v,this.startPosition=g),this.log("seek to target start position "+g+" from current time "+f),a.currentTime=g}}},c._getAudioCodec=function(a){var f=this.config.defaultAudioCodec||a.audioCodec;return this.audioCodecSwap&&f&&(this.log("Swapping audio codec"),f=f.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),f},c._loadBitrateTestFrag=function(a,f){var g=this;a.bitrateTest=!0,this._doFragLoad(a,f).then(function(p){var v=g.hls;if(p&&!v.nextLoadLevel&&!g.fragContextChanged(a)){g.fragLoadError=0,g.state=It,g.startFragRequested=!1,g.bitrateTest=!1;var _=a.stats;_.parsing.start=_.parsing.end=_.buffering.start=_.buffering.end=self.performance.now(),v.trigger(b.Events.FRAG_LOADED,p),a.bitrateTest=!1}})},c._handleTransmuxComplete=function(a){var f,g="main",p=this.hls,v=a.remuxResult,_=a.chunkMeta,L=this.getCurrentContext(_);if(!L)return this.warn("The loading context changed while buffering fragment "+_.sn+" of level "+_.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(_.level);var x=L.frag,M=L.part,j=L.level,K=v.video,Z=v.text,he=v.id3,_e=v.initSegment,Ee=j.details,De=this.altAudio?void 0:v.audio;if(!this.fragContextChanged(x)){if(this.state=Pr,_e){_e.tracks&&(this._bufferInitSegment(j,_e.tracks,x,_),p.trigger(b.Events.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:g,tracks:_e.tracks}));var $e=_e.initPTS,st=_e.timescale;(0,C.isFiniteNumber)($e)&&(this.initPTS[x.cc]=$e,p.trigger(b.Events.INIT_PTS_FOUND,{frag:x,id:g,initPTS:$e,timescale:st}))}if(K&&v.independent!==!1){if(Ee){var Se=K.startPTS,Xe=K.endPTS,je=K.startDTS,mt=K.endDTS;if(M)M.elementaryStreams[K.type]={startPTS:Se,endPTS:Xe,startDTS:je,endDTS:mt};else if(K.firstKeyFrame&&K.independent&&_.id===1&&(this.couldBacktrack=!0),K.dropped&&K.independent){var xt=this.getMainFwdBufferInfo();if((xt?xt.end:this.getLoadPosition())+this.config.maxBufferHole<(K.firstKeyFramePTS?K.firstKeyFramePTS:Se)-this.config.maxBufferHole)return void this.backtrack(x);x.setElementaryStreamInfo(K.type,x.start,Xe,x.start,mt,!0)}x.setElementaryStreamInfo(K.type,Se,Xe,je,mt),this.backtrackFragment&&(this.backtrackFragment=x),this.bufferFragmentData(K,x,M,_)}}else if(v.independent===!1)return void this.backtrack(x);if(De){var Tt=De.startPTS,_t=De.endPTS,Lt=De.startDTS,Xt=De.endDTS;M&&(M.elementaryStreams[oe.ElementaryStreamTypes.AUDIO]={startPTS:Tt,endPTS:_t,startDTS:Lt,endDTS:Xt}),x.setElementaryStreamInfo(oe.ElementaryStreamTypes.AUDIO,Tt,_t,Lt,Xt),this.bufferFragmentData(De,x,M,_)}if(Ee&&he!=null&&(f=he.samples)!==null&&f!==void 0&&f.length){var Wt={id:g,frag:x,details:Ee,samples:he.samples};p.trigger(b.Events.FRAG_PARSING_METADATA,Wt)}if(Ee&&Z){var Ht={id:g,frag:x,details:Ee,samples:Z.samples};p.trigger(b.Events.FRAG_PARSING_USERDATA,Ht)}}},c._bufferInitSegment=function(a,f,g,p){var v=this;if(this.state===Pr){this.audioOnly=!!f.audio&&!f.video,this.altAudio&&!this.audioOnly&&delete f.audio;var _=f.audio,L=f.video,x=f.audiovideo;if(_){var M=a.audioCodec,j=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(M&&(M=M.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),_.metadata.channelCount!==1&&j.indexOf("firefox")===-1&&(M="mp4a.40.5")),j.indexOf("android")!==-1&&_.container!=="audio/mpeg"&&(M="mp4a.40.2",this.log("Android: force audio codec to "+M)),a.audioCodec&&a.audioCodec!==M&&this.log('Swapping manifest audio codec "'+a.audioCodec+'" for "'+M+'"'),_.levelCodec=M,_.id="main",this.log("Init audio buffer, container:"+_.container+", codecs[selected/level/parsed]=["+(M||"")+"/"+(a.audioCodec||"")+"/"+_.codec+"]")}L&&(L.levelCodec=a.videoCodec,L.id="main",this.log("Init video buffer, container:"+L.container+", codecs[level/parsed]=["+(a.videoCodec||"")+"/"+L.codec+"]")),x&&this.log("Init audiovideo buffer, container:"+x.container+", codecs[level/parsed]=["+(a.attrs.CODECS||"")+"/"+x.codec+"]"),this.hls.trigger(b.Events.BUFFER_CODECS,f),Object.keys(f).forEach(function(K){var Z=f[K].initSegment;Z!=null&&Z.byteLength&&v.hls.trigger(b.Events.BUFFER_APPENDING,{type:K,data:Z,frag:g,part:null,chunkMeta:p,parent:g.type})}),this.tick()}},c.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,O.PlaylistLevelType.MAIN)},c.backtrack=function(a){this.couldBacktrack=!0,this.backtrackFragment=a,this.resetTransmuxer(),this.flushBufferGap(a),this.fragmentTracker.removeFragment(a),this.fragPrevious=null,this.nextLoadPosition=a.start,this.state=It},c.checkFragmentChanged=function(){var a=this.media,f=null;if(a&&a.readyState>1&&a.seeking===!1){var g=a.currentTime;if(Ut.isBuffered(a,g)?f=this.getAppendedFrag(g):Ut.isBuffered(a,g+.1)&&(f=this.getAppendedFrag(g+.1)),f){this.backtrackFragment=null;var p=this.fragPlaying,v=f.level;p&&f.sn===p.sn&&p.level===v&&f.urlId===p.urlId||(this.fragPlaying=f,this.hls.trigger(b.Events.FRAG_CHANGED,{frag:f}),p&&p.level===v||this.hls.trigger(b.Events.LEVEL_SWITCHED,{level:v}))}}},o=s,(l=[{key:"nextLevel",get:function(){var a=this.nextBufferedFrag;return a?a.level:-1}},{key:"currentFrag",get:function(){var a=this.media;return a?this.fragPlaying||this.getAppendedFrag(a.currentTime):null}},{key:"currentProgramDateTime",get:function(){var a=this.media;if(a){var f=a.currentTime,g=this.currentFrag;if(g&&(0,C.isFiniteNumber)(f)&&(0,C.isFiniteNumber)(g.programDateTime)){var p=g.programDateTime+1e3*(f-g.start);return new Date(p)}}return null}},{key:"currentLevel",get:function(){var a=this.currentFrag;return a?a.level:-1}},{key:"nextBufferedFrag",get:function(){var a=this.currentFrag;return a?this.followingBufferedFrag(a):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&Yh(o.prototype,l),Object.defineProperty(o,"prototype",{writable:!1}),s}(Da);const cs=function(){function E(n,s,o){s===void 0&&(s=0),o===void 0&&(o=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=n,this.alpha_=n?Math.exp(Math.log(.5)/n):0,this.estimate_=s,this.totalWeight_=o}var h=E.prototype;return h.sample=function(n,s){var o=Math.pow(this.alpha_,n);this.estimate_=s*(1-o)+o*this.estimate_,this.totalWeight_+=n},h.getTotalWeight=function(){return this.totalWeight_},h.getEstimate=function(){if(this.alpha_){var n=1-Math.pow(this.alpha_,this.totalWeight_);if(n)return this.estimate_/n}return this.estimate_},E}(),jh=function(){function E(n,s,o){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=o,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new cs(n),this.fast_=new cs(s)}var h=E.prototype;return h.update=function(n,s){var o=this.slow_,l=this.fast_;this.slow_.halfLife!==n&&(this.slow_=new cs(n,o.getEstimate(),o.getTotalWeight())),this.fast_.halfLife!==s&&(this.fast_=new cs(s,l.getEstimate(),l.getTotalWeight()))},h.sample=function(n,s){var o=(n=Math.max(n,this.minDelayMs_))/1e3,l=8*s/o;this.fast_.sample(o,l),this.slow_.sample(o,l)},h.canEstimate=function(){var n=this.fast_;return n&&n.getTotalWeight()>=this.minWeight_},h.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},h.destroy=function(){},E}();function qh(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}const Wh=function(){function E(o){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=o;var l=o.config;this.bwEstimator=new jh(l.abrEwmaSlowVoD,l.abrEwmaFastVoD,l.abrEwmaDefaultEstimate),this.registerListeners()}var h,n,s=E.prototype;return s.registerListeners=function(){var o=this.hls;o.on(b.Events.FRAG_LOADING,this.onFragLoading,this),o.on(b.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(b.Events.ERROR,this.onError,this)},s.unregisterListeners=function(){var o=this.hls;o.off(b.Events.FRAG_LOADING,this.onFragLoading,this),o.off(b.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(b.Events.ERROR,this.onError,this)},s.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},s.onFragLoading=function(o,l){var c,a=l.frag;a.type===O.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=a,this.partCurrent=(c=l.part)!=null?c:null,this.timer=self.setInterval(this.onCheck,100)))},s.onLevelLoaded=function(o,l){var c=this.hls.config;l.details.live?this.bwEstimator.update(c.abrEwmaSlowLive,c.abrEwmaFastLive):this.bwEstimator.update(c.abrEwmaSlowVoD,c.abrEwmaFastVoD)},s._abandonRulesCheck=function(){var o=this.fragCurrent,l=this.partCurrent,c=this.hls,a=c.autoLevelEnabled,f=c.media;if(o&&f){var g=l?l.stats:o.stats,p=l?l.duration:o.duration;if(g.aborted||g.loaded&&g.loaded===g.total||o.level===0)return this.clearTimer(),void(this._nextAutoLevel=-1);if(a&&!f.paused&&f.playbackRate&&f.readyState){var v=c.mainForwardBufferInfo;if(v!==null){var _=performance.now()-g.loading.start,L=Math.abs(f.playbackRate);if(!(_<=500*p/L)){var x=g.loaded&&g.loading.first,M=this.bwEstimator.getEstimate(),j=c.levels,K=c.minAutoLevel,Z=j[o.level],he=g.total||Math.max(g.loaded,Math.round(p*Z.maxBitrate/8)),_e=x?1e3*g.loaded/_:0,Ee=_e?(he-g.loaded)/_e:8*he/M,De=v.len/L;if(!(Ee<=De)){var $e,st=Number.POSITIVE_INFINITY;for($e=o.level-1;$e>K;$e--){var Se=j[$e].maxBitrate;if((st=_e?p*Se/(6.4*_e):p*Se/M)<De)break}st>=Ee||(P.logger.warn("Fragment "+o.sn+(l?" part "+l.index:"")+" of level "+o.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+$e+`
      Current BW estimate: `+((0,C.isFiniteNumber)(M)?(M/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+Ee.toFixed(3)+` s
      Estimated load time for the next fragment: `+st.toFixed(3)+` s
      Time to underbuffer: `+De.toFixed(3)+" s"),c.nextLoadLevel=$e,x&&this.bwEstimator.sample(_,g.loaded),this.clearTimer(),(o.loader||o.keyLoader)&&(this.fragCurrent=this.partCurrent=null,o.abortRequests()),c.trigger(b.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:o,part:l,stats:g}))}}}}}},s.onFragLoaded=function(o,l){var c=l.frag,a=l.part;if(c.type===O.PlaylistLevelType.MAIN&&(0,C.isFiniteNumber)(c.sn)){var f=a?a.stats:c.stats,g=a?a.duration:c.duration;if(this.clearTimer(),this.lastLoadedFragLevel=c.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var p=this.hls.levels[c.level],v=(p.loaded?p.loaded.bytes:0)+f.loaded,_=(p.loaded?p.loaded.duration:0)+g;p.loaded={bytes:v,duration:_},p.realBitrate=Math.round(8*v/_)}if(c.bitrateTest){var L={stats:f,frag:c,part:a,id:c.type};this.onFragBuffered(b.Events.FRAG_BUFFERED,L)}}},s.onFragBuffered=function(o,l){var c=l.frag,a=l.part,f=a?a.stats:c.stats;if(!f.aborted&&c.type===O.PlaylistLevelType.MAIN&&c.sn!=="initSegment"){var g=f.parsing.end-f.loading.start;this.bwEstimator.sample(g,f.loaded),f.bwEstimate=this.bwEstimator.getEstimate(),c.bitrateTest?this.bitrateTestDelay=g/1e3:this.bitrateTestDelay=0}},s.onError=function(o,l){var c;if(((c=l.frag)===null||c===void 0?void 0:c.type)===O.PlaylistLevelType.MAIN){if(l.type===R.ErrorTypes.KEY_SYSTEM_ERROR)return void this.clearTimer();switch(l.details){case R.ErrorDetails.FRAG_LOAD_ERROR:case R.ErrorDetails.FRAG_LOAD_TIMEOUT:case R.ErrorDetails.KEY_LOAD_ERROR:case R.ErrorDetails.KEY_LOAD_TIMEOUT:this.clearTimer()}}},s.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},s.getNextABRAutoLevel=function(){var o=this.fragCurrent,l=this.partCurrent,c=this.hls,a=c.maxAutoLevel,f=c.config,g=c.minAutoLevel,p=c.media,v=l?l.duration:o?o.duration:0,_=p&&p.playbackRate!==0?Math.abs(p.playbackRate):1,L=this.bwEstimator?this.bwEstimator.getEstimate():f.abrEwmaDefaultEstimate,x=c.mainForwardBufferInfo,M=(x?x.len:0)/_,j=this.findBestLevel(L,g,a,M,f.abrBandWidthFactor,f.abrBandWidthUpFactor);if(j>=0)return j;P.logger.trace((M?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var K=v?Math.min(v,f.maxStarvationDelay):f.maxStarvationDelay,Z=f.abrBandWidthFactor,he=f.abrBandWidthUpFactor;if(!M){var _e=this.bitrateTestDelay;_e&&(K=(v?Math.min(v,f.maxLoadingDelay):f.maxLoadingDelay)-_e,P.logger.trace("bitrate test took "+Math.round(1e3*_e)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*K)+" ms"),Z=he=1)}return j=this.findBestLevel(L,g,a,M+K,Z,he),Math.max(j,0)},s.findBestLevel=function(o,l,c,a,f,g){for(var p,v=this.fragCurrent,_=this.partCurrent,L=this.lastLoadedFragLevel,x=this.hls.levels,M=x[L],j=!(M==null||(p=M.details)===null||p===void 0||!p.live),K=M==null?void 0:M.codecSet,Z=_?_.duration:v?v.duration:0,he=c;he>=l;he--){var _e=x[he];if(_e&&(!K||_e.codecSet===K)){var Ee,De=_e.details,$e=(_?De==null?void 0:De.partTarget:De==null?void 0:De.averagetargetduration)||Z;Ee=he<=L?f*o:g*o;var st=x[he].maxBitrate,Se=st*$e/Ee;if(P.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+he+"/"+Math.round(Ee)+"/"+st+"/"+$e+"/"+a+"/"+Se),Ee>st&&(Se===0||!(0,C.isFiniteNumber)(Se)||j&&!this.bitrateTestDelay||Se<a))return he}}return-1},h=E,(n=[{key:"nextAutoLevel",get:function(){var o=this._nextAutoLevel,l=this.bwEstimator;if(o!==-1&&!l.canEstimate())return o;var c=this.getNextABRAutoLevel();return o!==-1&&this.hls.levels[c].loadError?o:(o!==-1&&(c=Math.min(o,c)),c)},set:function(o){this._nextAutoLevel=o}}])&&qh(h.prototype,n),Object.defineProperty(h,"prototype",{writable:!1}),E}();var Zu=function(){function E(){this.chunks=[],this.dataLength=0}var h=E.prototype;return h.push=function(n){this.chunks.push(n),this.dataLength+=n.length},h.flush=function(){var n,s=this.chunks,o=this.dataLength;return s.length?(n=s.length===1?s[0]:function(l,c){for(var a=new Uint8Array(c),f=0,g=0;g<l.length;g++){var p=l[g];a.set(p,f),f+=p.length}return a}(s,o),this.reset(),n):new Uint8Array(0)},h.reset=function(){this.chunks.length=0,this.dataLength=0},E}();function fs(){return fs=Object.assign?Object.assign.bind():function(E){for(var h=1;h<arguments.length;h++){var n=arguments[h];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(E[s]=n[s])}return E},fs.apply(this,arguments)}function wa(E,h){return wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},wa(E,h)}var Xh=function(E){var h,n;function s(l,c,a){var f;return(f=E.call(this,l,c,a,"[audio-stream-controller]")||this).videoBuffer=null,f.videoTrackCC=-1,f.waitingVideoCC=-1,f.audioSwitch=!1,f.trackId=-1,f.waitingData=null,f.mainDetails=null,f.bufferFlushed=!1,f.cachedTrackLoadedData=null,f._registerListeners(),f}n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,wa(h,n);var o=s.prototype;return o.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},o._registerListeners=function(){var l=this.hls;l.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.on(b.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),l.on(b.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),l.on(b.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),l.on(b.Events.ERROR,this.onError,this),l.on(b.Events.BUFFER_RESET,this.onBufferReset,this),l.on(b.Events.BUFFER_CREATED,this.onBufferCreated,this),l.on(b.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),l.on(b.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),l.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},o._unregisterListeners=function(){var l=this.hls;l.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.off(b.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),l.off(b.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),l.off(b.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),l.off(b.Events.ERROR,this.onError,this),l.off(b.Events.BUFFER_RESET,this.onBufferReset,this),l.off(b.Events.BUFFER_CREATED,this.onBufferCreated,this),l.off(b.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),l.off(b.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),l.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},o.onInitPtsFound=function(l,c){var a=c.frag,f=c.id,g=c.initPTS;if(f==="main"){var p=a.cc;this.initPTS[a.cc]=g,this.log("InitPTS for cc: "+p+" found from main: "+g),this.videoTrackCC=p,this.state===Ai&&this.tick()}},o.startLoad=function(l){if(!this.levels)return this.startPosition=l,void(this.state=Sr);var c=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,c>0&&l===-1?(this.log("Override startPosition with lastCurrentTime @"+c.toFixed(3)),l=c,this.state=It):(this.loadedmetadata=!1,this.state=ls),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=l,this.tick()},o.doTick=function(){switch(this.state){case It:this.doTickIdle();break;case ls:var l,c=this.levels,a=this.trackId,f=c==null||(l=c[a])===null||l===void 0?void 0:l.details;if(f){if(this.waitForCdnTuneIn(f))break;this.state=Ai}break;case Yn:var g,p=performance.now(),v=this.retryDate;(!v||p>=v||(g=this.media)!==null&&g!==void 0&&g.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=It);break;case Ai:var _=this.waitingData;if(_){var L=_.frag,x=_.part,M=_.cache,j=_.complete;if(this.initPTS[L.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=Kn;var K={frag:L,part:x,payload:M.flush(),networkDetails:null};this._handleFragmentLoadProgress(K),j&&E.prototype._handleFragmentLoadComplete.call(this,K)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+L.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var Z=this.getLoadPosition(),he=Ut.bufferInfo(this.mediaBuffer,Z,this.config.maxBufferHole);La(he.end,this.config.maxFragLookUpTolerance,L)<0&&(this.log("Waiting fragment cc ("+L.cc+") @ "+L.start+" cancelled because another fragment at "+he.end+" is needed"),this.clearWaitingFragment())}}else this.state=It}this.onTickEnd()},o.clearWaitingFragment=function(){var l=this.waitingData;l&&(this.fragmentTracker.removeFragment(l.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=It)},o.resetLoadingState=function(){this.clearWaitingFragment(),E.prototype.resetLoadingState.call(this)},o.onTickEnd=function(){var l=this.media;l&&l.readyState&&(this.lastCurrentTime=l.currentTime)},o.doTickIdle=function(){var l=this.hls,c=this.levels,a=this.media,f=this.trackId,g=l.config;if(c&&c[f]&&(a||!this.startFragRequested&&g.startFragPrefetch)){var p=c[f].details;if(!p||p.live&&this.levelLastLoaded!==f||this.waitForCdnTuneIn(p))this.state=ls;else{var v=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&v&&(this.bufferFlushed=!1,this.afterBufferFlushed(v,oe.ElementaryStreamTypes.AUDIO,O.PlaylistLevelType.AUDIO));var _=this.getFwdBufferInfo(v,O.PlaylistLevelType.AUDIO);if(_!==null){var L=this.audioSwitch;if(!L&&this._streamEnded(_,p))return l.trigger(b.Events.BUFFER_EOS,{type:"audio"}),void(this.state=yi);var x=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,O.PlaylistLevelType.MAIN);if(!(_.len>=this.getMaxBufferLength(x==null?void 0:x.len))||L){var M=p.fragments[0].start,j=_.end;if(L&&a){var K=this.getLoadPosition();j=K,p.PTSKnown&&K<M&&(_.end>M||_.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),a.currentTime=M+.05)}if(!(x&&j>x.end+p.targetduration)&&(x&&x.len||!_.len)){var Z=this.getNextFragment(j,p);Z?this.loadFragment(Z,p,j):this.bufferFlushed=!0}}}}}},o.getMaxBufferLength=function(l){var c=E.prototype.getMaxBufferLength.call(this);return l?Math.max(c,l):c},o.onMediaDetaching=function(){this.videoBuffer=null,E.prototype.onMediaDetaching.call(this)},o.onAudioTracksUpdated=function(l,c){var a=c.audioTracks;this.resetTransmuxer(),this.levels=a.map(function(f){return new W(f)})},o.onAudioTrackSwitching=function(l,c){var a=!!c.url;this.trackId=c.id;var f=this.fragCurrent;f&&f.abortRequests(),this.fragCurrent=null,this.clearWaitingFragment(),a?this.setInterval(100):this.resetTransmuxer(),a?(this.audioSwitch=!0,this.state=It):this.state=Sr,this.tick()},o.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},o.onLevelLoaded=function(l,c){this.mainDetails=c.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(b.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},o.onAudioTrackLoaded=function(l,c){var a;if(this.mainDetails!=null){var f=this.levels,g=c.details,p=c.id;if(f){this.log("Track "+p+" loaded ["+g.startSN+","+g.endSN+"],duration:"+g.totalduration);var v=f[p],_=0;if(g.live||(a=v.details)!==null&&a!==void 0&&a.live){var L=this.mainDetails;if(g.fragments[0]||(g.deltaUpdateFailed=!0),g.deltaUpdateFailed||!L)return;!v.details&&g.hasProgramDateTime&&L.hasProgramDateTime?(Vu(g,L),_=g.fragments[0].start):_=this.alignPlaylists(g,v.details)}v.details=g,this.levelLastLoaded=p,this.startFragRequested||!this.mainDetails&&g.live||this.setStartPosition(v.details,_),this.state!==ls||this.waitForCdnTuneIn(g)||(this.state=It),this.tick()}else this.warn("Audio tracks were reset while loading level "+p)}else this.cachedTrackLoadedData=c},o._handleFragmentLoadProgress=function(l){var c,a=l.frag,f=l.part,g=l.payload,p=this.config,v=this.trackId,_=this.levels;if(_){var L=_[v],x=L.details,M=p.defaultAudioCodec||L.audioCodec||"mp4a.40.2",j=this.transmuxer;j||(j=this.transmuxer=new $u(this.hls,O.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var K=this.initPTS[a.cc],Z=(c=a.initSegment)===null||c===void 0?void 0:c.data;if(K!==void 0){var he=f?f.index:-1,_e=he!==-1,Ee=new Sa(a.level,a.sn,a.stats.chunkCount,g.byteLength,he,_e);j.push(g,Z,M,"",a,f,x.totalduration,!1,Ee,K)}else this.log("Unknown video PTS for cc "+a.cc+", waiting for video PTS before demuxing audio frag "+a.sn+" of ["+x.startSN+" ,"+x.endSN+"],track "+v),(this.waitingData=this.waitingData||{frag:a,part:f,cache:new Zu,complete:!1}).cache.push(new Uint8Array(g)),this.waitingVideoCC=this.videoTrackCC,this.state=Ai}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+a.sn+" of level "+a.level+" will not be buffered")},o._handleFragmentLoadComplete=function(l){this.waitingData?this.waitingData.complete=!0:E.prototype._handleFragmentLoadComplete.call(this,l)},o.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},o.onBufferCreated=function(l,c){var a=c.tracks.audio;a&&(this.mediaBuffer=a.buffer||null),c.tracks.video&&(this.videoBuffer=c.tracks.video.buffer||null)},o.onFragBuffered=function(l,c){var a,f=c.frag,g=c.part;f.type===O.PlaylistLevelType.AUDIO?this.fragContextChanged(f)?this.warn("Fragment "+f.sn+(g?" p: "+g.index:"")+" of level "+f.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):(f.sn!=="initSegment"&&(this.fragPrevious=f,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(b.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(f,g)):this.loadedmetadata||f.type!==O.PlaylistLevelType.MAIN||(a=this.videoBuffer||this.media)!==null&&a!==void 0&&a.buffered.length&&(this.loadedmetadata=!0)},o.onError=function(l,c){if(c.type!==R.ErrorTypes.KEY_SYSTEM_ERROR)switch(c.details){case R.ErrorDetails.FRAG_LOAD_ERROR:case R.ErrorDetails.FRAG_LOAD_TIMEOUT:case R.ErrorDetails.FRAG_PARSING_ERROR:case R.ErrorDetails.KEY_LOAD_ERROR:case R.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(O.PlaylistLevelType.AUDIO,c);break;case R.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case R.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==Wr&&this.state!==Sr&&(this.state=c.fatal?Wr:It,this.warn(c.details+" while loading frag, switching to "+this.state+" state"));break;case R.ErrorDetails.BUFFER_FULL_ERROR:if(c.parent==="audio"&&(this.state===Pr||this.state===bi)){var a=!0,f=this.getFwdBufferInfo(this.mediaBuffer,O.PlaylistLevelType.AUDIO);f&&f.len>.5&&(a=!this.reduceMaxBufferLength(f.len)),a&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,E.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(O.PlaylistLevelType.AUDIO,c)},o.onBufferFlushed=function(l,c){c.type===oe.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===yi&&(this.state=It))},o._handleTransmuxComplete=function(l){var c,a="audio",f=this.hls,g=l.remuxResult,p=l.chunkMeta,v=this.getCurrentContext(p);if(!v)return this.warn("The loading context changed while buffering fragment "+p.sn+" of level "+p.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(p.level);var _=v.frag,L=v.part,x=v.level.details,M=g.audio,j=g.text,K=g.id3,Z=g.initSegment;if(!this.fragContextChanged(_)&&x){if(this.state=Pr,this.audioSwitch&&M&&this.completeAudioSwitch(),Z!=null&&Z.tracks&&(this._bufferInitSegment(Z.tracks,_,p),f.trigger(b.Events.FRAG_PARSING_INIT_SEGMENT,{frag:_,id:a,tracks:Z.tracks})),M){var he=M.startPTS,_e=M.endPTS,Ee=M.startDTS,De=M.endDTS;L&&(L.elementaryStreams[oe.ElementaryStreamTypes.AUDIO]={startPTS:he,endPTS:_e,startDTS:Ee,endDTS:De}),_.setElementaryStreamInfo(oe.ElementaryStreamTypes.AUDIO,he,_e,Ee,De),this.bufferFragmentData(M,_,L,p)}if(K!=null&&(c=K.samples)!==null&&c!==void 0&&c.length){var $e=fs({id:a,frag:_,details:x},K);f.trigger(b.Events.FRAG_PARSING_METADATA,$e)}if(j){var st=fs({id:a,frag:_,details:x},j);f.trigger(b.Events.FRAG_PARSING_USERDATA,st)}}},o._bufferInitSegment=function(l,c,a){if(this.state===Pr){l.video&&delete l.video;var f=l.audio;if(f){f.levelCodec=f.codec,f.id="audio",this.log("Init audio buffer, container:"+f.container+", codecs[parsed]=["+f.codec+"]"),this.hls.trigger(b.Events.BUFFER_CODECS,l);var g=f.initSegment;if(g!=null&&g.byteLength){var p={type:"audio",frag:c,part:null,chunkMeta:a,parent:c.type,data:g};this.hls.trigger(b.Events.BUFFER_APPENDING,p)}this.tick()}}},o.loadFragment=function(l,c,a){var f=this.fragmentTracker.getState(l);this.fragCurrent=l,(this.audioSwitch||f===qe.NOT_LOADED||f===qe.PARTIAL)&&(l.sn==="initSegment"?this._loadInitSegment(l,c):c.live&&!(0,C.isFiniteNumber)(this.initPTS[l.cc])?(this.log("Waiting for video PTS in continuity counter "+l.cc+" of live stream before loading audio fragment "+l.sn+" of level "+this.trackId),this.state=Ai):(this.startFragRequested=!0,E.prototype.loadFragment.call(this,l,c,a)))},o.completeAudioSwitch=function(){var l=this.hls,c=this.media,a=this.trackId;c&&(this.log("Switching audio track : flushing all audio"),E.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,l.trigger(b.Events.AUDIO_TRACK_SWITCHED,{id:a})},s}(Da);const Qh=Xh;function zh(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}function Ma(E,h){return Ma=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Ma(E,h)}const $h=function(E){var h,n;function s(a){var f;return(f=E.call(this,a,"[audio-track-controller]")||this).tracks=[],f.groupId=null,f.tracksInGroup=[],f.trackId=-1,f.trackName="",f.selectDefaultTrack=!0,f.registerListeners(),f}n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,Ma(h,n);var o,l,c=s.prototype;return c.registerListeners=function(){var a=this.hls;a.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.on(b.Events.LEVEL_LOADING,this.onLevelLoading,this),a.on(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),a.on(b.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),a.on(b.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var a=this.hls;a.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.off(b.Events.LEVEL_LOADING,this.onLevelLoading,this),a.off(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),a.off(b.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),a.off(b.Events.ERROR,this.onError,this)},c.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,E.prototype.destroy.call(this)},c.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},c.onManifestParsed=function(a,f){this.tracks=f.audioTracks||[]},c.onAudioTrackLoaded=function(a,f){var g=f.id,p=f.details,v=this.tracksInGroup[g];if(v){var _=v.details;v.details=f.details,this.log("audioTrack "+g+" loaded ["+p.startSN+"-"+p.endSN+"]"),g===this.trackId&&(this.retryCount=0,this.playlistLoaded(g,f,_))}else this.warn("Invalid audio track id "+g)},c.onLevelLoading=function(a,f){this.switchLevel(f.level)},c.onLevelSwitching=function(a,f){this.switchLevel(f.level)},c.switchLevel=function(a){var f=this.hls.levels[a];if(f!=null&&f.audioGroupIds){var g=f.audioGroupIds[f.urlId];if(this.groupId!==g){this.groupId=g;var p=this.tracks.filter(function(_){return!g||_.groupId===g});this.selectDefaultTrack&&!p.some(function(_){return _.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=p;var v={audioTracks:p};this.log("Updating audio tracks, "+p.length+' track(s) found in "'+g+'" group-id'),this.hls.trigger(b.Events.AUDIO_TRACKS_UPDATED,v),this.selectInitialTrack()}}},c.onError=function(a,f){E.prototype.onError.call(this,a,f),!f.fatal&&f.context&&f.context.type===O.PlaylistContextType.AUDIO_TRACK&&f.context.id===this.trackId&&f.context.groupId===this.groupId&&this.retryLoadingOrFail(f)},c.setAudioTrack=function(a){var f=this.tracksInGroup;if(a<0||a>=f.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var g=f[this.trackId];this.log("Now switching to audio-track index "+a);var p=f[a],v=p.id,_=p.groupId,L=_===void 0?"":_,x=p.name,M=p.type,j=p.url;if(this.trackId=a,this.trackName=x,this.selectDefaultTrack=!1,this.hls.trigger(b.Events.AUDIO_TRACK_SWITCHING,{id:v,groupId:L,name:x,type:M,url:j}),!p.details||p.details.live){var K=this.switchParams(p.url,g==null?void 0:g.details);this.loadPlaylist(K)}}},c.selectInitialTrack=function(){this.tracksInGroup;var a=this.trackName,f=this.findTrackId(a)||this.findTrackId();f!==-1?this.setAudioTrack(f):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},c.findTrackId=function(a){for(var f=this.tracksInGroup,g=0;g<f.length;g++){var p=f[g];if((!this.selectDefaultTrack||p.default)&&(!a||a===p.name))return p.id}return-1},c.loadPlaylist=function(a){E.prototype.loadPlaylist.call(this);var f=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(f)){var g=f.id,p=f.groupId,v=f.url;if(a)try{v=a.addDirectives(v)}catch(_){this.warn("Could not construct new URL with HLS Delivery Directives: "+_)}this.log("loading audio-track playlist for id: "+g),this.clearTimer(),this.hls.trigger(b.Events.AUDIO_TRACK_LOADING,{url:v,id:g,groupId:p,deliveryDirectives:a||null})}},o=s,(l=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(a){this.selectDefaultTrack=!1,this.setAudioTrack(a)}}])&&zh(o.prototype,l),Object.defineProperty(o,"prototype",{writable:!1}),s}(Oe);function Zh(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}function Fa(E,h){return Fa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Fa(E,h)}var Jh=function(E){var h,n;function s(a,f,g){var p;return(p=E.call(this,a,f,g,"[subtitle-stream-controller]")||this).levels=[],p.currentTrackId=-1,p.tracksBuffered=[],p.mainDetails=null,p._registerListeners(),p}n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,Fa(h,n);var o,l,c=s.prototype;return c.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},c._registerListeners=function(){var a=this.hls;a.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.on(b.Events.ERROR,this.onError,this),a.on(b.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),a.on(b.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),a.on(b.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.on(b.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),a.on(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),a.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c._unregisterListeners=function(){var a=this.hls;a.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),a.off(b.Events.ERROR,this.onError,this),a.off(b.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),a.off(b.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),a.off(b.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.off(b.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),a.off(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),a.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c.startLoad=function(a){this.stopLoad(),this.state=It,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a,this.tick()},c.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},c.onLevelLoaded=function(a,f){this.mainDetails=f.details},c.onSubtitleFragProcessed=function(a,f){var g=f.frag,p=f.success;if(this.fragPrevious=g,this.state=It,p){var v=this.tracksBuffered[this.currentTrackId];if(v){for(var _,L=g.start,x=0;x<v.length;x++)if(L>=v[x].start&&L<=v[x].end){_=v[x];break}var M=g.start+g.duration;_?_.end=M:(_={start:L,end:M},v.push(_)),this.fragmentTracker.fragBuffered(g)}}},c.onBufferFlushing=function(a,f){var g=f.startOffset,p=f.endOffset;if(g===0&&p!==Number.POSITIVE_INFINITY){var v=this.currentTrackId,_=this.levels;if(!_.length||!_[v]||!_[v].details)return;var L=p-_[v].details.targetduration;if(L<=0)return;f.endOffsetSubtitles=Math.max(0,L),this.tracksBuffered.forEach(function(x){for(var M=0;M<x.length;)if(x[M].end<=L)x.shift();else{if(!(x[M].start<L))break;x[M].start=L,M++}}),this.fragmentTracker.removeFragmentsInRange(g,L,O.PlaylistLevelType.SUBTITLE)}},c.onFragBuffered=function(a,f){var g;this.loadedmetadata||f.frag.type!==O.PlaylistLevelType.MAIN||(g=this.media)!==null&&g!==void 0&&g.buffered.length&&(this.loadedmetadata=!0)},c.onError=function(a,f){var g=f.frag;g&&g.type===O.PlaylistLevelType.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state=It)},c.onSubtitleTracksUpdated=function(a,f){var g=this,p=f.subtitleTracks;this.tracksBuffered=[],this.levels=p.map(function(v){return new W(v)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(v){g.tracksBuffered[v.id]=[]}),this.mediaBuffer=null},c.onSubtitleTrackSwitch=function(a,f){if(this.currentTrackId=f.id,this.levels.length&&this.currentTrackId!==-1){var g=this.levels[this.currentTrackId];g!=null&&g.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,g&&this.setInterval(500)}else this.clearInterval()},c.onSubtitleTrackLoaded=function(a,f){var g,p=f.details,v=f.id,_=this.currentTrackId,L=this.levels;if(L.length){var x=L[_];if(!(v>=L.length||v!==_)&&x){this.mediaBuffer=this.mediaBufferTimeRanges;var M=0;if(p.live||(g=x.details)!==null&&g!==void 0&&g.live){var j=this.mainDetails;if(p.deltaUpdateFailed||!j)return;var K=j.fragments[0];x.details?(M=this.alignPlaylists(p,x.details))===0&&K&&ye(p,M=K.start):p.hasProgramDateTime&&j.hasProgramDateTime?(Vu(p,j),M=p.fragments[0].start):K&&ye(p,M=K.start)}x.details=p,this.levelLastLoaded=v,this.startFragRequested||!this.mainDetails&&p.live||this.setStartPosition(x.details,M),this.tick(),p.live&&!this.fragCurrent&&this.media&&this.state===It&&(Ca(null,p.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),x.details=void 0))}}},c._handleFragmentLoadComplete=function(a){var f=this,g=a.frag,p=a.payload,v=g.decryptdata,_=this.hls;if(!this.fragContextChanged(g)&&p&&p.byteLength>0&&v&&v.key&&v.iv&&v.method==="AES-128"){var L=performance.now();this.decrypter.decrypt(new Uint8Array(p),v.key.buffer,v.iv.buffer).then(function(x){var M=performance.now();_.trigger(b.Events.FRAG_DECRYPTED,{frag:g,payload:x,stats:{tstart:L,tdecrypt:M}})}).catch(function(x){f.warn(x.name+": "+x.message),f.state=It})}},c.doTick=function(){if(this.media){if(this.state===It){var a=this.currentTrackId,f=this.levels;if(!f.length||!f[a]||!f[a].details)return;var g=f[a].details,p=g.targetduration,v=this.config,_=this.getLoadPosition(),L=Ut.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],_-p,v.maxBufferHole),x=L.end,M=L.len,j=this.getFwdBufferInfo(this.media,O.PlaylistLevelType.MAIN);if(M>this.getMaxBufferLength(j==null?void 0:j.len)+p)return;var K=g.fragments,Z=K.length,he=g.edge,_e=null,Ee=this.fragPrevious;if(x<he){var De=v.maxFragLookUpTolerance;!(_e=Ca(Ee,K,Math.max(K[0].start,x),De))&&Ee&&Ee.start<K[0].start&&(_e=K[0])}else _e=K[Z-1];if(!_e)return;_e=this.mapToInitFragWhenRequired(_e),this.fragmentTracker.getState(_e)===qe.NOT_LOADED&&this.loadFragment(_e,g,x)}}else this.state=It},c.getMaxBufferLength=function(a){var f=E.prototype.getMaxBufferLength.call(this);return a?Math.max(f,a):f},c.loadFragment=function(a,f,g){this.fragCurrent=a,a.sn==="initSegment"?this._loadInitSegment(a,f):(this.startFragRequested=!0,E.prototype.loadFragment.call(this,a,f,g))},o=s,(l=[{key:"mediaBufferTimeRanges",get:function(){return new e0(this.tracksBuffered[this.currentTrackId]||[])}}])&&Zh(o.prototype,l),Object.defineProperty(o,"prototype",{writable:!1}),s}(Da),e0=function(E){this.buffered=void 0;var h=function(n,s,o){if((s>>>=0)>o-1)throw new DOMException("Failed to execute '"+n+"' on 'TimeRanges': The index provided ("+s+") is greater than the maximum bound ("+o+")");return E[s][n]};this.buffered={get length(){return E.length},end:function(n){return h("end",n,E.length)},start:function(n){return h("start",n,E.length)}}};function t0(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}function Ba(E,h){return Ba=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Ba(E,h)}function Ua(E){for(var h=[],n=0;n<E.length;n++){var s=E[n];s.kind==="subtitles"&&s.label&&h.push(E[n])}return h}const r0=function(E){var h,n;function s(a){var f;return(f=E.call(this,a,"[subtitle-track-controller]")||this).media=null,f.tracks=[],f.groupId=null,f.tracksInGroup=[],f.trackId=-1,f.selectDefaultTrack=!0,f.queuedDefaultTrack=-1,f.trackChangeListener=function(){return f.onTextTracksChanged()},f.asyncPollTrackChange=function(){return f.pollTrackChange(0)},f.useTextTrackPolling=!1,f.subtitlePollingInterval=-1,f._subtitleDisplay=!0,f.registerListeners(),f}n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,Ba(h,n);var o,l,c=s.prototype;return c.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,E.prototype.destroy.call(this)},c.registerListeners=function(){var a=this.hls;a.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.on(b.Events.LEVEL_LOADING,this.onLevelLoading,this),a.on(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),a.on(b.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.on(b.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var a=this.hls;a.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.off(b.Events.LEVEL_LOADING,this.onLevelLoading,this),a.off(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),a.off(b.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.off(b.Events.ERROR,this.onError,this)},c.onMediaAttached=function(a,f){this.media=f.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},c.pollTrackChange=function(a){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,a)},c.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Ua(this.media.textTracks).forEach(function(a){Me(a)}),this.subtitleTrack=-1,this.media=null)},c.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},c.onManifestParsed=function(a,f){this.tracks=f.subtitleTracks},c.onSubtitleTrackLoaded=function(a,f){var g=f.id,p=f.details,v=this.trackId,_=this.tracksInGroup[v];if(_){var L=_.details;_.details=f.details,this.log("subtitle track "+g+" loaded ["+p.startSN+"-"+p.endSN+"]"),g===this.trackId&&(this.retryCount=0,this.playlistLoaded(g,f,L))}else this.warn("Invalid subtitle track id "+g)},c.onLevelLoading=function(a,f){this.switchLevel(f.level)},c.onLevelSwitching=function(a,f){this.switchLevel(f.level)},c.switchLevel=function(a){var f=this.hls.levels[a];if(f!=null&&f.textGroupIds){var g=f.textGroupIds[f.urlId];if(this.groupId!==g){var p=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,v=this.tracks.filter(function(x){return!g||x.groupId===g});this.tracksInGroup=v;var _=this.findTrackId(p==null?void 0:p.name)||this.findTrackId();this.groupId=g;var L={subtitleTracks:v};this.log("Updating subtitle tracks, "+v.length+' track(s) found in "'+g+'" group-id'),this.hls.trigger(b.Events.SUBTITLE_TRACKS_UPDATED,L),_!==-1&&this.setSubtitleTrack(_,p)}}},c.findTrackId=function(a){for(var f=this.tracksInGroup,g=0;g<f.length;g++){var p=f[g];if((!this.selectDefaultTrack||p.default)&&(!a||a===p.name))return p.id}return-1},c.onError=function(a,f){E.prototype.onError.call(this,a,f),!f.fatal&&f.context&&f.context.type===O.PlaylistContextType.SUBTITLE_TRACK&&f.context.id===this.trackId&&f.context.groupId===this.groupId&&this.retryLoadingOrFail(f)},c.loadPlaylist=function(a){E.prototype.loadPlaylist.call(this);var f=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(f)){var g=f.id,p=f.groupId,v=f.url;if(a)try{v=a.addDirectives(v)}catch(_){this.warn("Could not construct new URL with HLS Delivery Directives: "+_)}this.log("Loading subtitle playlist for id "+g),this.hls.trigger(b.Events.SUBTITLE_TRACK_LOADING,{url:v,id:g,groupId:p,deliveryDirectives:a||null})}},c.toggleTrackModes=function(a){var f=this,g=this.media,p=this.trackId;if(g){var v=Ua(g.textTracks),_=v.filter(function(M){return M.groupId===f.groupId});if(a===-1)[].slice.call(v).forEach(function(M){M.mode="disabled"});else{var L=_[p];L&&(L.mode="disabled")}var x=_[a];x&&(x.mode=this.subtitleDisplay?"showing":"hidden")}},c.setSubtitleTrack=function(a,f){var g,p=this.tracksInGroup;if(this.media){if(this.trackId!==a&&this.toggleTrackModes(a),!(this.trackId===a&&(a===-1||(g=p[a])!==null&&g!==void 0&&g.details)||a<-1||a>=p.length)){this.clearTimer();var v=p[a];if(this.log("Switching to subtitle track "+a),this.trackId=a,v){var _=v.id,L=v.groupId,x=L===void 0?"":L,M=v.name,j=v.type,K=v.url;this.hls.trigger(b.Events.SUBTITLE_TRACK_SWITCH,{id:_,groupId:x,name:M,type:j,url:K});var Z=this.switchParams(v.url,f==null?void 0:f.details);this.loadPlaylist(Z)}else this.hls.trigger(b.Events.SUBTITLE_TRACK_SWITCH,{id:a})}}else this.queuedDefaultTrack=a},c.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var a=-1,f=Ua(this.media.textTracks),g=0;g<f.length;g++)if(f[g].mode==="hidden")a=g;else if(f[g].mode==="showing"){a=g;break}this.subtitleTrack!==a&&(this.subtitleTrack=a)}},o=s,(l=[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(a){this._subtitleDisplay=a,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(a){this.selectDefaultTrack=!1;var f=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(a,f)}}])&&t0(o.prototype,l),Object.defineProperty(o,"prototype",{writable:!1}),s}(Oe);var St,n0=function(){function E(n){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=n}var h=E.prototype;return h.append=function(n,s){var o=this.queues[s];o.push(n),o.length===1&&this.buffers[s]&&this.executeNext(s)},h.insertAbort=function(n,s){this.queues[s].unshift(n),this.executeNext(s)},h.appendBlocker=function(n){var s,o=new Promise(function(c){s=c}),l={execute:s,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(l,n),o},h.executeNext=function(n){var s=this.buffers,o=this.queues,l=s[n],c=o[n];if(c.length){var a=c[0];try{a.execute()}catch(f){P.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),a.onError(f),l&&l.updating||(c.shift(),this.executeNext(n))}}},h.shiftAndExecuteNext=function(n){this.queues[n].shift(),this.executeNext(n)},h.current=function(n){return this.queues[n][0]},E}(),Ju=Na(),el=/([ha]vc.)(?:\.[^.,]+)+/,i0=function(){function E(n){var s=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var o=s.hls,l=s.media,c=s.mediaSource;P.logger.log("[buffer-controller]: Media source opened"),l&&(s.updateMediaElementDuration(),o.trigger(b.Events.MEDIA_ATTACHED,{media:l})),c&&c.removeEventListener("sourceopen",s._onMediaSourceOpen),s.checkPendingTracks()},this._onMediaSourceClose=function(){P.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){P.logger.log("[buffer-controller]: Media source ended")},this.hls=n,this._initSourceBuffer(),this.registerListeners()}var h=E.prototype;return h.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},h.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},h.registerListeners=function(){var n=this.hls;n.on(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.on(b.Events.BUFFER_RESET,this.onBufferReset,this),n.on(b.Events.BUFFER_APPENDING,this.onBufferAppending,this),n.on(b.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.on(b.Events.BUFFER_EOS,this.onBufferEos,this),n.on(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),n.on(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this),n.on(b.Events.FRAG_PARSED,this.onFragParsed,this),n.on(b.Events.FRAG_CHANGED,this.onFragChanged,this)},h.unregisterListeners=function(){var n=this.hls;n.off(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.off(b.Events.BUFFER_RESET,this.onBufferReset,this),n.off(b.Events.BUFFER_APPENDING,this.onBufferAppending,this),n.off(b.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.off(b.Events.BUFFER_EOS,this.onBufferEos,this),n.off(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),n.off(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this),n.off(b.Events.FRAG_PARSED,this.onFragParsed,this),n.off(b.Events.FRAG_CHANGED,this.onFragChanged,this)},h._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new n0(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null},h.onManifestParsed=function(n,s){var o=2;(s.audio&&!s.video||!s.altAudio)&&(o=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=o,this.details=null,P.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},h.onMediaAttaching=function(n,s){var o=this.media=s.media;if(o&&Ju){var l=this.mediaSource=new Ju;l.addEventListener("sourceopen",this._onMediaSourceOpen),l.addEventListener("sourceended",this._onMediaSourceEnded),l.addEventListener("sourceclose",this._onMediaSourceClose),o.src=self.URL.createObjectURL(l),this._objectUrl=o.src}},h.onMediaDetaching=function(){var n=this.media,s=this.mediaSource,o=this._objectUrl;if(s){if(P.logger.log("[buffer-controller]: media source detaching"),s.readyState==="open")try{s.endOfStream()}catch(l){P.logger.warn("[buffer-controller]: onMediaDetaching: "+l.message+" while calling endOfStream")}this.onBufferReset(),s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),n&&(o&&self.URL.revokeObjectURL(o),n.src===o?(n.removeAttribute("src"),n.load()):P.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(b.Events.MEDIA_DETACHED,void 0)},h.onBufferReset=function(){var n=this;this.getSourceBufferTypes().forEach(function(s){var o=n.sourceBuffer[s];try{o&&(n.removeBufferListeners(s),n.mediaSource&&n.mediaSource.removeSourceBuffer(o),n.sourceBuffer[s]=void 0)}catch(l){P.logger.warn("[buffer-controller]: Failed to reset the "+s+" buffer",l)}}),this._initSourceBuffer()},h.onBufferCodecs=function(n,s){var o=this,l=this.getSourceBufferTypes().length;Object.keys(s).forEach(function(c){if(l){var a=o.tracks[c];if(a&&typeof a.buffer.changeType=="function"){var f=s[c],g=f.id,p=f.codec,v=f.levelCodec,_=f.container,L=f.metadata,x=(a.levelCodec||a.codec).replace(el,"$1"),M=(v||p).replace(el,"$1");if(x!==M){var j=_+";codecs="+(v||p);o.appendChangeType(c,j),P.logger.log("[buffer-controller]: switching codec "+x+" to "+M),o.tracks[c]={buffer:a.buffer,codec:p,container:_,levelCodec:v,metadata:L,id:g}}}}else o.pendingTracks[c]=s[c]}),l||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},h.appendChangeType=function(n,s){var o=this,l=this.operationQueue,c={execute:function(){var a=o.sourceBuffer[n];a&&(P.logger.log("[buffer-controller]: changing "+n+" sourceBuffer type to "+s),a.changeType(s)),l.shiftAndExecuteNext(n)},onStart:function(){},onComplete:function(){},onError:function(a){P.logger.warn("[buffer-controller]: Failed to change "+n+" SourceBuffer type",a)}};l.append(c,n)},h.onBufferAppending=function(n,s){var o=this,l=this.hls,c=this.operationQueue,a=this.tracks,f=s.data,g=s.type,p=s.frag,v=s.part,_=s.chunkMeta,L=_.buffering[g],x=self.performance.now();L.start=x;var M=p.stats.buffering,j=v?v.stats.buffering:null;M.start===0&&(M.start=x),j&&j.start===0&&(j.start=x);var K=a.audio,Z=!1;g==="audio"&&(K==null?void 0:K.container)==="audio/mpeg"&&(Z=!this.lastMpegAudioChunk||_.id===1||this.lastMpegAudioChunk.sn!==_.sn,this.lastMpegAudioChunk=_);var he=p.start,_e={execute:function(){if(L.executeStart=self.performance.now(),Z){var Ee=o.sourceBuffer[g];if(Ee){var De=he-Ee.timestampOffset;Math.abs(De)>=.1&&(P.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+he+" (delta: "+De+") sn: "+p.sn+")"),Ee.timestampOffset=he)}}o.appendExecutor(f,g)},onStart:function(){},onComplete:function(){var Ee=self.performance.now();L.executeEnd=L.end=Ee,M.first===0&&(M.first=Ee),j&&j.first===0&&(j.first=Ee);var De=o.sourceBuffer,$e={};for(var st in De)$e[st]=Ut.getBuffered(De[st]);o.appendError=0,o.hls.trigger(b.Events.BUFFER_APPENDED,{type:g,frag:p,part:v,chunkMeta:_,parent:p.type,timeRanges:$e})},onError:function(Ee){P.logger.error("[buffer-controller]: Error encountered while trying to append to the "+g+" SourceBuffer",Ee);var De={type:R.ErrorTypes.MEDIA_ERROR,parent:p.type,details:R.ErrorDetails.BUFFER_APPEND_ERROR,err:Ee,fatal:!1};Ee.code===DOMException.QUOTA_EXCEEDED_ERR?De.details=R.ErrorDetails.BUFFER_FULL_ERROR:(o.appendError++,De.details=R.ErrorDetails.BUFFER_APPEND_ERROR,o.appendError>l.config.appendErrorMaxRetry&&(P.logger.error("[buffer-controller]: Failed "+l.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),De.fatal=!0,l.stopLoad())),l.trigger(b.Events.ERROR,De)}};c.append(_e,g)},h.onBufferFlushing=function(n,s){var o=this,l=this.operationQueue,c=function(a){return{execute:o.removeExecutor.bind(o,a,s.startOffset,s.endOffset),onStart:function(){},onComplete:function(){o.hls.trigger(b.Events.BUFFER_FLUSHED,{type:a})},onError:function(f){P.logger.warn("[buffer-controller]: Failed to remove from "+a+" SourceBuffer",f)}}};s.type?l.append(c(s.type),s.type):this.getSourceBufferTypes().forEach(function(a){l.append(c(a),a)})},h.onFragParsed=function(n,s){var o=this,l=s.frag,c=s.part,a=[],f=c?c.elementaryStreams:l.elementaryStreams;f[oe.ElementaryStreamTypes.AUDIOVIDEO]?a.push("audiovideo"):(f[oe.ElementaryStreamTypes.AUDIO]&&a.push("audio"),f[oe.ElementaryStreamTypes.VIDEO]&&a.push("video")),a.length===0&&P.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+l.type+" level: "+l.level+" sn: "+l.sn),this.blockBuffers(function(){var g=self.performance.now();l.stats.buffering.end=g,c&&(c.stats.buffering.end=g);var p=c?c.stats:l.stats;o.hls.trigger(b.Events.FRAG_BUFFERED,{frag:l,part:c,stats:p,id:l.type})},a)},h.onFragChanged=function(n,s){this.flushBackBuffer()},h.onBufferEos=function(n,s){var o=this;this.getSourceBufferTypes().reduce(function(l,c){var a=o.sourceBuffer[c];return!a||s.type&&s.type!==c||(a.ending=!0,a.ended||(a.ended=!0,P.logger.log("[buffer-controller]: "+c+" sourceBuffer now EOS"))),l&&!(a&&!a.ended)},!0)&&(P.logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(function(){o.getSourceBufferTypes().forEach(function(c){var a=o.sourceBuffer[c];a&&(a.ending=!1)});var l=o.mediaSource;l&&l.readyState==="open"?(P.logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),l.endOfStream()):l&&P.logger.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+l.readyState)}))},h.onLevelUpdated=function(n,s){var o=s.details;o.fragments.length&&(this.details=o,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},h.flushBackBuffer=function(){var n=this.hls,s=this.details,o=this.media,l=this.sourceBuffer;if(o&&s!==null){var c=this.getSourceBufferTypes();if(c.length){var a=s.live&&n.config.liveBackBufferLength!==null?n.config.liveBackBufferLength:n.config.backBufferLength;if((0,C.isFiniteNumber)(a)&&!(a<0)){var f=o.currentTime,g=s.levelTargetDuration,p=Math.max(a,g),v=Math.floor(f/g)*g-p;c.forEach(function(_){var L=l[_];if(L){var x=Ut.getBuffered(L);if(x.length>0&&v>x.start(0)){if(n.trigger(b.Events.BACK_BUFFER_REACHED,{bufferEnd:v}),s.live)n.trigger(b.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:v});else if(L.ended&&x.end(x.length-1)-f<2*g)return void P.logger.info("[buffer-controller]: Cannot flush "+_+" back buffer while SourceBuffer is in ended state");n.trigger(b.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:v,type:_})}}})}}}},h.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&this.mediaSource.readyState==="open"){var n=this.details,s=this.hls,o=this.media,l=this.mediaSource,c=n.fragments[0].start+n.totalduration,a=o.duration,f=(0,C.isFiniteNumber)(l.duration)?l.duration:0;n.live&&s.config.liveDurationInfinity?(P.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),l.duration=1/0,this.updateSeekableRange(n)):(c>f&&c>a||!(0,C.isFiniteNumber)(a))&&(P.logger.log("[buffer-controller]: Updating Media Source duration to "+c.toFixed(3)),l.duration=c)}},h.updateSeekableRange=function(n){var s=this.mediaSource,o=n.fragments;if(o.length&&n.live&&s!=null&&s.setLiveSeekableRange){var l=Math.max(0,o[0].start),c=Math.max(l,l+n.totalduration);s.setLiveSeekableRange(l,c)}},h.checkPendingTracks=function(){var n=this.bufferCodecEventsExpected,s=this.operationQueue,o=this.pendingTracks,l=Object.keys(o).length;if(l&&!n||l===2){this.createSourceBuffers(o),this.pendingTracks={};var c=this.getSourceBufferTypes();if(c.length===0)return void this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});c.forEach(function(a){s.executeNext(a)})}},h.createSourceBuffers=function(n){var s=this.sourceBuffer,o=this.mediaSource;if(!o)throw Error("createSourceBuffers called when mediaSource was null");var l=0;for(var c in n)if(!s[c]){var a=n[c];if(!a)throw Error("source buffer exists for track "+c+", however track does not");var f=a.levelCodec||a.codec,g=a.container+";codecs="+f;P.logger.log("[buffer-controller]: creating sourceBuffer("+g+")");try{var p=s[c]=o.addSourceBuffer(g),v=c;this.addBufferListener(v,"updatestart",this._onSBUpdateStart),this.addBufferListener(v,"updateend",this._onSBUpdateEnd),this.addBufferListener(v,"error",this._onSBUpdateError),this.tracks[c]={buffer:p,codec:f,container:a.container,levelCodec:a.levelCodec,metadata:a.metadata,id:a.id},l++}catch(_){P.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+_.message),this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:_,mimeType:g})}}l&&this.hls.trigger(b.Events.BUFFER_CREATED,{tracks:this.tracks})},h._onSBUpdateStart=function(n){this.operationQueue.current(n).onStart()},h._onSBUpdateEnd=function(n){var s=this.operationQueue;s.current(n).onComplete(),s.shiftAndExecuteNext(n)},h._onSBUpdateError=function(n,s){P.logger.error("[buffer-controller]: "+n+" SourceBuffer error",s),this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var o=this.operationQueue.current(n);o&&o.onError(s)},h.removeExecutor=function(n,s,o){var l=this.media,c=this.mediaSource,a=this.operationQueue,f=this.sourceBuffer[n];if(!l||!c||!f)return P.logger.warn("[buffer-controller]: Attempting to remove from the "+n+" SourceBuffer, but it does not exist"),void a.shiftAndExecuteNext(n);var g=(0,C.isFiniteNumber)(l.duration)?l.duration:1/0,p=(0,C.isFiniteNumber)(c.duration)?c.duration:1/0,v=Math.max(0,s),_=Math.min(o,g,p);_>v&&!f.ending?(f.ended=!1,P.logger.log("[buffer-controller]: Removing ["+v+","+_+"] from the "+n+" SourceBuffer"),f.remove(v,_)):a.shiftAndExecuteNext(n)},h.appendExecutor=function(n,s){var o=this.operationQueue,l=this.sourceBuffer[s];if(!l)return P.logger.warn("[buffer-controller]: Attempting to append to the "+s+" SourceBuffer, but it does not exist"),void o.shiftAndExecuteNext(s);l.ended=!1,l.appendBuffer(n)},h.blockBuffers=function(n,s){var o=this;if(s===void 0&&(s=this.getSourceBufferTypes()),!s.length)return P.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(n);var l=this.operationQueue,c=s.map(function(a){return l.appendBlocker(a)});Promise.all(c).then(function(){n(),s.forEach(function(a){var f=o.sourceBuffer[a];f&&f.updating||l.shiftAndExecuteNext(a)})})},h.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},h.addBufferListener=function(n,s,o){var l=this.sourceBuffer[n];if(l){var c=o.bind(this,n);this.listeners[n].push({event:s,listener:c}),l.addEventListener(s,c)}},h.removeBufferListeners=function(n){var s=this.sourceBuffer[n];s&&this.listeners[n].forEach(function(o){s.removeEventListener(o.event,o.listener)})},E}(),tl={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},rl=function(E){var h=E;return tl.hasOwnProperty(E)&&(h=tl[E]),String.fromCharCode(h)},yn=15,Xr=100,s0={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},a0={17:2,18:4,21:6,22:8,23:10,19:13,20:15},o0={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},u0={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l0=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];(function(E){E[E.ERROR=0]="ERROR",E[E.TEXT=1]="TEXT",E[E.WARNING=2]="WARNING",E[E.INFO=2]="INFO",E[E.DEBUG=3]="DEBUG",E[E.DATA=3]="DATA"})(St||(St={}));var c0=function(){function E(){this.time=null,this.verboseLevel=St.ERROR}return E.prototype.log=function(h,n){if(this.verboseLevel>=h){var s=typeof n=="function"?n():n;P.logger.log(this.time+" ["+h+"] "+s)}},E}(),An=function(E){for(var h=[],n=0;n<E.length;n++)h.push(E[n].toString(16));return h},nl=function(){function E(n,s,o,l,c){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=n||"white",this.underline=s||!1,this.italics=o||!1,this.background=l||"black",this.flash=c||!1}var h=E.prototype;return h.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},h.setStyles=function(n){for(var s=["foreground","underline","italics","background","flash"],o=0;o<s.length;o++){var l=s[o];n.hasOwnProperty(l)&&(this[l]=n[l])}},h.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},h.equals=function(n){return this.foreground===n.foreground&&this.underline===n.underline&&this.italics===n.italics&&this.background===n.background&&this.flash===n.flash},h.copy=function(n){this.foreground=n.foreground,this.underline=n.underline,this.italics=n.italics,this.background=n.background,this.flash=n.flash},h.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},E}(),f0=function(){function E(n,s,o,l,c,a){this.uchar=void 0,this.penState=void 0,this.uchar=n||" ",this.penState=new nl(s,o,l,c,a)}var h=E.prototype;return h.reset=function(){this.uchar=" ",this.penState.reset()},h.setChar=function(n,s){this.uchar=n,this.penState.copy(s)},h.setPenState=function(n){this.penState.copy(n)},h.equals=function(n){return this.uchar===n.uchar&&this.penState.equals(n.penState)},h.copy=function(n){this.uchar=n.uchar,this.penState.copy(n.penState)},h.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},E}(),d0=function(){function E(n){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var s=0;s<Xr;s++)this.chars.push(new f0);this.logger=n,this.pos=0,this.currPenState=new nl}var h=E.prototype;return h.equals=function(n){for(var s=!0,o=0;o<Xr;o++)if(!this.chars[o].equals(n.chars[o])){s=!1;break}return s},h.copy=function(n){for(var s=0;s<Xr;s++)this.chars[s].copy(n.chars[s])},h.isEmpty=function(){for(var n=!0,s=0;s<Xr;s++)if(!this.chars[s].isEmpty()){n=!1;break}return n},h.setCursor=function(n){this.pos!==n&&(this.pos=n),this.pos<0?(this.logger.log(St.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>Xr&&(this.logger.log(St.DEBUG,"Too large cursor position "+this.pos),this.pos=Xr)},h.moveCursor=function(n){var s=this.pos+n;if(n>1)for(var o=this.pos+1;o<s+1;o++)this.chars[o].setPenState(this.currPenState);this.setCursor(s)},h.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},h.insertChar=function(n){var s=this;n>=144&&this.backSpace();var o=rl(n);this.pos>=Xr?this.logger.log(St.ERROR,function(){return"Cannot insert "+n.toString(16)+" ("+o+") at position "+s.pos+". Skipping it!"}):(this.chars[this.pos].setChar(o,this.currPenState),this.moveCursor(1))},h.clearFromPos=function(n){var s;for(s=n;s<Xr;s++)this.chars[s].reset()},h.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},h.clearToEndOfRow=function(){this.clearFromPos(this.pos)},h.getTextString=function(){for(var n=[],s=!0,o=0;o<Xr;o++){var l=this.chars[o].uchar;l!==" "&&(s=!1),n.push(l)}return s?"":n.join("")},h.setPenStyles=function(n){this.currPenState.setStyles(n),this.chars[this.pos].setPenState(this.currPenState)},E}(),Ha=function(){function E(n){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var s=0;s<yn;s++)this.rows.push(new d0(n));this.logger=n,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var h=E.prototype;return h.reset=function(){for(var n=0;n<yn;n++)this.rows[n].clear();this.currRow=14},h.equals=function(n){for(var s=!0,o=0;o<yn;o++)if(!this.rows[o].equals(n.rows[o])){s=!1;break}return s},h.copy=function(n){for(var s=0;s<yn;s++)this.rows[s].copy(n.rows[s])},h.isEmpty=function(){for(var n=!0,s=0;s<yn;s++)if(!this.rows[s].isEmpty()){n=!1;break}return n},h.backSpace=function(){this.rows[this.currRow].backSpace()},h.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},h.insertChar=function(n){this.rows[this.currRow].insertChar(n)},h.setPen=function(n){this.rows[this.currRow].setPenStyles(n)},h.moveCursor=function(n){this.rows[this.currRow].moveCursor(n)},h.setCursor=function(n){this.logger.log(St.INFO,"setCursor: "+n),this.rows[this.currRow].setCursor(n)},h.setPAC=function(n){this.logger.log(St.INFO,function(){return"pacData = "+JSON.stringify(n)});var s=n.row-1;if(this.nrRollUpRows&&s<this.nrRollUpRows-1&&(s=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==s){for(var o=0;o<yn;o++)this.rows[o].clear();var l=this.currRow+1-this.nrRollUpRows,c=this.lastOutputScreen;if(c){var a=c.rows[l].cueStartTime,f=this.logger.time;if(a&&f!==null&&a<f)for(var g=0;g<this.nrRollUpRows;g++)this.rows[s-this.nrRollUpRows+g+1].copy(c.rows[l+g])}}this.currRow=s;var p=this.rows[this.currRow];if(n.indent!==null){var v=n.indent,_=Math.max(v-1,0);p.setCursor(n.indent),n.color=p.chars[_].penState.foreground}var L={foreground:n.color,underline:n.underline,italics:n.italics,background:"black",flash:!1};this.setPen(L)},h.setBkgData=function(n){this.logger.log(St.INFO,function(){return"bkgData = "+JSON.stringify(n)}),this.backSpace(),this.setPen(n),this.insertChar(32)},h.setRollUpRows=function(n){this.nrRollUpRows=n},h.rollUp=function(){var n=this;if(this.nrRollUpRows!==null){this.logger.log(St.TEXT,function(){return n.getDisplayText()});var s=this.currRow+1-this.nrRollUpRows,o=this.rows.splice(s,1)[0];o.clear(),this.rows.splice(this.currRow,0,o),this.logger.log(St.INFO,"Rolling up")}else this.logger.log(St.DEBUG,"roll_up but nrRollUpRows not set yet")},h.getDisplayText=function(n){n=n||!1;for(var s=[],o="",l=-1,c=0;c<yn;c++){var a=this.rows[c].getTextString();a&&(l=c+1,n?s.push("Row "+l+": '"+a+"'"):s.push(a.trim()))}return s.length>0&&(o=n?"["+s.join(" | ")+"]":s.join(`
`)),o},h.getTextAndFormat=function(){return this.rows},E}(),il=function(){function E(n,s,o){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=n,this.outputFilter=s,this.mode=null,this.verbose=0,this.displayedMemory=new Ha(o),this.nonDisplayedMemory=new Ha(o),this.lastOutputScreen=new Ha(o),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=o}var h=E.prototype;return h.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},h.getHandler=function(){return this.outputFilter},h.setHandler=function(n){this.outputFilter=n},h.setPAC=function(n){this.writeScreen.setPAC(n)},h.setBkgData=function(n){this.writeScreen.setBkgData(n)},h.setMode=function(n){n!==this.mode&&(this.mode=n,this.logger.log(St.INFO,function(){return"MODE="+n}),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=n)},h.insertChars=function(n){for(var s=this,o=0;o<n.length;o++)this.writeScreen.insertChar(n[o]);var l=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(St.INFO,function(){return l+": "+s.writeScreen.getDisplayText(!0)}),this.mode!=="MODE_PAINT-ON"&&this.mode!=="MODE_ROLL-UP"||(this.logger.log(St.TEXT,function(){return"DISPLAYED: "+s.displayedMemory.getDisplayText(!0)}),this.outputDataUpdate())},h.ccRCL=function(){this.logger.log(St.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},h.ccBS=function(){this.logger.log(St.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},h.ccAOF=function(){},h.ccAON=function(){},h.ccDER=function(){this.logger.log(St.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},h.ccRU=function(n){this.logger.log(St.INFO,"RU("+n+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(n)},h.ccFON=function(){this.logger.log(St.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},h.ccRDC=function(){this.logger.log(St.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},h.ccTR=function(){this.logger.log(St.INFO,"TR"),this.setMode("MODE_TEXT")},h.ccRTD=function(){this.logger.log(St.INFO,"RTD"),this.setMode("MODE_TEXT")},h.ccEDM=function(){this.logger.log(St.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},h.ccCR=function(){this.logger.log(St.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},h.ccENM=function(){this.logger.log(St.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},h.ccEOC=function(){var n=this;if(this.logger.log(St.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var s=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=s,this.writeScreen=this.nonDisplayedMemory,this.logger.log(St.TEXT,function(){return"DISP: "+n.displayedMemory.getDisplayText()})}this.outputDataUpdate(!0)},h.ccTO=function(n){this.logger.log(St.INFO,"TO("+n+") - Tab Offset"),this.writeScreen.moveCursor(n)},h.ccMIDROW=function(n){var s={flash:!1};if(s.underline=n%2==1,s.italics=n>=46,s.italics)s.foreground="white";else{var o=Math.floor(n/2)-16;s.foreground=["white","green","blue","cyan","red","yellow","magenta"][o]}this.logger.log(St.INFO,"MIDROW: "+JSON.stringify(s)),this.writeScreen.setPen(s)},h.outputDataUpdate=function(n){n===void 0&&(n=!1);var s=this.logger.time;s!==null&&this.outputFilter&&(this.cueStartTime!==null||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,s,this.lastOutputScreen),n&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:s):this.cueStartTime=s,this.lastOutputScreen.copy(this.displayedMemory))},h.cueSplitAtTime=function(n){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,n,this.displayedMemory),this.cueStartTime=n))},E}(),h0=function(){function E(n,s,o){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var l=new c0;this.channels=[null,new il(n,s,l),new il(n+1,o,l)],this.cmdHistory={a:null,b:null},this.logger=l}var h=E.prototype;return h.getHandler=function(n){return this.channels[n].getHandler()},h.setHandler=function(n,s){this.channels[n].setHandler(s)},h.addData=function(n,s){var o,l,c,a=!1;this.logger.time=n;for(var f=0;f<s.length;f+=2)if(l=127&s[f],c=127&s[f+1],l!==0||c!==0){if(this.logger.log(St.DATA,"["+An([s[f],s[f+1]])+"] -> ("+An([l,c])+")"),(o=this.parseCmd(l,c))||(o=this.parseMidrow(l,c)),o||(o=this.parsePAC(l,c)),o||(o=this.parseBackgroundAttributes(l,c)),!o&&(a=this.parseChars(l,c))){var g=this.currentChannel;g&&g>0?this.channels[g].insertChars(a):this.logger.log(St.WARNING,"No channel found yet. TEXT-MODE?")}o||a||this.logger.log(St.WARNING,"Couldn't parse cleaned data "+An([l,c])+" orig: "+An([s[f],s[f+1]]))}},h.parseCmd=function(n,s){var o=this.cmdHistory;if(!((n===20||n===28||n===21||n===29)&&s>=32&&s<=47||(n===23||n===31)&&s>=33&&s<=35))return!1;if(sl(n,s,o))return jn(null,null,o),this.logger.log(St.DEBUG,"Repeated command ("+An([n,s])+") is dropped"),!0;var l=n===20||n===21||n===23?1:2,c=this.channels[l];return n===20||n===21||n===28||n===29?s===32?c.ccRCL():s===33?c.ccBS():s===34?c.ccAOF():s===35?c.ccAON():s===36?c.ccDER():s===37?c.ccRU(2):s===38?c.ccRU(3):s===39?c.ccRU(4):s===40?c.ccFON():s===41?c.ccRDC():s===42?c.ccTR():s===43?c.ccRTD():s===44?c.ccEDM():s===45?c.ccCR():s===46?c.ccENM():s===47&&c.ccEOC():c.ccTO(s-32),jn(n,s,o),this.currentChannel=l,!0},h.parseMidrow=function(n,s){var o=0;if((n===17||n===25)&&s>=32&&s<=47){if((o=n===17?1:2)!==this.currentChannel)return this.logger.log(St.ERROR,"Mismatch channel in midrow parsing"),!1;var l=this.channels[o];return!!l&&(l.ccMIDROW(s),this.logger.log(St.DEBUG,"MIDROW ("+An([n,s])+")"),!0)}return!1},h.parsePAC=function(n,s){var o,l=this.cmdHistory;if(!((n>=17&&n<=23||n>=25&&n<=31)&&s>=64&&s<=127||(n===16||n===24)&&s>=64&&s<=95))return!1;if(sl(n,s,l))return jn(null,null,l),!0;var c=n<=23?1:2;o=s>=64&&s<=95?c===1?s0[n]:o0[n]:c===1?a0[n]:u0[n];var a=this.channels[c];return!!a&&(a.setPAC(this.interpretPAC(o,s)),jn(n,s,l),this.currentChannel=c,!0)},h.interpretPAC=function(n,s){var o,l={color:null,italics:!1,indent:null,underline:!1,row:n};return o=s>95?s-96:s-64,l.underline=(1&o)==1,o<=13?l.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(o/2)]:o<=15?(l.italics=!0,l.color="white"):l.indent=4*Math.floor((o-16)/2),l},h.parseChars=function(n,s){var o,l,c=null,a=null;if(n>=25?(o=2,a=n-8):(o=1,a=n),a>=17&&a<=19?(l=a===17?s+80:a===18?s+112:s+144,this.logger.log(St.INFO,"Special char '"+rl(l)+"' in channel "+o),c=[l]):n>=32&&n<=127&&(c=s===0?[n]:[n,s]),c){var f=An(c);this.logger.log(St.DEBUG,"Char codes =  "+f.join(",")),jn(n,s,this.cmdHistory)}return c},h.parseBackgroundAttributes=function(n,s){var o;if(!((n===16||n===24)&&s>=32&&s<=47||(n===23||n===31)&&s>=45&&s<=47))return!1;var l={};n===16||n===24?(o=Math.floor((s-32)/2),l.background=l0[o],s%2==1&&(l.background=l.background+"_semi")):s===45?l.background="transparent":(l.foreground="black",s===47&&(l.underline=!0));var c=n<=23?1:2;return this.channels[c].setBkgData(l),jn(n,s,this.cmdHistory),!0},h.reset=function(){for(var n=0;n<Object.keys(this.channels).length;n++){var s=this.channels[n];s&&s.reset()}this.cmdHistory={a:null,b:null}},h.cueSplitAtTime=function(n){for(var s=0;s<this.channels.length;s++){var o=this.channels[s];o&&o.cueSplitAtTime(n)}},E}();function jn(E,h,n){n.a=E,n.b=h}function sl(E,h,n){return n.a===E&&n.b===h}const al=h0;var ds=function(){function E(n,s){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=n,this.trackName=s}var h=E.prototype;return h.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},h.newCue=function(n,s,o){(this.startTime===null||this.startTime>n)&&(this.startTime=n),this.endTime=s,this.screen=o,this.timelineController.createCaptionsTrack(this.trackName)},h.reset=function(){this.cueRanges=[],this.startTime=null},E}();const Ga=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var E=["","lr","rl"],h=["start","middle","end","left","right"];function n(c,a){if(typeof a!="string"||!Array.isArray(c))return!1;var f=a.toLowerCase();return!!~c.indexOf(f)&&f}function s(c){return n(h,c)}function o(c){for(var a=arguments.length,f=new Array(a>1?a-1:0),g=1;g<a;g++)f[g-1]=arguments[g];for(var p=1;p<arguments.length;p++){var v=arguments[p];for(var _ in v)c[_]=v[_]}return c}function l(c,a,f){var g=this,p={enumerable:!0};g.hasBeenReset=!1;var v="",_=!1,L=c,x=a,M=f,j=null,K="",Z=!0,he="auto",_e="start",Ee=50,De="middle",$e=50,st="middle";Object.defineProperty(g,"id",o({},p,{get:function(){return v},set:function(Se){v=""+Se}})),Object.defineProperty(g,"pauseOnExit",o({},p,{get:function(){return _},set:function(Se){_=!!Se}})),Object.defineProperty(g,"startTime",o({},p,{get:function(){return L},set:function(Se){if(typeof Se!="number")throw new TypeError("Start time must be set to a number.");L=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"endTime",o({},p,{get:function(){return x},set:function(Se){if(typeof Se!="number")throw new TypeError("End time must be set to a number.");x=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"text",o({},p,{get:function(){return M},set:function(Se){M=""+Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"region",o({},p,{get:function(){return j},set:function(Se){j=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"vertical",o({},p,{get:function(){return K},set:function(Se){var Xe=function(je){return n(E,je)}(Se);if(Xe===!1)throw new SyntaxError("An invalid or illegal string was specified.");K=Xe,this.hasBeenReset=!0}})),Object.defineProperty(g,"snapToLines",o({},p,{get:function(){return Z},set:function(Se){Z=!!Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"line",o({},p,{get:function(){return he},set:function(Se){if(typeof Se!="number"&&Se!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");he=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"lineAlign",o({},p,{get:function(){return _e},set:function(Se){var Xe=s(Se);if(!Xe)throw new SyntaxError("An invalid or illegal string was specified.");_e=Xe,this.hasBeenReset=!0}})),Object.defineProperty(g,"position",o({},p,{get:function(){return Ee},set:function(Se){if(Se<0||Se>100)throw new Error("Position must be between 0 and 100.");Ee=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"positionAlign",o({},p,{get:function(){return De},set:function(Se){var Xe=s(Se);if(!Xe)throw new SyntaxError("An invalid or illegal string was specified.");De=Xe,this.hasBeenReset=!0}})),Object.defineProperty(g,"size",o({},p,{get:function(){return $e},set:function(Se){if(Se<0||Se>100)throw new Error("Size must be between 0 and 100.");$e=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"align",o({},p,{get:function(){return st},set:function(Se){var Xe=s(Se);if(!Xe)throw new SyntaxError("An invalid or illegal string was specified.");st=Xe,this.hasBeenReset=!0}})),g.displayState=void 0}return l.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},l}();var g0=function(){function E(){}return E.prototype.decode=function(h,n){if(!h)return"";if(typeof h!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(h))},E}();function ol(E){function h(s,o,l,c){return 3600*(0|s)+60*(0|o)+(0|l)+parseFloat(c||0)}var n=E.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?h(n[2],n[3],0,n[4]):h(n[1],n[2],n[3],n[4]):null}var m0=function(){function E(){this.values=Object.create(null)}var h=E.prototype;return h.set=function(n,s){this.get(n)||s===""||(this.values[n]=s)},h.get=function(n,s,o){return o?this.has(n)?this.values[n]:s[o]:this.has(n)?this.values[n]:s},h.has=function(n){return n in this.values},h.alt=function(n,s,o){for(var l=0;l<o.length;++l)if(s===o[l]){this.set(n,s);break}},h.integer=function(n,s){/^-?\d+$/.test(s)&&this.set(n,parseInt(s,10))},h.percent=function(n,s){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(s)){var o=parseFloat(s);if(o>=0&&o<=100)return this.set(n,o),!0}return!1},E}();function ul(E,h,n,s){var o=s?E.split(s):[E];for(var l in o)if(typeof o[l]=="string"){var c=o[l].split(n);c.length===2&&h(c[0],c[1])}}var Ka=new Ga(0,0,""),hs=Ka.align==="middle"?"middle":"center";function p0(E,h,n){var s=E;function o(){var c=ol(E);if(c===null)throw new Error("Malformed timestamp: "+s);return E=E.replace(/^[^\sa-zA-Z-]+/,""),c}function l(){E=E.replace(/^\s+/,"")}if(l(),h.startTime=o(),l(),E.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+s);E=E.slice(3),l(),h.endTime=o(),l(),function(c,a){var f=new m0;ul(c,function(v,_){var L;switch(v){case"region":for(var x=n.length-1;x>=0;x--)if(n[x].id===_){f.set(v,n[x].region);break}break;case"vertical":f.alt(v,_,["rl","lr"]);break;case"line":L=_.split(","),f.integer(v,L[0]),f.percent(v,L[0])&&f.set("snapToLines",!1),f.alt(v,L[0],["auto"]),L.length===2&&f.alt("lineAlign",L[1],["start",hs,"end"]);break;case"position":L=_.split(","),f.percent(v,L[0]),L.length===2&&f.alt("positionAlign",L[1],["start",hs,"end","line-left","line-right","auto"]);break;case"size":f.percent(v,_);break;case"align":f.alt(v,_,["start",hs,"end","left","right"])}},/:/,/\s/),a.region=f.get("region",null),a.vertical=f.get("vertical","");var g=f.get("line","auto");g==="auto"&&Ka.line===-1&&(g=-1),a.line=g,a.lineAlign=f.get("lineAlign","start"),a.snapToLines=f.get("snapToLines",!0),a.size=f.get("size",100),a.align=f.get("align",hs);var p=f.get("position","auto");p==="auto"&&Ka.position===50&&(p=a.align==="start"||a.align==="left"?0:a.align==="end"||a.align==="right"?100:50),a.position=p}(E,h)}function ll(E){return E.replace(/<br(?: \/)?>/gi,`
`)}var E0=function(){function E(){this.state="INITIAL",this.buffer="",this.decoder=new g0,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var h=E.prototype;return h.parse=function(n){var s=this;function o(){var g=s.buffer,p=0;for(g=ll(g);p<g.length&&g[p]!=="\r"&&g[p]!==`
`;)++p;var v=g.slice(0,p);return g[p]==="\r"&&++p,g[p]===`
`&&++p,s.buffer=g.slice(p),v}n&&(s.buffer+=s.decoder.decode(n,{stream:!0}));try{var l="";if(s.state==="INITIAL"){if(!/\r\n|\n/.test(s.buffer))return this;var c=(l=o()).match(/^()?WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new Error("Malformed WebVTT signature.");s.state="HEADER"}for(var a=!1;s.buffer;){if(!/\r\n|\n/.test(s.buffer))return this;switch(a?a=!1:l=o(),s.state){case"HEADER":/:/.test(l)?ul(l,function(g,p){},/:/):l||(s.state="ID");continue;case"NOTE":l||(s.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(l)){s.state="NOTE";break}if(!l)continue;if(s.cue=new Ga(0,0,""),s.state="CUE",l.indexOf("-->")===-1){s.cue.id=l;continue}case"CUE":if(!s.cue){s.state="BADCUE";continue}try{p0(l,s.cue,s.regionList)}catch{s.cue=null,s.state="BADCUE";continue}s.state="CUETEXT";continue;case"CUETEXT":var f=l.indexOf("-->")!==-1;if(!l||f&&(a=!0)){s.oncue&&s.cue&&s.oncue(s.cue),s.cue=null,s.state="ID";continue}if(s.cue===null)continue;s.cue.text&&(s.cue.text+=`
`),s.cue.text+=l;continue;case"BADCUE":l||(s.state="ID")}}}catch{s.state==="CUETEXT"&&s.cue&&s.oncue&&s.oncue(s.cue),s.cue=null,s.state=s.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},h.flush=function(){var n=this;try{if((n.cue||n.state==="HEADER")&&(n.buffer+=`

`,n.parse()),n.state==="INITIAL"||n.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(s){n.onparsingerror&&n.onparsingerror(s)}return n.onflush&&n.onflush(),this},E}(),cl=y(673),T0=y(524),v0=/\r\n|\n\r|\n|\r/g,Ya=function(E,h,n){return n===void 0&&(n=0),E.slice(n,n+h.length)===h},Va=function(E){for(var h=5381,n=E.length;n;)h=33*h^E.charCodeAt(--n);return(h>>>0).toString()};function ja(E,h,n){return Va(E.toString())+Va(h.toString())+Va(n)}function qa(){return qa=Object.assign?Object.assign.bind():function(E){for(var h=1;h<arguments.length;h++){var n=arguments[h];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(E[s]=n[s])}return E},qa.apply(this,arguments)}var Wa="stpp.ttml.im1t",fl=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,dl=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,b0={left:"start",center:"center",right:"end",start:"start",end:"end"};function hl(E,h,n,s,o){var l=(0,ve.findBox)(new Uint8Array(E),["mdat"]);if(l.length!==0){var c=l.map(function(f){return(0,Be.utf8ArrayToStr)(f)}),a=(0,cl.toTimescaleFromScale)(h,1,n);try{c.forEach(function(f){return s(function(g,p){var v=new DOMParser().parseFromString(g,"text/xml").getElementsByTagName("tt")[0];if(!v)throw new Error("Invalid ttml");var _={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},L=Object.keys(_).reduce(function(Z,he){return Z[he]=v.getAttribute("ttp:"+he)||_[he],Z},{}),x=v.getAttribute("xml:space")!=="preserve",M=gl(Xa(v,"styling","style")),j=gl(Xa(v,"layout","region")),K=Xa(v,"body","[begin]");return[].map.call(K,function(Z){var he=ml(Z,x);if(!he||!Z.hasAttribute("begin"))return null;var _e=za(Z.getAttribute("begin"),L),Ee=za(Z.getAttribute("dur"),L),De=za(Z.getAttribute("end"),L);if(_e===null)throw pl(Z);if(De===null){if(Ee===null)throw pl(Z);De=_e+Ee}var $e=new Ga(_e-p,De-p,he);$e.id=ja($e.startTime,$e.endTime,$e.text);var st=function(je,mt,xt){var Tt="http://www.w3.org/ns/ttml#styling",_t=null,Lt=je!=null&&je.hasAttribute("style")?je.getAttribute("style"):null;return Lt&&xt.hasOwnProperty(Lt)&&(_t=xt[Lt]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function(Xt,Wt){var Ht=Qa(mt,Tt,Wt)||Qa(je,Tt,Wt)||Qa(_t,Tt,Wt);return Ht&&(Xt[Wt]=Ht),Xt},{})}(j[Z.getAttribute("region")],M[Z.getAttribute("style")],M),Se=st.textAlign;if(Se){var Xe=b0[Se];Xe&&($e.lineAlign=Xe),$e.align=Se}return qa($e,st),$e}).filter(function(Z){return Z!==null})}(f,a))})}catch(f){o(f)}}else o(new Error("Could not parse IMSC1 mdat"))}function Xa(E,h,n){var s=E.getElementsByTagName(h)[0];return s?[].slice.call(s.querySelectorAll(n)):[]}function gl(E){return E.reduce(function(h,n){var s=n.getAttribute("xml:id");return s&&(h[s]=n),h},{})}function ml(E,h){return[].slice.call(E.childNodes).reduce(function(n,s,o){var l;return s.nodeName==="br"&&o?n+`
`:(l=s.childNodes)!==null&&l!==void 0&&l.length?ml(s,h):h?n+s.textContent.trim().replace(/\s+/g," "):n+s.textContent},"")}function Qa(E,h,n){return E&&E.hasAttributeNS(h,n)?E.getAttributeNS(h,n):null}function pl(E){return new Error("Could not parse ttml timestamp "+E)}function za(E,h){if(!E)return null;var n=ol(E);return n===null&&(fl.test(E)?n=function(s,o){var l=fl.exec(s),c=(0|l[4])+(0|l[5])/o.subFrameRate;return 3600*(0|l[1])+60*(0|l[2])+(0|l[3])+c/o.frameRate}(E,h):dl.test(E)&&(n=function(s,o){var l=dl.exec(s),c=Number(l[1]);switch(l[2]){case"h":return 3600*c;case"m":return 60*c;case"ms":return 1e3*c;case"f":return c/o.frameRate;case"t":return c/o.tickRate}return c}(E,h))),n}var y0=function(){function E(n){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=n,this.config=n.config,this.Cues=n.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var s=new ds(this,"textTrack1"),o=new ds(this,"textTrack2"),l=new ds(this,"textTrack3"),c=new ds(this,"textTrack4");this.cea608Parser1=new al(1,s,o),this.cea608Parser2=new al(3,l,c)}n.on(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this),n.on(b.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),n.on(b.Events.FRAG_LOADING,this.onFragLoading,this),n.on(b.Events.FRAG_LOADED,this.onFragLoaded,this),n.on(b.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),n.on(b.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),n.on(b.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),n.on(b.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),n.on(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var h=E.prototype;return h.destroy=function(){var n=this.hls;n.off(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this),n.off(b.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),n.off(b.Events.FRAG_LOADING,this.onFragLoading,this),n.off(b.Events.FRAG_LOADED,this.onFragLoaded,this),n.off(b.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),n.off(b.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),n.off(b.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),n.off(b.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),n.off(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},h.addCues=function(n,s,o,l,c){for(var a,f,g,p,v=!1,_=c.length;_--;){var L=c[_],x=(a=L[0],f=L[1],g=s,p=o,Math.min(f,p)-Math.max(a,g));if(x>=0&&(L[0]=Math.min(L[0],s),L[1]=Math.max(L[1],o),v=!0,x/(o-s)>.5))return}if(v||c.push([s,o]),this.config.renderTextTracksNatively){var M=this.captionsTracks[n];this.Cues.newCue(M,s,o,l)}else{var j=this.Cues.newCue(null,s,o,l);this.hls.trigger(b.Events.CUES_PARSED,{type:"captions",cues:j,track:n})}},h.onInitPtsFound=function(n,s){var o=this,l=s.frag,c=s.id,a=s.initPTS,f=s.timescale,g=this.unparsedVttFrags;c==="main"&&(this.initPTS[l.cc]=a,this.timescale[l.cc]=f),g.length&&(this.unparsedVttFrags=[],g.forEach(function(p){o.onFragLoaded(b.Events.FRAG_LOADED,p)}))},h.getExistingTrack=function(n){var s=this.media;if(s)for(var o=0;o<s.textTracks.length;o++){var l=s.textTracks[o];if(l[n])return l}return null},h.createCaptionsTrack=function(n){this.config.renderTextTracksNatively?this.createNativeTrack(n):this.createNonNativeTrack(n)},h.createNativeTrack=function(n){if(!this.captionsTracks[n]){var s=this.captionsProperties,o=this.captionsTracks,l=this.media,c=s[n],a=c.label,f=c.languageCode,g=this.getExistingTrack(n);if(g)o[n]=g,Me(o[n]),me(o[n],l);else{var p=this.createTextTrack("captions",a,f);p&&(p[n]=!0,o[n]=p)}}},h.createNonNativeTrack=function(n){if(!this.nonNativeCaptionsTracks[n]){var s=this.captionsProperties[n];if(s){var o={_id:n,label:s.label,kind:"captions",default:!!s.media&&!!s.media.default,closedCaptions:s.media};this.nonNativeCaptionsTracks[n]=o,this.hls.trigger(b.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[o]})}}},h.createTextTrack=function(n,s,o){var l=this.media;if(l)return l.addTextTrack(n,s,o)},h.onMediaAttaching=function(n,s){this.media=s.media,this._cleanTracks()},h.onMediaDetaching=function(){var n=this.captionsTracks;Object.keys(n).forEach(function(s){Me(n[s]),delete n[s]}),this.nonNativeCaptionsTracks={}},h.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},h._cleanTracks=function(){var n=this.media;if(n){var s=n.textTracks;if(s)for(var o=0;o<s.length;o++)Me(s[o])}},h.onSubtitleTracksUpdated=function(n,s){var o=this;this.textTracks=[];var l=s.subtitleTracks||[],c=l.some(function(p){return p.textCodec===Wa});if(this.config.enableWebVTT||c&&this.config.enableIMSC1){var a=this.tracks&&l&&this.tracks.length===l.length;if(this.tracks=l||[],this.config.renderTextTracksNatively){var f=this.media?this.media.textTracks:[];this.tracks.forEach(function(p,v){var _;if(v<f.length){for(var L=null,x=0;x<f.length;x++)if(A0(f[x],p)){L=f[x];break}L&&(_=L)}if(_)Me(_);else{var M=o._captionsOrSubtitlesFromCharacteristics(p);(_=o.createTextTrack(M,p.name,p.lang))&&(_.mode="disabled")}_&&(_.groupId=p.groupId,o.textTracks.push(_))})}else if(!a&&this.tracks&&this.tracks.length){var g=this.tracks.map(function(p){return{label:p.name,kind:p.type.toLowerCase(),default:p.default,subtitleTrack:p}});this.hls.trigger(b.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:g})}}},h._captionsOrSubtitlesFromCharacteristics=function(n){var s;if((s=n.attrs)!==null&&s!==void 0&&s.CHARACTERISTICS){var o=/transcribes-spoken-dialog/gi.test(n.attrs.CHARACTERISTICS),l=/describes-music-and-sound/gi.test(n.attrs.CHARACTERISTICS);if(o&&l)return"captions"}return"subtitles"},h.onManifestLoaded=function(n,s){var o=this;this.config.enableCEA708Captions&&s.captions&&s.captions.forEach(function(l){var c=/(?:CC|SERVICE)([1-4])/.exec(l.instreamId);if(c){var a="textTrack"+c[1],f=o.captionsProperties[a];f&&(f.label=l.name,l.lang&&(f.languageCode=l.lang),f.media=l)}})},h.closedCaptionsForLevel=function(n){var s=this.hls.levels[n.level];return s==null?void 0:s.attrs["CLOSED-CAPTIONS"]},h.onFragLoading=function(n,s){var o=this.cea608Parser1,l=this.cea608Parser2,c=this.lastSn,a=this.lastPartIndex;if(this.enabled&&o&&l&&s.frag.type===O.PlaylistLevelType.MAIN){var f,g,p=s.frag.sn,v=(f=s==null||(g=s.part)===null||g===void 0?void 0:g.index)!=null?f:-1;p===c+1||p===c&&v===a+1||(o.reset(),l.reset()),this.lastSn=p,this.lastPartIndex=v}},h.onFragLoaded=function(n,s){var o=s.frag,l=s.payload,c=this.initPTS,a=this.unparsedVttFrags;if(o.type===O.PlaylistLevelType.SUBTITLE)if(l.byteLength){if(!(0,C.isFiniteNumber)(c[o.cc]))return a.push(s),void(c.length&&this.hls.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Missing initial subtitle PTS")}));var f=o.decryptdata,g="stats"in s;if(f==null||!f.encrypted||g){var p=this.tracks[o.level],v=this.vttCCs;v[o.cc]||(v[o.cc]={start:o.start,prevCC:this.prevCC,new:!0},this.prevCC=o.cc),p&&p.textCodec===Wa?this._parseIMSC1(o,l):this._parseVTTs(o,l,v)}}else this.hls.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Empty subtitle payload")})},h._parseIMSC1=function(n,s){var o=this,l=this.hls;hl(s,this.initPTS[n.cc],this.timescale[n.cc],function(c){o._appendCues(c,n.level),l.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},function(c){P.logger.log("Failed to parse IMSC1: "+c),l.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:c})})},h._parseVTTs=function(n,s,o){var l,c=this,a=this.hls;(function(f,g,p,v,_,L,x,M){var j,K=new E0,Z=(0,Be.utf8ArrayToStr)(new Uint8Array(f)).trim().replace(v0,`
`).split(`
`),he=[],_e=(0,cl.toMpegTsClockFromTimescale)(g,p),Ee="00:00.000",De=0,$e=0,st=!0;K.oncue=function(Se){var Xe=v[_],je=v.ccOffset,mt=(De-_e)/9e4;Xe!=null&&Xe.new&&($e!==void 0?je=v.ccOffset=Xe.start:function(Lt,Xt,Wt){var Ht=Lt[Xt],Qt=Lt[Ht.prevCC];if(!Qt||!Qt.new&&Ht.new)return Lt.ccOffset=Lt.presentationOffset=Ht.start,void(Ht.new=!1);for(;(pr=Qt)!==null&&pr!==void 0&&pr.new;){var pr;Lt.ccOffset+=Ht.start-Qt.start,Ht.new=!1,Qt=Lt[(Ht=Qt).prevCC]}Lt.presentationOffset=Wt}(v,_,mt)),mt&&(je=mt-v.presentationOffset);var xt=Se.endTime-Se.startTime,Tt=(0,T0.normalizePts)(9e4*(Se.startTime+je-$e),9e4*L)/9e4;Se.startTime=Math.max(Tt,0),Se.endTime=Math.max(Tt+xt,0);var _t=Se.text.trim();Se.text=decodeURIComponent(encodeURIComponent(_t)),Se.id||(Se.id=ja(Se.startTime,Se.endTime,_t)),Se.endTime>0&&he.push(Se)},K.onparsingerror=function(Se){j=Se},K.onflush=function(){j?M(j):x(he)},Z.forEach(function(Se){if(st){if(Ya(Se,"X-TIMESTAMP-MAP=")){st=!1,Se.slice(16).split(",").forEach(function(Xe){Ya(Xe,"LOCAL:")?Ee=Xe.slice(6):Ya(Xe,"MPEGTS:")&&(De=parseInt(Xe.slice(7)))});try{$e=function(Xe){var je=parseInt(Xe.slice(-3)),mt=parseInt(Xe.slice(-6,-4)),xt=parseInt(Xe.slice(-9,-7)),Tt=Xe.length>9?parseInt(Xe.substring(0,Xe.indexOf(":"))):0;if(!((0,C.isFiniteNumber)(je)&&(0,C.isFiniteNumber)(mt)&&(0,C.isFiniteNumber)(xt)&&(0,C.isFiniteNumber)(Tt)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+Xe);return je+=1e3*mt,(je+=6e4*xt)+36e5*Tt}(Ee)/1e3}catch(Xe){j=Xe}return}Se===""&&(st=!1)}K.parse(Se+`
`)}),K.flush()})((l=n.initSegment)!==null&&l!==void 0&&l.data?(0,ve.appendUint8Array)(n.initSegment.data,new Uint8Array(s)):s,this.initPTS[n.cc],this.timescale[n.cc],o,n.cc,n.start,function(f){c._appendCues(f,n.level),a.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},function(f){c._fallbackToIMSC1(n,s),P.logger.log("Failed to parse VTT cue: "+f),a.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:f})})},h._fallbackToIMSC1=function(n,s){var o=this,l=this.tracks[n.level];l.textCodec||hl(s,this.initPTS[n.cc],this.timescale[n.cc],function(){l.textCodec=Wa,o._parseIMSC1(n,s)},function(){l.textCodec="wvtt"})},h._appendCues=function(n,s){var o=this.hls;if(this.config.renderTextTracksNatively){var l=this.textTracks[s];if(!l||l.mode==="disabled")return;n.forEach(function(f){return Ne(l,f)})}else{var c=this.tracks[s];if(!c)return;var a=c.default?"default":"subtitles"+s;o.trigger(b.Events.CUES_PARSED,{type:"subtitles",cues:n,track:a})}},h.onFragDecrypted=function(n,s){var o=s.frag;if(o.type===O.PlaylistLevelType.SUBTITLE){if(!(0,C.isFiniteNumber)(this.initPTS[o.cc]))return void this.unparsedVttFrags.push(s);this.onFragLoaded(b.Events.FRAG_LOADED,s)}},h.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},h.onFragParsingUserdata=function(n,s){var o=this.cea608Parser1,l=this.cea608Parser2;if(this.enabled&&o&&l){var c=s.frag,a=s.samples;if(c.type!==O.PlaylistLevelType.MAIN||this.closedCaptionsForLevel(c)!=="NONE")for(var f=0;f<a.length;f++){var g=a[f].bytes;if(g){var p=this.extractCea608Data(g);o.addData(a[f].pts,p[0]),l.addData(a[f].pts,p[1])}}}},h.onBufferFlushing=function(n,s){var o=s.startOffset,l=s.endOffset,c=s.endOffsetSubtitles,a=s.type,f=this.media;if(f&&!(f.currentTime<l)){if(!a||a==="video"){var g=this.captionsTracks;Object.keys(g).forEach(function(v){return ke(g[v],o,l)})}if(this.config.renderTextTracksNatively&&o===0&&c!==void 0){var p=this.textTracks;Object.keys(p).forEach(function(v){return ke(p[v],o,c)})}}},h.extractCea608Data=function(n){for(var s=[[],[]],o=31&n[0],l=2,c=0;c<o;c++){var a=n[l++],f=127&n[l++],g=127&n[l++];if((f!==0||g!==0)&&4&a){var p=3&a;p!==0&&p!==1||(s[p].push(f),s[p].push(g))}}return s},E}();function A0(E,h){return E&&E.label===h.name&&!(E.textTrack1||E.textTrack2)}function _0(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}const S0=function(){function E(o){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=o,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var h,n,s=E.prototype;return s.setStreamController=function(o){this.streamController=o},s.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},s.registerListeners=function(){var o=this.hls;o.on(b.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),o.on(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(b.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},s.unregisterListener=function(){var o=this.hls;o.off(b.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),o.off(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(b.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},s.onFpsDropLevelCapping=function(o,l){E.isLevelAllowed(l.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(l.droppedLevel)},s.onMediaAttaching=function(o,l){this.media=l.media instanceof HTMLVideoElement?l.media:null,this.clientRect=null},s.onManifestParsed=function(o,l){var c=this.hls;this.restrictedLevels=[],this.firstLevel=l.firstLevel,c.config.capLevelToPlayerSize&&l.video&&this.startCapping()},s.onBufferCodecs=function(o,l){this.hls.config.capLevelToPlayerSize&&l.video&&this.startCapping()},s.onMediaDetaching=function(){this.stopCapping()},s.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var o=this.hls.levels;if(o.length){var l=this.hls;l.autoLevelCapping=this.getMaxLevel(o.length-1),l.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=l.autoLevelCapping}}},s.getMaxLevel=function(o){var l=this,c=this.hls.levels;if(!c.length)return-1;var a=c.filter(function(f,g){return E.isLevelAllowed(g,l.restrictedLevels)&&g<=o});return this.clientRect=null,E.getMaxLevelByMediaSize(a,this.mediaWidth,this.mediaHeight)},s.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},s.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},s.getDimensions=function(){if(this.clientRect)return this.clientRect;var o=this.media,l={width:0,height:0};if(o){var c=o.getBoundingClientRect();l.width=c.width,l.height=c.height,l.width||l.height||(l.width=c.right-c.left||o.width||0,l.height=c.bottom-c.top||o.height||0)}return this.clientRect=l,l},E.isLevelAllowed=function(o,l){return l===void 0&&(l=[]),l.indexOf(o)===-1},E.getMaxLevelByMediaSize=function(o,l,c){if(!o||!o.length)return-1;for(var a,f,g=o.length-1,p=0;p<o.length;p+=1){var v=o[p];if((v.width>=l||v.height>=c)&&(a=v,!(f=o[p+1])||a.width!==f.width||a.height!==f.height)){g=p;break}}return g},h=E,(n=[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var o=1;if(!this.hls.config.ignoreDevicePixelRatio)try{o=self.devicePixelRatio}catch{}return o}}])&&_0(h.prototype,n),Object.defineProperty(h,"prototype",{writable:!1}),E}(),I0=function(){function E(n){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=n,this.registerListeners()}var h=E.prototype;return h.setStreamController=function(n){this.streamController=n},h.registerListeners=function(){this.hls.on(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},h.unregisterListeners=function(){this.hls.off(b.Events.MEDIA_ATTACHING,this.onMediaAttaching)},h.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},h.onMediaAttaching=function(n,s){var o=this.hls.config;if(o.capLevelOnFPSDrop){var l=s.media instanceof self.HTMLVideoElement?s.media:null;this.media=l,l&&typeof l.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),o.fpsDroppedMonitoringPeriod)}},h.checkFPS=function(n,s,o){var l=performance.now();if(s){if(this.lastTime){var c=l-this.lastTime,a=o-this.lastDroppedFrames,f=s-this.lastDecodedFrames,g=1e3*a/c,p=this.hls;if(p.trigger(b.Events.FPS_DROP,{currentDropped:a,currentDecoded:f,totalDroppedFrames:o}),g>0&&a>p.config.fpsDroppedMonitoringThreshold*f){var v=p.currentLevel;P.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+v),v>0&&(p.autoLevelCapping===-1||p.autoLevelCapping>=v)&&(v-=1,p.trigger(b.Events.FPS_DROP_LEVEL_CAPPING,{level:v,droppedLevel:p.currentLevel}),p.autoLevelCapping=v,this.streamController.nextLevelSwitch())}}this.lastTime=l,this.lastDroppedFrames=o,this.lastDecodedFrames=s}},h.checkFPSInterval=function(){var n=this.media;if(n)if(this.isVideoPlaybackQualityAvailable){var s=n.getVideoPlaybackQuality();this.checkFPS(n,s.totalVideoFrames,s.droppedVideoFrames)}else this.checkFPS(n,n.webkitDecodedFrameCount,n.webkitDroppedFrameCount)},E}();var _n=y(300);function $a(E){var h=typeof Map=="function"?new Map:void 0;return $a=function(n){if(n===null||(s=n,Function.toString.call(s).indexOf("[native code]")===-1))return n;var s;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(h!==void 0){if(h.has(n))return h.get(n);h.set(n,o)}function o(){return Za(n,arguments,Ja(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),_i(o,n)},$a(E)}function Za(E,h,n){return Za=C0()?Reflect.construct.bind():function(s,o,l){var c=[null];c.push.apply(c,o);var a=new(Function.bind.apply(s,c));return l&&_i(a,l.prototype),a},Za.apply(null,arguments)}function C0(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _i(E,h){return _i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},_i(E,h)}function Ja(E){return Ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(h){return h.__proto__||Object.getPrototypeOf(h)},Ja(E)}var gs="[eme]",El=function(){function E(n){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=E.CDMCleanupPromise?[E.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=P.logger.debug.bind(P.logger,gs),this.log=P.logger.log.bind(P.logger,gs),this.warn=P.logger.warn.bind(P.logger,gs),this.error=P.logger.error.bind(P.logger,gs),this.hls=n,this.config=n.config,this.registerListeners()}var h=E.prototype;return h.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null},h.registerListeners=function(){this.hls.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},h.unregisterListeners=function(){this.hls.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},h.getLicenseServerUrl=function(n){var s=this.config,o=s.drmSystems,l=s.widevineLicenseUrl,c=o[n];if(c)return c.licenseUrl;if(n===ae.WIDEVINE&&l)return l;throw new Error('no license server URL configured for key-system "'+n+'"')},h.getServerCertificateUrl=function(n){var s=this.config.drmSystems[n];if(s)return s.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+n+'"]')},h.attemptKeySystemAccess=function(n){var s=this,o=this.hls.levels,l=function(f,g,p){return!!f&&p.indexOf(f)===g},c=o.map(function(f){return f.audioCodec}).filter(l),a=o.map(function(f){return f.videoCodec}).filter(l);return c.length+a.length===0&&a.push("avc1.42e01e"),new Promise(function(f,g){(function p(v){var _=v.shift();s.getMediaKeysPromise(_,c,a).then(function(L){return f({keySystem:_,mediaKeys:L})}).catch(function(L){v.length?p(v):g(L instanceof Ir?L:new Ir({type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:L,fatal:!0},L.message))})})(n)})},h.requestMediaKeySystemAccess=function(n,s){var o=this.config.requestMediaKeySystemAccessFunc;if(typeof o!="function"){var l="Configured requestMediaKeySystemAccess is not a function "+o;return Re===null&&self.location.protocol==="http:"&&(l="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(l))}return o(n,s)},h.getMediaKeysPromise=function(n,s,o){var l=this,c=function(p,v,_,L){var x;switch(p){case ae.FAIRPLAY:x=["cenc","sinf"];break;case ae.WIDEVINE:case ae.PLAYREADY:x=["cenc"];break;case ae.CLEARKEY:x=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+p)}return function(M,j,K,Z){return[{initDataTypes:M,persistentState:Z.persistentState||"not-allowed",distinctiveIdentifier:Z.distinctiveIdentifier||"not-allowed",sessionTypes:Z.sessionTypes||[Z.sessionType||"temporary"],audioCapabilities:j.map(function(he){return{contentType:'audio/mp4; codecs="'+he+'"',robustness:Z.audioRobustness||"",encryptionScheme:Z.audioEncryptionScheme||null}}),videoCapabilities:K.map(function(he){return{contentType:'video/mp4; codecs="'+he+'"',robustness:Z.videoRobustness||"",encryptionScheme:Z.videoEncryptionScheme||null}})}]}(x,v,_,L)}(n,s,o,this.config.drmSystemOptions),a=this.keySystemAccessPromises[n],f=a==null?void 0:a.keySystemAccess;if(!f){this.log('Requesting encrypted media "'+n+'" key-system access with config: '+JSON.stringify(c)),f=this.requestMediaKeySystemAccess(n,c);var g=this.keySystemAccessPromises[n]={keySystemAccess:f};return f.catch(function(p){l.log('Failed to obtain access to key-system "'+n+'": '+p)}),f.then(function(p){l.log('Access for key-system "'+p.keySystem+'" obtained');var v=l.fetchServerCertificate(n);return l.log('Create media-keys for "'+n+'"'),g.mediaKeys=p.createMediaKeys().then(function(_){return l.log('Media-keys created for "'+n+'"'),v.then(function(L){return L?l.setMediaKeysServerCertificate(_,n,L):_})}),g.mediaKeys.catch(function(_){l.error('Failed to create media-keys for "'+n+'"}: '+_)}),g.mediaKeys})}return f.then(function(){return a.mediaKeys})},h.createMediaKeySessionContext=function(n){var s=n.decryptdata,o=n.keySystem,l=n.mediaKeys;this.log('Creating key-system session "'+o+'" keyId: '+_n.default.hexDump(s.keyId||[]));var c=l.createSession(),a={decryptdata:s,keySystem:o,mediaKeys:l,mediaKeysSession:c,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a},h.renewKeySession=function(n){var s=n.decryptdata;if(s.pssh){var o=this.createMediaKeySessionContext(n),l=this.getKeyIdString(s);this.keyIdToKeySessionPromise[l]=this.generateRequestWithPreferredKeySession(o,"cenc",s.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(n)},h.getKeyIdString=function(n){if(!n)throw new Error("Could not read keyId of undefined decryptdata");if(n.keyId===null)throw new Error("keyId is null");return _n.default.hexDump(n.keyId)},h.updateKeySession=function(n,s){var o,l=n.mediaKeysSession;return this.log('Updating key-session "'+l.sessionId+'" for keyID '+_n.default.hexDump(((o=n.decryptdata)===null||o===void 0?void 0:o.keyId)||[])+`
      } (data length: `+(s&&s.byteLength)+")"),l.update(s)},h.selectKeySystemFormat=function(n){var s=Object.keys(n.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+n.sn+" "+n.type+": "+n.level+") key formats "+s.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(s)),this.keyFormatPromise},h.getKeyFormatPromise=function(n){var s=this;return new Promise(function(o,l){var c=Te(s.config),a=n.map(z).filter(function(f){return!!f&&c.indexOf(f)!==-1});return s.getKeySystemSelectionPromise(a).then(function(f){var g=f.keySystem,p=H(g);p?o(p):l(new Error('Unable to find format for key-system "'+g+'"'))}).catch(l)})},h.loadKey=function(n){var s=this,o=n.keyInfo.decryptdata,l=this.getKeyIdString(o),c="(keyId: "+l+' format: "'+o.keyFormat+'" method: '+o.method+" uri: "+o.uri+")";this.log("Starting session for key "+c);var a=this.keyIdToKeySessionPromise[l];return a||(a=this.keyIdToKeySessionPromise[l]=this.getKeySystemForKeyPromise(o).then(function(f){var g=f.keySystem,p=f.mediaKeys;return s.throwIfDestroyed(),s.log("Handle encrypted media sn: "+n.frag.sn+" "+n.frag.type+": "+n.frag.level+" using key "+c),s.attemptSetMediaKeys(g,p).then(function(){s.throwIfDestroyed();var v=s.createMediaKeySessionContext({keySystem:g,mediaKeys:p,decryptdata:o});return s.generateRequestWithPreferredKeySession(v,"cenc",o.pssh,"playlist-key")})})).catch(function(f){return s.handleError(f)}),a},h.throwIfDestroyed=function(n){if(!this.hls)throw new Error("invalid state")},h.handleError=function(n){this.hls&&(this.error(n.message),n instanceof Ir?this.hls.trigger(b.Events.ERROR,n.data):this.hls.trigger(b.Events.ERROR,{type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_NO_KEYS,error:n,fatal:!0}))},h.getKeySystemForKeyPromise=function(n){var s=this.getKeyIdString(n),o=this.keyIdToKeySessionPromise[s];if(!o){var l=z(n.keyFormat),c=l?[l]:Te(this.config);return this.attemptKeySystemAccess(c)}return o},h.getKeySystemSelectionPromise=function(n){if(n.length||(n=Te(this.config)),n.length===0)throw new Ir({type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(n)},h._onMediaEncrypted=function(n){var s=this,o=n.initDataType,l=n.initData;if(this.debug('"'+n.type+'" event: init data type: "'+o+'"'),l!==null){var c,a;if(o==="sinf"&&this.config.drmSystems[ae.FAIRPLAY]){var f=(0,ve.bin2str)(new Uint8Array(l));try{var g=ue(JSON.parse(f).sinf),p=(0,ve.parseSinf)(new Uint8Array(g));if(!p)return;c=p.subarray(8,24),a=ae.FAIRPLAY}catch{return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{var v=(0,ve.parsePssh)(l);if(v===null)return;v.version===0&&v.systemId===Ue.WIDEVINE&&v.data&&(c=v.data.subarray(8,24)),a=function(he){if(he===Ue.WIDEVINE)return ae.WIDEVINE}(v.systemId)}if(a&&c){for(var _=_n.default.hexDump(c),L=this.keyIdToKeySessionPromise,x=this.mediaKeySessions,M=L[_],j=function(he){var _e=x[he],Ee=_e.decryptdata;if(Ee.pssh||!Ee.keyId)return"continue";var De=_n.default.hexDump(Ee.keyId);return _===De||Ee.uri.replace(/-/g,"").indexOf(_)!==-1?(M=L[De],delete L[De],Ee.pssh=new Uint8Array(l),Ee.keyId=c,M=L[_]=M.then(function(){return s.generateRequestWithPreferredKeySession(_e,o,l,"encrypted-event-key-match")}),"break"):void 0},K=0;K<x.length;K++){var Z=j(K);if(Z!=="continue"&&Z==="break")break}M||(M=L[_]=this.getKeySystemSelectionPromise([a]).then(function(he){var _e,Ee=he.keySystem,De=he.mediaKeys;s.throwIfDestroyed();var $e=new We("ISO-23001-7",_,(_e=H(Ee))!=null?_e:"");return $e.pssh=new Uint8Array(l),$e.keyId=c,s.attemptSetMediaKeys(Ee,De).then(function(){s.throwIfDestroyed();var st=s.createMediaKeySessionContext({decryptdata:$e,keySystem:Ee,mediaKeys:De});return s.generateRequestWithPreferredKeySession(st,o,l,"encrypted-event-no-match")})})),M.catch(function(he){return s.handleError(he)})}}},h._onWaitingForKey=function(n){this.log('"'+n.type+'" event')},h.attemptSetMediaKeys=function(n,s){var o=this,l=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+n+'"');var c=Promise.all(l).then(function(){if(!o.media)throw new Error("Attempted to set mediaKeys without media element attached");return o.media.setMediaKeys(s)});return this.setMediaKeysQueue.push(c),c.then(function(){o.log('Media-keys set for "'+n+'"'),l.push(c),o.setMediaKeysQueue=o.setMediaKeysQueue.filter(function(a){return l.indexOf(a)===-1})})},h.generateRequestWithPreferredKeySession=function(n,s,o,l){var c,a,f=this,g=(c=this.config.drmSystems)===null||c===void 0||(a=c[n.keySystem])===null||a===void 0?void 0:a.generateRequest;if(g)try{var p=g.call(this.hls,s,o,n);if(!p)throw new Error("Invalid response from configured generateRequest filter");s=p.initDataType,o=n.decryptdata.pssh=p.initData?new Uint8Array(p.initData):null}catch(M){var v;if(this.warn(M.message),(v=this.hls)!==null&&v!==void 0&&v.config.debug)throw M}if(o===null)return this.log('Skipping key-session request for "'+l+'" (no initData)'),Promise.resolve(n);var _=this.getKeyIdString(n.decryptdata);this.log('Generating key-session request for "'+l+'": '+_+" (init data type: "+s+" length: "+(o?o.byteLength:null)+")");var L=new(Gh());n.mediaKeysSession.onmessage=function(M){var j=n.mediaKeysSession;if(j){var K=M.messageType,Z=M.message;f.log('"'+K+'" message event for session "'+j.sessionId+'" message size: '+Z.byteLength),K==="license-request"||K==="license-renewal"?f.renewLicense(n,Z).catch(function(he){f.handleError(he),L.emit("error",he)}):K==="license-release"?n.keySystem===ae.FAIRPLAY&&(f.updateKeySession(n,w("acknowledged")),f.removeSession(n)):f.warn('unhandled media key message type "'+K+'"')}else L.emit("error",new Error("invalid state"))},n.mediaKeysSession.onkeystatuseschange=function(M){if(n.mediaKeysSession){f.onKeyStatusChange(n);var j=n.keyStatus;L.emit("keyStatus",j),j==="expired"&&(f.warn(n.keySystem+" expired for key "+_),f.renewKeySession(n))}else L.emit("error",new Error("invalid state"))};var x=new Promise(function(M,j){L.on("error",j),L.on("keyStatus",function(K){K.startsWith("usable")?M():K==="output-restricted"?j(new Ir({type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):K==="internal-error"?j(new Ir({type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+K+'"')):K==="expired"?j(new Error("key expired while generating request")):f.warn('unhandled key status change "'+K+'"')})});return n.mediaKeysSession.generateRequest(s,o).then(function(){var M;f.log('Request generated for key-session "'+((M=n.mediaKeysSession)===null||M===void 0?void 0:M.sessionId)+'" keyId: '+_)}).catch(function(M){throw new Ir({type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_NO_SESSION,error:M,fatal:!1},"Error generating key-session request: "+M)}).then(function(){return x}).catch(function(M){throw L.removeAllListeners(),f.removeSession(n),M}).then(function(){return L.removeAllListeners(),n})},h.onKeyStatusChange=function(n){var s=this;n.mediaKeysSession.keyStatuses.forEach(function(o,l){s.log('key status change "'+o+'" for keyStatuses keyId: '+_n.default.hexDump("buffer"in l?new Uint8Array(l.buffer,l.byteOffset,l.byteLength):new Uint8Array(l))+" session keyId: "+_n.default.hexDump(new Uint8Array(n.decryptdata.keyId||[]))+" uri: "+n.decryptdata.uri),n.keyStatus=o})},h.fetchServerCertificate=function(n){var s=this;return new Promise(function(o,l){var c=s.getServerCertificateUrl(n);if(!c)return o();s.log('Fetching serverCertificate for "'+n+'"');var a=new XMLHttpRequest;a.open("GET",c,!0),a.responseType="arraybuffer",a.onreadystatechange=function(){a.readyState===XMLHttpRequest.DONE&&(a.status===200?o(a.response):l(new Ir({type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:a},'"'+n+'" certificate request XHR failed ('+c+"). Status: "+a.status+" ("+a.statusText+")")))},a.send()})},h.setMediaKeysServerCertificate=function(n,s,o){var l=this;return new Promise(function(c,a){n.setServerCertificate(o).then(function(f){l.log("setServerCertificate "+(f?"success":"not supported by CDM")+" ("+(o==null?void 0:o.byteLength)+') on "'+s+'"'),c(n)}).catch(function(f){a(new Ir({type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:f,fatal:!0},f.message))})})},h.renewLicense=function(n,s){var o=this;return this.requestLicense(n,new Uint8Array(s)).then(function(l){return o.updateKeySession(n,new Uint8Array(l)).catch(function(c){throw new Ir({type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:c,fatal:!0},c.message)})})},h.setupLicenseXHR=function(n,s,o,l){var c=this,a=this.config.licenseXhrSetup;return a?Promise.resolve().then(function(){if(!o.decryptdata)throw new Error("Key removed");return a.call(c.hls,n,s,o,l)}).catch(function(f){if(!o.decryptdata)throw f;return n.open("POST",s,!0),a.call(c.hls,n,s,o,l)}).then(function(f){return n.readyState||n.open("POST",s,!0),{xhr:n,licenseChallenge:f||l}}):(n.open("POST",s,!0),Promise.resolve({xhr:n,licenseChallenge:l}))},h.requestLicense=function(n,s){var o=this;return new Promise(function(l,c){var a=o.getLicenseServerUrl(n.keySystem);o.log("Sending license request to URL: "+a);var f=new XMLHttpRequest;f.responseType="arraybuffer",f.onreadystatechange=function(){if(!o.hls||!n.mediaKeysSession)return c(new Error("invalid state"));if(f.readyState===4)if(f.status===200){o._requestLicenseFailureCount=0;var g=f.response;o.log("License received "+(g instanceof ArrayBuffer?g.byteLength:g));var p=o.config.licenseResponseCallback;if(p)try{g=p.call(o.hls,f,a,n)}catch(_){o.error(_)}l(g)}else if(o._requestLicenseFailureCount++,o._requestLicenseFailureCount>3||f.status>=400&&f.status<500)c(new Ir({type:R.ErrorTypes.KEY_SYSTEM_ERROR,details:R.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:f},"License Request XHR failed ("+a+"). Status: "+f.status+" ("+f.statusText+")"));else{var v=3-o._requestLicenseFailureCount+1;o.warn("Retrying license request, "+v+" attempts left"),o.requestLicense(n,s).then(l,c)}},n.licenseXhr&&n.licenseXhr.readyState!==XMLHttpRequest.DONE&&n.licenseXhr.abort(),n.licenseXhr=f,o.setupLicenseXHR(f,a,n,s).then(function(g){var p=g.xhr,v=g.licenseChallenge;p.send(v)})})},h.onMediaAttached=function(n,s){if(this.config.emeEnabled){var o=s.media;this.media=o,o.addEventListener("encrypted",this.onMediaEncrypted),o.addEventListener("waitingforkey",this.onWaitingForKey)}},h.onMediaDetached=function(){var n=this,s=this.media,o=this.mediaKeySessions;s&&(s.removeEventListener("encrypted",this.onMediaEncrypted),s.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},We.clearKeyUriToKeyIdMap();var l=o.length;E.CDMCleanupPromise=Promise.all(o.map(function(c){return n.removeSession(c)}).concat(s==null?void 0:s.setMediaKeys(null).catch(function(c){n.log("Could not clear media keys: "+c+". media.src: "+(s==null?void 0:s.src))}))).then(function(){l&&(n.log("finished closing key sessions and clearing media keys"),o.length=0)}).catch(function(c){n.log("Could not close sessions and clear media keys: "+c+". media.src: "+(s==null?void 0:s.src))})},h.onManifestLoaded=function(n,s){var o=s.sessionKeys;if(o&&this.config.emeEnabled&&!this.keyFormatPromise){var l=o.reduce(function(c,a){return c.indexOf(a.keyFormat)===-1&&c.push(a.keyFormat),c},[]);this.log("Selecting key-system from session-keys "+l.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(l)}},h.removeSession=function(n){var s=this,o=n.mediaKeysSession,l=n.licenseXhr;if(o){this.log("Remove licenses and keys and close session "+o.sessionId),o.onmessage=null,o.onkeystatuseschange=null,l&&l.readyState!==XMLHttpRequest.DONE&&l.abort(),n.mediaKeysSession=n.decryptdata=n.licenseXhr=void 0;var c=this.mediaKeySessions.indexOf(n);return c>-1&&this.mediaKeySessions.splice(c,1),o.remove().catch(function(a){s.log("Could not remove session: "+a)}).then(function(){return o.close()}).catch(function(a){s.log("Could not close session: "+a)})}},E}();El.CDMCleanupPromise=void 0;var Ir=function(E){var h,n;function s(o,l){var c;return(c=E.call(this,l)||this).data=void 0,c.data=o,o.err=o.error,c}return n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,_i(h,n),s}($a(Error));const L0=El;var rr,eo,Tl;function vl(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}function bl(E,h,n){return h&&vl(E.prototype,h),n&&vl(E,n),Object.defineProperty(E,"prototype",{writable:!1}),E}function yl(E,h){var n=typeof Symbol<"u"&&E[Symbol.iterator]||E["@@iterator"];if(n)return(n=n.call(E)).next.bind(n);if(Array.isArray(E)||(n=function(o,l){if(o){if(typeof o=="string")return Al(o,l);var c=Object.prototype.toString.call(o).slice(8,-1);return c==="Object"&&o.constructor&&(c=o.constructor.name),c==="Map"||c==="Set"?Array.from(o):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?Al(o,l):void 0}}(E))||h&&E&&typeof E.length=="number"){n&&(E=n);var s=0;return function(){return s>=E.length?{done:!0}:{done:!1,value:E[s++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Al(E,h){(h==null||h>E.length)&&(h=E.length);for(var n=0,s=new Array(h);n<h;n++)s[n]=E[n];return s}function ms(){return ms=Object.assign?Object.assign.bind():function(E){for(var h=1;h<arguments.length;h++){var n=arguments[h];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(E[s]=n[s])}return E},ms.apply(this,arguments)}(function(E){E.MANIFEST="m",E.AUDIO="a",E.VIDEO="v",E.MUXED="av",E.INIT="i",E.CAPTION="c",E.TIMED_TEXT="tt",E.KEY="k",E.OTHER="o"})(rr||(rr={})),function(E){E.DASH="d",E.HLS="h",E.SMOOTH="s",E.OTHER="o"}(eo||(eo={})),function(E){E.VOD="v",E.LIVE="l"}(Tl||(Tl={}));var R0=function(){function E(n){var s=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){s.initialized&&(s.starved=!0),s.buffering=!0},this.onPlaying=function(){s.initialized||(s.initialized=!0),s.buffering=!1},this.applyPlaylistData=function(c){try{s.apply(c,{ot:rr.MANIFEST,su:!s.initialized})}catch(a){P.logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=function(c){try{var a=c.frag,f=s.hls.levels[a.level],g=s.getObjectType(a),p={d:1e3*a.duration,ot:g};g!==rr.VIDEO&&g!==rr.AUDIO&&g!=rr.MUXED||(p.br=f.bitrate/1e3,p.tb=s.getTopBandwidth(g)/1e3,p.bl=s.getBufferLength(g)),s.apply(c,p)}catch(v){P.logger.warn("Could not generate segment CMCD data.",v)}},this.hls=n;var o=this.config=n.config,l=o.cmcd;l!=null&&(o.pLoader=this.createPlaylistLoader(),o.fLoader=this.createFragmentLoader(),this.sid=l.sessionId||E.uuid(),this.cid=l.contentId,this.useHeaders=l.useHeaders===!0,this.registerListeners())}var h=E.prototype;return h.registerListeners=function(){var n=this.hls;n.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.on(b.Events.MEDIA_DETACHED,this.onMediaDetached,this),n.on(b.Events.BUFFER_CREATED,this.onBufferCreated,this)},h.unregisterListeners=function(){var n=this.hls;n.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.off(b.Events.MEDIA_DETACHED,this.onMediaDetached,this),n.off(b.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},h.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},h.onMediaAttached=function(n,s){this.media=s.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},h.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},h.onBufferCreated=function(n,s){var o,l;this.audioBuffer=(o=s.tracks.audio)===null||o===void 0?void 0:o.buffer,this.videoBuffer=(l=s.tracks.video)===null||l===void 0?void 0:l.buffer},h.createData=function(){var n;return{v:1,sf:eo.HLS,sid:this.sid,cid:this.cid,pr:(n=this.media)===null||n===void 0?void 0:n.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},h.apply=function(n,s){s===void 0&&(s={}),ms(s,this.createData());var o=s.ot===rr.INIT||s.ot===rr.VIDEO||s.ot===rr.MUXED;if(this.starved&&o&&(s.bs=!0,s.su=!0,this.starved=!1),s.su==null&&(s.su=this.buffering),this.useHeaders){var l=E.toHeaders(s);if(!Object.keys(l).length)return;n.headers||(n.headers={}),ms(n.headers,l)}else{var c=E.toQuery(s);if(!c)return;n.url=E.appendQueryToUri(n.url,c)}},h.getObjectType=function(n){var s=n.type;return s==="subtitle"?rr.TIMED_TEXT:n.sn==="initSegment"?rr.INIT:s==="audio"?rr.AUDIO:s==="main"?this.hls.audioTracks.length?rr.VIDEO:rr.MUXED:void 0},h.getTopBandwidth=function(n){var s,o=0,l=this.hls;if(n===rr.AUDIO)s=l.audioTracks;else{var c=l.maxAutoLevel,a=c>-1?c+1:l.levels.length;s=l.levels.slice(0,a)}for(var f,g=yl(s);!(f=g()).done;){var p=f.value;p.bitrate>o&&(o=p.bitrate)}return o>0?o:NaN},h.getBufferLength=function(n){var s=this.hls.media,o=n===rr.AUDIO?this.audioBuffer:this.videoBuffer;return o&&s?1e3*Ut.bufferInfo(o,s.currentTime,this.config.maxBufferHole).len:NaN},h.createPlaylistLoader=function(){var n=this.config.pLoader,s=this.applyPlaylistData,o=n||this.config.loader;return function(){function l(a){this.loader=void 0,this.loader=new o(a)}var c=l.prototype;return c.destroy=function(){this.loader.destroy()},c.abort=function(){this.loader.abort()},c.load=function(a,f,g){s(a),this.loader.load(a,f,g)},bl(l,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),l}()},h.createFragmentLoader=function(){var n=this.config.fLoader,s=this.applyFragmentData,o=n||this.config.loader;return function(){function l(a){this.loader=void 0,this.loader=new o(a)}var c=l.prototype;return c.destroy=function(){this.loader.destroy()},c.abort=function(){this.loader.abort()},c.load=function(a,f,g){s(a),this.loader.load(a,f,g)},bl(l,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),l}()},E.uuid=function(){var n=URL.createObjectURL(new Blob),s=n.toString();return URL.revokeObjectURL(n),s.slice(s.lastIndexOf("/")+1)},E.serialize=function(n){for(var s,o=[],l=function(M){return!Number.isNaN(M)&&M!=null&&M!==""&&M!==!1},c=function(M){return Math.round(M)},a=function(M){return 100*c(M/100)},f={br:c,d:c,bl:a,dl:a,mtp:a,nor:function(M){return encodeURIComponent(M)},rtp:a,tb:c},g=yl(Object.keys(n||{}).sort());!(s=g()).done;){var p=s.value,v=n[p];if(l(v)&&!(p==="v"&&v===1||p=="pr"&&v===1)){var _=f[p];_&&(v=_(v));var L,x=typeof v;L=p==="ot"||p==="sf"||p==="st"?p+"="+v:x==="boolean"?p:x==="number"?p+"="+v:p+"="+JSON.stringify(v),o.push(L)}}return o.join(",")},E.toHeaders=function(n){for(var s={},o=["Object","Request","Session","Status"],l=[{},{},{},{}],c={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},a=0,f=Object.keys(n);a<f.length;a++){var g=f[a];l[c[g]!=null?c[g]:1][g]=n[g]}for(var p=0;p<l.length;p++){var v=E.serialize(l[p]);v&&(s["CMCD-"+o[p]]=v)}return s},E.toQuery=function(n){return"CMCD="+encodeURIComponent(E.serialize(n))},E.appendQueryToUri=function(n,s){if(!s)return n;var o=n.includes("?")?"&":"?";return""+n+o+s},E}(),_l=y(408),D0=/^age:\s*[\d.]+\s*$/m;const Sl=function(){function E(n){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=n?n.xhrSetup:null,this.stats=new _l.LoadStats,this.retryDelay=0}var h=E.prototype;return h.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},h.abortInternal=function(){var n=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),n&&(n.onreadystatechange=null,n.onprogress=null,n.readyState!==4&&(this.stats.aborted=!0,n.abort()))},h.abort=function(){var n;this.abortInternal(),(n=this.callbacks)!==null&&n!==void 0&&n.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},h.load=function(n,s,o){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=n,this.config=s,this.callbacks=o,this.retryDelay=s.retryDelay,this.loadInternal()},h.loadInternal=function(){var n=this.config,s=this.context;if(n){var o=this.loader=new self.XMLHttpRequest,l=this.stats;l.loading.first=0,l.loaded=0;var c=this.xhrSetup;try{if(c)try{c(o,s.url)}catch{o.open("GET",s.url,!0),c(o,s.url)}o.readyState||o.open("GET",s.url,!0);var a=this.context.headers;if(a)for(var f in a)o.setRequestHeader(f,a[f])}catch(g){return void this.callbacks.onError({code:o.status,text:g.message},s,o)}s.rangeEnd&&o.setRequestHeader("Range","bytes="+s.rangeStart+"-"+(s.rangeEnd-1)),o.onreadystatechange=this.readystatechange.bind(this),o.onprogress=this.loadprogress.bind(this),o.responseType=s.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),o.send()}},h.readystatechange=function(){var n=this.context,s=this.loader,o=this.stats;if(n&&s){var l=s.readyState,c=this.config;if(!o.aborted&&l>=2)if(self.clearTimeout(this.requestTimeout),o.loading.first===0&&(o.loading.first=Math.max(self.performance.now(),o.loading.start)),l===4){s.onreadystatechange=null,s.onprogress=null;var a=s.status,f=s.responseType==="arraybuffer";if(a>=200&&a<300&&(f&&s.response||s.responseText!==null)){var g,p;if(o.loading.end=Math.max(self.performance.now(),o.loading.first),p=f?(g=s.response).byteLength:(g=s.responseText).length,o.loaded=o.total=p,!this.callbacks)return;var v=this.callbacks.onProgress;if(v&&v(o,n,g,s),!this.callbacks)return;var _={url:s.responseURL,data:g};this.callbacks.onSuccess(_,o,n,s)}else o.retry>=c.maxRetry||a>=400&&a<499?(P.logger.error(a+" while loading "+n.url),this.callbacks.onError({code:a,text:s.statusText},n,s)):(P.logger.warn(a+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,c.maxRetryDelay),o.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),c.timeout)}},h.loadtimeout=function(){P.logger.warn("timeout while loading "+this.context.url);var n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))},h.loadprogress=function(n){var s=this.stats;s.loaded=n.loaded,n.lengthComputable&&(s.total=n.total)},h.getCacheAge=function(){var n=null;if(this.loader&&D0.test(this.loader.getAllResponseHeaders())){var s=this.loader.getResponseHeader("age");n=s?parseFloat(s):null}return n},E}();function to(E){var h=typeof Map=="function"?new Map:void 0;return to=function(n){if(n===null||(s=n,Function.toString.call(s).indexOf("[native code]")===-1))return n;var s;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(h!==void 0){if(h.has(n))return h.get(n);h.set(n,o)}function o(){return ro(n,arguments,no(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Si(o,n)},to(E)}function ro(E,h,n){return ro=N0()?Reflect.construct.bind():function(s,o,l){var c=[null];c.push.apply(c,o);var a=new(Function.bind.apply(s,c));return l&&Si(a,l.prototype),a},ro.apply(null,arguments)}function N0(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Si(E,h){return Si=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Si(E,h)}function no(E){return no=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(h){return h.__proto__||Object.getPrototypeOf(h)},no(E)}function io(){return io=Object.assign?Object.assign.bind():function(E){for(var h=1;h<arguments.length;h++){var n=arguments[h];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(E[s]=n[s])}return E},io.apply(this,arguments)}var O0=function(){function E(n){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=n.fetchSetup||x0,this.controller=new self.AbortController,this.stats=new _l.LoadStats}var h=E.prototype;return h.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},h.abortInternal=function(){var n=this.response;n&&n.ok||(this.stats.aborted=!0,this.controller.abort())},h.abort=function(){var n;this.abortInternal(),(n=this.callbacks)!==null&&n!==void 0&&n.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},h.load=function(n,s,o){var l=this,c=this.stats;if(c.loading.start)throw new Error("Loader can only be used once.");c.loading.start=self.performance.now();var a=function(v,_){var L={method:"GET",mode:"cors",credentials:"same-origin",signal:_,headers:new self.Headers(io({},v.headers))};return v.rangeEnd&&L.headers.set("Range","bytes="+v.rangeStart+"-"+String(v.rangeEnd-1)),L}(n,this.controller.signal),f=o.onProgress,g=n.responseType==="arraybuffer",p=g?"byteLength":"length";this.context=n,this.config=s,this.callbacks=o,this.request=this.fetchSetup(n,a),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){l.abortInternal(),o.onTimeout(c,n,l.response)},s.timeout),self.fetch(this.request).then(function(v){if(l.response=l.loader=v,!v.ok){var _=v.status,L=v.statusText;throw new k0(L||"fetch, bad network response",_,v)}return c.loading.first=Math.max(self.performance.now(),c.loading.start),c.total=parseInt(v.headers.get("Content-Length")||"0"),f&&(0,C.isFiniteNumber)(s.highWaterMark)?l.loadProgressively(v,c,n,s.highWaterMark,f):g?v.arrayBuffer():v.text()}).then(function(v){var _=l.response;self.clearTimeout(l.requestTimeout),c.loading.end=Math.max(self.performance.now(),c.loading.first);var L=v[p];L&&(c.loaded=c.total=L);var x={url:_.url,data:v};f&&!(0,C.isFiniteNumber)(s.highWaterMark)&&f(c,n,v,_),o.onSuccess(x,c,n,_)}).catch(function(v){if(self.clearTimeout(l.requestTimeout),!c.aborted){var _=v&&v.code||0,L=v?v.message:null;o.onError({code:_,text:L},n,v?v.details:null)}})},h.getCacheAge=function(){var n=null;if(this.response){var s=this.response.headers.get("age");n=s?parseFloat(s):null}return n},h.loadProgressively=function(n,s,o,l,c){l===void 0&&(l=0);var a=new Zu,f=n.body.getReader();return function g(){return f.read().then(function(p){if(p.done)return a.dataLength&&c(s,o,a.flush(),n),Promise.resolve(new ArrayBuffer(0));var v=p.value,_=v.length;return s.loaded+=_,_<l||a.dataLength?(a.push(v),a.dataLength>=l&&c(s,o,a.flush(),n)):c(s,o,v,n),g()}).catch(function(){return Promise.reject()})}()},E}();function x0(E,h){return new self.Request(E.url,h)}var k0=function(E){var h,n;function s(o,l,c){var a;return(a=E.call(this,o)||this).code=void 0,a.details=void 0,a.code=l,a.details=c,a}return n=E,(h=s).prototype=Object.create(n.prototype),h.prototype.constructor=h,Si(h,n),s}(to(Error));const Il=O0;var P0=/\s/;function so(){return so=Object.assign?Object.assign.bind():function(E){for(var h=1;h<arguments.length;h++){var n=arguments[h];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(E[s]=n[s])}return E},so.apply(this,arguments)}function Cl(E,h){var n=Object.keys(E);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(E);h&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(E,o).enumerable})),n.push.apply(n,s)}return n}function Ll(E){for(var h=1;h<arguments.length;h++){var n=arguments[h]!=null?arguments[h]:{};h%2?Cl(Object(n),!0).forEach(function(s){w0(E,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(n)):Cl(Object(n)).forEach(function(s){Object.defineProperty(E,s,Object.getOwnPropertyDescriptor(n,s))})}return E}function w0(E,h,n){return(h=function(s){var o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s,"string");return typeof o=="symbol"?o:String(o)}(h))in E?Object.defineProperty(E,h,{value:n,enumerable:!0,configurable:!0,writable:!0}):E[h]=n,E}var M0=Ll(Ll({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Sl,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Wh,bufferController:i0,capLevelController:S0,fpsController:I0,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Re,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},{cueHandler:{newCue:function(E,h,n,s){for(var o,l,c,a,f,g=[],p=self.VTTCue||self.TextTrackCue,v=0;v<s.rows.length;v++)if(c=!0,a=0,f="",!(o=s.rows[v]).isEmpty()){for(var _=0;_<o.chars.length;_++)P0.test(o.chars[_].uchar)&&c?a++:(f+=o.chars[_].uchar,c=!1);o.cueStartTime=h,h===n&&(n+=1e-4),a>=16?a--:a++;var L=ll(f.trim()),x=ja(h,n,L);E&&E.cues&&E.cues.getCueById(x)||((l=new p(h,n,L)).id=x,l.line=v+1,l.align="left",l.position=10+Math.min(80,10*Math.floor(8*a/32)),g.push(l))}return E&&g.length&&(g.sort(function(M,j){return M.line==="auto"||j.line==="auto"?0:M.line>8&&j.line>8?j.line-M.line:M.line-j.line}),g.forEach(function(M){return Ne(E,M)})),g}},enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Jh,subtitleTrackController:r0,timelineController:y0,audioStreamController:Qh,audioTrackController:$h,emeController:L0,cmcdController:R0});function Rl(E,h){for(var n=0;n<h.length;n++){var s=h[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(E,typeof(o=function(l,c){if(typeof l!="object"||l===null)return l;var a=l[Symbol.toPrimitive];if(a!==void 0){var f=a.call(l,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s.key,"string"))=="symbol"?o:String(o),s)}var o}var Dl=function(){function E(l){l===void 0&&(l={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new xa.EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var c=this.config=function(Se,Xe){if((Xe.liveSyncDurationCount||Xe.liveMaxLatencyDurationCount)&&(Xe.liveSyncDuration||Xe.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(Xe.liveMaxLatencyDurationCount!==void 0&&(Xe.liveSyncDurationCount===void 0||Xe.liveMaxLatencyDurationCount<=Xe.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(Xe.liveMaxLatencyDuration!==void 0&&(Xe.liveSyncDuration===void 0||Xe.liveMaxLatencyDuration<=Xe.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return so({},Se,Xe)}(E.DefaultConfig,l);this.userConfig=l,(0,P.enableLogs)(c.debug,"Hls instance"),this._autoLevelCapping=-1,c.progressive&&function(Se){var Xe=Se.loader;Xe!==Il&&Xe!==Sl?(P.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),Se.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}()&&(Se.loader=Il,Se.progressive=!0,Se.enableSoftwareAES=!0,P.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}(c);var a=c.abrController,f=c.bufferController,g=c.capLevelController,p=c.fpsController,v=this.abrController=new a(this),_=this.bufferController=new f(this),L=this.capLevelController=new g(this),x=new p(this),M=new re(this),j=new et(this),K=this.levelController=new gt(this),Z=new Ct(this),he=new Ar(this.config),_e=this.streamController=new Vh(this,Z,he);L.setStreamController(_e),x.setStreamController(_e);var Ee=[M,K,_e];this.networkControllers=Ee;var De=[v,_,L,x,j,Z];this.audioTrackController=this.createController(c.audioTrackController,Ee);var $e=c.audioStreamController;$e&&Ee.push(new $e(this,Z,he)),this.subtitleTrackController=this.createController(c.subtitleTrackController,Ee);var st=c.subtitleStreamController;st&&Ee.push(new st(this,Z,he)),this.createController(c.timelineController,De),he.emeController=this.emeController=this.createController(c.emeController,De),this.cmcdController=this.createController(c.cmcdController,De),this.latencyController=this.createController(ft,De),this.coreComponents=De}E.isSupported=function(){return function(){var l=Na();if(!l)return!1;var c=Wu(),a=l&&typeof l.isTypeSupported=="function"&&l.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),f=!c||c.prototype&&typeof c.prototype.appendBuffer=="function"&&typeof c.prototype.remove=="function";return!!a&&!!f}()};var h,n,s,o=E.prototype;return o.createController=function(l,c){if(l){var a=new l(this);return c&&c.push(a),a}return null},o.on=function(l,c,a){a===void 0&&(a=this),this._emitter.on(l,c,a)},o.once=function(l,c,a){a===void 0&&(a=this),this._emitter.once(l,c,a)},o.removeAllListeners=function(l){this._emitter.removeAllListeners(l)},o.off=function(l,c,a,f){a===void 0&&(a=this),this._emitter.off(l,c,a,f)},o.listeners=function(l){return this._emitter.listeners(l)},o.emit=function(l,c,a){return this._emitter.emit(l,c,a)},o.trigger=function(l,c){if(this.config.debug)return this.emit(l,l,c);try{return this.emit(l,l,c)}catch(a){P.logger.error("An internal error happened while handling event "+l+'. Error message: "'+a.message+'". Here is a stacktrace:',a),this.trigger(b.Events.ERROR,{type:R.ErrorTypes.OTHER_ERROR,details:R.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:l,error:a})}return!1},o.listenerCount=function(l){return this._emitter.listenerCount(l)},o.destroy=function(){P.logger.log("destroy"),this.trigger(b.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(l){return l.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(l){return l.destroy()}),this.coreComponents.length=0},o.attachMedia=function(l){P.logger.log("attachMedia"),this._media=l,this.trigger(b.Events.MEDIA_ATTACHING,{media:l})},o.detachMedia=function(){P.logger.log("detachMedia"),this.trigger(b.Events.MEDIA_DETACHING,void 0),this._media=null},o.loadSource=function(l){this.stopLoad();var c=this.media,a=this.url,f=this.url=I.buildAbsoluteURL(self.location.href,l,{alwaysNormalize:!0});P.logger.log("loadSource:"+f),c&&a&&a!==f&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(c)),this.trigger(b.Events.MANIFEST_LOADING,{url:l})},o.startLoad=function(l){l===void 0&&(l=-1),P.logger.log("startLoad("+l+")"),this.networkControllers.forEach(function(c){c.startLoad(l)})},o.stopLoad=function(){P.logger.log("stopLoad"),this.networkControllers.forEach(function(l){l.stopLoad()})},o.swapAudioCodec=function(){P.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},o.recoverMediaError=function(){P.logger.log("recoverMediaError");var l=this._media;this.detachMedia(),l&&this.attachMedia(l)},o.removeLevel=function(l,c){c===void 0&&(c=0),this.levelController.removeLevel(l,c)},h=E,s=[{key:"version",get:function(){return"1.3.1"}},{key:"Events",get:function(){return b.Events}},{key:"ErrorTypes",get:function(){return R.ErrorTypes}},{key:"ErrorDetails",get:function(){return R.ErrorDetails}},{key:"DefaultConfig",get:function(){return E.defaultConfig?E.defaultConfig:M0},set:function(l){E.defaultConfig=l}}],(n=[{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(l){P.logger.log("set currentLevel:"+l),this.loadLevel=l,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(l){P.logger.log("set nextLevel:"+l),this.levelController.manualLevel=l,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(l){P.logger.log("set loadLevel:"+l),this.levelController.manualLevel=l}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(l){this.levelController.nextLoadLevel=l}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(l){P.logger.log("set firstLevel:"+l),this.levelController.firstLevel=l}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(l){P.logger.log("set startLevel:"+l),l!==-1&&(l=Math.max(l,this.minAutoLevel)),this.levelController.startLevel=l}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(l){var c=!!l;c!==this.config.capLevelToPlayerSize&&(c?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=c)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(l){this._autoLevelCapping!==l&&(P.logger.log("set autoLevelCapping:"+l),this._autoLevelCapping=l)}},{key:"bandwidthEstimate",get:function(){var l=this.abrController.bwEstimator;return l?l.getEstimate():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(l){Ft.indexOf(l)>-1&&(this._maxHdcpLevel=l)}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var l=this.levels,c=this.config.minAutoBitrate;if(!l)return 0;for(var a=l.length,f=0;f<a;f++)if(l[f].maxBitrate>=c)return f;return 0}},{key:"maxAutoLevel",get:function(){var l,c=this.levels,a=this.autoLevelCapping,f=this.maxHdcpLevel;if(l=a===-1&&c&&c.length?c.length-1:a,f)for(var g=l;g--;){var p=c[g].attrs["HDCP-LEVEL"];if(p&&p<=f)return g}return l}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(l){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,l)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var l=this.audioTrackController;return l?l.audioTracks:[]}},{key:"audioTrack",get:function(){var l=this.audioTrackController;return l?l.audioTrack:-1},set:function(l){var c=this.audioTrackController;c&&(c.audioTrack=l)}},{key:"subtitleTracks",get:function(){var l=this.subtitleTrackController;return l?l.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var l=this.subtitleTrackController;return l?l.subtitleTrack:-1},set:function(l){var c=this.subtitleTrackController;c&&(c.subtitleTrack=l)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var l=this.subtitleTrackController;return!!l&&l.subtitleDisplay},set:function(l){var c=this.subtitleTrackController;c&&(c.subtitleDisplay=l)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(l){this.config.lowLatencyMode=l}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&Rl(h.prototype,n),s&&Rl(h,s),Object.defineProperty(h,"prototype",{writable:!1}),E}();Dl.defaultConfig=void 0},923:(T,A,y)=>{y.r(A),y.d(A,{BaseSegment:()=>ie,ElementaryStreamTypes:()=>S,Fragment:()=>fe,Part:()=>Q});var S,I=y(965),C=y(945),b=y(408);function R(de,oe){de.prototype=Object.create(oe.prototype),de.prototype.constructor=de,P(de,oe)}function P(de,oe){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(se,ae){return se.__proto__=ae,se},P(de,oe)}function ce(de,oe){for(var se=0;se<oe.length;se++){var ae=oe[se];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(de,typeof(we=function(Ue,Je){if(typeof Ue!="object"||Ue===null)return Ue;var ue=Ue[Symbol.toPrimitive];if(ue!==void 0){var w=ue.call(Ue,Je);if(typeof w!="object")return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Ue)}(ae.key,"string"))=="symbol"?we:String(we),ae)}var we}function J(de,oe,se){return oe&&ce(de.prototype,oe),se&&ce(de,se),Object.defineProperty(de,"prototype",{writable:!1}),de}(function(de){de.AUDIO="audio",de.VIDEO="video",de.AUDIOVIDEO="audiovideo"})(S||(S={}));var ie=function(){function de(oe){var se;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((se={})[S.AUDIO]=null,se[S.VIDEO]=null,se[S.AUDIOVIDEO]=null,se),this.baseurl=oe}return de.prototype.setByteRange=function(oe,se){var ae=oe.split("@",2),we=[];ae.length===1?we[0]=se?se.byteRangeEndOffset:0:we[0]=parseInt(ae[1]),we[1]=parseInt(ae[0])+we[0],this._byteRange=we},J(de,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,C.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(oe){this._url=oe}}]),de}(),fe=function(de){function oe(ae,we){var Ue;return(Ue=de.call(this,we)||this)._decryptdata=null,Ue.rawProgramDateTime=null,Ue.programDateTime=null,Ue.tagList=[],Ue.duration=0,Ue.sn=0,Ue.levelkeys=void 0,Ue.type=void 0,Ue.loader=null,Ue.keyLoader=null,Ue.level=-1,Ue.cc=0,Ue.startPTS=void 0,Ue.endPTS=void 0,Ue.appendedPTS=void 0,Ue.startDTS=void 0,Ue.endDTS=void 0,Ue.start=0,Ue.deltaPTS=void 0,Ue.maxStartPTS=void 0,Ue.minEndPTS=void 0,Ue.stats=new b.LoadStats,Ue.urlId=0,Ue.data=void 0,Ue.bitrateTest=!1,Ue.title=null,Ue.initSegment=null,Ue.endList=void 0,Ue.type=ae,Ue}R(oe,de);var se=oe.prototype;return se.setKeyFormat=function(ae){if(this.levelkeys){var we=this.levelkeys[ae];we&&!this._decryptdata&&(this._decryptdata=we.getDecryptData(this.sn))}},se.abortRequests=function(){var ae,we;(ae=this.loader)===null||ae===void 0||ae.abort(),(we=this.keyLoader)===null||we===void 0||we.abort()},se.setElementaryStreamInfo=function(ae,we,Ue,Je,ue,w){w===void 0&&(w=!1);var z=this.elementaryStreams,H=z[ae];H?(H.startPTS=Math.min(H.startPTS,we),H.endPTS=Math.max(H.endPTS,Ue),H.startDTS=Math.min(H.startDTS,Je),H.endDTS=Math.max(H.endDTS,ue)):z[ae]={startPTS:we,endPTS:Ue,startDTS:Je,endDTS:ue,partial:w}},se.clearElementaryStreamInfo=function(){var ae=this.elementaryStreams;ae[S.AUDIO]=null,ae[S.VIDEO]=null,ae[S.AUDIOVIDEO]=null},J(oe,[{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var ae=this.levelkeys.identity;if(ae)this._decryptdata=ae.getDecryptData(this.sn);else{var we=Object.keys(this.levelkeys);if(we.length===1)return this._decryptdata=this.levelkeys[we[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!(0,I.isFiniteNumber)(this.programDateTime))return null;var ae=(0,I.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*ae}},{key:"encrypted",get:function(){var ae;if((ae=this._decryptdata)!==null&&ae!==void 0&&ae.encrypted)return!0;if(this.levelkeys){var we=Object.keys(this.levelkeys),Ue=we.length;if(Ue>1||Ue===1&&this.levelkeys[we[0]].encrypted)return!0}return!1}}]),oe}(ie),Q=function(de){function oe(se,ae,we,Ue,Je){var ue;(ue=de.call(this,we)||this).fragOffset=0,ue.duration=0,ue.gap=!1,ue.independent=!1,ue.relurl=void 0,ue.fragment=void 0,ue.index=void 0,ue.stats=new b.LoadStats,ue.duration=se.decimalFloatingPoint("DURATION"),ue.gap=se.bool("GAP"),ue.independent=se.bool("INDEPENDENT"),ue.relurl=se.enumeratedString("URI"),ue.fragment=ae,ue.index=Ue;var w=se.enumeratedString("BYTERANGE");return w&&ue.setByteRange(w,Je),Je&&(ue.fragOffset=Je.fragOffset+Je.duration),ue}return R(oe,de),J(oe,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var se=this.elementaryStreams;return!!(se.audio||se.video||se.audiovideo)}}]),oe}(ie)},408:(T,A,y)=>{y.r(A),y.d(A,{LoadStats:()=>S});var S=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},965:(T,A,y)=>{y.r(A),y.d(A,{MAX_SAFE_INTEGER:()=>I,isFiniteNumber:()=>S});var S=Number.isFinite||function(C){return typeof C=="number"&&isFinite(C)},I=Number.MAX_SAFE_INTEGER||9007199254740991},524:(T,A,y)=>{y.r(A),y.d(A,{default:()=>se,flushTextTrackMetadataCueSamples:()=>we,flushTextTrackUserdataCueSamples:()=>Ue,normalizePts:()=>ae});var S=y(965);const I=function(){function w(){}return w.getSilentFrame=function(z,H){if(z==="mp4a.40.2"){if(H===1)return new Uint8Array([0,200,0,128,35,128]);if(H===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(H===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(H===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(H===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(H===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(H===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(H===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(H===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},w}();var C=Math.pow(2,32)-1,b=function(){function w(){}return w.init=function(){var z;for(z in w.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},w.types)w.types.hasOwnProperty(z)&&(w.types[z]=[z.charCodeAt(0),z.charCodeAt(1),z.charCodeAt(2),z.charCodeAt(3)]);var H=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Te=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);w.HDLR_TYPES={video:H,audio:Te};var Re=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ve=new Uint8Array([0,0,0,0,0,0,0,0]);w.STTS=w.STSC=w.STCO=ve,w.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),w.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),w.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),w.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var pe=new Uint8Array([105,115,111,109]),We=new Uint8Array([97,118,99,49]),Ze=new Uint8Array([0,0,0,1]);w.FTYP=w.box(w.types.ftyp,pe,Ze,pe,We),w.DINF=w.box(w.types.dinf,w.box(w.types.dref,Re))},w.box=function(z){for(var H=8,Te=arguments.length,Re=new Array(Te>1?Te-1:0),ve=1;ve<Te;ve++)Re[ve-1]=arguments[ve];for(var pe=Re.length,We=pe;pe--;)H+=Re[pe].byteLength;var Ze=new Uint8Array(H);for(Ze[0]=H>>24&255,Ze[1]=H>>16&255,Ze[2]=H>>8&255,Ze[3]=255&H,Ze.set(z,4),pe=0,H=8;pe<We;pe++)Ze.set(Re[pe],H),H+=Re[pe].byteLength;return Ze},w.hdlr=function(z){return w.box(w.types.hdlr,w.HDLR_TYPES[z])},w.mdat=function(z){return w.box(w.types.mdat,z)},w.mdhd=function(z,H){H*=z;var Te=Math.floor(H/(C+1)),Re=Math.floor(H%(C+1));return w.box(w.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,z>>24&255,z>>16&255,z>>8&255,255&z,Te>>24,Te>>16&255,Te>>8&255,255&Te,Re>>24,Re>>16&255,Re>>8&255,255&Re,85,196,0,0]))},w.mdia=function(z){return w.box(w.types.mdia,w.mdhd(z.timescale,z.duration),w.hdlr(z.type),w.minf(z))},w.mfhd=function(z){return w.box(w.types.mfhd,new Uint8Array([0,0,0,0,z>>24,z>>16&255,z>>8&255,255&z]))},w.minf=function(z){return z.type==="audio"?w.box(w.types.minf,w.box(w.types.smhd,w.SMHD),w.DINF,w.stbl(z)):w.box(w.types.minf,w.box(w.types.vmhd,w.VMHD),w.DINF,w.stbl(z))},w.moof=function(z,H,Te){return w.box(w.types.moof,w.mfhd(z),w.traf(Te,H))},w.moov=function(z){for(var H=z.length,Te=[];H--;)Te[H]=w.trak(z[H]);return w.box.apply(null,[w.types.moov,w.mvhd(z[0].timescale,z[0].duration)].concat(Te).concat(w.mvex(z)))},w.mvex=function(z){for(var H=z.length,Te=[];H--;)Te[H]=w.trex(z[H]);return w.box.apply(null,[w.types.mvex].concat(Te))},w.mvhd=function(z,H){H*=z;var Te=Math.floor(H/(C+1)),Re=Math.floor(H%(C+1)),ve=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,z>>24&255,z>>16&255,z>>8&255,255&z,Te>>24,Te>>16&255,Te>>8&255,255&Te,Re>>24,Re>>16&255,Re>>8&255,255&Re,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return w.box(w.types.mvhd,ve)},w.sdtp=function(z){var H,Te,Re=z.samples||[],ve=new Uint8Array(4+Re.length);for(H=0;H<Re.length;H++)Te=Re[H].flags,ve[H+4]=Te.dependsOn<<4|Te.isDependedOn<<2|Te.hasRedundancy;return w.box(w.types.sdtp,ve)},w.stbl=function(z){return w.box(w.types.stbl,w.stsd(z),w.box(w.types.stts,w.STTS),w.box(w.types.stsc,w.STSC),w.box(w.types.stsz,w.STSZ),w.box(w.types.stco,w.STCO))},w.avc1=function(z){var H,Te,Re,ve=[],pe=[];for(H=0;H<z.sps.length;H++)Re=(Te=z.sps[H]).byteLength,ve.push(Re>>>8&255),ve.push(255&Re),ve=ve.concat(Array.prototype.slice.call(Te));for(H=0;H<z.pps.length;H++)Re=(Te=z.pps[H]).byteLength,pe.push(Re>>>8&255),pe.push(255&Re),pe=pe.concat(Array.prototype.slice.call(Te));var We=w.box(w.types.avcC,new Uint8Array([1,ve[3],ve[4],ve[5],255,224|z.sps.length].concat(ve).concat([z.pps.length]).concat(pe))),Ze=z.width,Qe=z.height,Ve=z.pixelRatio[0],lt=z.pixelRatio[1];return w.box(w.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ze>>8&255,255&Ze,Qe>>8&255,255&Qe,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),We,w.box(w.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),w.box(w.types.pasp,new Uint8Array([Ve>>24,Ve>>16&255,Ve>>8&255,255&Ve,lt>>24,lt>>16&255,lt>>8&255,255&lt])))},w.esds=function(z){var H=z.config.length;return new Uint8Array([0,0,0,0,3,23+H,0,1,0,4,15+H,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([H]).concat(z.config).concat([6,1,2]))},w.mp4a=function(z){var H=z.samplerate;return w.box(w.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,z.channelCount,0,16,0,0,0,0,H>>8&255,255&H,0,0]),w.box(w.types.esds,w.esds(z)))},w.mp3=function(z){var H=z.samplerate;return w.box(w.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,z.channelCount,0,16,0,0,0,0,H>>8&255,255&H,0,0]))},w.stsd=function(z){return z.type==="audio"?z.segmentCodec==="mp3"&&z.codec==="mp3"?w.box(w.types.stsd,w.STSD,w.mp3(z)):w.box(w.types.stsd,w.STSD,w.mp4a(z)):w.box(w.types.stsd,w.STSD,w.avc1(z))},w.tkhd=function(z){var H=z.id,Te=z.duration*z.timescale,Re=z.width,ve=z.height,pe=Math.floor(Te/(C+1)),We=Math.floor(Te%(C+1));return w.box(w.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,H>>24&255,H>>16&255,H>>8&255,255&H,0,0,0,0,pe>>24,pe>>16&255,pe>>8&255,255&pe,We>>24,We>>16&255,We>>8&255,255&We,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,Re>>8&255,255&Re,0,0,ve>>8&255,255&ve,0,0]))},w.traf=function(z,H){var Te=w.sdtp(z),Re=z.id,ve=Math.floor(H/(C+1)),pe=Math.floor(H%(C+1));return w.box(w.types.traf,w.box(w.types.tfhd,new Uint8Array([0,0,0,0,Re>>24,Re>>16&255,Re>>8&255,255&Re])),w.box(w.types.tfdt,new Uint8Array([1,0,0,0,ve>>24,ve>>16&255,ve>>8&255,255&ve,pe>>24,pe>>16&255,pe>>8&255,255&pe])),w.trun(z,Te.length+16+20+8+16+8+8),Te)},w.trak=function(z){return z.duration=z.duration||4294967295,w.box(w.types.trak,w.tkhd(z),w.mdia(z))},w.trex=function(z){var H=z.id;return w.box(w.types.trex,new Uint8Array([0,0,0,0,H>>24,H>>16&255,H>>8&255,255&H,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},w.trun=function(z,H){var Te,Re,ve,pe,We,Ze,Qe=z.samples||[],Ve=Qe.length,lt=12+16*Ve,At=new Uint8Array(lt);for(H+=8+lt,At.set([z.type==="video"?1:0,0,15,1,Ve>>>24&255,Ve>>>16&255,Ve>>>8&255,255&Ve,H>>>24&255,H>>>16&255,H>>>8&255,255&H],0),Te=0;Te<Ve;Te++)ve=(Re=Qe[Te]).duration,pe=Re.size,We=Re.flags,Ze=Re.cts,At.set([ve>>>24&255,ve>>>16&255,ve>>>8&255,255&ve,pe>>>24&255,pe>>>16&255,pe>>>8&255,255&pe,We.isLeading<<2|We.dependsOn,We.isDependedOn<<6|We.hasRedundancy<<4|We.paddingValue<<1|We.isNonSync,61440&We.degradPrio,15&We.degradPrio,Ze>>>24&255,Ze>>>16&255,Ze>>>8&255,255&Ze],12+16*Te);return w.box(w.types.trun,At)},w.initSegment=function(z){w.types||w.init();var H=w.moov(z),Te=new Uint8Array(w.FTYP.byteLength+H.byteLength);return Te.set(w.FTYP),Te.set(H,w.FTYP.byteLength),Te},w}();b.types=void 0,b.HDLR_TYPES=void 0,b.STTS=void 0,b.STSC=void 0,b.STCO=void 0,b.STSZ=void 0,b.VMHD=void 0,b.SMHD=void 0,b.STSD=void 0,b.FTYP=void 0,b.DINF=void 0;const R=b;var P=y(851),ce=y(973),J=y(93),ie=y(308),fe=y(673);function Q(){return Q=Object.assign?Object.assign.bind():function(w){for(var z=1;z<arguments.length;z++){var H=arguments[z];for(var Te in H)Object.prototype.hasOwnProperty.call(H,Te)&&(w[Te]=H[Te])}return w},Q.apply(this,arguments)}var de=null,oe=null,se=function(){function w(H,Te,Re,ve){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=H,this.config=Te,this.typeSupported=Re,this.ISGenerated=!1,de===null){var pe=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);de=pe?parseInt(pe[1]):0}if(oe===null){var We=navigator.userAgent.match(/Safari\/(\d+)/i);oe=We?parseInt(We[1]):0}}var z=w.prototype;return z.destroy=function(){},z.resetTimeStamp=function(H){J.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=H},z.resetNextTimestamp=function(){J.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},z.resetInitSegment=function(){J.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},z.getVideoStartPts=function(H){var Te=!1,Re=H.reduce(function(ve,pe){var We=pe.pts-ve;return We<-4294967296?(Te=!0,ae(ve,pe.pts)):We>0?ve:pe.pts},H[0].pts);return Te&&J.logger.debug("PTS rollover detected"),Re},z.remux=function(H,Te,Re,ve,pe,We,Ze,Qe){var Ve,lt,At,B,$,q,ge=pe,Ae=pe,xe=H.pid>-1,Ie=Te.pid>-1,N=Te.samples.length,O=H.samples.length>0,V=Ze&&N>0||N>1;if((!xe||O)&&(!Ie||V)||this.ISGenerated||Ze){this.ISGenerated||(At=this.generateIS(H,Te,pe));var re,me=this.isVideoContiguous,Ne=-1;if(V&&(Ne=function(ze){for(var He=0;He<ze.length;He++)if(ze[He].key)return He;return-1}(Te.samples),!me&&this.config.forceKeyFrameOnDiscontinuity))if(q=!0,Ne>0){J.logger.warn("[mp4-remuxer]: Dropped "+Ne+" out of "+N+" video samples due to a missing keyframe");var Me=this.getVideoStartPts(Te.samples);Te.samples=Te.samples.slice(Ne),Te.dropped+=Ne,re=Ae+=(Te.samples[0].pts-Me)/Te.inputTimeScale}else Ne===-1&&(J.logger.warn("[mp4-remuxer]: No keyframe found out of "+N+" video samples"),q=!1);if(this.ISGenerated){if(O&&V){var ke=this.getVideoStartPts(Te.samples),Be=(ae(H.samples[0].pts,ke)-ke)/Te.inputTimeScale;ge+=Math.max(0,Be),Ae+=Math.max(0,-Be)}if(O){if(H.samplerate||(J.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),At=this.generateIS(H,Te,pe)),lt=this.remuxAudio(H,ge,this.isAudioContiguous,We,Ie||V||Qe===ie.PlaylistLevelType.AUDIO?Ae:void 0),V){var Ce=lt?lt.endPTS-lt.startPTS:0;Te.inputTimeScale||(J.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),At=this.generateIS(H,Te,pe)),Ve=this.remuxVideo(Te,Ae,me,Ce)}}else V&&(Ve=this.remuxVideo(Te,Ae,me,0));Ve&&(Ve.firstKeyFrame=Ne,Ve.independent=Ne!==-1,Ve.firstKeyFramePTS=re)}}return this.ISGenerated&&(Re.samples.length&&($=we(Re,pe,this._initPTS,this._initDTS)),ve.samples.length&&(B=Ue(ve,pe,this._initPTS))),{audio:lt,video:Ve,initSegment:At,independent:q,text:B,id3:$}},z.generateIS=function(H,Te,Re){var ve,pe,We,Ze=H.samples,Qe=Te.samples,Ve=this.typeSupported,lt={},At=!(0,S.isFiniteNumber)(this._initPTS),B="audio/mp4";if(At&&(ve=pe=1/0),H.config&&Ze.length&&(H.timescale=H.samplerate,H.segmentCodec==="mp3"&&(Ve.mpeg?(B="audio/mpeg",H.codec=""):Ve.mp3&&(H.codec="mp3")),lt.audio={id:"audio",container:B,codec:H.codec,initSegment:H.segmentCodec==="mp3"&&Ve.mpeg?new Uint8Array(0):R.initSegment([H]),metadata:{channelCount:H.channelCount}},At&&(We=H.inputTimeScale,ve=pe=Ze[0].pts-Math.round(We*Re))),Te.sps&&Te.pps&&Qe.length&&(Te.timescale=Te.inputTimeScale,lt.video={id:"main",container:"video/mp4",codec:Te.codec,initSegment:R.initSegment([Te]),metadata:{width:Te.width,height:Te.height}},At)){We=Te.inputTimeScale;var $=this.getVideoStartPts(Qe),q=Math.round(We*Re);pe=Math.min(pe,ae(Qe[0].dts,$)-q),ve=Math.min(ve,$-q)}if(Object.keys(lt).length)return this.ISGenerated=!0,At&&(this._initPTS=ve,this._initDTS=pe),{tracks:lt,initPTS:ve,timescale:We}},z.remuxVideo=function(H,Te,Re,ve){var pe,We,Ze=H.inputTimeScale,Qe=H.samples,Ve=[],lt=Qe.length,At=this._initPTS,B=this.nextAvcDts,$=8,q=this.videoSampleDuration,ge=Number.POSITIVE_INFINITY,Ae=Number.NEGATIVE_INFINITY,xe=!1;Re&&B!==null||(B=Te*Ze-(Qe[0].pts-ae(Qe[0].dts,Qe[0].pts)));for(var Ie=0;Ie<lt;Ie++){var N=Qe[Ie];N.pts=ae(N.pts-At,B),N.dts=ae(N.dts-At,B),N.dts<Qe[Ie>0?Ie-1:Ie].dts&&(xe=!0)}xe&&Qe.sort(function(zt,Ar){var vn=zt.dts-Ar.dts,_r=zt.pts-Ar.pts;return vn||_r}),pe=Qe[0].dts;var O=Qe[Qe.length-1].dts-pe,V=O?Math.round(O/(lt-1)):q||H.inputTimeScale/30;if(Re){var re=pe-B,me=re>V,Ne=re<-1;if((me||Ne)&&(me?J.logger.warn("AVC: "+(0,fe.toMsFromMpegTsClock)(re,!0)+" ms ("+re+"dts) hole between fragments detected, filling it"):J.logger.warn("AVC: "+(0,fe.toMsFromMpegTsClock)(-re,!0)+" ms ("+re+"dts) overlapping between fragments detected"),!Ne||B>Qe[0].pts)){pe=B;var Me=Qe[0].pts-re;Qe[0].dts=pe,Qe[0].pts=Me,J.logger.log("Video: First PTS/DTS adjusted: "+(0,fe.toMsFromMpegTsClock)(Me,!0)+"/"+(0,fe.toMsFromMpegTsClock)(pe,!0)+", delta: "+(0,fe.toMsFromMpegTsClock)(re,!0)+" ms")}}pe=Math.max(0,pe);for(var ke=0,Be=0,Ce=0;Ce<lt;Ce++){for(var ze=Qe[Ce],He=ze.units,Ge=He.length,et=0,nt=0;nt<Ge;nt++)et+=He[nt].data.length;Be+=et,ke+=Ge,ze.length=et,ze.dts=Math.max(ze.dts,pe),ge=Math.min(ze.pts,ge),Ae=Math.max(ze.pts,Ae)}We=Qe[lt-1].dts;var ft,dt=Be+4*ke+8;try{ft=new Uint8Array(dt)}catch{return void this.observer.emit(P.Events.ERROR,P.Events.ERROR,{type:ce.ErrorTypes.MUX_ERROR,details:ce.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:dt,reason:"fail allocating video mdat "+dt})}var Et=new DataView(ft.buffer);Et.setUint32(0,dt),ft.set(R.types.mdat,4);for(var Ft=!1,te=Number.POSITIVE_INFINITY,W=Number.POSITIVE_INFINITY,D=Number.NEGATIVE_INFINITY,G=Number.NEGATIVE_INFINITY,U=0;U<lt;U++){for(var X=Qe[U],ee=X.units,ne=0,ye=0,Oe=ee.length;ye<Oe;ye++){var Pe=ee[ye],Ke=Pe.data,tt=Pe.data.byteLength;Et.setUint32($,tt),$+=4,ft.set(Ke,$),$+=tt,ne+=4+tt}var qe=void 0;if(U<lt-1)q=Qe[U+1].dts-X.dts,qe=Qe[U+1].pts-X.pts;else{var at=this.config,gt=U>0?X.dts-Qe[U-1].dts:V;if(qe=U>0?X.pts-Qe[U-1].pts:V,at.stretchShortVideoTrack&&this.nextAudioPts!==null){var Ct=Math.floor(at.maxBufferHole*Ze),it=(ve?ge+ve*Ze:this.nextAudioPts)-X.pts;it>Ct?((q=it-gt)<0?q=gt:Ft=!0,J.logger.log("[mp4-remuxer]: It is approximately "+it/90+" ms to the next segment; using duration "+q/90+" ms for the last video frame.")):q=gt}else q=gt}var Nt=Math.round(X.pts-X.dts);te=Math.min(te,q),D=Math.max(D,q),W=Math.min(W,qe),G=Math.max(G,qe),Ve.push(new Je(X.key,q,ne,Nt))}if(Ve.length){if(de){if(de<70){var er=Ve[0].flags;er.dependsOn=2,er.isNonSync=0}}else if(oe&&G-W<D-te&&V/D<.025&&Ve[0].cts===0){J.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var Yt=pe,Mt=0,qt=Ve.length;Mt<qt;Mt++){var ot=Yt+Ve[Mt].duration,ur=Yt+Ve[Mt].cts;if(Mt<qt-1){var qr=ot+Ve[Mt+1].cts;Ve[Mt].duration=qr-ur}else Ve[Mt].duration=Mt?Ve[Mt-1].duration:V;Ve[Mt].cts=0,Yt=ot}}}q=Ft||!q?V:q,this.nextAvcDts=B=We+q,this.videoSampleDuration=q,this.isVideoContiguous=!0;var Vt={data1:R.moof(H.sequenceNumber++,pe,Q({},H,{samples:Ve})),data2:ft,startPTS:ge/Ze,endPTS:(Ae+q)/Ze,startDTS:pe/Ze,endDTS:B/Ze,type:"video",hasAudio:!1,hasVideo:!0,nb:Ve.length,dropped:H.dropped};return H.samples=[],H.dropped=0,Vt},z.remuxAudio=function(H,Te,Re,ve,pe){var We=H.inputTimeScale,Ze=We/(H.samplerate?H.samplerate:We),Qe=H.segmentCodec==="aac"?1024:1152,Ve=Qe*Ze,lt=this._initPTS,At=H.segmentCodec==="mp3"&&this.typeSupported.mpeg,B=[],$=pe!==void 0,q=H.samples,ge=At?0:8,Ae=this.nextAudioPts||-1,xe=Te*We;if(this.isAudioContiguous=Re=Re||q.length&&Ae>0&&(ve&&Math.abs(xe-Ae)<9e3||Math.abs(ae(q[0].pts-lt,xe)-Ae)<20*Ve),q.forEach(function(ye){ye.pts=ae(ye.pts-lt,xe)}),!Re||Ae<0){if(q=q.filter(function(ye){return ye.pts>=0}),!q.length)return;Ae=pe===0?0:ve&&!$?Math.max(0,xe):q[0].pts}if(H.segmentCodec==="aac")for(var Ie=this.config.maxAudioFramesDrift,N=0,O=Ae;N<q.length;N++){var V=q[N],re=V.pts,me=re-O,Ne=Math.abs(1e3*me/We);if(me<=-Ie*Ve&&$)N===0&&(J.logger.warn("Audio frame @ "+(re/We).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*me/We)+" ms."),this.nextAudioPts=Ae=O=re);else if(me>=Ie*Ve&&Ne<1e4&&$){var Me=Math.round(me/Ve);(O=re-Me*Ve)<0&&(Me--,O+=Ve),N===0&&(this.nextAudioPts=Ae=O),J.logger.warn("[mp4-remuxer]: Injecting "+Me+" audio frame @ "+(O/We).toFixed(3)+"s due to "+Math.round(1e3*me/We)+" ms gap.");for(var ke=0;ke<Me;ke++){var Be=Math.max(O,0),Ce=I.getSilentFrame(H.manifestCodec||H.codec,H.channelCount);Ce||(J.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ce=V.unit.subarray()),q.splice(N,0,{unit:Ce,pts:Be}),O+=Ve,N++}}V.pts=O,O+=Ve}for(var ze,He=null,Ge=null,et=0,nt=q.length;nt--;)et+=q[nt].unit.byteLength;for(var ft=0,dt=q.length;ft<dt;ft++){var Et=q[ft],Ft=Et.unit,te=Et.pts;if(Ge!==null)B[ft-1].duration=Math.round((te-Ge)/Ze);else{if(Re&&H.segmentCodec==="aac"&&(te=Ae),He=te,!(et>0))return;et+=ge;try{ze=new Uint8Array(et)}catch{return void this.observer.emit(P.Events.ERROR,P.Events.ERROR,{type:ce.ErrorTypes.MUX_ERROR,details:ce.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:et,reason:"fail allocating audio mdat "+et})}At||(new DataView(ze.buffer).setUint32(0,et),ze.set(R.types.mdat,4))}ze.set(Ft,ge);var W=Ft.byteLength;ge+=W,B.push(new Je(!0,Qe,W,0)),Ge=te}var D=B.length;if(D){var G=B[B.length-1];this.nextAudioPts=Ae=Ge+Ze*G.duration;var U=At?new Uint8Array(0):R.moof(H.sequenceNumber++,He/Ze,Q({},H,{samples:B}));H.samples=[];var X=He/We,ee=Ae/We,ne={data1:U,data2:ze,startPTS:X,endPTS:ee,startDTS:X,endDTS:ee,type:"audio",hasAudio:!0,hasVideo:!1,nb:D};return this.isAudioContiguous=!0,ne}},z.remuxEmptyAudio=function(H,Te,Re,ve){var pe=H.inputTimeScale,We=pe/(H.samplerate?H.samplerate:pe),Ze=this.nextAudioPts,Qe=(Ze!==null?Ze:ve.startDTS*pe)+this._initDTS,Ve=ve.endDTS*pe+this._initDTS,lt=1024*We,At=Math.ceil((Ve-Qe)/lt),B=I.getSilentFrame(H.manifestCodec||H.codec,H.channelCount);if(J.logger.warn("[mp4-remuxer]: remux empty Audio"),B){for(var $=[],q=0;q<At;q++){var ge=Qe+q*lt;$.push({unit:B,pts:ge,dts:ge})}return H.samples=$,this.remuxAudio(H,Te,Re,!1)}J.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},w}();function ae(w,z){var H;if(z===null)return w;for(H=z<w?-8589934592:8589934592;Math.abs(w-z)>4294967296;)w+=H;return w}function we(w,z,H,Te){var Re=w.samples.length;if(Re){for(var ve=w.inputTimeScale,pe=0;pe<Re;pe++){var We=w.samples[pe];We.pts=ae(We.pts-H,z*ve)/ve,We.dts=ae(We.dts-Te,z*ve)/ve}var Ze=w.samples;return w.samples=[],{samples:Ze}}}function Ue(w,z,H){var Te=w.samples.length;if(Te){for(var Re=w.inputTimeScale,ve=0;ve<Te;ve++){var pe=w.samples[ve];pe.pts=ae(pe.pts-H,z*Re)/Re}w.samples.sort(function(Ze,Qe){return Ze.pts-Qe.pts});var We=w.samples;return w.samples=[],{samples:We}}}var Je=function(w,z,H,Te){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=z,this.size=H,this.cts=Te,this.flags=new ue(w)},ue=function(w){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=w?2:1,this.isNonSync=w?0:1}},856:(T,A,y)=>{var S;y.r(A),y.d(A,{MetadataSchema:()=>S}),function(I){I.audioId3="org.id3",I.dateRange="com.apple.quicktime.HLS",I.emsg="https://aomedia.org/emsg/ID3"}(S||(S={}))},308:(T,A,y)=>{var S,I;y.r(A),y.d(A,{PlaylistContextType:()=>S,PlaylistLevelType:()=>I}),function(C){C.MANIFEST="manifest",C.LEVEL="level",C.AUDIO_TRACK="audioTrack",C.SUBTITLE_TRACK="subtitleTrack"}(S||(S={})),function(C){C.MAIN="main",C.AUDIO="audio",C.SUBTITLE="subtitle"}(I||(I={}))},300:(T,A,y)=>{y.r(A),y.d(A,{default:()=>S});const S={hexDump:function(I){for(var C="",b=0;b<I.length;b++){var R=I[b].toString(16);R.length<2&&(R="0"+R),C+=R}return C}}},93:(T,A,y)=>{y.r(A),y.d(A,{enableLogs:()=>R,logger:()=>P});var S=function(){},I={trace:S,debug:S,log:S,warn:S,info:S,error:S},C=I;function b(ce){var J=self.console[ce];return J?J.bind(self.console,"["+ce+"] >"):S}function R(ce,J){if(self.console&&ce===!0||typeof ce=="object"){(function(ie){for(var fe=arguments.length,Q=new Array(fe>1?fe-1:0),de=1;de<fe;de++)Q[de-1]=arguments[de];Q.forEach(function(oe){C[oe]=ie[oe]?ie[oe].bind(ie):b(oe)})})(ce,"debug","log","info","warn","error");try{C.log('Debug logs enabled for "'+J+'"')}catch{C=I}}else C=I}var P=I},63:(T,A,y)=>{y.r(A),y.d(A,{RemuxerTrackIdConfig:()=>J,appendUint8Array:()=>Re,bin2str:()=>ie,computeRawDurationFromSamples:()=>z,discardEPB:()=>Ze,findBox:()=>se,getDuration:()=>w,getStartDTS:()=>ue,mp4Box:()=>Ve,mp4pssh:()=>lt,offsetStartDTS:()=>H,parseEmsg:()=>Qe,parseInitSegment:()=>we,parsePssh:()=>At,parseSEIMessageFromNALu:()=>We,parseSamples:()=>ve,parseSegmentIndex:()=>ae,parseSinf:()=>Je,patchEncyptionData:()=>Ue,readSint32:()=>de,readUint16:()=>fe,readUint32:()=>Q,segmentValidRange:()=>Te,writeUint32:()=>oe});var S=y(923),I=y(145),C=y(181),b=y(93),R=y(300),P=Math.pow(2,32)-1,ce=[].push,J={video:1,audio:2,id3:3,text:4};function ie(B){return String.fromCharCode.apply(null,B)}function fe(B,$){var q=B[$]<<8|B[$+1];return q<0?65536+q:q}function Q(B,$){var q=de(B,$);return q<0?4294967296+q:q}function de(B,$){return B[$]<<24|B[$+1]<<16|B[$+2]<<8|B[$+3]}function oe(B,$,q){B[$]=q>>24,B[$+1]=q>>16&255,B[$+2]=q>>8&255,B[$+3]=255&q}function se(B,$){var q=[];if(!$.length)return q;for(var ge=B.byteLength,Ae=0;Ae<ge;){var xe=Q(B,Ae),Ie=xe>1?Ae+xe:ge;if(ie(B.subarray(Ae+4,Ae+8))===$[0])if($.length===1)q.push(B.subarray(Ae+8,Ie));else{var N=se(B.subarray(Ae+8,Ie),$.slice(1));N.length&&ce.apply(q,N)}Ae=Ie}return q}function ae(B){var $=[],q=B[0],ge=8,Ae=Q(B,ge);ge+=4,ge+=q===0?8:16,ge+=2;var xe=B.length+0,Ie=fe(B,ge);ge+=2;for(var N=0;N<Ie;N++){var O=ge,V=Q(B,O);O+=4;var re=2147483647&V;if((2147483648&V)>>>31==1)return console.warn("SIDX has hierarchical references (not supported)"),null;var me=Q(B,O);O+=4,$.push({referenceSize:re,subsegmentDuration:me,info:{duration:me/Ae,start:xe,end:xe+re-1}}),xe+=re,ge=O+=4}return{earliestPresentationTime:0,timescale:Ae,version:q,referencesCount:Ie,references:$}}function we(B){for(var $=[],q=se(B,["moov","trak"]),ge=0;ge<q.length;ge++){var Ae=q[ge],xe=se(Ae,["tkhd"])[0];if(xe){var Ie=xe[0],N=Ie===0?12:20,O=Q(xe,N),V=se(Ae,["mdia","mdhd"])[0];if(V){var re=Q(V,N=(Ie=V[0])===0?12:20),me=se(Ae,["mdia","hdlr"])[0];if(me){var Ne=ie(me.subarray(8,12)),Me={soun:S.ElementaryStreamTypes.AUDIO,vide:S.ElementaryStreamTypes.VIDEO}[Ne];if(Me){var ke=se(Ae,["mdia","minf","stbl","stsd"])[0],Be=void 0;ke&&(Be=ie(ke.subarray(12,16))),$[O]={timescale:re,type:Me},$[Me]={timescale:re,id:O,codec:Be}}}}}}return se(B,["moov","mvex","trex"]).forEach(function(Ce){var ze=Q(Ce,4),He=$[ze];He&&(He.default={duration:Q(Ce,12),flags:Q(Ce,20)})}),$}function Ue(B,$){if(!B||!$)return B;var q=$.keyId;return q&&$.isCommonEncryption&&se(B,["moov","trak"]).forEach(function(ge){var Ae=se(ge,["mdia","minf","stbl","stsd"])[0].subarray(8),xe=se(Ae,["enca"]),Ie=xe.length>0;Ie||(xe=se(Ae,["encv"])),xe.forEach(function(N){se(Ie?N.subarray(28):N.subarray(78),["sinf"]).forEach(function(O){var V=Je(O);if(V){var re=V.subarray(8,24);re.some(function(me){return me!==0})||(b.logger.log("[eme] Patching keyId in 'enc"+(Ie?"a":"v")+">sinf>>tenc' box: "+R.default.hexDump(re)+" -> "+R.default.hexDump(q)),V.set(q,8))}})})}),B}function Je(B){var $=se(B,["schm"])[0];if($){var q=ie($.subarray(4,8));if(q==="cbcs"||q==="cenc")return se(B,["schi","tenc"])[0]}return b.logger.error("[eme] missing 'schm' box"),null}function ue(B,$){return se($,["moof","traf"]).reduce(function(q,ge){var Ae=se(ge,["tfdt"])[0],xe=Ae[0],Ie=se(ge,["tfhd"]).reduce(function(N,O){var V=Q(O,4),re=B[V];if(re){var me=Q(Ae,4);xe===1&&(me*=Math.pow(2,32),me+=Q(Ae,8));var Ne=me/(re.timescale||9e4);if(isFinite(Ne)&&(N===null||Ne<N))return Ne}return N},null);return Ie!==null&&isFinite(Ie)&&(q===null||Ie<q)?Ie:q},null)||0}function w(B,$){for(var q=0,ge=0,Ae=0,xe=se(B,["moof","traf"]),Ie=0;Ie<xe.length;Ie++){var N=xe[Ie],O=se(N,["tfhd"])[0],V=$[Q(O,4)];if(V){var re=V.default,me=Q(O,0)|(re==null?void 0:re.flags),Ne=re==null?void 0:re.duration;8&me&&(Ne=Q(O,2&me?12:8));for(var Me=V.timescale||9e4,ke=se(N,["trun"]),Be=0;Be<ke.length;Be++)!(q=z(ke[Be]))&&Ne&&(q=Ne*Q(ke[Be],4)),V.type===S.ElementaryStreamTypes.VIDEO?ge+=q/Me:V.type===S.ElementaryStreamTypes.AUDIO&&(Ae+=q/Me)}}if(ge===0&&Ae===0){for(var Ce=0,ze=se(B,["sidx"]),He=0;He<ze.length;He++){var Ge=ae(ze[He]);Ge!=null&&Ge.references&&(Ce+=Ge.references.reduce(function(et,nt){return et+nt.info.duration||0},0))}return Ce}return ge||Ae}function z(B){var $=Q(B,0),q=8;1&$&&(q+=4),4&$&&(q+=4);for(var ge=0,Ae=Q(B,4),xe=0;xe<Ae;xe++)256&$&&(ge+=Q(B,q),q+=4),512&$&&(q+=4),1024&$&&(q+=4),2048&$&&(q+=4);return ge}function H(B,$,q){se($,["moof","traf"]).forEach(function(ge){se(ge,["tfhd"]).forEach(function(Ae){var xe=Q(Ae,4),Ie=B[xe];if(Ie){var N=Ie.timescale||9e4;se(ge,["tfdt"]).forEach(function(O){var V=O[0],re=Q(O,4);if(V===0)re-=q*N,oe(O,4,re=Math.max(re,0));else{re*=Math.pow(2,32),re+=Q(O,8),re-=q*N,re=Math.max(re,0);var me=Math.floor(re/(P+1)),Ne=Math.floor(re%(P+1));oe(O,4,me),oe(O,8,Ne)}})}})})}function Te(B){var $={valid:null,remainder:null},q=se(B,["moof"]);if(!q)return $;if(q.length<2)return $.remainder=B,$;var ge=q[q.length-1];return $.valid=(0,I.sliceUint8)(B,0,ge.byteOffset-8),$.remainder=(0,I.sliceUint8)(B,ge.byteOffset-8),$}function Re(B,$){var q=new Uint8Array(B.length+$.length);return q.set(B),q.set($,B.length),q}function ve(B,$){var q=[],ge=$.samples,Ae=$.timescale,xe=$.id,Ie=!1;return se(ge,["moof"]).map(function(N){var O=N.byteOffset-8;se(N,["traf"]).map(function(V){var re=se(V,["tfdt"]).map(function(me){var Ne=me[0],Me=Q(me,4);return Ne===1&&(Me*=Math.pow(2,32),Me+=Q(me,8)),Me/Ae})[0];return re!==void 0&&(B=re),se(V,["tfhd"]).map(function(me){var Ne=Q(me,4),Me=16777215&Q(me,0),ke=0,Be=(16&Me)!=0,Ce=0,ze=(32&Me)!=0,He=8;Ne===xe&&(1&Me&&(He+=8),2&Me&&(He+=4),8&Me&&(ke=Q(me,He),He+=4),Be&&(Ce=Q(me,He),He+=4),ze&&(He+=4),$.type==="video"&&(Ie=function(Ge){if(!Ge)return!1;var et=Ge.indexOf("."),nt=et<0?Ge:Ge.substring(0,et);return nt==="hvc1"||nt==="hev1"||nt==="dvh1"||nt==="dvhe"}($.codec)),se(V,["trun"]).map(function(Ge){var et=Ge[0],nt=16777215&Q(Ge,0),ft=(1&nt)!=0,dt=0,Et=(4&nt)!=0,Ft=(256&nt)!=0,te=0,W=(512&nt)!=0,D=0,G=(1024&nt)!=0,U=(2048&nt)!=0,X=0,ee=Q(Ge,4),ne=8;ft&&(dt=Q(Ge,ne),ne+=4),Et&&(ne+=4);for(var ye=dt+O,Oe=0;Oe<ee;Oe++){if(Ft?(te=Q(Ge,ne),ne+=4):te=ke,W?(D=Q(Ge,ne),ne+=4):D=Ce,G&&(ne+=4),U&&(X=et===0?Q(Ge,ne):de(Ge,ne),ne+=4),$.type===S.ElementaryStreamTypes.VIDEO)for(var Pe=0;Pe<D;){var Ke=Q(ge,ye);pe(Ie,ge[ye+=4])&&We(ge.subarray(ye,ye+Ke),Ie?2:1,B+X/Ae,q),ye+=Ke,Pe+=Ke+4}B+=te/Ae}}))})})}),q}function pe(B,$){if(B){var q=$>>1&63;return q===39||q===40}return(31&$)==6}function We(B,$,q,ge){var Ae=Ze(B),xe=0;xe+=$;for(var Ie=0,N=0,O=!1,V=0;xe<Ae.length;){Ie=0;do{if(xe>=Ae.length)break;Ie+=V=Ae[xe++]}while(V===255);N=0;do{if(xe>=Ae.length)break;N+=V=Ae[xe++]}while(V===255);var re=Ae.length-xe;if(!O&&Ie===4&&xe<Ae.length){if(O=!0,Ae[xe++]===181){var me=fe(Ae,xe);if(xe+=2,me===49){var Ne=Q(Ae,xe);if(xe+=4,Ne===1195456820){var Me=Ae[xe++];if(Me===3){var ke=Ae[xe++],Be=64&ke,Ce=Be?2+3*(31&ke):0,ze=new Uint8Array(Ce);if(Be){ze[0]=ke;for(var He=1;He<Ce;He++)ze[He]=Ae[xe++]}ge.push({type:Me,payloadType:Ie,pts:q,bytes:ze})}}}}}else if(Ie===5&&N<re){if(O=!0,N>16){for(var Ge=[],et=0;et<16;et++){var nt=Ae[xe++].toString(16);Ge.push(nt.length==1?"0"+nt:nt),et!==3&&et!==5&&et!==7&&et!==9||Ge.push("-")}for(var ft=N-16,dt=new Uint8Array(ft),Et=0;Et<ft;Et++)dt[Et]=Ae[xe++];ge.push({payloadType:Ie,pts:q,uuid:Ge.join(""),userData:(0,C.utf8ArrayToStr)(dt),userDataBytes:dt})}}else if(N<re)xe+=N;else if(N>re)break}}function Ze(B){for(var $=B.byteLength,q=[],ge=1;ge<$-2;)B[ge]===0&&B[ge+1]===0&&B[ge+2]===3?(q.push(ge+2),ge+=2):ge++;if(q.length===0)return B;var Ae=$-q.length,xe=new Uint8Array(Ae),Ie=0;for(ge=0;ge<Ae;Ie++,ge++)Ie===q[0]&&(Ie++,q.shift()),xe[ge]=B[Ie];return xe}function Qe(B){var $=B[0],q="",ge="",Ae=0,xe=0,Ie=0,N=0,O=0,V=0;if($===0){for(;ie(B.subarray(V,V+1))!=="\0";)q+=ie(B.subarray(V,V+1)),V+=1;for(q+=ie(B.subarray(V,V+1)),V+=1;ie(B.subarray(V,V+1))!=="\0";)ge+=ie(B.subarray(V,V+1)),V+=1;ge+=ie(B.subarray(V,V+1)),V+=1,Ae=Q(B,12),xe=Q(B,16),N=Q(B,20),O=Q(B,24),V=28}else if($===1){Ae=Q(B,V+=4);var re=Q(B,V+=4),me=Q(B,V+=4);for(V+=4,Ie=Math.pow(2,32)*re+me,Number.isSafeInteger(Ie)||(Ie=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),N=Q(B,V),O=Q(B,V+=4),V+=4;ie(B.subarray(V,V+1))!=="\0";)q+=ie(B.subarray(V,V+1)),V+=1;for(q+=ie(B.subarray(V,V+1)),V+=1;ie(B.subarray(V,V+1))!=="\0";)ge+=ie(B.subarray(V,V+1)),V+=1;ge+=ie(B.subarray(V,V+1)),V+=1}return{schemeIdUri:q,value:ge,timeScale:Ae,presentationTime:Ie,presentationTimeDelta:xe,eventDuration:N,id:O,payload:B.subarray(V,B.byteLength)}}function Ve(B){for(var $=arguments.length,q=new Array($>1?$-1:0),ge=1;ge<$;ge++)q[ge-1]=arguments[ge];for(var Ae=q.length,xe=8,Ie=Ae;Ie--;)xe+=q[Ie].byteLength;var N=new Uint8Array(xe);for(N[0]=xe>>24&255,N[1]=xe>>16&255,N[2]=xe>>8&255,N[3]=255&xe,N.set(B,4),Ie=0,xe=8;Ie<Ae;Ie++)N.set(q[Ie],xe),xe+=q[Ie].byteLength;return N}function lt(B,$,q){if(B.byteLength!==16)throw new RangeError("Invalid system id");var ge,Ae,xe;if($){ge=1,Ae=new Uint8Array(16*$.length);for(var Ie=0;Ie<$.length;Ie++){var N=$[Ie];if(N.byteLength!==16)throw new RangeError("Invalid key");Ae.set(N,16*Ie)}}else ge=0,Ae=new Uint8Array;ge>0?(xe=new Uint8Array(4),$.length>0&&new DataView(xe.buffer).setUint32(0,$.length,!1)):xe=new Uint8Array;var O=new Uint8Array(4);return q&&q.byteLength>0&&new DataView(O.buffer).setUint32(0,q.byteLength,!1),Ve([112,115,115,104],new Uint8Array([ge,0,0,0]),B,xe,Ae,O,q||new Uint8Array)}function At(B){if(!(B instanceof ArrayBuffer)||B.byteLength<32)return null;var $={version:0,systemId:"",kids:null,data:null},q=new DataView(B),ge=q.getUint32(0);if(B.byteLength!==ge&&ge>44||q.getUint32(4)!==1886614376||($.version=q.getUint32(8)>>>24,$.version>1))return null;$.systemId=R.default.hexDump(new Uint8Array(B,12,16));var Ae=q.getUint32(28);if($.version===0){if(ge-32<Ae)return null;$.data=new Uint8Array(B,32,Ae)}else if($.version===1){$.kids=[];for(var xe=0;xe<Ae;xe++)$.kids.push(new Uint8Array(B,32+16*xe,16))}return $}},673:(T,A,y)=>{function S(R,P,ce,J){ce===void 0&&(ce=1),J===void 0&&(J=!1);var ie=R*P*ce;return J?Math.round(ie):ie}function I(R,P,ce,J){return ce===void 0&&(ce=1),J===void 0&&(J=!1),S(R,P,1/ce,J)}function C(R,P){return P===void 0&&(P=!1),S(R,1e3,11111111111111112e-21,P)}function b(R,P){return P===void 0&&(P=1),S(R,9e4,1/P)}y.r(A),y.d(A,{toMpegTsClockFromTimescale:()=>b,toMsFromMpegTsClock:()=>C,toTimescaleFromBase:()=>S,toTimescaleFromScale:()=>I})},145:(T,A,y)=>{function S(I,C,b){return Uint8Array.prototype.slice?I.slice(C,b):new Uint8Array(Array.prototype.slice.call(I,C,b))}y.r(A),y.d(A,{sliceUint8:()=>S})},729:T=>{var A=Object.prototype.hasOwnProperty,y="~";function S(){}function I(P,ce,J){this.fn=P,this.context=ce,this.once=J||!1}function C(P,ce,J,ie,fe){if(typeof J!="function")throw new TypeError("The listener must be a function");var Q=new I(J,ie||P,fe),de=y?y+ce:ce;return P._events[de]?P._events[de].fn?P._events[de]=[P._events[de],Q]:P._events[de].push(Q):(P._events[de]=Q,P._eventsCount++),P}function b(P,ce){--P._eventsCount==0?P._events=new S:delete P._events[ce]}function R(){this._events=new S,this._eventsCount=0}Object.create&&(S.prototype=Object.create(null),new S().__proto__||(y=!1)),R.prototype.eventNames=function(){var P,ce,J=[];if(this._eventsCount===0)return J;for(ce in P=this._events)A.call(P,ce)&&J.push(y?ce.slice(1):ce);return Object.getOwnPropertySymbols?J.concat(Object.getOwnPropertySymbols(P)):J},R.prototype.listeners=function(P){var ce=y?y+P:P,J=this._events[ce];if(!J)return[];if(J.fn)return[J.fn];for(var ie=0,fe=J.length,Q=new Array(fe);ie<fe;ie++)Q[ie]=J[ie].fn;return Q},R.prototype.listenerCount=function(P){var ce=y?y+P:P,J=this._events[ce];return J?J.fn?1:J.length:0},R.prototype.emit=function(P,ce,J,ie,fe,Q){var de=y?y+P:P;if(!this._events[de])return!1;var oe,se,ae=this._events[de],we=arguments.length;if(ae.fn){switch(ae.once&&this.removeListener(P,ae.fn,void 0,!0),we){case 1:return ae.fn.call(ae.context),!0;case 2:return ae.fn.call(ae.context,ce),!0;case 3:return ae.fn.call(ae.context,ce,J),!0;case 4:return ae.fn.call(ae.context,ce,J,ie),!0;case 5:return ae.fn.call(ae.context,ce,J,ie,fe),!0;case 6:return ae.fn.call(ae.context,ce,J,ie,fe,Q),!0}for(se=1,oe=new Array(we-1);se<we;se++)oe[se-1]=arguments[se];ae.fn.apply(ae.context,oe)}else{var Ue,Je=ae.length;for(se=0;se<Je;se++)switch(ae[se].once&&this.removeListener(P,ae[se].fn,void 0,!0),we){case 1:ae[se].fn.call(ae[se].context);break;case 2:ae[se].fn.call(ae[se].context,ce);break;case 3:ae[se].fn.call(ae[se].context,ce,J);break;case 4:ae[se].fn.call(ae[se].context,ce,J,ie);break;default:if(!oe)for(Ue=1,oe=new Array(we-1);Ue<we;Ue++)oe[Ue-1]=arguments[Ue];ae[se].fn.apply(ae[se].context,oe)}}return!0},R.prototype.on=function(P,ce,J){return C(this,P,ce,J,!1)},R.prototype.once=function(P,ce,J){return C(this,P,ce,J,!0)},R.prototype.removeListener=function(P,ce,J,ie){var fe=y?y+P:P;if(!this._events[fe])return this;if(!ce)return b(this,fe),this;var Q=this._events[fe];if(Q.fn)Q.fn!==ce||ie&&!Q.once||J&&Q.context!==J||b(this,fe);else{for(var de=0,oe=[],se=Q.length;de<se;de++)(Q[de].fn!==ce||ie&&!Q[de].once||J&&Q[de].context!==J)&&oe.push(Q[de]);oe.length?this._events[fe]=oe.length===1?oe[0]:oe:b(this,fe)}return this},R.prototype.removeAllListeners=function(P){var ce;return P?(ce=y?y+P:P,this._events[ce]&&b(this,ce)):(this._events=new S,this._eventsCount=0),this},R.prototype.off=R.prototype.removeListener,R.prototype.addListener=R.prototype.on,R.prefixed=y,R.EventEmitter=R,T.exports=R},945:function(T){var A,y,S,I,C;A=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,y=/^(?=([^\/?#]*))\1([^]*)$/,S=/(?:\/|^)\.(?=\/)/g,I=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,C={buildAbsoluteURL:function(b,R,P){if(P=P||{},b=b.trim(),!(R=R.trim())){if(!P.alwaysNormalize)return b;var ce=C.parseURL(b);if(!ce)throw new Error("Error trying to parse base URL.");return ce.path=C.normalizePath(ce.path),C.buildURLFromParts(ce)}var J=C.parseURL(R);if(!J)throw new Error("Error trying to parse relative URL.");if(J.scheme)return P.alwaysNormalize?(J.path=C.normalizePath(J.path),C.buildURLFromParts(J)):R;var ie=C.parseURL(b);if(!ie)throw new Error("Error trying to parse base URL.");if(!ie.netLoc&&ie.path&&ie.path[0]!=="/"){var fe=y.exec(ie.path);ie.netLoc=fe[1],ie.path=fe[2]}ie.netLoc&&!ie.path&&(ie.path="/");var Q={scheme:ie.scheme,netLoc:J.netLoc,path:null,params:J.params,query:J.query,fragment:J.fragment};if(!J.netLoc&&(Q.netLoc=ie.netLoc,J.path[0]!=="/"))if(J.path){var de=ie.path,oe=de.substring(0,de.lastIndexOf("/")+1)+J.path;Q.path=C.normalizePath(oe)}else Q.path=ie.path,J.params||(Q.params=ie.params,J.query||(Q.query=ie.query));return Q.path===null&&(Q.path=P.alwaysNormalize?C.normalizePath(J.path):J.path),C.buildURLFromParts(Q)},parseURL:function(b){var R=A.exec(b);return R?{scheme:R[1]||"",netLoc:R[2]||"",path:R[3]||"",params:R[4]||"",query:R[5]||"",fragment:R[6]||""}:null},normalizePath:function(b){for(b=b.split("").reverse().join("").replace(S,"");b.length!==(b=b.replace(I,"")).length;);return b.split("").reverse().join("")},buildURLFromParts:function(b){return b.scheme+b.netLoc+b.path+b.params+b.query+b.fragment}},T.exports=C}},i={};function u(T){var A=i[T];if(A!==void 0)return A.exports;var y=i[T]={exports:{}};return r[T].call(y.exports,y,y.exports,u),y.exports}u.m=r,u.n=T=>{var A=T&&T.__esModule?()=>T.default:()=>T;return u.d(A,{a:A}),A},u.d=(T,A)=>{for(var y in A)u.o(A,y)&&!u.o(T,y)&&Object.defineProperty(T,y,{enumerable:!0,get:A[y]})},u.o=(T,A)=>Object.prototype.hasOwnProperty.call(T,A),u.r=T=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(T,"__esModule",{value:!0})};var d=u(76);return d.default})())})(TA);const wA=BT(Jo);export{en as F,CA as a,td as b,SA as c,IA as d,is as e,Uf as f,_m as g,mr as h,yA as i,Sg as j,Os as k,_A as l,wA as m,OA as n,ym as o,NA as p,RA as q,AA as r,DA as s,vA as t,ni as u,LA as v,bA as w};
