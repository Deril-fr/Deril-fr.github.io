function pu(e,t){const r=Object.create(null),n=e.split(",");for(let a=0;a<n.length;a++)r[n[a]]=!0;return t?a=>!!r[a.toLowerCase()]:a=>!!r[a]}function Eu(e){if(Et(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],a=Zt(n)?Eg(n):Eu(n);if(a)for(const f in a)t[f]=a[f]}return t}else{if(Zt(e))return e;if(Yt(e))return e}}const gg=/;(?![^(]*\))/g,mg=/:([^]+)/,pg=/\/\*.*?\*\//gs;function Eg(e){const t={};return e.replace(pg,"").split(gg).forEach(r=>{if(r){const n=r.split(mg);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Tu(e){let t="";if(Zt(e))t=e;else if(Et(e))for(let r=0;r<e.length;r++){const n=Tu(e[r]);n&&(t+=n+" ")}else if(Yt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const Tg="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",vg=pu(Tg);function Lh(e){return!!e||e===""}const M_=e=>Zt(e)?e:e==null?"":Et(e)||Yt(e)&&(e.toString===Oh||!At(e.toString))?JSON.stringify(e,Rh,2):String(e),Rh=(e,t)=>t&&t.__v_isRef?Rh(e,t.value):oi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,a])=>(r[`${n} =>`]=a,r),{})}:Dh(t)?{[`Set(${t.size})`]:[...t.values()]}:Yt(t)&&!Et(t)&&!xh(t)?String(t):t,Ut={},ai=[],xr=()=>{},bg=()=>!1,yg=/^on[^a-z]/,ua=e=>yg.test(e),vu=e=>e.startsWith("onUpdate:"),ur=Object.assign,bu=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},Ag=Object.prototype.hasOwnProperty,Nt=(e,t)=>Ag.call(e,t),Et=Array.isArray,oi=e=>ca(e)==="[object Map]",Dh=e=>ca(e)==="[object Set]",At=e=>typeof e=="function",Zt=e=>typeof e=="string",yu=e=>typeof e=="symbol",Yt=e=>e!==null&&typeof e=="object",Nh=e=>Yt(e)&&At(e.then)&&At(e.catch),Oh=Object.prototype.toString,ca=e=>Oh.call(e),_g=e=>ca(e).slice(8,-1),xh=e=>ca(e)==="[object Object]",Au=e=>Zt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ms=pu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),la=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},Sg=/-(\w)/g,Xr=la(e=>e.replace(Sg,(t,r)=>r?r.toUpperCase():"")),Ig=/\B([A-Z])/g,bi=la(e=>e.replace(Ig,"-$1").toLowerCase()),ha=la(e=>e.charAt(0).toUpperCase()+e.slice(1)),Eo=la(e=>e?`on${ha(e)}`:""),Zi=(e,t)=>!Object.is(e,t),Fs=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},Vs=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},qs=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Wc;const Cg=()=>Wc||(Wc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Hr;class Lg{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Hr,!t&&Hr&&(this.index=(Hr.scopes||(Hr.scopes=[])).push(this)-1)}run(t){if(this.active){const r=Hr;try{return Hr=this,t()}finally{Hr=r}}}on(){Hr=this}off(){Hr=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!t){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.parent=void 0,this.active=!1}}}function Rg(e,t=Hr){t&&t.active&&t.effects.push(e)}const _u=e=>{const t=new Set(e);return t.w=0,t.n=0,t},kh=e=>(e.w&yn)>0,Ph=e=>(e.n&yn)>0,Dg=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=yn},Ng=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const a=t[n];kh(a)&&!Ph(a)?a.delete(e):t[r++]=a,a.w&=~yn,a.n&=~yn}t.length=r}},Fo=new WeakMap;let Ui=0,yn=1;const Bo=30;let Nr;const Hn=Symbol(""),Uo=Symbol("");class Su{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,Rg(this,n)}run(){if(!this.active)return this.fn();let t=Nr,r=Tn;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Nr,Nr=this,Tn=!0,yn=1<<++Ui,Ui<=Bo?Dg(this):Xc(this),this.fn()}finally{Ui<=Bo&&Ng(this),yn=1<<--Ui,Nr=this.parent,Tn=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Nr===this?this.deferStop=!0:this.active&&(Xc(this),this.onStop&&this.onStop(),this.active=!1)}}function Xc(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Tn=!0;const wh=[];function yi(){wh.push(Tn),Tn=!1}function Ai(){const e=wh.pop();Tn=e===void 0?!0:e}function vr(e,t,r){if(Tn&&Nr){let n=Fo.get(e);n||Fo.set(e,n=new Map);let a=n.get(r);a||n.set(r,a=_u()),Mh(a)}}function Mh(e,t){let r=!1;Ui<=Bo?Ph(e)||(e.n|=yn,r=!kh(e)):r=!e.has(Nr),r&&(e.add(Nr),Nr.deps.push(e))}function on(e,t,r,n,a,f){const E=Fo.get(e);if(!E)return;let A=[];if(t==="clear")A=[...E.values()];else if(r==="length"&&Et(e)){const y=qs(n);E.forEach((_,I)=>{(I==="length"||I>=y)&&A.push(_)})}else switch(r!==void 0&&A.push(E.get(r)),t){case"add":Et(e)?Au(r)&&A.push(E.get("length")):(A.push(E.get(Hn)),oi(e)&&A.push(E.get(Uo)));break;case"delete":Et(e)||(A.push(E.get(Hn)),oi(e)&&A.push(E.get(Uo)));break;case"set":oi(e)&&A.push(E.get(Hn));break}if(A.length===1)A[0]&&Ho(A[0]);else{const y=[];for(const _ of A)_&&y.push(..._);Ho(_u(y))}}function Ho(e,t){const r=Et(e)?e:[...e];for(const n of r)n.computed&&$c(n);for(const n of r)n.computed||$c(n)}function $c(e,t){(e!==Nr||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Og=pu("__proto__,__v_isRef,__isVue"),Fh=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(yu)),xg=Iu(),kg=Iu(!1,!0),Pg=Iu(!0),Qc=wg();function wg(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=Pt(this);for(let f=0,E=this.length;f<E;f++)vr(n,"get",f+"");const a=n[t](...r);return a===-1||a===!1?n[t](...r.map(Pt)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){yi();const n=Pt(this)[t].apply(this,r);return Ai(),n}}),e}function Iu(e=!1,t=!1){return function(n,a,f){if(a==="__v_isReactive")return!e;if(a==="__v_isReadonly")return e;if(a==="__v_isShallow")return t;if(a==="__v_raw"&&f===(e?t?zg:Kh:t?Gh:Hh).get(n))return n;const E=Et(n);if(!e&&E&&Nt(Qc,a))return Reflect.get(Qc,a,f);const A=Reflect.get(n,a,f);return(yu(a)?Fh.has(a):Og(a))||(e||vr(n,"get",a),t)?A:sr(A)?E&&Au(a)?A:A.value:Yt(A)?e?Yh(A):ls(A):A}}const Mg=Bh(),Fg=Bh(!0);function Bh(e=!1){return function(r,n,a,f){let E=r[n];if(di(E)&&sr(E)&&!sr(a))return!1;if(!e&&(!Ws(a)&&!di(a)&&(E=Pt(E),a=Pt(a)),!Et(r)&&sr(E)&&!sr(a)))return E.value=a,!0;const A=Et(r)&&Au(n)?Number(n)<r.length:Nt(r,n),y=Reflect.set(r,n,a,f);return r===Pt(f)&&(A?Zi(a,E)&&on(r,"set",n,a):on(r,"add",n,a)),y}}function Bg(e,t){const r=Nt(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&on(e,"delete",t,void 0),n}function Ug(e,t){const r=Reflect.has(e,t);return(!yu(t)||!Fh.has(t))&&vr(e,"has",t),r}function Hg(e){return vr(e,"iterate",Et(e)?"length":Hn),Reflect.ownKeys(e)}const Uh={get:xg,set:Mg,deleteProperty:Bg,has:Ug,ownKeys:Hg},Gg={get:Pg,set(e,t){return!0},deleteProperty(e,t){return!0}},Kg=ur({},Uh,{get:kg,set:Fg}),Cu=e=>e,fa=e=>Reflect.getPrototypeOf(e);function Ss(e,t,r=!1,n=!1){e=e.__v_raw;const a=Pt(e),f=Pt(t);r||(t!==f&&vr(a,"get",t),vr(a,"get",f));const{has:E}=fa(a),A=n?Cu:r?Du:es;if(E.call(a,t))return A(e.get(t));if(E.call(a,f))return A(e.get(f));e!==a&&e.get(t)}function Is(e,t=!1){const r=this.__v_raw,n=Pt(r),a=Pt(e);return t||(e!==a&&vr(n,"has",e),vr(n,"has",a)),e===a?r.has(e):r.has(e)||r.has(a)}function Cs(e,t=!1){return e=e.__v_raw,!t&&vr(Pt(e),"iterate",Hn),Reflect.get(e,"size",e)}function zc(e){e=Pt(e);const t=Pt(this);return fa(t).has.call(t,e)||(t.add(e),on(t,"add",e,e)),this}function Jc(e,t){t=Pt(t);const r=Pt(this),{has:n,get:a}=fa(r);let f=n.call(r,e);f||(e=Pt(e),f=n.call(r,e));const E=a.call(r,e);return r.set(e,t),f?Zi(t,E)&&on(r,"set",e,t):on(r,"add",e,t),this}function Zc(e){const t=Pt(this),{has:r,get:n}=fa(t);let a=r.call(t,e);a||(e=Pt(e),a=r.call(t,e)),n&&n.call(t,e);const f=t.delete(e);return a&&on(t,"delete",e,void 0),f}function el(){const e=Pt(this),t=e.size!==0,r=e.clear();return t&&on(e,"clear",void 0,void 0),r}function Ls(e,t){return function(n,a){const f=this,E=f.__v_raw,A=Pt(E),y=t?Cu:e?Du:es;return!e&&vr(A,"iterate",Hn),E.forEach((_,I)=>n.call(a,y(_),y(I),f))}}function Rs(e,t,r){return function(...n){const a=this.__v_raw,f=Pt(a),E=oi(f),A=e==="entries"||e===Symbol.iterator&&E,y=e==="keys"&&E,_=a[e](...n),I=r?Cu:t?Du:es;return!t&&vr(f,"iterate",y?Uo:Hn),{next(){const{value:C,done:b}=_.next();return b?{value:C,done:b}:{value:A?[I(C[0]),I(C[1])]:I(C),done:b}},[Symbol.iterator](){return this}}}}function fn(e){return function(...t){return e==="delete"?!1:this}}function Yg(){const e={get(f){return Ss(this,f)},get size(){return Cs(this)},has:Is,add:zc,set:Jc,delete:Zc,clear:el,forEach:Ls(!1,!1)},t={get(f){return Ss(this,f,!1,!0)},get size(){return Cs(this)},has:Is,add:zc,set:Jc,delete:Zc,clear:el,forEach:Ls(!1,!0)},r={get(f){return Ss(this,f,!0)},get size(){return Cs(this,!0)},has(f){return Is.call(this,f,!0)},add:fn("add"),set:fn("set"),delete:fn("delete"),clear:fn("clear"),forEach:Ls(!0,!1)},n={get(f){return Ss(this,f,!0,!0)},get size(){return Cs(this,!0)},has(f){return Is.call(this,f,!0)},add:fn("add"),set:fn("set"),delete:fn("delete"),clear:fn("clear"),forEach:Ls(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(f=>{e[f]=Rs(f,!1,!1),r[f]=Rs(f,!0,!1),t[f]=Rs(f,!1,!0),n[f]=Rs(f,!0,!0)}),[e,r,t,n]}const[jg,Vg,qg,Wg]=Yg();function Lu(e,t){const r=t?e?Wg:qg:e?Vg:jg;return(n,a,f)=>a==="__v_isReactive"?!e:a==="__v_isReadonly"?e:a==="__v_raw"?n:Reflect.get(Nt(r,a)&&a in n?r:n,a,f)}const Xg={get:Lu(!1,!1)},$g={get:Lu(!1,!0)},Qg={get:Lu(!0,!1)},Hh=new WeakMap,Gh=new WeakMap,Kh=new WeakMap,zg=new WeakMap;function Jg(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Zg(e){return e.__v_skip||!Object.isExtensible(e)?0:Jg(_g(e))}function ls(e){return di(e)?e:Ru(e,!1,Uh,Xg,Hh)}function em(e){return Ru(e,!1,Kg,$g,Gh)}function Yh(e){return Ru(e,!0,Gg,Qg,Kh)}function Ru(e,t,r,n,a){if(!Yt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const f=a.get(e);if(f)return f;const E=Zg(e);if(E===0)return e;const A=new Proxy(e,E===2?n:r);return a.set(e,A),A}function ui(e){return di(e)?ui(e.__v_raw):!!(e&&e.__v_isReactive)}function di(e){return!!(e&&e.__v_isReadonly)}function Ws(e){return!!(e&&e.__v_isShallow)}function jh(e){return ui(e)||di(e)}function Pt(e){const t=e&&e.__v_raw;return t?Pt(t):e}function Vh(e){return Vs(e,"__v_skip",!0),e}const es=e=>Yt(e)?ls(e):e,Du=e=>Yt(e)?Yh(e):e;function qh(e){Tn&&Nr&&(e=Pt(e),Mh(e.dep||(e.dep=_u())))}function Wh(e,t){e=Pt(e),e.dep&&Ho(e.dep)}function sr(e){return!!(e&&e.__v_isRef===!0)}function tm(e){return Xh(e,!1)}function rm(e){return Xh(e,!0)}function Xh(e,t){return sr(e)?e:new nm(e,t)}class nm{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:Pt(t),this._value=r?t:es(t)}get value(){return qh(this),this._value}set value(t){const r=this.__v_isShallow||Ws(t)||di(t);t=r?t:Pt(t),Zi(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:es(t),Wh(this))}}function ci(e){return sr(e)?e.value:e}const im={get:(e,t,r)=>ci(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const a=e[t];return sr(a)&&!sr(r)?(a.value=r,!0):Reflect.set(e,t,r,n)}};function $h(e){return ui(e)?e:new Proxy(e,im)}var Qh;class sm{constructor(t,r,n,a){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[Qh]=!1,this._dirty=!0,this.effect=new Su(t,()=>{this._dirty||(this._dirty=!0,Wh(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this.__v_isReadonly=n}get value(){const t=Pt(this);return qh(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Qh="__v_isReadonly";function am(e,t,r=!1){let n,a;const f=At(e);return f?(n=e,a=xr):(n=e.get,a=e.set),new sm(n,a,f||!a,r)}function vn(e,t,r,n){let a;try{a=n?e(...n):e()}catch(f){da(f,t,r)}return a}function kr(e,t,r,n){if(At(e)){const f=vn(e,t,r,n);return f&&Nh(f)&&f.catch(E=>{da(E,t,r)}),f}const a=[];for(let f=0;f<e.length;f++)a.push(kr(e[f],t,r,n));return a}function da(e,t,r,n=!0){const a=t?t.vnode:null;if(t){let f=t.parent;const E=t.proxy,A=r;for(;f;){const _=f.ec;if(_){for(let I=0;I<_.length;I++)if(_[I](e,E,A)===!1)return}f=f.parent}const y=t.appContext.config.errorHandler;if(y){vn(y,null,10,[e,E,A]);return}}om(e,r,a,n)}function om(e,t,r,n=!0){console.error(e)}let ts=!1,Go=!1;const ir=[];let Yr=0;const li=[];let rn=null,kn=0;const zh=Promise.resolve();let Nu=null;function Jh(e){const t=Nu||zh;return e?t.then(this?e.bind(this):e):t}function um(e){let t=Yr+1,r=ir.length;for(;t<r;){const n=t+r>>>1;rs(ir[n])<e?t=n+1:r=n}return t}function Ou(e){(!ir.length||!ir.includes(e,ts&&e.allowRecurse?Yr+1:Yr))&&(e.id==null?ir.push(e):ir.splice(um(e.id),0,e),Zh())}function Zh(){!ts&&!Go&&(Go=!0,Nu=zh.then(tf))}function cm(e){const t=ir.indexOf(e);t>Yr&&ir.splice(t,1)}function lm(e){Et(e)?li.push(...e):(!rn||!rn.includes(e,e.allowRecurse?kn+1:kn))&&li.push(e),Zh()}function tl(e,t=ts?Yr+1:0){for(;t<ir.length;t++){const r=ir[t];r&&r.pre&&(ir.splice(t,1),t--,r())}}function ef(e){if(li.length){const t=[...new Set(li)];if(li.length=0,rn){rn.push(...t);return}for(rn=t,rn.sort((r,n)=>rs(r)-rs(n)),kn=0;kn<rn.length;kn++)rn[kn]();rn=null,kn=0}}const rs=e=>e.id==null?1/0:e.id,hm=(e,t)=>{const r=rs(e)-rs(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function tf(e){Go=!1,ts=!0,ir.sort(hm);const t=xr;try{for(Yr=0;Yr<ir.length;Yr++){const r=ir[Yr];r&&r.active!==!1&&vn(r,null,14)}}finally{Yr=0,ir.length=0,ef(),ts=!1,Nu=null,(ir.length||li.length)&&tf()}}function fm(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Ut;let a=r;const f=t.startsWith("update:"),E=f&&t.slice(7);if(E&&E in n){const I=`${E==="modelValue"?"model":E}Modifiers`,{number:C,trim:b}=n[I]||Ut;b&&(a=r.map(L=>Zt(L)?L.trim():L)),C&&(a=r.map(qs))}let A,y=n[A=Eo(t)]||n[A=Eo(Xr(t))];!y&&f&&(y=n[A=Eo(bi(t))]),y&&kr(y,e,6,a);const _=n[A+"Once"];if(_){if(!e.emitted)e.emitted={};else if(e.emitted[A])return;e.emitted[A]=!0,kr(_,e,6,a)}}function rf(e,t,r=!1){const n=t.emitsCache,a=n.get(e);if(a!==void 0)return a;const f=e.emits;let E={},A=!1;if(!At(e)){const y=_=>{const I=rf(_,t,!0);I&&(A=!0,ur(E,I))};!r&&t.mixins.length&&t.mixins.forEach(y),e.extends&&y(e.extends),e.mixins&&e.mixins.forEach(y)}return!f&&!A?(Yt(e)&&n.set(e,null),null):(Et(f)?f.forEach(y=>E[y]=null):ur(E,f),Yt(e)&&n.set(e,E),E)}function ga(e,t){return!e||!ua(t)?!1:(t=t.slice(2).replace(/Once$/,""),Nt(e,t[0].toLowerCase()+t.slice(1))||Nt(e,bi(t))||Nt(e,t))}let _r=null,nf=null;function Xs(e){const t=_r;return _r=e,nf=e&&e.type.__scopeId||null,t}function dm(e,t=_r,r){if(!t||e._n)return e;const n=(...a)=>{n._d&&ll(-1);const f=Xs(t);let E;try{E=e(...a)}finally{Xs(f),n._d&&ll(1)}return E};return n._n=!0,n._c=!0,n._d=!0,n}function To(e){const{type:t,vnode:r,proxy:n,withProxy:a,props:f,propsOptions:[E],slots:A,attrs:y,emit:_,render:I,renderCache:C,data:b,setupState:L,ctx:O,inheritAttrs:oe}=e;let z,ee;const le=Xs(e);try{if(r.shapeFlag&4){const fe=a||n;z=Kr(I.call(fe,fe,C,f,L,b,O)),ee=y}else{const fe=t;z=Kr(fe.length>1?fe(f,{attrs:y,slots:A,emit:_}):fe(f,null)),ee=t.props?y:gm(y)}}catch(fe){Ki.length=0,da(fe,e,1),z=pr(Kn)}let $=z;if(ee&&oe!==!1){const fe=Object.keys(ee),{shapeFlag:ue}=$;fe.length&&ue&7&&(E&&fe.some(vu)&&(ee=mm(ee,E)),$=gi($,ee))}return r.dirs&&($=gi($),$.dirs=$.dirs?$.dirs.concat(r.dirs):r.dirs),r.transition&&($.transition=r.transition),z=$,Xs(le),z}const gm=e=>{let t;for(const r in e)(r==="class"||r==="style"||ua(r))&&((t||(t={}))[r]=e[r]);return t},mm=(e,t)=>{const r={};for(const n in e)(!vu(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function pm(e,t,r){const{props:n,children:a,component:f}=e,{props:E,children:A,patchFlag:y}=t,_=f.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&y>=0){if(y&1024)return!0;if(y&16)return n?rl(n,E,_):!!E;if(y&8){const I=t.dynamicProps;for(let C=0;C<I.length;C++){const b=I[C];if(E[b]!==n[b]&&!ga(_,b))return!0}}}else return(a||A)&&(!A||!A.$stable)?!0:n===E?!1:n?E?rl(n,E,_):!0:!!E;return!1}function rl(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let a=0;a<n.length;a++){const f=n[a];if(t[f]!==e[f]&&!ga(r,f))return!0}return!1}function Em({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const Tm=e=>e.__isSuspense;function vm(e,t){t&&t.pendingBranch?Et(e)?t.effects.push(...e):t.effects.push(e):lm(e)}function Bs(e,t){if(rr){let r=rr.provides;const n=rr.parent&&rr.parent.provides;n===r&&(r=rr.provides=Object.create(n)),r[e]=t}}function sn(e,t,r=!1){const n=rr||_r;if(n){const a=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(a&&e in a)return a[e];if(arguments.length>1)return r&&At(t)?t.call(n.proxy):t}}const Ds={};function Us(e,t,r){return sf(e,t,r)}function sf(e,t,{immediate:r,deep:n,flush:a,onTrack:f,onTrigger:E}=Ut){const A=rr;let y,_=!1,I=!1;if(sr(e)?(y=()=>e.value,_=Ws(e)):ui(e)?(y=()=>e,n=!0):Et(e)?(I=!0,_=e.some($=>ui($)||Ws($)),y=()=>e.map($=>{if(sr($))return $.value;if(ui($))return Bn($);if(At($))return vn($,A,2)})):At(e)?t?y=()=>vn(e,A,2):y=()=>{if(!(A&&A.isUnmounted))return C&&C(),kr(e,A,3,[b])}:y=xr,t&&n){const $=y;y=()=>Bn($())}let C,b=$=>{C=ee.onStop=()=>{vn($,A,4)}},L;if(is)if(b=xr,t?r&&kr(t,A,3,[y(),I?[]:void 0,b]):y(),a==="sync"){const $=mp();L=$.__watcherHandles||($.__watcherHandles=[])}else return xr;let O=I?new Array(e.length).fill(Ds):Ds;const oe=()=>{if(ee.active)if(t){const $=ee.run();(n||_||(I?$.some((fe,ue)=>Zi(fe,O[ue])):Zi($,O)))&&(C&&C(),kr(t,A,3,[$,O===Ds?void 0:I&&O[0]===Ds?[]:O,b]),O=$)}else ee.run()};oe.allowRecurse=!!t;let z;a==="sync"?z=oe:a==="post"?z=()=>fr(oe,A&&A.suspense):(oe.pre=!0,A&&(oe.id=A.uid),z=()=>Ou(oe));const ee=new Su(y,z);t?r?oe():O=ee.run():a==="post"?fr(ee.run.bind(ee),A&&A.suspense):ee.run();const le=()=>{ee.stop(),A&&A.scope&&bu(A.scope.effects,ee)};return L&&L.push(le),le}function bm(e,t,r){const n=this.proxy,a=Zt(e)?e.includes(".")?af(n,e):()=>n[e]:e.bind(n,n);let f;At(t)?f=t:(f=t.handler,r=t);const E=rr;mi(this);const A=sf(a,f.bind(n),r);return E?mi(E):Gn(),A}function af(e,t){const r=t.split(".");return()=>{let n=e;for(let a=0;a<r.length&&n;a++)n=n[r[a]];return n}}function Bn(e,t){if(!Yt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),sr(e))Bn(e.value,t);else if(Et(e))for(let r=0;r<e.length;r++)Bn(e[r],t);else if(Dh(e)||oi(e))e.forEach(r=>{Bn(r,t)});else if(xh(e))for(const r in e)Bn(e[r],t);return e}function of(e){return At(e)?{setup:e,name:e.name}:e}const Hs=e=>!!e.type.__asyncLoader,uf=e=>e.type.__isKeepAlive;function ym(e,t){cf(e,"a",t)}function Am(e,t){cf(e,"da",t)}function cf(e,t,r=rr){const n=e.__wdc||(e.__wdc=()=>{let a=r;for(;a;){if(a.isDeactivated)return;a=a.parent}return e()});if(ma(t,n,r),r){let a=r.parent;for(;a&&a.parent;)uf(a.parent.vnode)&&_m(n,t,r,a),a=a.parent}}function _m(e,t,r,n){const a=ma(t,e,n,!0);lf(()=>{bu(n[t],a)},r)}function ma(e,t,r=rr,n=!1){if(r){const a=r[e]||(r[e]=[]),f=t.__weh||(t.__weh=(...E)=>{if(r.isUnmounted)return;yi(),mi(r);const A=kr(t,r,e,E);return Gn(),Ai(),A});return n?a.unshift(f):a.push(f),f}}const cn=e=>(t,r=rr)=>(!is||e==="sp")&&ma(e,(...n)=>t(...n),r),Sm=cn("bm"),Im=cn("m"),Cm=cn("bu"),Lm=cn("u"),Rm=cn("bum"),lf=cn("um"),Dm=cn("sp"),Nm=cn("rtg"),Om=cn("rtc");function xm(e,t=rr){ma("ec",e,t)}function F_(e,t){const r=_r;if(r===null)return e;const n=Ta(r)||r.proxy,a=e.dirs||(e.dirs=[]);for(let f=0;f<t.length;f++){let[E,A,y,_=Ut]=t[f];E&&(At(E)&&(E={mounted:E,updated:E}),E.deep&&Bn(A),a.push({dir:E,instance:n,value:A,oldValue:void 0,arg:y,modifiers:_}))}return e}function Dn(e,t,r,n){const a=e.dirs,f=t&&t.dirs;for(let E=0;E<a.length;E++){const A=a[E];f&&(A.oldValue=f[E].value);let y=A.dir[n];y&&(yi(),kr(y,r,8,[e.el,A,e,t]),Ai())}}const hf="components",km="directives";function B_(e,t){return ff(hf,e,!0,t)||e}const Pm=Symbol();function U_(e){return ff(km,e)}function ff(e,t,r=!0,n=!1){const a=_r||rr;if(a){const f=a.type;if(e===hf){const A=fp(f,!1);if(A&&(A===t||A===Xr(t)||A===ha(Xr(t))))return f}const E=nl(a[e]||f[e],t)||nl(a.appContext[e],t);return!E&&n?f:E}}function nl(e,t){return e&&(e[t]||e[Xr(t)]||e[ha(Xr(t))])}function H_(e,t,r,n){let a;const f=r&&r[n];if(Et(e)||Zt(e)){a=new Array(e.length);for(let E=0,A=e.length;E<A;E++)a[E]=t(e[E],E,void 0,f&&f[E])}else if(typeof e=="number"){a=new Array(e);for(let E=0;E<e;E++)a[E]=t(E+1,E,void 0,f&&f[E])}else if(Yt(e))if(e[Symbol.iterator])a=Array.from(e,(E,A)=>t(E,A,void 0,f&&f[A]));else{const E=Object.keys(e);a=new Array(E.length);for(let A=0,y=E.length;A<y;A++){const _=E[A];a[A]=t(e[_],_,A,f&&f[A])}}else a=[];return r&&(r[n]=a),a}const Ko=e=>e?Sf(e)?Ta(e)||e.proxy:Ko(e.parent):null,Gi=ur(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ko(e.parent),$root:e=>Ko(e.root),$emit:e=>e.emit,$options:e=>xu(e),$forceUpdate:e=>e.f||(e.f=()=>Ou(e.update)),$nextTick:e=>e.n||(e.n=Jh.bind(e.proxy)),$watch:e=>bm.bind(e)}),vo=(e,t)=>e!==Ut&&!e.__isScriptSetup&&Nt(e,t),wm={get({_:e},t){const{ctx:r,setupState:n,data:a,props:f,accessCache:E,type:A,appContext:y}=e;let _;if(t[0]!=="$"){const L=E[t];if(L!==void 0)switch(L){case 1:return n[t];case 2:return a[t];case 4:return r[t];case 3:return f[t]}else{if(vo(n,t))return E[t]=1,n[t];if(a!==Ut&&Nt(a,t))return E[t]=2,a[t];if((_=e.propsOptions[0])&&Nt(_,t))return E[t]=3,f[t];if(r!==Ut&&Nt(r,t))return E[t]=4,r[t];Yo&&(E[t]=0)}}const I=Gi[t];let C,b;if(I)return t==="$attrs"&&vr(e,"get",t),I(e);if((C=A.__cssModules)&&(C=C[t]))return C;if(r!==Ut&&Nt(r,t))return E[t]=4,r[t];if(b=y.config.globalProperties,Nt(b,t))return b[t]},set({_:e},t,r){const{data:n,setupState:a,ctx:f}=e;return vo(a,t)?(a[t]=r,!0):n!==Ut&&Nt(n,t)?(n[t]=r,!0):Nt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(f[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:a,propsOptions:f}},E){let A;return!!r[E]||e!==Ut&&Nt(e,E)||vo(t,E)||(A=f[0])&&Nt(A,E)||Nt(n,E)||Nt(Gi,E)||Nt(a.config.globalProperties,E)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Nt(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let Yo=!0;function Mm(e){const t=xu(e),r=e.proxy,n=e.ctx;Yo=!1,t.beforeCreate&&il(t.beforeCreate,e,"bc");const{data:a,computed:f,methods:E,watch:A,provide:y,inject:_,created:I,beforeMount:C,mounted:b,beforeUpdate:L,updated:O,activated:oe,deactivated:z,beforeDestroy:ee,beforeUnmount:le,destroyed:$,unmounted:fe,render:ue,renderTracked:se,renderTriggered:re,errorCaptured:Ne,serverPrefetch:Pe,expose:Ze,inheritAttrs:ce,components:P,directives:Q,filters:U}=t;if(_&&Fm(_,n,null,e.appContext.config.unwrapInjectedRef),E)for(const ve in E){const Ee=E[ve];At(Ee)&&(n[ve]=Ee.bind(r))}if(a){const ve=a.call(r,r);Yt(ve)&&(e.data=ls(ve))}if(Yo=!0,f)for(const ve in f){const Ee=f[ve],We=At(Ee)?Ee.bind(r,r):At(Ee.get)?Ee.get.bind(r,r):xr,Je=!At(Ee)&&At(Ee.set)?Ee.set.bind(r):xr,$e=Ar({get:We,set:Je});Object.defineProperty(n,ve,{enumerable:!0,configurable:!0,get:()=>$e.value,set:je=>$e.value=je})}if(A)for(const ve in A)df(A[ve],n,r,ve);if(y){const ve=At(y)?y.call(r):y;Reflect.ownKeys(ve).forEach(Ee=>{Bs(Ee,ve[Ee])})}I&&il(I,e,"c");function Le(ve,Ee){Et(Ee)?Ee.forEach(We=>ve(We.bind(r))):Ee&&ve(Ee.bind(r))}if(Le(Sm,C),Le(Im,b),Le(Cm,L),Le(Lm,O),Le(ym,oe),Le(Am,z),Le(xm,Ne),Le(Om,se),Le(Nm,re),Le(Rm,le),Le(lf,fe),Le(Dm,Pe),Et(Ze))if(Ze.length){const ve=e.exposed||(e.exposed={});Ze.forEach(Ee=>{Object.defineProperty(ve,Ee,{get:()=>r[Ee],set:We=>r[Ee]=We})})}else e.exposed||(e.exposed={});ue&&e.render===xr&&(e.render=ue),ce!=null&&(e.inheritAttrs=ce),P&&(e.components=P),Q&&(e.directives=Q)}function Fm(e,t,r=xr,n=!1){Et(e)&&(e=jo(e));for(const a in e){const f=e[a];let E;Yt(f)?"default"in f?E=sn(f.from||a,f.default,!0):E=sn(f.from||a):E=sn(f),sr(E)&&n?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>E.value,set:A=>E.value=A}):t[a]=E}}function il(e,t,r){kr(Et(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function df(e,t,r,n){const a=n.includes(".")?af(r,n):()=>r[n];if(Zt(e)){const f=t[e];At(f)&&Us(a,f)}else if(At(e))Us(a,e.bind(r));else if(Yt(e))if(Et(e))e.forEach(f=>df(f,t,r,n));else{const f=At(e.handler)?e.handler.bind(r):t[e.handler];At(f)&&Us(a,f,e)}}function xu(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:a,optionsCache:f,config:{optionMergeStrategies:E}}=e.appContext,A=f.get(t);let y;return A?y=A:!a.length&&!r&&!n?y=t:(y={},a.length&&a.forEach(_=>$s(y,_,E,!0)),$s(y,t,E)),Yt(t)&&f.set(t,y),y}function $s(e,t,r,n=!1){const{mixins:a,extends:f}=t;f&&$s(e,f,r,!0),a&&a.forEach(E=>$s(e,E,r,!0));for(const E in t)if(!(n&&E==="expose")){const A=Bm[E]||r&&r[E];e[E]=A?A(e[E],t[E]):t[E]}return e}const Bm={data:sl,props:xn,emits:xn,methods:xn,computed:xn,beforeCreate:or,created:or,beforeMount:or,mounted:or,beforeUpdate:or,updated:or,beforeDestroy:or,beforeUnmount:or,destroyed:or,unmounted:or,activated:or,deactivated:or,errorCaptured:or,serverPrefetch:or,components:xn,directives:xn,watch:Hm,provide:sl,inject:Um};function sl(e,t){return t?e?function(){return ur(At(e)?e.call(this,this):e,At(t)?t.call(this,this):t)}:t:e}function Um(e,t){return xn(jo(e),jo(t))}function jo(e){if(Et(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function or(e,t){return e?[...new Set([].concat(e,t))]:t}function xn(e,t){return e?ur(ur(Object.create(null),e),t):t}function Hm(e,t){if(!e)return t;if(!t)return e;const r=ur(Object.create(null),e);for(const n in t)r[n]=or(e[n],t[n]);return r}function Gm(e,t,r,n=!1){const a={},f={};Vs(f,Ea,1),e.propsDefaults=Object.create(null),gf(e,t,a,f);for(const E in e.propsOptions[0])E in a||(a[E]=void 0);r?e.props=n?a:em(a):e.type.props?e.props=a:e.props=f,e.attrs=f}function Km(e,t,r,n){const{props:a,attrs:f,vnode:{patchFlag:E}}=e,A=Pt(a),[y]=e.propsOptions;let _=!1;if((n||E>0)&&!(E&16)){if(E&8){const I=e.vnode.dynamicProps;for(let C=0;C<I.length;C++){let b=I[C];if(ga(e.emitsOptions,b))continue;const L=t[b];if(y)if(Nt(f,b))L!==f[b]&&(f[b]=L,_=!0);else{const O=Xr(b);a[O]=Vo(y,A,O,L,e,!1)}else L!==f[b]&&(f[b]=L,_=!0)}}}else{gf(e,t,a,f)&&(_=!0);let I;for(const C in A)(!t||!Nt(t,C)&&((I=bi(C))===C||!Nt(t,I)))&&(y?r&&(r[C]!==void 0||r[I]!==void 0)&&(a[C]=Vo(y,A,C,void 0,e,!0)):delete a[C]);if(f!==A)for(const C in f)(!t||!Nt(t,C))&&(delete f[C],_=!0)}_&&on(e,"set","$attrs")}function gf(e,t,r,n){const[a,f]=e.propsOptions;let E=!1,A;if(t)for(let y in t){if(Ms(y))continue;const _=t[y];let I;a&&Nt(a,I=Xr(y))?!f||!f.includes(I)?r[I]=_:(A||(A={}))[I]=_:ga(e.emitsOptions,y)||(!(y in n)||_!==n[y])&&(n[y]=_,E=!0)}if(f){const y=Pt(r),_=A||Ut;for(let I=0;I<f.length;I++){const C=f[I];r[C]=Vo(a,y,C,_[C],e,!Nt(_,C))}}return E}function Vo(e,t,r,n,a,f){const E=e[r];if(E!=null){const A=Nt(E,"default");if(A&&n===void 0){const y=E.default;if(E.type!==Function&&At(y)){const{propsDefaults:_}=a;r in _?n=_[r]:(mi(a),n=_[r]=y.call(null,t),Gn())}else n=y}E[0]&&(f&&!A?n=!1:E[1]&&(n===""||n===bi(r))&&(n=!0))}return n}function mf(e,t,r=!1){const n=t.propsCache,a=n.get(e);if(a)return a;const f=e.props,E={},A=[];let y=!1;if(!At(e)){const I=C=>{y=!0;const[b,L]=mf(C,t,!0);ur(E,b),L&&A.push(...L)};!r&&t.mixins.length&&t.mixins.forEach(I),e.extends&&I(e.extends),e.mixins&&e.mixins.forEach(I)}if(!f&&!y)return Yt(e)&&n.set(e,ai),ai;if(Et(f))for(let I=0;I<f.length;I++){const C=Xr(f[I]);al(C)&&(E[C]=Ut)}else if(f)for(const I in f){const C=Xr(I);if(al(C)){const b=f[I],L=E[C]=Et(b)||At(b)?{type:b}:Object.assign({},b);if(L){const O=cl(Boolean,L.type),oe=cl(String,L.type);L[0]=O>-1,L[1]=oe<0||O<oe,(O>-1||Nt(L,"default"))&&A.push(C)}}}const _=[E,A];return Yt(e)&&n.set(e,_),_}function al(e){return e[0]!=="$"}function ol(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function ul(e,t){return ol(e)===ol(t)}function cl(e,t){return Et(t)?t.findIndex(r=>ul(r,e)):At(t)&&ul(t,e)?0:-1}const pf=e=>e[0]==="_"||e==="$stable",ku=e=>Et(e)?e.map(Kr):[Kr(e)],Ym=(e,t,r)=>{if(t._n)return t;const n=dm((...a)=>ku(t(...a)),r);return n._c=!1,n},Ef=(e,t,r)=>{const n=e._ctx;for(const a in e){if(pf(a))continue;const f=e[a];if(At(f))t[a]=Ym(a,f,n);else if(f!=null){const E=ku(f);t[a]=()=>E}}},Tf=(e,t)=>{const r=ku(t);e.slots.default=()=>r},jm=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=Pt(t),Vs(t,"_",r)):Ef(t,e.slots={})}else e.slots={},t&&Tf(e,t);Vs(e.slots,Ea,1)},Vm=(e,t,r)=>{const{vnode:n,slots:a}=e;let f=!0,E=Ut;if(n.shapeFlag&32){const A=t._;A?r&&A===1?f=!1:(ur(a,t),!r&&A===1&&delete a._):(f=!t.$stable,Ef(t,a)),E=t}else t&&(Tf(e,t),E={default:1});if(f)for(const A in a)!pf(A)&&!(A in E)&&delete a[A]};function vf(){return{app:null,config:{isNativeTag:bg,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let qm=0;function Wm(e,t){return function(n,a=null){At(n)||(n=Object.assign({},n)),a!=null&&!Yt(a)&&(a=null);const f=vf(),E=new Set;let A=!1;const y=f.app={_uid:qm++,_component:n,_props:a,_container:null,_context:f,_instance:null,version:pp,get config(){return f.config},set config(_){},use(_,...I){return E.has(_)||(_&&At(_.install)?(E.add(_),_.install(y,...I)):At(_)&&(E.add(_),_(y,...I))),y},mixin(_){return f.mixins.includes(_)||f.mixins.push(_),y},component(_,I){return I?(f.components[_]=I,y):f.components[_]},directive(_,I){return I?(f.directives[_]=I,y):f.directives[_]},mount(_,I,C){if(!A){const b=pr(n,a);return b.appContext=f,I&&t?t(b,_):e(b,_,C),A=!0,y._container=_,_.__vue_app__=y,Ta(b.component)||b.component.proxy}},unmount(){A&&(e(null,y._container),delete y._container.__vue_app__)},provide(_,I){return f.provides[_]=I,y}};return y}}function qo(e,t,r,n,a=!1){if(Et(e)){e.forEach((b,L)=>qo(b,t&&(Et(t)?t[L]:t),r,n,a));return}if(Hs(n)&&!a)return;const f=n.shapeFlag&4?Ta(n.component)||n.component.proxy:n.el,E=a?null:f,{i:A,r:y}=e,_=t&&t.r,I=A.refs===Ut?A.refs={}:A.refs,C=A.setupState;if(_!=null&&_!==y&&(Zt(_)?(I[_]=null,Nt(C,_)&&(C[_]=null)):sr(_)&&(_.value=null)),At(y))vn(y,A,12,[E,I]);else{const b=Zt(y),L=sr(y);if(b||L){const O=()=>{if(e.f){const oe=b?Nt(C,y)?C[y]:I[y]:y.value;a?Et(oe)&&bu(oe,f):Et(oe)?oe.includes(f)||oe.push(f):b?(I[y]=[f],Nt(C,y)&&(C[y]=I[y])):(y.value=[f],e.k&&(I[e.k]=y.value))}else b?(I[y]=E,Nt(C,y)&&(C[y]=E)):L&&(y.value=E,e.k&&(I[e.k]=E))};E?(O.id=-1,fr(O,r)):O()}}}const fr=vm;function Xm(e){return $m(e)}function $m(e,t){const r=Cg();r.__VUE__=!0;const{insert:n,remove:a,patchProp:f,createElement:E,createText:A,createComment:y,setText:_,setElementText:I,parentNode:C,nextSibling:b,setScopeId:L=xr,insertStaticContent:O}=e,oe=(N,x,j,ie=null,me=null,Oe=null,Fe=!1,we=null,Ue=!!x.dynamicChildren)=>{if(N===x)return;N&&!Pi(N,x)&&(ie=q(N),je(N,me,Oe,!0),N=null),x.patchFlag===-2&&(Ue=!1,x.dynamicChildren=null);const{type:Ce,ref:Qe,shapeFlag:He}=x;switch(Ce){case pa:z(N,x,j,ie);break;case Kn:ee(N,x,j,ie);break;case Gs:N==null&&le(x,j,ie,Fe);break;case nn:P(N,x,j,ie,me,Oe,Fe,we,Ue);break;default:He&1?ue(N,x,j,ie,me,Oe,Fe,we,Ue):He&6?Q(N,x,j,ie,me,Oe,Fe,we,Ue):(He&64||He&128)&&Ce.process(N,x,j,ie,me,Oe,Fe,we,Ue,Ae)}Qe!=null&&me&&qo(Qe,N&&N.ref,Oe,x||N,!x)},z=(N,x,j,ie)=>{if(N==null)n(x.el=A(x.children),j,ie);else{const me=x.el=N.el;x.children!==N.children&&_(me,x.children)}},ee=(N,x,j,ie)=>{N==null?n(x.el=y(x.children||""),j,ie):x.el=N.el},le=(N,x,j,ie)=>{[N.el,N.anchor]=O(N.children,x,j,ie,N.el,N.anchor)},$=({el:N,anchor:x},j,ie)=>{let me;for(;N&&N!==x;)me=b(N),n(N,j,ie),N=me;n(x,j,ie)},fe=({el:N,anchor:x})=>{let j;for(;N&&N!==x;)j=b(N),a(N),N=j;a(x)},ue=(N,x,j,ie,me,Oe,Fe,we,Ue)=>{Fe=Fe||x.type==="svg",N==null?se(x,j,ie,me,Oe,Fe,we,Ue):Pe(N,x,me,Oe,Fe,we,Ue)},se=(N,x,j,ie,me,Oe,Fe,we)=>{let Ue,Ce;const{type:Qe,props:He,shapeFlag:Ge,transition:et,dirs:nt}=N;if(Ue=N.el=E(N.type,Oe,He&&He.is,He),Ge&8?I(Ue,N.children):Ge&16&&Ne(N.children,Ue,null,ie,me,Oe&&Qe!=="foreignObject",Fe,we),nt&&Dn(N,null,ie,"created"),He){for(const ft in He)ft!=="value"&&!Ms(ft)&&f(Ue,ft,null,He[ft],Oe,N.children,ie,me,J);"value"in He&&f(Ue,"value",null,He.value),(Ce=He.onVnodeBeforeMount)&&Ur(Ce,ie,N)}re(Ue,N,N.scopeId,Fe,ie),nt&&Dn(N,null,ie,"beforeMount");const ht=(!me||me&&!me.pendingBranch)&&et&&!et.persisted;ht&&et.beforeEnter(Ue),n(Ue,x,j),((Ce=He&&He.onVnodeMounted)||ht||nt)&&fr(()=>{Ce&&Ur(Ce,ie,N),ht&&et.enter(Ue),nt&&Dn(N,null,ie,"mounted")},me)},re=(N,x,j,ie,me)=>{if(j&&L(N,j),ie)for(let Oe=0;Oe<ie.length;Oe++)L(N,ie[Oe]);if(me){let Oe=me.subTree;if(x===Oe){const Fe=me.vnode;re(N,Fe,Fe.scopeId,Fe.slotScopeIds,me.parent)}}},Ne=(N,x,j,ie,me,Oe,Fe,we,Ue=0)=>{for(let Ce=Ue;Ce<N.length;Ce++){const Qe=N[Ce]=we?pn(N[Ce]):Kr(N[Ce]);oe(null,Qe,x,j,ie,me,Oe,Fe,we)}},Pe=(N,x,j,ie,me,Oe,Fe)=>{const we=x.el=N.el;let{patchFlag:Ue,dynamicChildren:Ce,dirs:Qe}=x;Ue|=N.patchFlag&16;const He=N.props||Ut,Ge=x.props||Ut;let et;j&&Nn(j,!1),(et=Ge.onVnodeBeforeUpdate)&&Ur(et,j,x,N),Qe&&Dn(x,N,j,"beforeUpdate"),j&&Nn(j,!0);const nt=me&&x.type!=="foreignObject";if(Ce?Ze(N.dynamicChildren,Ce,we,j,ie,nt,Oe):Fe||Ee(N,x,we,null,j,ie,nt,Oe,!1),Ue>0){if(Ue&16)ce(we,x,He,Ge,j,ie,me);else if(Ue&2&&He.class!==Ge.class&&f(we,"class",null,Ge.class,me),Ue&4&&f(we,"style",He.style,Ge.style,me),Ue&8){const ht=x.dynamicProps;for(let ft=0;ft<ht.length;ft++){const Tt=ht[ft],Bt=He[Tt],ne=Ge[Tt];(ne!==Bt||Tt==="value")&&f(we,Tt,Bt,ne,me,N.children,j,ie,J)}}Ue&1&&N.children!==x.children&&I(we,x.children)}else!Fe&&Ce==null&&ce(we,x,He,Ge,j,ie,me);((et=Ge.onVnodeUpdated)||Qe)&&fr(()=>{et&&Ur(et,j,x,N),Qe&&Dn(x,N,j,"updated")},ie)},Ze=(N,x,j,ie,me,Oe,Fe)=>{for(let we=0;we<x.length;we++){const Ue=N[we],Ce=x[we],Qe=Ue.el&&(Ue.type===nn||!Pi(Ue,Ce)||Ue.shapeFlag&70)?C(Ue.el):j;oe(Ue,Ce,Qe,null,ie,me,Oe,Fe,!0)}},ce=(N,x,j,ie,me,Oe,Fe)=>{if(j!==ie){if(j!==Ut)for(const we in j)!Ms(we)&&!(we in ie)&&f(N,we,j[we],null,Fe,x.children,me,Oe,J);for(const we in ie){if(Ms(we))continue;const Ue=ie[we],Ce=j[we];Ue!==Ce&&we!=="value"&&f(N,we,Ce,Ue,Fe,x.children,me,Oe,J)}"value"in ie&&f(N,"value",j.value,ie.value)}},P=(N,x,j,ie,me,Oe,Fe,we,Ue)=>{const Ce=x.el=N?N.el:A(""),Qe=x.anchor=N?N.anchor:A("");let{patchFlag:He,dynamicChildren:Ge,slotScopeIds:et}=x;et&&(we=we?we.concat(et):et),N==null?(n(Ce,j,ie),n(Qe,j,ie),Ne(x.children,j,Qe,me,Oe,Fe,we,Ue)):He>0&&He&64&&Ge&&N.dynamicChildren?(Ze(N.dynamicChildren,Ge,j,me,Oe,Fe,we),(x.key!=null||me&&x===me.subTree)&&bf(N,x,!0)):Ee(N,x,j,Qe,me,Oe,Fe,we,Ue)},Q=(N,x,j,ie,me,Oe,Fe,we,Ue)=>{x.slotScopeIds=we,N==null?x.shapeFlag&512?me.ctx.activate(x,j,ie,Fe,Ue):U(x,j,ie,me,Oe,Fe,Ue):pe(N,x,Ue)},U=(N,x,j,ie,me,Oe,Fe)=>{const we=N.component=op(N,ie,me);if(uf(N)&&(we.ctx.renderer=Ae),up(we),we.asyncDep){if(me&&me.registerDep(we,Le),!N.el){const Ue=we.subTree=pr(Kn);ee(null,Ue,x,j)}return}Le(we,N,x,j,me,Oe,Fe)},pe=(N,x,j)=>{const ie=x.component=N.component;if(pm(N,x,j))if(ie.asyncDep&&!ie.asyncResolved){ve(ie,x,j);return}else ie.next=x,cm(ie.update),ie.update();else x.el=N.el,ie.vnode=x},Le=(N,x,j,ie,me,Oe,Fe)=>{const we=()=>{if(N.isMounted){let{next:Qe,bu:He,u:Ge,parent:et,vnode:nt}=N,ht=Qe,ft;Nn(N,!1),Qe?(Qe.el=nt.el,ve(N,Qe,Fe)):Qe=nt,He&&Fs(He),(ft=Qe.props&&Qe.props.onVnodeBeforeUpdate)&&Ur(ft,et,Qe,nt),Nn(N,!0);const Tt=To(N),Bt=N.subTree;N.subTree=Tt,oe(Bt,Tt,C(Bt.el),q(Bt),N,me,Oe),Qe.el=Tt.el,ht===null&&Em(N,Tt.el),Ge&&fr(Ge,me),(ft=Qe.props&&Qe.props.onVnodeUpdated)&&fr(()=>Ur(ft,et,Qe,nt),me)}else{let Qe;const{el:He,props:Ge}=x,{bm:et,m:nt,parent:ht}=N,ft=Hs(x);if(Nn(N,!1),et&&Fs(et),!ft&&(Qe=Ge&&Ge.onVnodeBeforeMount)&&Ur(Qe,ht,x),Nn(N,!0),He&&Ie){const Tt=()=>{N.subTree=To(N),Ie(He,N.subTree,N,me,null)};ft?x.type.__asyncLoader().then(()=>!N.isUnmounted&&Tt()):Tt()}else{const Tt=N.subTree=To(N);oe(null,Tt,j,ie,N,me,Oe),x.el=Tt.el}if(nt&&fr(nt,me),!ft&&(Qe=Ge&&Ge.onVnodeMounted)){const Tt=x;fr(()=>Ur(Qe,ht,Tt),me)}(x.shapeFlag&256||ht&&Hs(ht.vnode)&&ht.vnode.shapeFlag&256)&&N.a&&fr(N.a,me),N.isMounted=!0,x=j=ie=null}},Ue=N.effect=new Su(we,()=>Ou(Ce),N.scope),Ce=N.update=()=>Ue.run();Ce.id=N.uid,Nn(N,!0),Ce()},ve=(N,x,j)=>{x.component=N;const ie=N.vnode.props;N.vnode=x,N.next=null,Km(N,x.props,ie,j),Vm(N,x.children,j),yi(),tl(),Ai()},Ee=(N,x,j,ie,me,Oe,Fe,we,Ue=!1)=>{const Ce=N&&N.children,Qe=N?N.shapeFlag:0,He=x.children,{patchFlag:Ge,shapeFlag:et}=x;if(Ge>0){if(Ge&128){Je(Ce,He,j,ie,me,Oe,Fe,we,Ue);return}else if(Ge&256){We(Ce,He,j,ie,me,Oe,Fe,we,Ue);return}}et&8?(Qe&16&&J(Ce,me,Oe),He!==Ce&&I(j,He)):Qe&16?et&16?Je(Ce,He,j,ie,me,Oe,Fe,we,Ue):J(Ce,me,Oe,!0):(Qe&8&&I(j,""),et&16&&Ne(He,j,ie,me,Oe,Fe,we,Ue))},We=(N,x,j,ie,me,Oe,Fe,we,Ue)=>{N=N||ai,x=x||ai;const Ce=N.length,Qe=x.length,He=Math.min(Ce,Qe);let Ge;for(Ge=0;Ge<He;Ge++){const et=x[Ge]=Ue?pn(x[Ge]):Kr(x[Ge]);oe(N[Ge],et,j,null,me,Oe,Fe,we,Ue)}Ce>Qe?J(N,me,Oe,!0,!1,He):Ne(x,j,ie,me,Oe,Fe,we,Ue,He)},Je=(N,x,j,ie,me,Oe,Fe,we,Ue)=>{let Ce=0;const Qe=x.length;let He=N.length-1,Ge=Qe-1;for(;Ce<=He&&Ce<=Ge;){const et=N[Ce],nt=x[Ce]=Ue?pn(x[Ce]):Kr(x[Ce]);if(Pi(et,nt))oe(et,nt,j,null,me,Oe,Fe,we,Ue);else break;Ce++}for(;Ce<=He&&Ce<=Ge;){const et=N[He],nt=x[Ge]=Ue?pn(x[Ge]):Kr(x[Ge]);if(Pi(et,nt))oe(et,nt,j,null,me,Oe,Fe,we,Ue);else break;He--,Ge--}if(Ce>He){if(Ce<=Ge){const et=Ge+1,nt=et<Qe?x[et].el:ie;for(;Ce<=Ge;)oe(null,x[Ce]=Ue?pn(x[Ce]):Kr(x[Ce]),j,nt,me,Oe,Fe,we,Ue),Ce++}}else if(Ce>Ge)for(;Ce<=He;)je(N[Ce],me,Oe,!0),Ce++;else{const et=Ce,nt=Ce,ht=new Map;for(Ce=nt;Ce<=Ge;Ce++){const H=x[Ce]=Ue?pn(x[Ce]):Kr(x[Ce]);H.key!=null&&ht.set(H.key,Ce)}let ft,Tt=0;const Bt=Ge-nt+1;let ne=!1,W=0;const D=new Array(Bt);for(Ce=0;Ce<Bt;Ce++)D[Ce]=0;for(Ce=et;Ce<=He;Ce++){const H=N[Ce];if(Tt>=Bt){je(H,me,Oe,!0);continue}let X;if(H.key!=null)X=ht.get(H.key);else for(ft=nt;ft<=Ge;ft++)if(D[ft-nt]===0&&Pi(H,x[ft])){X=ft;break}X===void 0?je(H,me,Oe,!0):(D[X-nt]=Ce+1,X>=W?W=X:ne=!0,oe(H,x[X],j,null,me,Oe,Fe,we,Ue),Tt++)}const G=ne?Qm(D):ai;for(ft=G.length-1,Ce=Bt-1;Ce>=0;Ce--){const H=nt+Ce,X=x[H],te=H+1<Qe?x[H+1].el:ie;D[Ce]===0?oe(null,X,j,te,me,Oe,Fe,we,Ue):ne&&(ft<0||Ce!==G[ft]?$e(X,j,te,2):ft--)}}},$e=(N,x,j,ie,me=null)=>{const{el:Oe,type:Fe,transition:we,children:Ue,shapeFlag:Ce}=N;if(Ce&6){$e(N.component.subTree,x,j,ie);return}if(Ce&128){N.suspense.move(x,j,ie);return}if(Ce&64){Fe.move(N,x,j,Ae);return}if(Fe===nn){n(Oe,x,j);for(let He=0;He<Ue.length;He++)$e(Ue[He],x,j,ie);n(N.anchor,x,j);return}if(Fe===Gs){$(N,x,j);return}if(ie!==2&&Ce&1&&we)if(ie===0)we.beforeEnter(Oe),n(Oe,x,j),fr(()=>we.enter(Oe),me);else{const{leave:He,delayLeave:Ge,afterLeave:et}=we,nt=()=>n(Oe,x,j),ht=()=>{He(Oe,()=>{nt(),et&&et()})};Ge?Ge(Oe,nt,ht):ht()}else n(Oe,x,j)},je=(N,x,j,ie=!1,me=!1)=>{const{type:Oe,props:Fe,ref:we,children:Ue,dynamicChildren:Ce,shapeFlag:Qe,patchFlag:He,dirs:Ge}=N;if(we!=null&&qo(we,null,j,N,!0),Qe&256){x.ctx.deactivate(N);return}const et=Qe&1&&Ge,nt=!Hs(N);let ht;if(nt&&(ht=Fe&&Fe.onVnodeBeforeUnmount)&&Ur(ht,x,N),Qe&6)B(N.component,j,ie);else{if(Qe&128){N.suspense.unmount(j,ie);return}et&&Dn(N,null,x,"beforeUnmount"),Qe&64?N.type.remove(N,x,j,me,Ae,ie):Ce&&(Oe!==nn||He>0&&He&64)?J(Ce,x,j,!1,!0):(Oe===nn&&He&384||!me&&Qe&16)&&J(Ue,x,j),ie&&ct(N)}(nt&&(ht=Fe&&Fe.onVnodeUnmounted)||et)&&fr(()=>{ht&&Ur(ht,x,N),et&&Dn(N,null,x,"unmounted")},j)},ct=N=>{const{type:x,el:j,anchor:ie,transition:me}=N;if(x===nn){_t(j,ie);return}if(x===Gs){fe(N);return}const Oe=()=>{a(j),me&&!me.persisted&&me.afterLeave&&me.afterLeave()};if(N.shapeFlag&1&&me&&!me.persisted){const{leave:Fe,delayLeave:we}=me,Ue=()=>Fe(j,Oe);we?we(N.el,Oe,Ue):Ue()}else Oe()},_t=(N,x)=>{let j;for(;N!==x;)j=b(N),a(N),N=j;a(x)},B=(N,x,j)=>{const{bum:ie,scope:me,update:Oe,subTree:Fe,um:we}=N;ie&&Fs(ie),me.stop(),Oe&&(Oe.active=!1,je(Fe,N,x,j)),we&&fr(we,x),fr(()=>{N.isUnmounted=!0},x),x&&x.pendingBranch&&!x.isUnmounted&&N.asyncDep&&!N.asyncResolved&&N.suspenseId===x.pendingId&&(x.deps--,x.deps===0&&x.resolve())},J=(N,x,j,ie=!1,me=!1,Oe=0)=>{for(let Fe=Oe;Fe<N.length;Fe++)je(N[Fe],x,j,ie,me)},q=N=>N.shapeFlag&6?q(N.component.subTree):N.shapeFlag&128?N.suspense.next():b(N.anchor||N.el),ge=(N,x,j)=>{N==null?x._vnode&&je(x._vnode,null,null,!0):oe(x._vnode||null,N,x,null,null,null,j),tl(),ef(),x._vnode=N},Ae={p:oe,um:je,m:$e,r:ct,mt:U,mc:Ne,pc:Ee,pbc:Ze,n:q,o:e};let ke,Ie;return t&&([ke,Ie]=t(Ae)),{render:ge,hydrate:ke,createApp:Wm(ge,ke)}}function Nn({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function bf(e,t,r=!1){const n=e.children,a=t.children;if(Et(n)&&Et(a))for(let f=0;f<n.length;f++){const E=n[f];let A=a[f];A.shapeFlag&1&&!A.dynamicChildren&&((A.patchFlag<=0||A.patchFlag===32)&&(A=a[f]=pn(a[f]),A.el=E.el),r||bf(E,A)),A.type===pa&&(A.el=E.el)}}function Qm(e){const t=e.slice(),r=[0];let n,a,f,E,A;const y=e.length;for(n=0;n<y;n++){const _=e[n];if(_!==0){if(a=r[r.length-1],e[a]<_){t[n]=a,r.push(n);continue}for(f=0,E=r.length-1;f<E;)A=f+E>>1,e[r[A]]<_?f=A+1:E=A;_<e[r[f]]&&(f>0&&(t[n]=r[f-1]),r[f]=n)}}for(f=r.length,E=r[f-1];f-- >0;)r[f]=E,E=t[E];return r}const zm=e=>e.__isTeleport,nn=Symbol(void 0),pa=Symbol(void 0),Kn=Symbol(void 0),Gs=Symbol(void 0),Ki=[];let Or=null;function Jm(e=!1){Ki.push(Or=e?null:[])}function Zm(){Ki.pop(),Or=Ki[Ki.length-1]||null}let ns=1;function ll(e){ns+=e}function yf(e){return e.dynamicChildren=ns>0?Or||ai:null,Zm(),ns>0&&Or&&Or.push(e),e}function G_(e,t,r,n,a,f){return yf(_f(e,t,r,n,a,f,!0))}function ep(e,t,r,n,a){return yf(pr(e,t,r,n,a,!0))}function Wo(e){return e?e.__v_isVNode===!0:!1}function Pi(e,t){return e.type===t.type&&e.key===t.key}const Ea="__vInternal",Af=({key:e})=>e??null,Ks=({ref:e,ref_key:t,ref_for:r})=>e!=null?Zt(e)||sr(e)||At(e)?{i:_r,r:e,k:t,f:!!r}:e:null;function _f(e,t=null,r=null,n=0,a=null,f=e===nn?0:1,E=!1,A=!1){const y={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Af(t),ref:t&&Ks(t),scopeId:nf,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:f,patchFlag:n,dynamicProps:a,dynamicChildren:null,appContext:null,ctx:_r};return A?(Pu(y,r),f&128&&e.normalize(y)):r&&(y.shapeFlag|=Zt(r)?8:16),ns>0&&!E&&Or&&(y.patchFlag>0||f&6)&&y.patchFlag!==32&&Or.push(y),y}const pr=tp;function tp(e,t=null,r=null,n=0,a=null,f=!1){if((!e||e===Pm)&&(e=Kn),Wo(e)){const A=gi(e,t,!0);return r&&Pu(A,r),ns>0&&!f&&Or&&(A.shapeFlag&6?Or[Or.indexOf(e)]=A:Or.push(A)),A.patchFlag|=-2,A}if(dp(e)&&(e=e.__vccOpts),t){t=rp(t);let{class:A,style:y}=t;A&&!Zt(A)&&(t.class=Tu(A)),Yt(y)&&(jh(y)&&!Et(y)&&(y=ur({},y)),t.style=Eu(y))}const E=Zt(e)?1:Tm(e)?128:zm(e)?64:Yt(e)?4:At(e)?2:0;return _f(e,t,r,n,a,E,f,!0)}function rp(e){return e?jh(e)||Ea in e?ur({},e):e:null}function gi(e,t,r=!1){const{props:n,ref:a,patchFlag:f,children:E}=e,A=t?ip(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:A,key:A&&Af(A),ref:t&&t.ref?r&&a?Et(a)?a.concat(Ks(t)):[a,Ks(t)]:Ks(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:E,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==nn?f===-1?16:f|16:f,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&gi(e.ssContent),ssFallback:e.ssFallback&&gi(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx}}function np(e=" ",t=0){return pr(pa,null,e,t)}function K_(e,t){const r=pr(Gs,null,e);return r.staticCount=t,r}function Y_(e="",t=!1){return t?(Jm(),ep(Kn,null,e)):pr(Kn,null,e)}function Kr(e){return e==null||typeof e=="boolean"?pr(Kn):Et(e)?pr(nn,null,e.slice()):typeof e=="object"?pn(e):pr(pa,null,String(e))}function pn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:gi(e)}function Pu(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Et(t))r=16;else if(typeof t=="object")if(n&65){const a=t.default;a&&(a._c&&(a._d=!1),Pu(e,a()),a._c&&(a._d=!0));return}else{r=32;const a=t._;!a&&!(Ea in t)?t._ctx=_r:a===3&&_r&&(_r.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else At(t)?(t={default:t,_ctx:_r},r=32):(t=String(t),n&64?(r=16,t=[np(t)]):r=8);e.children=t,e.shapeFlag|=r}function ip(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const a in n)if(a==="class")t.class!==n.class&&(t.class=Tu([t.class,n.class]));else if(a==="style")t.style=Eu([t.style,n.style]);else if(ua(a)){const f=t[a],E=n[a];E&&f!==E&&!(Et(f)&&f.includes(E))&&(t[a]=f?[].concat(f,E):E)}else a!==""&&(t[a]=n[a])}return t}function Ur(e,t,r,n=null){kr(e,t,7,[r,n])}const sp=vf();let ap=0;function op(e,t,r){const n=e.type,a=(t?t.appContext:e.appContext)||sp,f={uid:ap++,vnode:e,type:n,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new Lg(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:mf(n,a),emitsOptions:rf(n,a),emit:null,emitted:null,propsDefaults:Ut,inheritAttrs:n.inheritAttrs,ctx:Ut,data:Ut,props:Ut,attrs:Ut,slots:Ut,refs:Ut,setupState:Ut,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return f.ctx={_:f},f.root=t?t.root:f,f.emit=fm.bind(null,f),e.ce&&e.ce(f),f}let rr=null;const mi=e=>{rr=e,e.scope.on()},Gn=()=>{rr&&rr.scope.off(),rr=null};function Sf(e){return e.vnode.shapeFlag&4}let is=!1;function up(e,t=!1){is=t;const{props:r,children:n}=e.vnode,a=Sf(e);Gm(e,r,a,t),jm(e,n);const f=a?cp(e,t):void 0;return is=!1,f}function cp(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=Vh(new Proxy(e.ctx,wm));const{setup:n}=r;if(n){const a=e.setupContext=n.length>1?hp(e):null;mi(e),yi();const f=vn(n,e,0,[e.props,a]);if(Ai(),Gn(),Nh(f)){if(f.then(Gn,Gn),t)return f.then(E=>{hl(e,E,t)}).catch(E=>{da(E,e,0)});e.asyncDep=f}else hl(e,f,t)}else If(e,t)}function hl(e,t,r){At(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Yt(t)&&(e.setupState=$h(t)),If(e,r)}let fl;function If(e,t,r){const n=e.type;if(!e.render){if(!t&&fl&&!n.render){const a=n.template||xu(e).template;if(a){const{isCustomElement:f,compilerOptions:E}=e.appContext.config,{delimiters:A,compilerOptions:y}=n,_=ur(ur({isCustomElement:f,delimiters:A},E),y);n.render=fl(a,_)}}e.render=n.render||xr}mi(e),yi(),Mm(e),Ai(),Gn()}function lp(e){return new Proxy(e.attrs,{get(t,r){return vr(e,"get","$attrs"),t[r]}})}function hp(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=lp(e))},slots:e.slots,emit:e.emit,expose:t}}function Ta(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy($h(Vh(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Gi)return Gi[r](e)},has(t,r){return r in t||r in Gi}}))}function fp(e,t=!0){return At(e)?e.displayName||e.name:e.name||t&&e.__name}function dp(e){return At(e)&&"__vccOpts"in e}const Ar=(e,t)=>am(e,t,is);function Cf(e,t,r){const n=arguments.length;return n===2?Yt(t)&&!Et(t)?Wo(t)?pr(e,null,[t]):pr(e,t):pr(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Wo(r)&&(r=[r]),pr(e,t,r))}const gp=Symbol(""),mp=()=>sn(gp),pp="3.2.45",Ep="http://www.w3.org/2000/svg",Pn=typeof document<"u"?document:null,dl=Pn&&Pn.createElement("template"),Tp={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const a=t?Pn.createElementNS(Ep,e):Pn.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&a.setAttribute("multiple",n.multiple),a},createText:e=>Pn.createTextNode(e),createComment:e=>Pn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Pn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,a,f){const E=r?r.previousSibling:t.lastChild;if(a&&(a===f||a.nextSibling))for(;t.insertBefore(a.cloneNode(!0),r),!(a===f||!(a=a.nextSibling)););else{dl.innerHTML=n?`<svg>${e}</svg>`:e;const A=dl.content;if(n){const y=A.firstChild;for(;y.firstChild;)A.appendChild(y.firstChild);A.removeChild(y)}t.insertBefore(A,r)}return[E?E.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function vp(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function bp(e,t,r){const n=e.style,a=Zt(r);if(r&&!a){for(const f in r)Xo(n,f,r[f]);if(t&&!Zt(t))for(const f in t)r[f]==null&&Xo(n,f,"")}else{const f=n.display;a?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=f)}}const gl=/\s*!important$/;function Xo(e,t,r){if(Et(r))r.forEach(n=>Xo(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=yp(e,t);gl.test(r)?e.setProperty(bi(n),r.replace(gl,""),"important"):e[n]=r}}const ml=["Webkit","Moz","ms"],bo={};function yp(e,t){const r=bo[t];if(r)return r;let n=Xr(t);if(n!=="filter"&&n in e)return bo[t]=n;n=ha(n);for(let a=0;a<ml.length;a++){const f=ml[a]+n;if(f in e)return bo[t]=f}return t}const pl="http://www.w3.org/1999/xlink";function Ap(e,t,r,n,a){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(pl,t.slice(6,t.length)):e.setAttributeNS(pl,t,r);else{const f=vg(t);r==null||f&&!Lh(r)?e.removeAttribute(t):e.setAttribute(t,f?"":r)}}function _p(e,t,r,n,a,f,E){if(t==="innerHTML"||t==="textContent"){n&&E(n,a,f),e[t]=r??"";return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const y=r??"";(e.value!==y||e.tagName==="OPTION")&&(e.value=y),r==null&&e.removeAttribute(t);return}let A=!1;if(r===""||r==null){const y=typeof e[t];y==="boolean"?r=Lh(r):r==null&&y==="string"?(r="",A=!0):y==="number"&&(r=0,A=!0)}try{e[t]=r}catch{}A&&e.removeAttribute(t)}function ni(e,t,r,n){e.addEventListener(t,r,n)}function Sp(e,t,r,n){e.removeEventListener(t,r,n)}function Ip(e,t,r,n,a=null){const f=e._vei||(e._vei={}),E=f[t];if(n&&E)E.value=n;else{const[A,y]=Cp(t);if(n){const _=f[t]=Dp(n,a);ni(e,A,_,y)}else E&&(Sp(e,A,E,y),f[t]=void 0)}}const El=/(?:Once|Passive|Capture)$/;function Cp(e){let t;if(El.test(e)){t={};let n;for(;n=e.match(El);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):bi(e.slice(2)),t]}let yo=0;const Lp=Promise.resolve(),Rp=()=>yo||(Lp.then(()=>yo=0),yo=Date.now());function Dp(e,t){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;kr(Np(n,r.value),t,5,[n])};return r.value=e,r.attached=Rp(),r}function Np(e,t){if(Et(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>a=>!a._stopped&&n&&n(a))}else return t}const Tl=/^on[a-z]/,Op=(e,t,r,n,a=!1,f,E,A,y)=>{t==="class"?vp(e,n,a):t==="style"?bp(e,r,n):ua(t)?vu(t)||Ip(e,t,r,n,E):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):xp(e,t,n,a))?_p(e,t,n,f,E,A,y):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),Ap(e,t,n,a))};function xp(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&Tl.test(t)&&At(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Tl.test(t)&&Zt(r)?!1:t in e}const vl=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Et(t)?r=>Fs(t,r):t};function kp(e){e.target.composing=!0}function bl(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const j_={created(e,{modifiers:{lazy:t,trim:r,number:n}},a){e._assign=vl(a);const f=n||a.props&&a.props.type==="number";ni(e,t?"change":"input",E=>{if(E.target.composing)return;let A=e.value;r&&(A=A.trim()),f&&(A=qs(A)),e._assign(A)}),r&&ni(e,"change",()=>{e.value=e.value.trim()}),t||(ni(e,"compositionstart",kp),ni(e,"compositionend",bl),ni(e,"change",bl))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:a}},f){if(e._assign=vl(f),e.composing||document.activeElement===e&&e.type!=="range"&&(r||n&&e.value.trim()===t||(a||e.type==="number")&&qs(e.value)===t))return;const E=t??"";e.value!==E&&(e.value=E)}},Pp=ur({patchProp:Op},Tp);let yl;function wp(){return yl||(yl=Xm(Pp))}const V_=(...e)=>{const t=wp().createApp(...e),{mount:r}=t;return t.mount=n=>{const a=Mp(n);if(!a)return;const f=t._component;!At(f)&&!f.render&&!f.template&&(f.template=a.innerHTML),a.innerHTML="";const E=r(a,!1,a instanceof SVGElement);return a instanceof Element&&(a.removeAttribute("v-cloak"),a.setAttribute("data-v-app","")),E},t};function Mp(e){return Zt(e)?document.querySelector(e):e}var Gr=(e=>(e.LOADING="loading",e.LOADED="loaded",e.ERROR="error",e))(Gr||{});const Fp=typeof window<"u"&&window!==null,Bp=Kp(),Up=Object.prototype.propertyIsEnumerable,Al=Object.getOwnPropertySymbols;function Yi(e){return typeof e=="function"||toString.call(e)==="[object Object]"}function Hp(e){return typeof e=="object"?e===null:typeof e!="function"}function Gp(e){return e!=="__proto__"&&e!=="constructor"&&e!=="prototype"}function Kp(){return Fp&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?("isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),!0):!1}function Yp(e,...t){if(!Yi(e))throw new TypeError("expected the first argument to be an object");if(t.length===0||typeof Symbol!="function"||typeof Al!="function")return e;for(const r of t){const n=Al(r);for(const a of n)Up.call(r,a)&&(e[a]=r[a])}return e}function Lf(e,...t){let r=0;for(Hp(e)&&(e=t[r++]),e||(e={});r<t.length;r++)if(Yi(t[r])){for(const n of Object.keys(t[r]))Gp(n)&&(Yi(e[n])&&Yi(t[r][n])?Lf(e[n],t[r][n]):e[n]=t[r][n]);Yp(e,t[r])}return e}const _l="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",jp="",Vp={rootMargin:"0px",threshold:0},ei="data-lazy-timeout-id";class qp{constructor(t){this.options={loading:_l,error:jp,observerOptions:Vp,log:!0,lifecycle:{}},this._images=new WeakMap,this.config(t)}config(t={}){Lf(this.options,t)}mount(t,r){if(!t)return;const{src:n,loading:a,error:f,lifecycle:E,delay:A}=this._valueFormatter(typeof r=="string"?r:r.value);this._lifecycle(Gr.LOADING,E,t),t.setAttribute("src",a||_l),Bp||(this.loadImages(t,n,f,E),this._log(()=>{throw new Error("Not support IntersectionObserver!")})),this._initIntersectionObserver(t,n,f,E,A)}update(t,r){var A;if(!t)return;(A=this._realObserver(t))==null||A.unobserve(t);const{src:n,error:a,lifecycle:f,delay:E}=this._valueFormatter(typeof r=="string"?r:r.value);this._initIntersectionObserver(t,n,a,f,E)}unmount(t){var r;t&&((r=this._realObserver(t))==null||r.unobserve(t),this._images.delete(t))}loadImages(t,r,n,a){this._setImageSrc(t,r,n,a)}_setImageSrc(t,r,n,a){t.tagName.toLowerCase()==="img"?(r&&t.getAttribute("src")!==r&&t.setAttribute("src",r),this._listenImageStatus(t,()=>{this._lifecycle(Gr.LOADED,a,t)},()=>{var f;t.onload=null,this._lifecycle(Gr.ERROR,a,t),(f=this._realObserver(t))==null||f.disconnect(),n&&t.getAttribute("src")!==n&&t.setAttribute("src",n),this._log(()=>{throw new Error(`Image failed to load!And failed src was: ${r} `)})})):t.style.backgroundImage=`url('${r}')`}_initIntersectionObserver(t,r,n,a,f){var A;const E=this.options.observerOptions;this._images.set(t,new IntersectionObserver(y=>{Array.prototype.forEach.call(y,_=>{f&&f>0?this._delayedIntersectionCallback(t,_,f,r,n,a):this._intersectionCallback(t,_,r,n,a)})},E)),(A=this._realObserver(t))==null||A.observe(t)}_intersectionCallback(t,r,n,a,f){var E;r.isIntersecting&&((E=this._realObserver(t))==null||E.unobserve(r.target),this._setImageSrc(t,n,a,f))}_delayedIntersectionCallback(t,r,n,a,f,E){if(r.isIntersecting){if(r.target.hasAttribute(ei))return;const A=setTimeout(()=>{this._intersectionCallback(t,r,a,f,E),r.target.removeAttribute(ei)},n);r.target.setAttribute(ei,String(A))}else r.target.hasAttribute(ei)&&(clearTimeout(Number(r.target.getAttribute(ei))),r.target.removeAttribute(ei))}_listenImageStatus(t,r,n){t.onload=r,t.onerror=n}_valueFormatter(t){let r=t,n=this.options.loading,a=this.options.error,f=this.options.lifecycle,E=this.options.delay;return Yi(t)&&(r=t.src,n=t.loading||this.options.loading,a=t.error||this.options.error,f=t.lifecycle||this.options.lifecycle,E=t.delay||this.options.delay),{src:r,loading:n,error:a,lifecycle:f,delay:E}}_log(t){this.options.log&&t()}_lifecycle(t,r,n){switch(t){case Gr.LOADING:n==null||n.setAttribute("lazy",Gr.LOADING),r!=null&&r.loading&&r.loading(n);break;case Gr.LOADED:n==null||n.setAttribute("lazy",Gr.LOADED),r!=null&&r.loaded&&r.loaded(n);break;case Gr.ERROR:n==null||n.setAttribute("lazy",Gr.ERROR),r!=null&&r.error&&r.error(n);break}}_realObserver(t){return this._images.get(t)}}const q_={install(e,t){const r=new qp(t);e.config.globalProperties.$Lazyload=r,e.provide("Lazyload",r),e.directive("lazy",{mounted:r.mount.bind(r),updated:r.update.bind(r),unmounted:r.unmount.bind(r)})}};/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const ii=typeof window<"u";function Wp(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const wt=Object.assign;function Ao(e,t){const r={};for(const n in t){const a=t[n];r[n]=Pr(a)?a.map(e):e(a)}return r}const ji=()=>{},Pr=Array.isArray,Xp=/\/$/,$p=e=>e.replace(Xp,"");function _o(e,t,r="/"){let n,a={},f="",E="";const A=t.indexOf("#");let y=t.indexOf("?");return A<y&&A>=0&&(y=-1),y>-1&&(n=t.slice(0,y),f=t.slice(y+1,A>-1?A:t.length),a=e(f)),A>-1&&(n=n||t.slice(0,A),E=t.slice(A,t.length)),n=Zp(n??t,r),{fullPath:n+(f&&"?")+f+E,path:n,query:a,hash:E}}function Qp(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function Sl(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function zp(e,t,r){const n=t.matched.length-1,a=r.matched.length-1;return n>-1&&n===a&&pi(t.matched[n],r.matched[a])&&Rf(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function pi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Rf(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!Jp(e[r],t[r]))return!1;return!0}function Jp(e,t){return Pr(e)?Il(e,t):Pr(t)?Il(t,e):e===t}function Il(e,t){return Pr(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function Zp(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/");let a=r.length-1,f,E;for(f=0;f<n.length;f++)if(E=n[f],E!==".")if(E==="..")a>1&&a--;else break;return r.slice(0,a).join("/")+"/"+n.slice(f-(f===n.length?1:0)).join("/")}var ss;(function(e){e.pop="pop",e.push="push"})(ss||(ss={}));var Vi;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Vi||(Vi={}));function eE(e){if(!e)if(ii){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),$p(e)}const tE=/^[^#]+#/;function rE(e,t){return e.replace(tE,"#")+t}function nE(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const va=()=>({left:window.pageXOffset,top:window.pageYOffset});function iE(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),a=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!a)return;t=nE(a,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Cl(e,t){return(history.state?history.state.position-t:-1)+e}const $o=new Map;function sE(e,t){$o.set(e,t)}function aE(e){const t=$o.get(e);return $o.delete(e),t}let oE=()=>location.protocol+"//"+location.host;function Df(e,t){const{pathname:r,search:n,hash:a}=t,f=e.indexOf("#");if(f>-1){let A=a.includes(e.slice(f))?e.slice(f).length:1,y=a.slice(A);return y[0]!=="/"&&(y="/"+y),Sl(y,"")}return Sl(r,e)+n+a}function uE(e,t,r,n){let a=[],f=[],E=null;const A=({state:b})=>{const L=Df(e,location),O=r.value,oe=t.value;let z=0;if(b){if(r.value=L,t.value=b,E&&E===O){E=null;return}z=oe?b.position-oe.position:0}else n(L);a.forEach(ee=>{ee(r.value,O,{delta:z,type:ss.pop,direction:z?z>0?Vi.forward:Vi.back:Vi.unknown})})};function y(){E=r.value}function _(b){a.push(b);const L=()=>{const O=a.indexOf(b);O>-1&&a.splice(O,1)};return f.push(L),L}function I(){const{history:b}=window;b.state&&b.replaceState(wt({},b.state,{scroll:va()}),"")}function C(){for(const b of f)b();f=[],window.removeEventListener("popstate",A),window.removeEventListener("beforeunload",I)}return window.addEventListener("popstate",A),window.addEventListener("beforeunload",I),{pauseListeners:y,listen:_,destroy:C}}function Ll(e,t,r,n=!1,a=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:a?va():null}}function cE(e){const{history:t,location:r}=window,n={value:Df(e,r)},a={value:t.state};a.value||f(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function f(y,_,I){const C=e.indexOf("#"),b=C>-1?(r.host&&document.querySelector("base")?e:e.slice(C))+y:oE()+e+y;try{t[I?"replaceState":"pushState"](_,"",b),a.value=_}catch(L){console.error(L),r[I?"replace":"assign"](b)}}function E(y,_){const I=wt({},t.state,Ll(a.value.back,y,a.value.forward,!0),_,{position:a.value.position});f(y,I,!0),n.value=y}function A(y,_){const I=wt({},a.value,t.state,{forward:y,scroll:va()});f(I.current,I,!0);const C=wt({},Ll(n.value,y,null),{position:I.position+1},_);f(y,C,!1),n.value=y}return{location:n,state:a,push:A,replace:E}}function W_(e){e=eE(e);const t=cE(e),r=uE(e,t.state,t.location,t.replace);function n(f,E=!0){E||r.pauseListeners(),history.go(f)}const a=wt({location:"",base:e,go:n,createHref:rE.bind(null,e)},t,r);return Object.defineProperty(a,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(a,"state",{enumerable:!0,get:()=>t.state.value}),a}function lE(e){return typeof e=="string"||e&&typeof e=="object"}function Nf(e){return typeof e=="string"||typeof e=="symbol"}const dn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Of=Symbol("");var Rl;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Rl||(Rl={}));function Ei(e,t){return wt(new Error,{type:e,[Of]:!0},t)}function en(e,t){return e instanceof Error&&Of in e&&(t==null||!!(e.type&t))}const Dl="[^/]+?",hE={sensitive:!1,strict:!1,start:!0,end:!0},fE=/[.+*?^${}()[\]/\\]/g;function dE(e,t){const r=wt({},hE,t),n=[];let a=r.start?"^":"";const f=[];for(const _ of e){const I=_.length?[]:[90];r.strict&&!_.length&&(a+="/");for(let C=0;C<_.length;C++){const b=_[C];let L=40+(r.sensitive?.25:0);if(b.type===0)C||(a+="/"),a+=b.value.replace(fE,"\\$&"),L+=40;else if(b.type===1){const{value:O,repeatable:oe,optional:z,regexp:ee}=b;f.push({name:O,repeatable:oe,optional:z});const le=ee||Dl;if(le!==Dl){L+=10;try{new RegExp(`(${le})`)}catch(fe){throw new Error(`Invalid custom RegExp for param "${O}" (${le}): `+fe.message)}}let $=oe?`((?:${le})(?:/(?:${le}))*)`:`(${le})`;C||($=z&&_.length<2?`(?:/${$})`:"/"+$),z&&($+="?"),a+=$,L+=20,z&&(L+=-8),oe&&(L+=-20),le===".*"&&(L+=-50)}I.push(L)}n.push(I)}if(r.strict&&r.end){const _=n.length-1;n[_][n[_].length-1]+=.7000000000000001}r.strict||(a+="/?"),r.end?a+="$":r.strict&&(a+="(?:/|$)");const E=new RegExp(a,r.sensitive?"":"i");function A(_){const I=_.match(E),C={};if(!I)return null;for(let b=1;b<I.length;b++){const L=I[b]||"",O=f[b-1];C[O.name]=L&&O.repeatable?L.split("/"):L}return C}function y(_){let I="",C=!1;for(const b of e){(!C||!I.endsWith("/"))&&(I+="/"),C=!1;for(const L of b)if(L.type===0)I+=L.value;else if(L.type===1){const{value:O,repeatable:oe,optional:z}=L,ee=O in _?_[O]:"";if(Pr(ee)&&!oe)throw new Error(`Provided param "${O}" is an array but it is not repeatable (* or + modifiers)`);const le=Pr(ee)?ee.join("/"):ee;if(!le)if(z)b.length<2&&(I.endsWith("/")?I=I.slice(0,-1):C=!0);else throw new Error(`Missing required param "${O}"`);I+=le}}return I||"/"}return{re:E,score:n,keys:f,parse:A,stringify:y}}function gE(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function mE(e,t){let r=0;const n=e.score,a=t.score;for(;r<n.length&&r<a.length;){const f=gE(n[r],a[r]);if(f)return f;r++}if(Math.abs(a.length-n.length)===1){if(Nl(n))return 1;if(Nl(a))return-1}return a.length-n.length}function Nl(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const pE={type:0,value:""},EE=/[a-zA-Z0-9_]/;function TE(e){if(!e)return[[]];if(e==="/")return[[pE]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(L){throw new Error(`ERR (${r})/"${_}": ${L}`)}let r=0,n=r;const a=[];let f;function E(){f&&a.push(f),f=[]}let A=0,y,_="",I="";function C(){_&&(r===0?f.push({type:0,value:_}):r===1||r===2||r===3?(f.length>1&&(y==="*"||y==="+")&&t(`A repeatable param (${_}) must be alone in its segment. eg: '/:ids+.`),f.push({type:1,value:_,regexp:I,repeatable:y==="*"||y==="+",optional:y==="*"||y==="?"})):t("Invalid state to consume buffer"),_="")}function b(){_+=y}for(;A<e.length;){if(y=e[A++],y==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:y==="/"?(_&&C(),E()):y===":"?(C(),r=1):b();break;case 4:b(),r=n;break;case 1:y==="("?r=2:EE.test(y)?b():(C(),r=0,y!=="*"&&y!=="?"&&y!=="+"&&A--);break;case 2:y===")"?I[I.length-1]=="\\"?I=I.slice(0,-1)+y:r=3:I+=y;break;case 3:C(),r=0,y!=="*"&&y!=="?"&&y!=="+"&&A--,I="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${_}"`),C(),E(),a}function vE(e,t,r){const n=dE(TE(e.path),r),a=wt(n,{record:e,parent:t,children:[],alias:[]});return t&&!a.record.aliasOf==!t.record.aliasOf&&t.children.push(a),a}function bE(e,t){const r=[],n=new Map;t=kl({strict:!1,end:!0,sensitive:!1},t);function a(I){return n.get(I)}function f(I,C,b){const L=!b,O=yE(I);O.aliasOf=b&&b.record;const oe=kl(t,I),z=[O];if("alias"in I){const $=typeof I.alias=="string"?[I.alias]:I.alias;for(const fe of $)z.push(wt({},O,{components:b?b.record.components:O.components,path:fe,aliasOf:b?b.record:O}))}let ee,le;for(const $ of z){const{path:fe}=$;if(C&&fe[0]!=="/"){const ue=C.record.path,se=ue[ue.length-1]==="/"?"":"/";$.path=C.record.path+(fe&&se+fe)}if(ee=vE($,C,oe),b?b.alias.push(ee):(le=le||ee,le!==ee&&le.alias.push(ee),L&&I.name&&!xl(ee)&&E(I.name)),O.children){const ue=O.children;for(let se=0;se<ue.length;se++)f(ue[se],ee,b&&b.children[se])}b=b||ee,(ee.record.components&&Object.keys(ee.record.components).length||ee.record.name||ee.record.redirect)&&y(ee)}return le?()=>{E(le)}:ji}function E(I){if(Nf(I)){const C=n.get(I);C&&(n.delete(I),r.splice(r.indexOf(C),1),C.children.forEach(E),C.alias.forEach(E))}else{const C=r.indexOf(I);C>-1&&(r.splice(C,1),I.record.name&&n.delete(I.record.name),I.children.forEach(E),I.alias.forEach(E))}}function A(){return r}function y(I){let C=0;for(;C<r.length&&mE(I,r[C])>=0&&(I.record.path!==r[C].record.path||!xf(I,r[C]));)C++;r.splice(C,0,I),I.record.name&&!xl(I)&&n.set(I.record.name,I)}function _(I,C){let b,L={},O,oe;if("name"in I&&I.name){if(b=n.get(I.name),!b)throw Ei(1,{location:I});oe=b.record.name,L=wt(Ol(C.params,b.keys.filter(le=>!le.optional).map(le=>le.name)),I.params&&Ol(I.params,b.keys.map(le=>le.name))),O=b.stringify(L)}else if("path"in I)O=I.path,b=r.find(le=>le.re.test(O)),b&&(L=b.parse(O),oe=b.record.name);else{if(b=C.name?n.get(C.name):r.find(le=>le.re.test(C.path)),!b)throw Ei(1,{location:I,currentLocation:C});oe=b.record.name,L=wt({},C.params,I.params),O=b.stringify(L)}const z=[];let ee=b;for(;ee;)z.unshift(ee.record),ee=ee.parent;return{name:oe,path:O,params:L,matched:z,meta:_E(z)}}return e.forEach(I=>f(I)),{addRoute:f,resolve:_,removeRoute:E,getRoutes:A,getRecordMatcher:a}}function Ol(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function yE(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:AE(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function AE(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function xl(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function _E(e){return e.reduce((t,r)=>wt(t,r.meta),{})}function kl(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function xf(e,t){return t.children.some(r=>r===e||xf(e,r))}const kf=/#/g,SE=/&/g,IE=/\//g,CE=/=/g,LE=/\?/g,Pf=/\+/g,RE=/%5B/g,DE=/%5D/g,wf=/%5E/g,NE=/%60/g,Mf=/%7B/g,OE=/%7C/g,Ff=/%7D/g,xE=/%20/g;function wu(e){return encodeURI(""+e).replace(OE,"|").replace(RE,"[").replace(DE,"]")}function kE(e){return wu(e).replace(Mf,"{").replace(Ff,"}").replace(wf,"^")}function Qo(e){return wu(e).replace(Pf,"%2B").replace(xE,"+").replace(kf,"%23").replace(SE,"%26").replace(NE,"`").replace(Mf,"{").replace(Ff,"}").replace(wf,"^")}function PE(e){return Qo(e).replace(CE,"%3D")}function wE(e){return wu(e).replace(kf,"%23").replace(LE,"%3F")}function ME(e){return e==null?"":wE(e).replace(IE,"%2F")}function Qs(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function FE(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<n.length;++a){const f=n[a].replace(Pf," "),E=f.indexOf("="),A=Qs(E<0?f:f.slice(0,E)),y=E<0?null:Qs(f.slice(E+1));if(A in t){let _=t[A];Pr(_)||(_=t[A]=[_]),_.push(y)}else t[A]=y}return t}function Pl(e){let t="";for(let r in e){const n=e[r];if(r=PE(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Pr(n)?n.map(f=>f&&Qo(f)):[n&&Qo(n)]).forEach(f=>{f!==void 0&&(t+=(t.length?"&":"")+r,f!=null&&(t+="="+f))})}return t}function BE(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Pr(n)?n.map(a=>a==null?null:""+a):n==null?n:""+n)}return t}const UE=Symbol(""),wl=Symbol(""),Mu=Symbol(""),Bf=Symbol(""),zo=Symbol("");function wi(){let e=[];function t(n){return e.push(n),()=>{const a=e.indexOf(n);a>-1&&e.splice(a,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function En(e,t,r,n,a){const f=n&&(n.enterCallbacks[a]=n.enterCallbacks[a]||[]);return()=>new Promise((E,A)=>{const y=C=>{C===!1?A(Ei(4,{from:r,to:t})):C instanceof Error?A(C):lE(C)?A(Ei(2,{from:t,to:C})):(f&&n.enterCallbacks[a]===f&&typeof C=="function"&&f.push(C),E())},_=e.call(n&&n.instances[a],t,r,y);let I=Promise.resolve(_);e.length<3&&(I=I.then(y)),I.catch(C=>A(C))})}function So(e,t,r,n){const a=[];for(const f of e)for(const E in f.components){let A=f.components[E];if(!(t!=="beforeRouteEnter"&&!f.instances[E]))if(HE(A)){const _=(A.__vccOpts||A)[t];_&&a.push(En(_,r,n,f,E))}else{let y=A();a.push(()=>y.then(_=>{if(!_)return Promise.reject(new Error(`Couldn't resolve component "${E}" at "${f.path}"`));const I=Wp(_)?_.default:_;f.components[E]=I;const b=(I.__vccOpts||I)[t];return b&&En(b,r,n,f,E)()}))}}return a}function HE(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Ml(e){const t=sn(Mu),r=sn(Bf),n=Ar(()=>t.resolve(ci(e.to))),a=Ar(()=>{const{matched:y}=n.value,{length:_}=y,I=y[_-1],C=r.matched;if(!I||!C.length)return-1;const b=C.findIndex(pi.bind(null,I));if(b>-1)return b;const L=Fl(y[_-2]);return _>1&&Fl(I)===L&&C[C.length-1].path!==L?C.findIndex(pi.bind(null,y[_-2])):b}),f=Ar(()=>a.value>-1&&jE(r.params,n.value.params)),E=Ar(()=>a.value>-1&&a.value===r.matched.length-1&&Rf(r.params,n.value.params));function A(y={}){return YE(y)?t[ci(e.replace)?"replace":"push"](ci(e.to)).catch(ji):Promise.resolve()}return{route:n,href:Ar(()=>n.value.href),isActive:f,isExactActive:E,navigate:A}}const GE=of({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Ml,setup(e,{slots:t}){const r=ls(Ml(e)),{options:n}=sn(Mu),a=Ar(()=>({[Bl(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Bl(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const f=t.default&&t.default(r);return e.custom?f:Cf("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:a.value},f)}}}),KE=GE;function YE(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function jE(e,t){for(const r in t){const n=t[r],a=e[r];if(typeof n=="string"){if(n!==a)return!1}else if(!Pr(a)||a.length!==n.length||n.some((f,E)=>f!==a[E]))return!1}return!0}function Fl(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Bl=(e,t,r)=>e??t??r,VE=of({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=sn(zo),a=Ar(()=>e.route||n.value),f=sn(wl,0),E=Ar(()=>{let _=ci(f);const{matched:I}=a.value;let C;for(;(C=I[_])&&!C.components;)_++;return _}),A=Ar(()=>a.value.matched[E.value]);Bs(wl,Ar(()=>E.value+1)),Bs(UE,A),Bs(zo,a);const y=tm();return Us(()=>[y.value,A.value,e.name],([_,I,C],[b,L,O])=>{I&&(I.instances[C]=_,L&&L!==I&&_&&_===b&&(I.leaveGuards.size||(I.leaveGuards=L.leaveGuards),I.updateGuards.size||(I.updateGuards=L.updateGuards))),_&&I&&(!L||!pi(I,L)||!b)&&(I.enterCallbacks[C]||[]).forEach(oe=>oe(_))},{flush:"post"}),()=>{const _=a.value,I=e.name,C=A.value,b=C&&C.components[I];if(!b)return Ul(r.default,{Component:b,route:_});const L=C.props[I],O=L?L===!0?_.params:typeof L=="function"?L(_):L:null,z=Cf(b,wt({},O,t,{onVnodeUnmounted:ee=>{ee.component.isUnmounted&&(C.instances[I]=null)},ref:y}));return Ul(r.default,{Component:z,route:_})||z}}});function Ul(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const qE=VE;function X_(e){const t=bE(e.routes,e),r=e.parseQuery||FE,n=e.stringifyQuery||Pl,a=e.history,f=wi(),E=wi(),A=wi(),y=rm(dn);let _=dn;ii&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const I=Ao.bind(null,B=>""+B),C=Ao.bind(null,ME),b=Ao.bind(null,Qs);function L(B,J){let q,ge;return Nf(B)?(q=t.getRecordMatcher(B),ge=J):ge=B,t.addRoute(ge,q)}function O(B){const J=t.getRecordMatcher(B);J&&t.removeRoute(J)}function oe(){return t.getRoutes().map(B=>B.record)}function z(B){return!!t.getRecordMatcher(B)}function ee(B,J){if(J=wt({},J||y.value),typeof B=="string"){const N=_o(r,B,J.path),x=t.resolve({path:N.path},J),j=a.createHref(N.fullPath);return wt(N,x,{params:b(x.params),hash:Qs(N.hash),redirectedFrom:void 0,href:j})}let q;if("path"in B)q=wt({},B,{path:_o(r,B.path,J.path).path});else{const N=wt({},B.params);for(const x in N)N[x]==null&&delete N[x];q=wt({},B,{params:C(B.params)}),J.params=C(J.params)}const ge=t.resolve(q,J),Ae=B.hash||"";ge.params=I(b(ge.params));const ke=Qp(n,wt({},B,{hash:kE(Ae),path:ge.path})),Ie=a.createHref(ke);return wt({fullPath:ke,hash:Ae,query:n===Pl?BE(B.query):B.query||{}},ge,{redirectedFrom:void 0,href:Ie})}function le(B){return typeof B=="string"?_o(r,B,y.value.path):wt({},B)}function $(B,J){if(_!==B)return Ei(8,{from:J,to:B})}function fe(B){return re(B)}function ue(B){return fe(wt(le(B),{replace:!0}))}function se(B){const J=B.matched[B.matched.length-1];if(J&&J.redirect){const{redirect:q}=J;let ge=typeof q=="function"?q(B):q;return typeof ge=="string"&&(ge=ge.includes("?")||ge.includes("#")?ge=le(ge):{path:ge},ge.params={}),wt({query:B.query,hash:B.hash,params:"path"in ge?{}:B.params},ge)}}function re(B,J){const q=_=ee(B),ge=y.value,Ae=B.state,ke=B.force,Ie=B.replace===!0,N=se(q);if(N)return re(wt(le(N),{state:typeof N=="object"?wt({},Ae,N.state):Ae,force:ke,replace:Ie}),J||q);const x=q;x.redirectedFrom=J;let j;return!ke&&zp(n,ge,q)&&(j=Ei(16,{to:x,from:ge}),Je(ge,ge,!0,!1)),(j?Promise.resolve(j):Pe(x,ge)).catch(ie=>en(ie)?en(ie,2)?ie:We(ie):ve(ie,x,ge)).then(ie=>{if(ie){if(en(ie,2))return re(wt({replace:Ie},le(ie.to),{state:typeof ie.to=="object"?wt({},Ae,ie.to.state):Ae,force:ke}),J||x)}else ie=ce(x,ge,!0,Ie,Ae);return Ze(x,ge,ie),ie})}function Ne(B,J){const q=$(B,J);return q?Promise.reject(q):Promise.resolve()}function Pe(B,J){let q;const[ge,Ae,ke]=WE(B,J);q=So(ge.reverse(),"beforeRouteLeave",B,J);for(const N of ge)N.leaveGuards.forEach(x=>{q.push(En(x,B,J))});const Ie=Ne.bind(null,B,J);return q.push(Ie),ti(q).then(()=>{q=[];for(const N of f.list())q.push(En(N,B,J));return q.push(Ie),ti(q)}).then(()=>{q=So(Ae,"beforeRouteUpdate",B,J);for(const N of Ae)N.updateGuards.forEach(x=>{q.push(En(x,B,J))});return q.push(Ie),ti(q)}).then(()=>{q=[];for(const N of B.matched)if(N.beforeEnter&&!J.matched.includes(N))if(Pr(N.beforeEnter))for(const x of N.beforeEnter)q.push(En(x,B,J));else q.push(En(N.beforeEnter,B,J));return q.push(Ie),ti(q)}).then(()=>(B.matched.forEach(N=>N.enterCallbacks={}),q=So(ke,"beforeRouteEnter",B,J),q.push(Ie),ti(q))).then(()=>{q=[];for(const N of E.list())q.push(En(N,B,J));return q.push(Ie),ti(q)}).catch(N=>en(N,8)?N:Promise.reject(N))}function Ze(B,J,q){for(const ge of A.list())ge(B,J,q)}function ce(B,J,q,ge,Ae){const ke=$(B,J);if(ke)return ke;const Ie=J===dn,N=ii?history.state:{};q&&(ge||Ie?a.replace(B.fullPath,wt({scroll:Ie&&N&&N.scroll},Ae)):a.push(B.fullPath,Ae)),y.value=B,Je(B,J,q,Ie),We()}let P;function Q(){P||(P=a.listen((B,J,q)=>{if(!_t.listening)return;const ge=ee(B),Ae=se(ge);if(Ae){re(wt(Ae,{replace:!0}),ge).catch(ji);return}_=ge;const ke=y.value;ii&&sE(Cl(ke.fullPath,q.delta),va()),Pe(ge,ke).catch(Ie=>en(Ie,12)?Ie:en(Ie,2)?(re(Ie.to,ge).then(N=>{en(N,20)&&!q.delta&&q.type===ss.pop&&a.go(-1,!1)}).catch(ji),Promise.reject()):(q.delta&&a.go(-q.delta,!1),ve(Ie,ge,ke))).then(Ie=>{Ie=Ie||ce(ge,ke,!1),Ie&&(q.delta&&!en(Ie,8)?a.go(-q.delta,!1):q.type===ss.pop&&en(Ie,20)&&a.go(-1,!1)),Ze(ge,ke,Ie)}).catch(ji)}))}let U=wi(),pe=wi(),Le;function ve(B,J,q){We(B);const ge=pe.list();return ge.length?ge.forEach(Ae=>Ae(B,J,q)):console.error(B),Promise.reject(B)}function Ee(){return Le&&y.value!==dn?Promise.resolve():new Promise((B,J)=>{U.add([B,J])})}function We(B){return Le||(Le=!B,Q(),U.list().forEach(([J,q])=>B?q(B):J()),U.reset()),B}function Je(B,J,q,ge){const{scrollBehavior:Ae}=e;if(!ii||!Ae)return Promise.resolve();const ke=!q&&aE(Cl(B.fullPath,0))||(ge||!q)&&history.state&&history.state.scroll||null;return Jh().then(()=>Ae(B,J,ke)).then(Ie=>Ie&&iE(Ie)).catch(Ie=>ve(Ie,B,J))}const $e=B=>a.go(B);let je;const ct=new Set,_t={currentRoute:y,listening:!0,addRoute:L,removeRoute:O,hasRoute:z,getRoutes:oe,resolve:ee,options:e,push:fe,replace:ue,go:$e,back:()=>$e(-1),forward:()=>$e(1),beforeEach:f.add,beforeResolve:E.add,afterEach:A.add,onError:pe.add,isReady:Ee,install(B){const J=this;B.component("RouterLink",KE),B.component("RouterView",qE),B.config.globalProperties.$router=J,Object.defineProperty(B.config.globalProperties,"$route",{enumerable:!0,get:()=>ci(y)}),ii&&!je&&y.value===dn&&(je=!0,fe(a.location).catch(Ae=>{}));const q={};for(const Ae in dn)q[Ae]=Ar(()=>y.value[Ae]);B.provide(Mu,J),B.provide(Bf,ls(q)),B.provide(zo,y);const ge=B.unmount;ct.add(B),B.unmount=function(){ct.delete(B),ct.size<1&&(_=dn,P&&P(),P=null,y.value=dn,je=!1,Le=!1),ge()}}};return _t}function ti(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function WE(e,t){const r=[],n=[],a=[],f=Math.max(t.matched.length,e.matched.length);for(let E=0;E<f;E++){const A=t.matched[E];A&&(e.matched.find(_=>pi(_,A))?n.push(A):r.push(A));const y=e.matched[E];y&&(t.matched.find(_=>pi(_,y))||a.push(y))}return[r,n,a]}function un(e){return Array.isArray?Array.isArray(e):Gf(e)==="[object Array]"}const XE=1/0;function $E(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-XE?"-0":t}function QE(e){return e==null?"":$E(e)}function Vr(e){return typeof e=="string"}function Uf(e){return typeof e=="number"}function zE(e){return e===!0||e===!1||JE(e)&&Gf(e)=="[object Boolean]"}function Hf(e){return typeof e=="object"}function JE(e){return Hf(e)&&e!==null}function Tr(e){return e!=null}function Io(e){return!e.trim().length}function Gf(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const ZE="Incorrect 'index' type",eT=e=>`Invalid value for key ${e}`,tT=e=>`Pattern length exceeds max of ${e}.`,rT=e=>`Missing ${e} property in key`,nT=e=>`Property 'weight' in key '${e}' must be a positive integer`,Hl=Object.prototype.hasOwnProperty;class iT{constructor(t){this._keys=[],this._keyMap={};let r=0;t.forEach(n=>{let a=Kf(n);r+=a.weight,this._keys.push(a),this._keyMap[a.id]=a,r+=a.weight}),this._keys.forEach(n=>{n.weight/=r})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Kf(e){let t=null,r=null,n=null,a=1,f=null;if(Vr(e)||un(e))n=e,t=Gl(e),r=Jo(e);else{if(!Hl.call(e,"name"))throw new Error(rT("name"));const E=e.name;if(n=E,Hl.call(e,"weight")&&(a=e.weight,a<=0))throw new Error(nT(E));t=Gl(E),r=Jo(E),f=e.getFn}return{path:t,id:r,weight:a,src:n,getFn:f}}function Gl(e){return un(e)?e:e.split(".")}function Jo(e){return un(e)?e.join("."):e}function sT(e,t){let r=[],n=!1;const a=(f,E,A)=>{if(Tr(f))if(!E[A])r.push(f);else{let y=E[A];const _=f[y];if(!Tr(_))return;if(A===E.length-1&&(Vr(_)||Uf(_)||zE(_)))r.push(QE(_));else if(un(_)){n=!0;for(let I=0,C=_.length;I<C;I+=1)a(_[I],E,A+1)}else E.length&&a(_,E,A+1)}};return a(e,Vr(t)?t.split("."):t,0),n?r:r[0]}const aT={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},oT={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},uT={location:0,threshold:.6,distance:100},cT={useExtendedSearch:!1,getFn:sT,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var gt={...oT,...aT,...uT,...cT};const lT=/[^ ]+/g;function hT(e=1,t=3){const r=new Map,n=Math.pow(10,t);return{get(a){const f=a.match(lT).length;if(r.has(f))return r.get(f);const E=1/Math.pow(f,.5*e),A=parseFloat(Math.round(E*n)/n);return r.set(f,A),A},clear(){r.clear()}}}class Fu{constructor({getFn:t=gt.getFn,fieldNormWeight:r=gt.fieldNormWeight}={}){this.norm=hT(r,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((r,n)=>{this._keysMap[r.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Vr(this.docs[0])?this.docs.forEach((t,r)=>{this._addString(t,r)}):this.docs.forEach((t,r)=>{this._addObject(t,r)}),this.norm.clear())}add(t){const r=this.size();Vr(t)?this._addString(t,r):this._addObject(t,r)}removeAt(t){this.records.splice(t,1);for(let r=t,n=this.size();r<n;r+=1)this.records[r].i-=1}getValueForItemAtKeyId(t,r){return t[this._keysMap[r]]}size(){return this.records.length}_addString(t,r){if(!Tr(t)||Io(t))return;let n={v:t,i:r,n:this.norm.get(t)};this.records.push(n)}_addObject(t,r){let n={i:r,$:{}};this.keys.forEach((a,f)=>{let E=a.getFn?a.getFn(t):this.getFn(t,a.path);if(Tr(E)){if(un(E)){let A=[];const y=[{nestedArrIndex:-1,value:E}];for(;y.length;){const{nestedArrIndex:_,value:I}=y.pop();if(Tr(I))if(Vr(I)&&!Io(I)){let C={v:I,i:_,n:this.norm.get(I)};A.push(C)}else un(I)&&I.forEach((C,b)=>{y.push({nestedArrIndex:b,value:C})})}n.$[f]=A}else if(Vr(E)&&!Io(E)){let A={v:E,n:this.norm.get(E)};n.$[f]=A}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function Yf(e,t,{getFn:r=gt.getFn,fieldNormWeight:n=gt.fieldNormWeight}={}){const a=new Fu({getFn:r,fieldNormWeight:n});return a.setKeys(e.map(Kf)),a.setSources(t),a.create(),a}function fT(e,{getFn:t=gt.getFn,fieldNormWeight:r=gt.fieldNormWeight}={}){const{keys:n,records:a}=e,f=new Fu({getFn:t,fieldNormWeight:r});return f.setKeys(n),f.setIndexRecords(a),f}function Ns(e,{errors:t=0,currentLocation:r=0,expectedLocation:n=0,distance:a=gt.distance,ignoreLocation:f=gt.ignoreLocation}={}){const E=t/e.length;if(f)return E;const A=Math.abs(n-r);return a?E+A/a:A?1:E}function dT(e=[],t=gt.minMatchCharLength){let r=[],n=-1,a=-1,f=0;for(let E=e.length;f<E;f+=1){let A=e[f];A&&n===-1?n=f:!A&&n!==-1&&(a=f-1,a-n+1>=t&&r.push([n,a]),n=-1)}return e[f-1]&&f-n>=t&&r.push([n,f-1]),r}const wn=32;function gT(e,t,r,{location:n=gt.location,distance:a=gt.distance,threshold:f=gt.threshold,findAllMatches:E=gt.findAllMatches,minMatchCharLength:A=gt.minMatchCharLength,includeMatches:y=gt.includeMatches,ignoreLocation:_=gt.ignoreLocation}={}){if(t.length>wn)throw new Error(tT(wn));const I=t.length,C=e.length,b=Math.max(0,Math.min(n,C));let L=f,O=b;const oe=A>1||y,z=oe?Array(C):[];let ee;for(;(ee=e.indexOf(t,O))>-1;){let re=Ns(t,{currentLocation:ee,expectedLocation:b,distance:a,ignoreLocation:_});if(L=Math.min(re,L),O=ee+I,oe){let Ne=0;for(;Ne<I;)z[ee+Ne]=1,Ne+=1}}O=-1;let le=[],$=1,fe=I+C;const ue=1<<I-1;for(let re=0;re<I;re+=1){let Ne=0,Pe=fe;for(;Ne<Pe;)Ns(t,{errors:re,currentLocation:b+Pe,expectedLocation:b,distance:a,ignoreLocation:_})<=L?Ne=Pe:fe=Pe,Pe=Math.floor((fe-Ne)/2+Ne);fe=Pe;let Ze=Math.max(1,b-Pe+1),ce=E?C:Math.min(b+Pe,C)+I,P=Array(ce+2);P[ce+1]=(1<<re)-1;for(let U=ce;U>=Ze;U-=1){let pe=U-1,Le=r[e.charAt(pe)];if(oe&&(z[pe]=+!!Le),P[U]=(P[U+1]<<1|1)&Le,re&&(P[U]|=(le[U+1]|le[U])<<1|1|le[U+1]),P[U]&ue&&($=Ns(t,{errors:re,currentLocation:pe,expectedLocation:b,distance:a,ignoreLocation:_}),$<=L)){if(L=$,O=pe,O<=b)break;Ze=Math.max(1,2*b-O)}}if(Ns(t,{errors:re+1,currentLocation:b,expectedLocation:b,distance:a,ignoreLocation:_})>L)break;le=P}const se={isMatch:O>=0,score:Math.max(.001,$)};if(oe){const re=dT(z,A);re.length?y&&(se.indices=re):se.isMatch=!1}return se}function mT(e){let t={};for(let r=0,n=e.length;r<n;r+=1){const a=e.charAt(r);t[a]=(t[a]||0)|1<<n-r-1}return t}class jf{constructor(t,{location:r=gt.location,threshold:n=gt.threshold,distance:a=gt.distance,includeMatches:f=gt.includeMatches,findAllMatches:E=gt.findAllMatches,minMatchCharLength:A=gt.minMatchCharLength,isCaseSensitive:y=gt.isCaseSensitive,ignoreLocation:_=gt.ignoreLocation}={}){if(this.options={location:r,threshold:n,distance:a,includeMatches:f,findAllMatches:E,minMatchCharLength:A,isCaseSensitive:y,ignoreLocation:_},this.pattern=y?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const I=(b,L)=>{this.chunks.push({pattern:b,alphabet:mT(b),startIndex:L})},C=this.pattern.length;if(C>wn){let b=0;const L=C%wn,O=C-L;for(;b<O;)I(this.pattern.substr(b,wn),b),b+=wn;if(L){const oe=C-wn;I(this.pattern.substr(oe),oe)}}else I(this.pattern,0)}searchIn(t){const{isCaseSensitive:r,includeMatches:n}=this.options;if(r||(t=t.toLowerCase()),this.pattern===t){let O={isMatch:!0,score:0};return n&&(O.indices=[[0,t.length-1]]),O}const{location:a,distance:f,threshold:E,findAllMatches:A,minMatchCharLength:y,ignoreLocation:_}=this.options;let I=[],C=0,b=!1;this.chunks.forEach(({pattern:O,alphabet:oe,startIndex:z})=>{const{isMatch:ee,score:le,indices:$}=gT(t,O,oe,{location:a+z,distance:f,threshold:E,findAllMatches:A,minMatchCharLength:y,includeMatches:n,ignoreLocation:_});ee&&(b=!0),C+=le,ee&&$&&(I=[...I,...$])});let L={isMatch:b,score:b?C/this.chunks.length:1};return b&&n&&(L.indices=I),L}}class An{constructor(t){this.pattern=t}static isMultiMatch(t){return Kl(t,this.multiRegex)}static isSingleMatch(t){return Kl(t,this.singleRegex)}search(){}}function Kl(e,t){const r=e.match(t);return r?r[1]:null}class pT extends An{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const r=t===this.pattern;return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class ET extends An{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const n=t.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class TT extends An{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const r=t.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class vT extends An{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const r=!t.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class bT extends An{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const r=t.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class yT extends An{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const r=!t.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class Vf extends An{constructor(t,{location:r=gt.location,threshold:n=gt.threshold,distance:a=gt.distance,includeMatches:f=gt.includeMatches,findAllMatches:E=gt.findAllMatches,minMatchCharLength:A=gt.minMatchCharLength,isCaseSensitive:y=gt.isCaseSensitive,ignoreLocation:_=gt.ignoreLocation}={}){super(t),this._bitapSearch=new jf(t,{location:r,threshold:n,distance:a,includeMatches:f,findAllMatches:E,minMatchCharLength:A,isCaseSensitive:y,ignoreLocation:_})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class qf extends An{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let r=0,n;const a=[],f=this.pattern.length;for(;(n=t.indexOf(this.pattern,r))>-1;)r=n+f,a.push([n,r-1]);const E=!!a.length;return{isMatch:E,score:E?0:1,indices:a}}}const Zo=[pT,qf,TT,vT,yT,bT,ET,Vf],Yl=Zo.length,AT=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,_T="|";function ST(e,t={}){return e.split(_T).map(r=>{let n=r.trim().split(AT).filter(f=>f&&!!f.trim()),a=[];for(let f=0,E=n.length;f<E;f+=1){const A=n[f];let y=!1,_=-1;for(;!y&&++_<Yl;){const I=Zo[_];let C=I.isMultiMatch(A);C&&(a.push(new I(C,t)),y=!0)}if(!y)for(_=-1;++_<Yl;){const I=Zo[_];let C=I.isSingleMatch(A);if(C){a.push(new I(C,t));break}}}return a})}const IT=new Set([Vf.type,qf.type]);class CT{constructor(t,{isCaseSensitive:r=gt.isCaseSensitive,includeMatches:n=gt.includeMatches,minMatchCharLength:a=gt.minMatchCharLength,ignoreLocation:f=gt.ignoreLocation,findAllMatches:E=gt.findAllMatches,location:A=gt.location,threshold:y=gt.threshold,distance:_=gt.distance}={}){this.query=null,this.options={isCaseSensitive:r,includeMatches:n,minMatchCharLength:a,findAllMatches:E,ignoreLocation:f,location:A,threshold:y,distance:_},this.pattern=r?t:t.toLowerCase(),this.query=ST(this.pattern,this.options)}static condition(t,r){return r.useExtendedSearch}searchIn(t){const r=this.query;if(!r)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:a}=this.options;t=a?t:t.toLowerCase();let f=0,E=[],A=0;for(let y=0,_=r.length;y<_;y+=1){const I=r[y];E.length=0,f=0;for(let C=0,b=I.length;C<b;C+=1){const L=I[C],{isMatch:O,indices:oe,score:z}=L.search(t);if(O){if(f+=1,A+=z,n){const ee=L.constructor.type;IT.has(ee)?E=[...E,...oe]:E.push(oe)}}else{A=0,f=0,E.length=0;break}}if(f){let C={isMatch:!0,score:A/f};return n&&(C.indices=E),C}}return{isMatch:!1,score:1}}}const eu=[];function LT(...e){eu.push(...e)}function tu(e,t){for(let r=0,n=eu.length;r<n;r+=1){let a=eu[r];if(a.condition(e,t))return new a(e,t)}return new jf(e,t)}const zs={AND:"$and",OR:"$or"},ru={PATH:"$path",PATTERN:"$val"},nu=e=>!!(e[zs.AND]||e[zs.OR]),RT=e=>!!e[ru.PATH],DT=e=>!un(e)&&Hf(e)&&!nu(e),jl=e=>({[zs.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function Wf(e,t,{auto:r=!0}={}){const n=a=>{let f=Object.keys(a);const E=RT(a);if(!E&&f.length>1&&!nu(a))return n(jl(a));if(DT(a)){const y=E?a[ru.PATH]:f[0],_=E?a[ru.PATTERN]:a[y];if(!Vr(_))throw new Error(eT(y));const I={keyId:Jo(y),pattern:_};return r&&(I.searcher=tu(_,t)),I}let A={children:[],operator:f[0]};return f.forEach(y=>{const _=a[y];un(_)&&_.forEach(I=>{A.children.push(n(I))})}),A};return nu(e)||(e=jl(e)),n(e)}function NT(e,{ignoreFieldNorm:t=gt.ignoreFieldNorm}){e.forEach(r=>{let n=1;r.matches.forEach(({key:a,norm:f,score:E})=>{const A=a?a.weight:null;n*=Math.pow(E===0&&A?Number.EPSILON:E,(A||1)*(t?1:f))}),r.score=n})}function OT(e,t){const r=e.matches;t.matches=[],Tr(r)&&r.forEach(n=>{if(!Tr(n.indices)||!n.indices.length)return;const{indices:a,value:f}=n;let E={indices:a,value:f};n.key&&(E.key=n.key.src),n.idx>-1&&(E.refIndex=n.idx),t.matches.push(E)})}function xT(e,t){t.score=e.score}function kT(e,t,{includeMatches:r=gt.includeMatches,includeScore:n=gt.includeScore}={}){const a=[];return r&&a.push(OT),n&&a.push(xT),e.map(f=>{const{idx:E}=f,A={item:t[E],refIndex:E};return a.length&&a.forEach(y=>{y(f,A)}),A})}class hs{constructor(t,r={},n){this.options={...gt,...r},this.options.useExtendedSearch,this._keyStore=new iT(this.options.keys),this.setCollection(t,n)}setCollection(t,r){if(this._docs=t,r&&!(r instanceof Fu))throw new Error(ZE);this._myIndex=r||Yf(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){Tr(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const r=[];for(let n=0,a=this._docs.length;n<a;n+=1){const f=this._docs[n];t(f,n)&&(this.removeAt(n),n-=1,a-=1,r.push(f))}return r}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:r=-1}={}){const{includeMatches:n,includeScore:a,shouldSort:f,sortFn:E,ignoreFieldNorm:A}=this.options;let y=Vr(t)?Vr(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return NT(y,{ignoreFieldNorm:A}),f&&y.sort(E),Uf(r)&&r>-1&&(y=y.slice(0,r)),kT(y,this._docs,{includeMatches:n,includeScore:a})}_searchStringList(t){const r=tu(t,this.options),{records:n}=this._myIndex,a=[];return n.forEach(({v:f,i:E,n:A})=>{if(!Tr(f))return;const{isMatch:y,score:_,indices:I}=r.searchIn(f);y&&a.push({item:f,idx:E,matches:[{score:_,value:f,norm:A,indices:I}]})}),a}_searchLogical(t){const r=Wf(t,this.options),n=(A,y,_)=>{if(!A.children){const{keyId:C,searcher:b}=A,L=this._findMatches({key:this._keyStore.get(C),value:this._myIndex.getValueForItemAtKeyId(y,C),searcher:b});return L&&L.length?[{idx:_,item:y,matches:L}]:[]}const I=[];for(let C=0,b=A.children.length;C<b;C+=1){const L=A.children[C],O=n(L,y,_);if(O.length)I.push(...O);else if(A.operator===zs.AND)return[]}return I},a=this._myIndex.records,f={},E=[];return a.forEach(({$:A,i:y})=>{if(Tr(A)){let _=n(r,A,y);_.length&&(f[y]||(f[y]={idx:y,item:A,matches:[]},E.push(f[y])),_.forEach(({matches:I})=>{f[y].matches.push(...I)}))}}),E}_searchObjectList(t){const r=tu(t,this.options),{keys:n,records:a}=this._myIndex,f=[];return a.forEach(({$:E,i:A})=>{if(!Tr(E))return;let y=[];n.forEach((_,I)=>{y.push(...this._findMatches({key:_,value:E[I],searcher:r}))}),y.length&&f.push({idx:A,item:E,matches:y})}),f}_findMatches({key:t,value:r,searcher:n}){if(!Tr(r))return[];let a=[];if(un(r))r.forEach(({v:f,i:E,n:A})=>{if(!Tr(f))return;const{isMatch:y,score:_,indices:I}=n.searchIn(f);y&&a.push({score:_,key:t,value:f,idx:E,norm:A,indices:I})});else{const{v:f,n:E}=r,{isMatch:A,score:y,indices:_}=n.searchIn(f);A&&a.push({score:y,key:t,value:f,norm:E,indices:_})}return a}}hs.version="6.6.2";hs.createIndex=Yf;hs.parseIndex=fT;hs.config=gt;hs.parseQuery=Wf;LT(CT);const Bu={xml:!1,decodeEntities:!0},Vl={_useHtmlParser2:!0,xmlMode:!0};function iu(e){return e!=null&&e.xml?typeof e.xml=="boolean"?Vl:{...Vl,...e.xml}:e??void 0}var xt;(function(e){e.Root="root",e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"})(xt||(xt={}));function PT(e){return e.type===xt.Tag||e.type===xt.Script||e.type===xt.Style}const wT=xt.Root,MT=xt.Text,FT=xt.Directive,BT=xt.Comment,UT=xt.Script,HT=xt.Style,GT=xt.Tag,KT=xt.CDATA,YT=xt.Doctype;class Xf{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(t){this.parent=t}get previousSibling(){return this.prev}set previousSibling(t){this.prev=t}get nextSibling(){return this.next}set nextSibling(t){this.next=t}cloneNode(t=!1){return Js(this,t)}}class Uu extends Xf{constructor(t){super(),this.data=t}get nodeValue(){return this.data}set nodeValue(t){this.data=t}}class as extends Uu{constructor(){super(...arguments),this.type=xt.Text}get nodeType(){return 3}}class Hu extends Uu{constructor(){super(...arguments),this.type=xt.Comment}get nodeType(){return 8}}class Gu extends Uu{constructor(t,r){super(r),this.name=t,this.type=xt.Directive}get nodeType(){return 1}}class Ku extends Xf{constructor(t){super(),this.children=t}get firstChild(){var t;return(t=this.children[0])!==null&&t!==void 0?t:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(t){this.children=t}}class $f extends Ku{constructor(){super(...arguments),this.type=xt.CDATA}get nodeType(){return 4}}class Yn extends Ku{constructor(){super(...arguments),this.type=xt.Root}get nodeType(){return 9}}let Yu=class extends Ku{constructor(t,r,n=[],a=t==="script"?xt.Script:t==="style"?xt.Style:xt.Tag){super(n),this.name=t,this.attribs=r,this.type=a}get nodeType(){return 1}get tagName(){return this.name}set tagName(t){this.name=t}get attributes(){return Object.keys(this.attribs).map(t=>{var r,n;return{name:t,value:this.attribs[t],namespace:(r=this["x-attribsNamespace"])===null||r===void 0?void 0:r[t],prefix:(n=this["x-attribsPrefix"])===null||n===void 0?void 0:n[t]}})}};function dt(e){return PT(e)}function ba(e){return e.type===xt.CDATA}function qr(e){return e.type===xt.Text}function ya(e){return e.type===xt.Comment}function su(e){return e.type===xt.Directive}function Vn(e){return e.type===xt.Root}function er(e){return Object.prototype.hasOwnProperty.call(e,"children")}function Js(e,t=!1){let r;if(qr(e))r=new as(e.data);else if(ya(e))r=new Hu(e.data);else if(dt(e)){const n=t?Co(e.children):[],a=new Yu(e.name,{...e.attribs},n);n.forEach(f=>f.parent=a),e.namespace!=null&&(a.namespace=e.namespace),e["x-attribsNamespace"]&&(a["x-attribsNamespace"]={...e["x-attribsNamespace"]}),e["x-attribsPrefix"]&&(a["x-attribsPrefix"]={...e["x-attribsPrefix"]}),r=a}else if(ba(e)){const n=t?Co(e.children):[],a=new $f(n);n.forEach(f=>f.parent=a),r=a}else if(Vn(e)){const n=t?Co(e.children):[],a=new Yn(n);n.forEach(f=>f.parent=a),e["x-mode"]&&(a["x-mode"]=e["x-mode"]),r=a}else if(su(e)){const n=new Gu(e.name,e.data);e["x-name"]!=null&&(n["x-name"]=e["x-name"],n["x-publicId"]=e["x-publicId"],n["x-systemId"]=e["x-systemId"]),r=n}else throw new Error(`Not implemented yet: ${e.type}`);return r.startIndex=e.startIndex,r.endIndex=e.endIndex,e.sourceCodeLocation!=null&&(r.sourceCodeLocation=e.sourceCodeLocation),r}function Co(e){const t=e.map(r=>Js(r,!0));for(let r=1;r<t.length;r++)t[r].prev=t[r-1],t[r-1].next=t[r];return t}const ql={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};class jT{constructor(t,r,n){this.dom=[],this.root=new Yn(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof r=="function"&&(n=r,r=ql),typeof t=="object"&&(r=t,t=void 0),this.callback=t??null,this.options=r??ql,this.elementCB=n??null}onparserinit(t){this.parser=t}onreset(){this.dom=[],this.root=new Yn(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(t){this.handleCallback(t)}onclosetag(){this.lastNode=null;const t=this.tagStack.pop();this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(t)}onopentag(t,r){const n=this.options.xmlMode?xt.Tag:void 0,a=new Yu(t,r,void 0,n);this.addNode(a),this.tagStack.push(a)}ontext(t){const{lastNode:r}=this;if(r&&r.type===xt.Text)r.data+=t,this.options.withEndIndices&&(r.endIndex=this.parser.endIndex);else{const n=new as(t);this.addNode(n),this.lastNode=n}}oncomment(t){if(this.lastNode&&this.lastNode.type===xt.Comment){this.lastNode.data+=t;return}const r=new Hu(t);this.addNode(r),this.lastNode=r}oncommentend(){this.lastNode=null}oncdatastart(){const t=new as(""),r=new $f([t]);this.addNode(r),t.parent=r,this.lastNode=t}oncdataend(){this.lastNode=null}onprocessinginstruction(t,r){const n=new Gu(t,r);this.addNode(n)}handleCallback(t){if(typeof this.callback=="function")this.callback(t,this.dom);else if(t)throw t}addNode(t){const r=this.tagStack[this.tagStack.length-1],n=r.children[r.children.length-1];this.options.withStartIndices&&(t.startIndex=this.parser.startIndex),this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),r.children.push(t),n&&(t.prev=n,n.next=t),t.parent=r,this.lastNode=null}}const gn=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),VT=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var Lo;const qT=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Wl=(Lo=String.fromCodePoint)!==null&&Lo!==void 0?Lo:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function WT(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=qT.get(e))!==null&&t!==void 0?t:e}var Xl;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.To_LOWER_BIT=32]="To_LOWER_BIT"})(Xl||(Xl={}));var an;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(an||(an={}));function Qf(e,t,r,n){const a=(t&an.BRANCH_LENGTH)>>7,f=t&an.JUMP_TABLE;if(a===0)return f!==0&&n===f?r:-1;if(f){const y=n-f;return y<0||y>=a?-1:e[r+y]-1}let E=r,A=E+a-1;for(;E<=A;){const y=E+A>>>1,_=e[y];if(_<n)E=y+1;else if(_>n)A=y-1;else return e[y+a]}return-1}const $l=/["&'<>$\x80-\uFFFF]/g,XT=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),$T=String.prototype.codePointAt!=null?(e,t)=>e.codePointAt(t):(e,t)=>(e.charCodeAt(t)&64512)===55296?(e.charCodeAt(t)-55296)*1024+e.charCodeAt(t+1)-56320+65536:e.charCodeAt(t);function zf(e){let t="",r=0,n;for(;(n=$l.exec(e))!==null;){const a=n.index,f=e.charCodeAt(a),E=XT.get(f);E!==void 0?(t+=e.substring(r,a)+E,r=a+1):(t+=`${e.substring(r,a)}&#x${$T(e,a).toString(16)};`,r=$l.lastIndex+=Number((f&64512)===55296))}return t+e.substr(r)}function Jf(e,t){return function(n){let a,f=0,E="";for(;a=e.exec(n);)f!==a.index&&(E+=n.substring(f,a.index)),E+=t.get(a[0].charCodeAt(0)),f=a.index+1;return E+n.substring(f)}}const Zf=Jf(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),ed=Jf(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),QT=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),zT=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),JT=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function ZT(e){return e.replace(/"/g,"&quot;")}function e1(e,t){var r;if(!e)return;const n=((r=t.encodeEntities)!==null&&r!==void 0?r:t.decodeEntities)===!1?ZT:t.xmlMode||t.encodeEntities!=="utf8"?zf:Zf;return Object.keys(e).map(a=>{var f,E;const A=(f=e[a])!==null&&f!==void 0?f:"";return t.xmlMode==="foreign"&&(a=(E=zT.get(a))!==null&&E!==void 0?E:a),!t.emptyAttrs&&!t.xmlMode&&A===""?a:`${a}="${n(A)}"`}).join(" ")}const Ql=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function Aa(e,t={}){const r="length"in e?e:[e];let n="";for(let a=0;a<r.length;a++)n+=t1(r[a],t);return n}function t1(e,t){switch(e.type){case wT:return Aa(e.children,t);case YT:case FT:return s1(e);case BT:return u1(e);case KT:return o1(e);case UT:case HT:case GT:return i1(e,t);case MT:return a1(e,t)}}const r1=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),n1=new Set(["svg","math"]);function i1(e,t){var r;t.xmlMode==="foreign"&&(e.name=(r=QT.get(e.name))!==null&&r!==void 0?r:e.name,e.parent&&r1.has(e.parent.name)&&(t={...t,xmlMode:!1})),!t.xmlMode&&n1.has(e.name)&&(t={...t,xmlMode:"foreign"});let n=`<${e.name}`;const a=e1(e.attribs,t);return a&&(n+=` ${a}`),e.children.length===0&&(t.xmlMode?t.selfClosingTags!==!1:t.selfClosingTags&&Ql.has(e.name))?(t.xmlMode||(n+=" "),n+="/>"):(n+=">",e.children.length>0&&(n+=Aa(e.children,t)),(t.xmlMode||!Ql.has(e.name))&&(n+=`</${e.name}>`)),n}function s1(e){return`<${e.data}>`}function a1(e,t){var r;let n=e.data||"";return((r=t.encodeEntities)!==null&&r!==void 0?r:t.decodeEntities)!==!1&&!(!t.xmlMode&&e.parent&&JT.has(e.parent.name))&&(n=t.xmlMode||t.encodeEntities!=="utf8"?zf(n):ed(n)),n}function o1(e){return`<![CDATA[${e.children[0].data}]]>`}function u1(e){return`<!--${e.data}-->`}function td(e,t){return Aa(e,t)}function c1(e,t){return er(e)?e.children.map(r=>td(r,t)).join(""):""}function Ys(e){return Array.isArray(e)?e.map(Ys).join(""):dt(e)?e.name==="br"?`
`:Ys(e.children):ba(e)?Ys(e.children):qr(e)?e.data:""}function Ti(e){return Array.isArray(e)?e.map(Ti).join(""):er(e)&&!ya(e)?Ti(e.children):qr(e)?e.data:""}function Zs(e){return Array.isArray(e)?e.map(Zs).join(""):er(e)&&(e.type===xt.Tag||ba(e))?Zs(e.children):qr(e)?e.data:""}function _a(e){return er(e)?e.children:[]}function rd(e){return e.parent||null}function nd(e){const t=rd(e);if(t!=null)return _a(t);const r=[e];let{prev:n,next:a}=e;for(;n!=null;)r.unshift(n),{prev:n}=n;for(;a!=null;)r.push(a),{next:a}=a;return r}function l1(e,t){var r;return(r=e.attribs)===null||r===void 0?void 0:r[t]}function h1(e,t){return e.attribs!=null&&Object.prototype.hasOwnProperty.call(e.attribs,t)&&e.attribs[t]!=null}function f1(e){return e.name}function ju(e){let{next:t}=e;for(;t!==null&&!dt(t);)({next:t}=t);return t}function Vu(e){let{prev:t}=e;for(;t!==null&&!dt(t);)({prev:t}=t);return t}function qn(e){if(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.parent){const t=e.parent.children;t.splice(t.lastIndexOf(e),1)}}function d1(e,t){const r=t.prev=e.prev;r&&(r.next=t);const n=t.next=e.next;n&&(n.prev=t);const a=t.parent=e.parent;if(a){const f=a.children;f[f.lastIndexOf(e)]=t,e.parent=null}}function g1(e,t){if(qn(t),t.next=null,t.parent=e,e.children.push(t)>1){const r=e.children[e.children.length-2];r.next=t,t.prev=r}else t.prev=null}function m1(e,t){qn(t);const{parent:r}=e,n=e.next;if(t.next=n,t.prev=e,e.next=t,t.parent=r,n){if(n.prev=t,r){const a=r.children;a.splice(a.lastIndexOf(n),0,t)}}else r&&r.children.push(t)}function p1(e,t){if(qn(t),t.parent=e,t.prev=null,e.children.unshift(t)!==1){const r=e.children[1];r.prev=t,t.next=r}else t.next=null}function E1(e,t){qn(t);const{parent:r}=e;if(r){const n=r.children;n.splice(n.indexOf(e),0,t)}e.prev&&(e.prev.next=t),t.parent=r,t.prev=e.prev,t.next=e,e.prev=t}function Sa(e,t,r=!0,n=1/0){return Array.isArray(t)||(t=[t]),Ia(e,t,r,n)}function Ia(e,t,r,n){const a=[];for(const f of t){if(e(f)&&(a.push(f),--n<=0))break;if(r&&er(f)&&f.children.length>0){const E=Ia(e,f.children,r,n);if(a.push(...E),n-=E.length,n<=0)break}}return a}function T1(e,t){return t.find(e)}function qu(e,t,r=!0){let n=null;for(let a=0;a<t.length&&!n;a++){const f=t[a];if(dt(f))e(f)?n=f:r&&f.children.length>0&&(n=qu(e,f.children,!0));else continue}return n}function id(e,t){return t.some(r=>dt(r)&&(e(r)||r.children.length>0&&id(e,r.children)))}function v1(e,t){var r;const n=[],a=t.filter(dt);let f;for(;f=a.shift();){const E=(r=f.children)===null||r===void 0?void 0:r.filter(dt);E&&E.length>0&&a.unshift(...E),e(f)&&n.push(f)}return n}const ea={tag_name(e){return typeof e=="function"?t=>dt(t)&&e(t.name):e==="*"?dt:t=>dt(t)&&t.name===e},tag_type(e){return typeof e=="function"?t=>e(t.type):t=>t.type===e},tag_contains(e){return typeof e=="function"?t=>qr(t)&&e(t.data):t=>qr(t)&&t.data===e}};function sd(e,t){return typeof t=="function"?r=>dt(r)&&t(r.attribs[e]):r=>dt(r)&&r.attribs[e]===t}function b1(e,t){return r=>e(r)||t(r)}function ad(e){const t=Object.keys(e).map(r=>{const n=e[r];return Object.prototype.hasOwnProperty.call(ea,r)?ea[r](n):sd(r,n)});return t.length===0?null:t.reduce(b1)}function y1(e,t){const r=ad(e);return r?r(t):!0}function A1(e,t,r,n=1/0){const a=ad(e);return a?Sa(a,t,r,n):[]}function _1(e,t,r=!0){return Array.isArray(t)||(t=[t]),qu(sd("id",e),t,r)}function _i(e,t,r=!0,n=1/0){return Sa(ea.tag_name(e),t,r,n)}function S1(e,t,r=!0,n=1/0){return Sa(ea.tag_type(e),t,r,n)}function I1(e){let t=e.length;for(;--t>=0;){const r=e[t];if(t>0&&e.lastIndexOf(r,t-1)>=0){e.splice(t,1);continue}for(let n=r.parent;n;n=n.parent)if(e.includes(n)){e.splice(t,1);break}}return e}var yr;(function(e){e[e.DISCONNECTED=1]="DISCONNECTED",e[e.PRECEDING=2]="PRECEDING",e[e.FOLLOWING=4]="FOLLOWING",e[e.CONTAINS=8]="CONTAINS",e[e.CONTAINED_BY=16]="CONTAINED_BY"})(yr||(yr={}));function od(e,t){const r=[],n=[];if(e===t)return 0;let a=er(e)?e:e.parent;for(;a;)r.unshift(a),a=a.parent;for(a=er(t)?t:t.parent;a;)n.unshift(a),a=a.parent;const f=Math.min(r.length,n.length);let E=0;for(;E<f&&r[E]===n[E];)E++;if(E===0)return yr.DISCONNECTED;const A=r[E-1],y=A.children,_=r[E],I=n[E];return y.indexOf(_)>y.indexOf(I)?A===t?yr.FOLLOWING|yr.CONTAINED_BY:yr.FOLLOWING:A===e?yr.PRECEDING|yr.CONTAINS:yr.PRECEDING}function Si(e){return e=e.filter((t,r,n)=>!n.includes(t,r+1)),e.sort((t,r)=>{const n=od(t,r);return n&yr.PRECEDING?-1:n&yr.FOLLOWING?1:0}),e}function C1(e){const t=ta(O1,e);return t?t.name==="feed"?L1(t):R1(t):null}function L1(e){var t;const r=e.children,n={type:"atom",items:_i("entry",r).map(E=>{var A;const{children:y}=E,_={media:ud(y)};dr(_,"id","id",y),dr(_,"title","title",y);const I=(A=ta("link",y))===null||A===void 0?void 0:A.attribs.href;I&&(_.link=I);const C=Un("summary",y)||Un("content",y);C&&(_.description=C);const b=Un("updated",y);return b&&(_.pubDate=new Date(b)),_})};dr(n,"id","id",r),dr(n,"title","title",r);const a=(t=ta("link",r))===null||t===void 0?void 0:t.attribs.href;a&&(n.link=a),dr(n,"description","subtitle",r);const f=Un("updated",r);return f&&(n.updated=new Date(f)),dr(n,"author","email",r,!0),n}function R1(e){var t,r;const n=(r=(t=ta("channel",e.children))===null||t===void 0?void 0:t.children)!==null&&r!==void 0?r:[],a={type:e.name.substr(0,3),id:"",items:_i("item",e.children).map(E=>{const{children:A}=E,y={media:ud(A)};dr(y,"id","guid",A),dr(y,"title","title",A),dr(y,"link","link",A),dr(y,"description","description",A);const _=Un("pubDate",A);return _&&(y.pubDate=new Date(_)),y})};dr(a,"title","title",n),dr(a,"link","link",n),dr(a,"description","description",n);const f=Un("lastBuildDate",n);return f&&(a.updated=new Date(f)),dr(a,"author","managingEditor",n,!0),a}const D1=["url","type","lang"],N1=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function ud(e){return _i("media:content",e).map(t=>{const{attribs:r}=t,n={medium:r.medium,isDefault:!!r.isDefault};for(const a of D1)r[a]&&(n[a]=r[a]);for(const a of N1)r[a]&&(n[a]=parseInt(r[a],10));return r.expression&&(n.expression=r.expression),n})}function ta(e,t){return _i(e,t,!0,1)[0]}function Un(e,t,r=!1){return Ti(_i(e,t,r,1)).trim()}function dr(e,t,r,n,a=!1){const f=Un(r,n,a);f&&(e[t]=f)}function O1(e){return e==="rss"||e==="feed"||e==="rdf:RDF"}const Ca=Object.freeze(Object.defineProperty({__proto__:null,get DocumentPosition(){return yr},append:m1,appendChild:g1,compareDocumentPosition:od,existsOne:id,filter:Sa,find:Ia,findAll:v1,findOne:qu,findOneChild:T1,getAttributeValue:l1,getChildren:_a,getElementById:_1,getElements:A1,getElementsByTagName:_i,getElementsByTagType:S1,getFeed:C1,getInnerHTML:c1,getName:f1,getOuterHTML:td,getParent:rd,getSiblings:nd,getText:Ys,hasAttrib:h1,hasChildren:er,innerText:Zs,isCDATA:ba,isComment:ya,isDocument:Vn,isTag:dt,isText:qr,nextElementSibling:ju,prepend:E1,prependChild:p1,prevElementSibling:Vu,removeElement:qn,removeSubsets:I1,replaceElement:d1,testElement:y1,textContent:Ti,uniqueSort:Si},Symbol.toStringTag,{value:"Module"}));function cd(e,t,r){return e?e(t??e._root.children,null,void 0,r).toString():""}function x1(e,t){return!t&&typeof e=="object"&&e!=null&&!("length"in e)&&!("type"in e)}function k1(e,t){const r=x1(e)?(t=e,void 0):e,n={...Bu,...this===null||this===void 0?void 0:this._options,...iu(t??{})};return cd(this,r,n)}function P1(e){const t={...this._options,xmlMode:!0};return cd(this,e,t)}function os(e){const t=e||(this?this.root():[]);let r="";for(let n=0;n<t.length;n++)r+=Ti(t[n]);return r}function w1(e,t,r=typeof t=="boolean"?t:!1){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(r=t);const n=this.load(e,Bu,!1);return r||n("script").remove(),n.root()[0].children.slice()}function M1(){return this(this._root)}function ld(e,t){if(t===e)return!1;let r=t;for(;r&&r!==r.parent;)if(r=r.parent,r===e)return!0;return!1}function F1(e,t){if(!zl(e)||!zl(t))return;let r=e.length;const n=+t.length;for(let a=0;a<n;a++)e[r++]=t[a];return e.length=r,e}function zl(e){if(Array.isArray(e))return!0;if(typeof e!="object"||!Object.prototype.hasOwnProperty.call(e,"length")||typeof e.length!="number"||e.length<0)return!1;for(let t=0;t<e.length;t++)if(!(t in e))return!1;return!0}const B1=Object.freeze(Object.defineProperty({__proto__:null,contains:ld,html:k1,merge:F1,parseHTML:w1,root:M1,text:os,xml:P1},Symbol.toStringTag,{value:"Module"}));function Wr(e){return e.cheerio!=null}function U1(e){return e.replace(/[_.-](\w|$)/g,(t,r)=>r.toUpperCase())}function H1(e){return e.replace(/[A-Z]/g,"-$&").toLowerCase()}function qt(e,t){const r=e.length;for(let n=0;n<r;n++)t(e[n],n);return e}function au(e){const t="length"in e?Array.prototype.map.call(e,n=>Js(n,!0)):[Js(e,!0)],r=new Yn(t);return t.forEach(n=>{n.parent=r}),t}var Mn;(function(e){e[e.LowerA=97]="LowerA",e[e.LowerZ=122]="LowerZ",e[e.UpperA=65]="UpperA",e[e.UpperZ=90]="UpperZ",e[e.Exclamation=33]="Exclamation"})(Mn||(Mn={}));function ou(e){const t=e.indexOf("<");if(t<0||t>e.length-3)return!1;const r=e.charCodeAt(t+1);return(r>=Mn.LowerA&&r<=Mn.LowerZ||r>=Mn.UpperA&&r<=Mn.UpperZ||r===Mn.Exclamation)&&e.includes(">",t+2)}const hi=Object.prototype.hasOwnProperty,us=/\s+/,Ro="data-",Jl={null:null,true:!0,false:!1},Wu=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,G1=/^{[^]*}$|^\[[^]*]$/;function ra(e,t,r){var n;if(!(!e||!dt(e))){if((n=e.attribs)!==null&&n!==void 0||(e.attribs={}),!t)return e.attribs;if(hi.call(e.attribs,t))return!r&&Wu.test(t)?t:e.attribs[t];if(e.name==="option"&&t==="value")return os(e.children);if(e.name==="input"&&(e.attribs.type==="radio"||e.attribs.type==="checkbox")&&t==="value")return"on"}}function fi(e,t,r){r===null?hd(e,t):e.attribs[t]=`${r}`}function K1(e,t){if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e!="string")throw new Error("Bad combination of arguments.");return qt(this,(r,n)=>{dt(r)&&fi(r,e,t.call(r,n,r.attribs[e]))})}return qt(this,r=>{dt(r)&&(typeof e=="object"?Object.keys(e).forEach(n=>{const a=e[n];fi(r,n,a)}):fi(r,e,t))})}return arguments.length>1?this:ra(this[0],e,this.options.xmlMode)}function Zl(e,t,r){return t in e?e[t]:!r&&Wu.test(t)?ra(e,t,!1)!==void 0:ra(e,t,r)}function Do(e,t,r,n){t in e?e[t]=r:fi(e,t,!n&&Wu.test(t)?r?"":null:`${r}`)}function Y1(e,t){var r;if(typeof e=="string"&&t===void 0){const n=this[0];if(!n||!dt(n))return;switch(e){case"style":{const a=this.css(),f=Object.keys(a);return f.forEach((E,A)=>{a[A]=E}),a.length=f.length,a}case"tagName":case"nodeName":return n.name.toUpperCase();case"href":case"src":{const a=(r=n.attribs)===null||r===void 0?void 0:r[e];return typeof URL<"u"&&(e==="href"&&(n.tagName==="a"||n.name==="link")||e==="src"&&(n.tagName==="img"||n.tagName==="iframe"||n.tagName==="audio"||n.tagName==="video"||n.tagName==="source"))&&a!==void 0&&this.options.baseURI?new URL(a,this.options.baseURI).href:a}case"innerText":return Zs(n);case"textContent":return Ti(n);case"outerHTML":return this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return Zl(n,e,this.options.xmlMode)}}if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e=="object")throw new Error("Bad combination of arguments.");return qt(this,(n,a)=>{dt(n)&&Do(n,e,t.call(n,a,Zl(n,e,this.options.xmlMode)),this.options.xmlMode)})}return qt(this,n=>{dt(n)&&(typeof e=="object"?Object.keys(e).forEach(a=>{const f=e[a];Do(n,a,f,this.options.xmlMode)}):Do(n,e,t,this.options.xmlMode))})}}function eh(e,t,r){var n;const a=e;(n=a.data)!==null&&n!==void 0||(a.data={}),typeof t=="object"?Object.assign(a.data,t):typeof t=="string"&&r!==void 0&&(a.data[t]=r)}function th(e,t){let r,n,a;t==null?(r=Object.keys(e.attribs).filter(f=>f.startsWith(Ro)),n=r.map(f=>U1(f.slice(Ro.length)))):(r=[Ro+H1(t)],n=[t]);for(let f=0;f<r.length;++f){const E=r[f],A=n[f];if(hi.call(e.attribs,E)&&!hi.call(e.data,A)){if(a=e.attribs[E],hi.call(Jl,a))a=Jl[a];else if(a===String(Number(a)))a=Number(a);else if(G1.test(a))try{a=JSON.parse(a)}catch{}e.data[A]=a}}return t==null?e.data:a}function j1(e,t){var r;const n=this[0];if(!n||!dt(n))return;const a=n;return(r=a.data)!==null&&r!==void 0||(a.data={}),e?typeof e=="object"||t!==void 0?(qt(this,f=>{dt(f)&&(typeof e=="object"?eh(f,e):eh(f,e,t))}),this):hi.call(a.data,e)?a.data[e]:th(a,e):th(a)}function V1(e){const t=arguments.length===0,r=this[0];if(!r||!dt(r))return t?void 0:this;switch(r.name){case"textarea":return this.text(e);case"select":{const n=this.find("option:selected");if(!t){if(this.attr("multiple")==null&&typeof e=="object")return this;this.find("option").removeAttr("selected");const a=typeof e!="object"?[e]:e;for(let f=0;f<a.length;f++)this.find(`option[value="${a[f]}"]`).attr("selected","");return this}return this.attr("multiple")?n.toArray().map(a=>os(a.children)):n.attr("value")}case"input":case"option":return t?this.attr("value"):this.attr("value",e)}}function hd(e,t){!e.attribs||!hi.call(e.attribs,t)||delete e.attribs[t]}function na(e){return e?e.trim().split(us):[]}function q1(e){const t=na(e);for(let r=0;r<t.length;r++)qt(this,n=>{dt(n)&&hd(n,t[r])});return this}function W1(e){return this.toArray().some(t=>{const r=dt(t)&&t.attribs.class;let n=-1;if(r&&e.length)for(;(n=r.indexOf(e,n+1))>-1;){const a=n+e.length;if((n===0||us.test(r[n-1]))&&(a===r.length||us.test(r[a])))return!0}return!1})}function fd(e){if(typeof e=="function")return qt(this,(n,a)=>{if(dt(n)){const f=n.attribs.class||"";fd.call([n],e.call(n,a,f))}});if(!e||typeof e!="string")return this;const t=e.split(us),r=this.length;for(let n=0;n<r;n++){const a=this[n];if(!dt(a))continue;const f=ra(a,"class",!1);if(!f)fi(a,"class",t.join(" ").trim());else{let E=` ${f} `;for(let A=0;A<t.length;A++){const y=`${t[A]} `;E.includes(` ${y}`)||(E+=y)}fi(a,"class",E.trim())}}return this}function dd(e){if(typeof e=="function")return qt(this,(a,f)=>{dt(a)&&dd.call([a],e.call(a,f,a.attribs.class||""))});const t=na(e),r=t.length,n=arguments.length===0;return qt(this,a=>{if(dt(a))if(n)a.attribs.class="";else{const f=na(a.attribs.class);let E=!1;for(let A=0;A<r;A++){const y=f.indexOf(t[A]);y>=0&&(f.splice(y,1),E=!0,A--)}E&&(a.attribs.class=f.join(" "))}})}function gd(e,t){if(typeof e=="function")return qt(this,(E,A)=>{dt(E)&&gd.call([E],e.call(E,A,E.attribs.class||"",t),t)});if(!e||typeof e!="string")return this;const r=e.split(us),n=r.length,a=typeof t=="boolean"?t?1:-1:0,f=this.length;for(let E=0;E<f;E++){const A=this[E];if(!dt(A))continue;const y=na(A.attribs.class);for(let _=0;_<n;_++){const I=y.indexOf(r[_]);a>=0&&I<0?y.push(r[_]):a<=0&&I>=0&&y.splice(I,1)}A.attribs.class=y.join(" ")}return this}const X1=Object.freeze(Object.defineProperty({__proto__:null,addClass:fd,attr:K1,data:j1,hasClass:W1,prop:Y1,removeAttr:q1,removeClass:dd,toggleClass:gd,val:V1},Symbol.toStringTag,{value:"Module"}));var ut;(function(e){e.Attribute="attribute",e.Pseudo="pseudo",e.PseudoElement="pseudo-element",e.Tag="tag",e.Universal="universal",e.Adjacent="adjacent",e.Child="child",e.Descendant="descendant",e.Parent="parent",e.Sibling="sibling",e.ColumnCombinator="column-combinator"})(ut||(ut={}));var Jt;(function(e){e.Any="any",e.Element="element",e.End="end",e.Equals="equals",e.Exists="exists",e.Hyphen="hyphen",e.Not="not",e.Start="start"})(Jt||(Jt={}));const rh=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,$1=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,Q1=new Map([[126,Jt.Element],[94,Jt.Start],[36,Jt.End],[42,Jt.Any],[33,Jt.Not],[124,Jt.Hyphen]]),z1=new Set(["has","not","matches","is","where","host","host-context"]);function qi(e){switch(e.type){case ut.Adjacent:case ut.Child:case ut.Descendant:case ut.Parent:case ut.Sibling:case ut.ColumnCombinator:return!0;default:return!1}}const J1=new Set(["contains","icontains"]);function Z1(e,t,r){const n=parseInt(t,16)-65536;return n!==n||r?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)}function Mi(e){return e.replace($1,Z1)}function No(e){return e===39||e===34}function nh(e){return e===32||e===9||e===10||e===12||e===13}function La(e){const t=[],r=md(t,`${e}`,0);if(r<e.length)throw new Error(`Unmatched selector: ${e.slice(r)}`);return t}function md(e,t,r){let n=[];function a(b){const L=t.slice(r+b).match(rh);if(!L)throw new Error(`Expected name, found ${t.slice(r)}`);const[O]=L;return r+=b+O.length,Mi(O)}function f(b){for(r+=b;r<t.length&&nh(t.charCodeAt(r));)r++}function E(){r+=1;const b=r;let L=1;for(;L>0&&r<t.length;r++)t.charCodeAt(r)===40&&!A(r)?L++:t.charCodeAt(r)===41&&!A(r)&&L--;if(L)throw new Error("Parenthesis not matched");return Mi(t.slice(b,r-1))}function A(b){let L=0;for(;t.charCodeAt(--b)===92;)L++;return(L&1)===1}function y(){if(n.length>0&&qi(n[n.length-1]))throw new Error("Did not expect successive traversals.")}function _(b){if(n.length>0&&n[n.length-1].type===ut.Descendant){n[n.length-1].type=b;return}y(),n.push({type:b})}function I(b,L){n.push({type:ut.Attribute,name:b,action:L,value:a(1),namespace:null,ignoreCase:"quirks"})}function C(){if(n.length&&n[n.length-1].type===ut.Descendant&&n.pop(),n.length===0)throw new Error("Empty sub-selector");e.push(n)}if(f(0),t.length===r)return r;e:for(;r<t.length;){const b=t.charCodeAt(r);switch(b){case 32:case 9:case 10:case 12:case 13:{(n.length===0||n[0].type!==ut.Descendant)&&(y(),n.push({type:ut.Descendant})),f(1);break}case 62:{_(ut.Child),f(1);break}case 60:{_(ut.Parent),f(1);break}case 126:{_(ut.Sibling),f(1);break}case 43:{_(ut.Adjacent),f(1);break}case 46:{I("class",Jt.Element);break}case 35:{I("id",Jt.Equals);break}case 91:{f(1);let L,O=null;t.charCodeAt(r)===124?L=a(1):t.startsWith("*|",r)?(O="*",L=a(2)):(L=a(0),t.charCodeAt(r)===124&&t.charCodeAt(r+1)!==61&&(O=L,L=a(1))),f(0);let oe=Jt.Exists;const z=Q1.get(t.charCodeAt(r));if(z){if(oe=z,t.charCodeAt(r+1)!==61)throw new Error("Expected `=`");f(2)}else t.charCodeAt(r)===61&&(oe=Jt.Equals,f(1));let ee="",le=null;if(oe!=="exists"){if(No(t.charCodeAt(r))){const ue=t.charCodeAt(r);let se=r+1;for(;se<t.length&&(t.charCodeAt(se)!==ue||A(se));)se+=1;if(t.charCodeAt(se)!==ue)throw new Error("Attribute value didn't end");ee=Mi(t.slice(r+1,se)),r=se+1}else{const ue=r;for(;r<t.length&&(!nh(t.charCodeAt(r))&&t.charCodeAt(r)!==93||A(r));)r+=1;ee=Mi(t.slice(ue,r))}f(0);const fe=t.charCodeAt(r)|32;fe===115?(le=!1,f(1)):fe===105&&(le=!0,f(1))}if(t.charCodeAt(r)!==93)throw new Error("Attribute selector didn't terminate");r+=1;const $={type:ut.Attribute,name:L,action:oe,value:ee,namespace:O,ignoreCase:le};n.push($);break}case 58:{if(t.charCodeAt(r+1)===58){n.push({type:ut.PseudoElement,name:a(2).toLowerCase(),data:t.charCodeAt(r)===40?E():null});continue}const L=a(1).toLowerCase();let O=null;if(t.charCodeAt(r)===40)if(z1.has(L)){if(No(t.charCodeAt(r+1)))throw new Error(`Pseudo-selector ${L} cannot be quoted`);if(O=[],r=md(O,t,r+1),t.charCodeAt(r)!==41)throw new Error(`Missing closing parenthesis in :${L} (${t})`);r+=1}else{if(O=E(),J1.has(L)){const oe=O.charCodeAt(0);oe===O.charCodeAt(O.length-1)&&No(oe)&&(O=O.slice(1,-1))}O=Mi(O)}n.push({type:ut.Pseudo,name:L,data:O});break}case 44:{C(),n=[],f(1);break}default:{if(t.startsWith("/*",r)){const oe=t.indexOf("*/",r+2);if(oe<0)throw new Error("Comment was not terminated");r=oe+2,n.length===0&&f(0);break}let L=null,O;if(b===42)r+=1,O="*";else if(b===124){if(O="",t.charCodeAt(r+1)===124){_(ut.ColumnCombinator),f(2);break}}else if(rh.test(t.slice(r)))O=a(0);else break e;t.charCodeAt(r)===124&&t.charCodeAt(r+1)!==124&&(L=O,t.charCodeAt(r+1)===42?(O="*",r+=2):O=a(1)),n.push(O==="*"?{type:ut.Universal,namespace:L}:{type:ut.Tag,name:O,namespace:L})}}}return C(),r}var ev=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yt={trueFunc:function(){return!0},falseFunc:function(){return!1}};const pd=new Map([[ut.Universal,50],[ut.Tag,30],[ut.Attribute,1],[ut.Pseudo,0]]);function Xu(e){return!pd.has(e.type)}const rv=new Map([[Jt.Exists,10],[Jt.Equals,8],[Jt.Not,7],[Jt.Start,6],[Jt.End,6],[Jt.Any,5]]);function nv(e){const t=e.map(Ed);for(let r=1;r<e.length;r++){const n=t[r];if(!(n<0))for(let a=r-1;a>=0&&n<t[a];a--){const f=e[a+1];e[a+1]=e[a],e[a]=f,t[a+1]=t[a],t[a]=n}}}function Ed(e){var t,r;let n=(t=pd.get(e.type))!==null&&t!==void 0?t:-1;return e.type===ut.Attribute?(n=(r=rv.get(e.action))!==null&&r!==void 0?r:4,e.action===Jt.Equals&&e.name==="id"&&(n=9),e.ignoreCase&&(n>>=1)):e.type===ut.Pseudo&&(e.data?e.name==="has"||e.name==="contains"?n=0:Array.isArray(e.data)?(n=Math.min(...e.data.map(a=>Math.min(...a.map(Ed)))),n<0&&(n=0)):n=2:n=3),n}const iv=/[-[\]{}()*+?.,\\^$|#\s]/g;function ih(e){return e.replace(iv,"\\$&")}const sv=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function On(e,t){return typeof e.ignoreCase=="boolean"?e.ignoreCase:e.ignoreCase==="quirks"?!!t.quirksMode:!t.xmlMode&&sv.has(e.name)}const av={equals(e,t,r){const{adapter:n}=r,{name:a}=t;let{value:f}=t;return On(t,r)?(f=f.toLowerCase(),E=>{const A=n.getAttributeValue(E,a);return A!=null&&A.length===f.length&&A.toLowerCase()===f&&e(E)}):E=>n.getAttributeValue(E,a)===f&&e(E)},hyphen(e,t,r){const{adapter:n}=r,{name:a}=t;let{value:f}=t;const E=f.length;return On(t,r)?(f=f.toLowerCase(),function(y){const _=n.getAttributeValue(y,a);return _!=null&&(_.length===E||_.charAt(E)==="-")&&_.substr(0,E).toLowerCase()===f&&e(y)}):function(y){const _=n.getAttributeValue(y,a);return _!=null&&(_.length===E||_.charAt(E)==="-")&&_.substr(0,E)===f&&e(y)}},element(e,t,r){const{adapter:n}=r,{name:a,value:f}=t;if(/\s/.test(f))return yt.falseFunc;const E=new RegExp(`(?:^|\\s)${ih(f)}(?:$|\\s)`,On(t,r)?"i":"");return function(y){const _=n.getAttributeValue(y,a);return _!=null&&_.length>=f.length&&E.test(_)&&e(y)}},exists(e,{name:t},{adapter:r}){return n=>r.hasAttrib(n,t)&&e(n)},start(e,t,r){const{adapter:n}=r,{name:a}=t;let{value:f}=t;const E=f.length;return E===0?yt.falseFunc:On(t,r)?(f=f.toLowerCase(),A=>{const y=n.getAttributeValue(A,a);return y!=null&&y.length>=E&&y.substr(0,E).toLowerCase()===f&&e(A)}):A=>{var y;return!!(!((y=n.getAttributeValue(A,a))===null||y===void 0)&&y.startsWith(f))&&e(A)}},end(e,t,r){const{adapter:n}=r,{name:a}=t;let{value:f}=t;const E=-f.length;return E===0?yt.falseFunc:On(t,r)?(f=f.toLowerCase(),A=>{var y;return((y=n.getAttributeValue(A,a))===null||y===void 0?void 0:y.substr(E).toLowerCase())===f&&e(A)}):A=>{var y;return!!(!((y=n.getAttributeValue(A,a))===null||y===void 0)&&y.endsWith(f))&&e(A)}},any(e,t,r){const{adapter:n}=r,{name:a,value:f}=t;if(f==="")return yt.falseFunc;if(On(t,r)){const E=new RegExp(ih(f),"i");return function(y){const _=n.getAttributeValue(y,a);return _!=null&&_.length>=f.length&&E.test(_)&&e(y)}}return E=>{var A;return!!(!((A=n.getAttributeValue(E,a))===null||A===void 0)&&A.includes(f))&&e(E)}},not(e,t,r){const{adapter:n}=r,{name:a}=t;let{value:f}=t;return f===""?E=>!!n.getAttributeValue(E,a)&&e(E):On(t,r)?(f=f.toLowerCase(),E=>{const A=n.getAttributeValue(E,a);return(A==null||A.length!==f.length||A.toLowerCase()!==f)&&e(E)}):E=>n.getAttributeValue(E,a)!==f&&e(E)}},ov=new Set([9,10,12,13,32]),sh="0".charCodeAt(0),uv="9".charCodeAt(0);function cv(e){if(e=e.trim().toLowerCase(),e==="even")return[2,0];if(e==="odd")return[2,1];let t=0,r=0,n=f(),a=E();if(t<e.length&&e.charAt(t)==="n"&&(t++,r=n*(a??1),A(),t<e.length?(n=f(),A(),a=E()):n=a=0),a===null||t<e.length)throw new Error(`n-th rule couldn't be parsed ('${e}')`);return[r,n*a];function f(){return e.charAt(t)==="-"?(t++,-1):(e.charAt(t)==="+"&&t++,1)}function E(){const y=t;let _=0;for(;t<e.length&&e.charCodeAt(t)>=sh&&e.charCodeAt(t)<=uv;)_=_*10+(e.charCodeAt(t)-sh),t++;return t===y?null:_}function A(){for(;t<e.length&&ov.has(e.charCodeAt(t));)t++}}function lv(e){const t=e[0],r=e[1]-1;if(r<0&&t<=0)return yt.falseFunc;if(t===-1)return f=>f<=r;if(t===0)return f=>f===r;if(t===1)return r<0?yt.trueFunc:f=>f>=r;const n=Math.abs(t),a=(r%n+n)%n;return t>1?f=>f>=r&&f%n===a:f=>f<=r&&f%n===a}function Os(e){return lv(cv(e))}function xs(e,t){return r=>{const n=t.getParent(r);return n!=null&&t.isTag(n)&&e(r)}}const uu={contains(e,t,{adapter:r}){return function(a){return e(a)&&r.getText(a).includes(t)}},icontains(e,t,{adapter:r}){const n=t.toLowerCase();return function(f){return e(f)&&r.getText(f).toLowerCase().includes(n)}},"nth-child"(e,t,{adapter:r,equals:n}){const a=Os(t);return a===yt.falseFunc?yt.falseFunc:a===yt.trueFunc?xs(e,r):function(E){const A=r.getSiblings(E);let y=0;for(let _=0;_<A.length&&!n(E,A[_]);_++)r.isTag(A[_])&&y++;return a(y)&&e(E)}},"nth-last-child"(e,t,{adapter:r,equals:n}){const a=Os(t);return a===yt.falseFunc?yt.falseFunc:a===yt.trueFunc?xs(e,r):function(E){const A=r.getSiblings(E);let y=0;for(let _=A.length-1;_>=0&&!n(E,A[_]);_--)r.isTag(A[_])&&y++;return a(y)&&e(E)}},"nth-of-type"(e,t,{adapter:r,equals:n}){const a=Os(t);return a===yt.falseFunc?yt.falseFunc:a===yt.trueFunc?xs(e,r):function(E){const A=r.getSiblings(E);let y=0;for(let _=0;_<A.length;_++){const I=A[_];if(n(E,I))break;r.isTag(I)&&r.getName(I)===r.getName(E)&&y++}return a(y)&&e(E)}},"nth-last-of-type"(e,t,{adapter:r,equals:n}){const a=Os(t);return a===yt.falseFunc?yt.falseFunc:a===yt.trueFunc?xs(e,r):function(E){const A=r.getSiblings(E);let y=0;for(let _=A.length-1;_>=0;_--){const I=A[_];if(n(E,I))break;r.isTag(I)&&r.getName(I)===r.getName(E)&&y++}return a(y)&&e(E)}},root(e,t,{adapter:r}){return n=>{const a=r.getParent(n);return(a==null||!r.isTag(a))&&e(n)}},scope(e,t,r,n){const{equals:a}=r;return!n||n.length===0?uu.root(e,t,r):n.length===1?f=>a(n[0],f)&&e(f):f=>n.includes(f)&&e(f)},hover:Oo("isHovered"),visited:Oo("isVisited"),active:Oo("isActive")};function Oo(e){return function(r,n,{adapter:a}){const f=a[e];return typeof f!="function"?yt.falseFunc:function(A){return f(A)&&r(A)}}}const ah={empty(e,{adapter:t}){return!t.getChildren(e).some(r=>t.isTag(r)||t.getText(r)!=="")},"first-child"(e,{adapter:t,equals:r}){if(t.prevElementSibling)return t.prevElementSibling(e)==null;const n=t.getSiblings(e).find(a=>t.isTag(a));return n!=null&&r(e,n)},"last-child"(e,{adapter:t,equals:r}){const n=t.getSiblings(e);for(let a=n.length-1;a>=0;a--){if(r(e,n[a]))return!0;if(t.isTag(n[a]))break}return!1},"first-of-type"(e,{adapter:t,equals:r}){const n=t.getSiblings(e),a=t.getName(e);for(let f=0;f<n.length;f++){const E=n[f];if(r(e,E))return!0;if(t.isTag(E)&&t.getName(E)===a)break}return!1},"last-of-type"(e,{adapter:t,equals:r}){const n=t.getSiblings(e),a=t.getName(e);for(let f=n.length-1;f>=0;f--){const E=n[f];if(r(e,E))return!0;if(t.isTag(E)&&t.getName(E)===a)break}return!1},"only-of-type"(e,{adapter:t,equals:r}){const n=t.getName(e);return t.getSiblings(e).every(a=>r(e,a)||!t.isTag(a)||t.getName(a)!==n)},"only-child"(e,{adapter:t,equals:r}){return t.getSiblings(e).every(n=>r(e,n)||!t.isTag(n))}};function oh(e,t,r,n){if(r===null){if(e.length>n)throw new Error(`Pseudo-class :${t} requires an argument`)}else if(e.length===n)throw new Error(`Pseudo-class :${t} doesn't have any arguments`)}const hv={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:`:is(
        :is(button, input, select, textarea, optgroup, option)[disabled],
        optgroup[disabled] > option,
        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)
    )`,enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"},Td={};function fv(e,t){return e===yt.falseFunc?yt.falseFunc:r=>t.isTag(r)&&e(r)}function vd(e,t){const r=t.getSiblings(e);if(r.length<=1)return[];const n=r.indexOf(e);return n<0||n===r.length-1?[]:r.slice(n+1).filter(t.isTag)}function cu(e){return{xmlMode:!!e.xmlMode,lowerCaseAttributeNames:!!e.lowerCaseAttributeNames,lowerCaseTags:!!e.lowerCaseTags,quirksMode:!!e.quirksMode,cacheResults:!!e.cacheResults,pseudos:e.pseudos,adapter:e.adapter,equals:e.equals}}const xo=(e,t,r,n,a)=>{const f=a(t,cu(r),n);return f===yt.trueFunc?e:f===yt.falseFunc?yt.falseFunc:E=>f(E)&&e(E)},ko={is:xo,matches:xo,where:xo,not(e,t,r,n,a){const f=a(t,cu(r),n);return f===yt.falseFunc?e:f===yt.trueFunc?yt.falseFunc:E=>!f(E)&&e(E)},has(e,t,r,n,a){const{adapter:f}=r,E=cu(r);E.relativeSelector=!0;const A=t.some(I=>I.some(Xu))?[Td]:void 0,y=a(t,E,A);if(y===yt.falseFunc)return yt.falseFunc;const _=fv(y,f);if(A&&y!==yt.trueFunc){const{shouldTestNextSiblings:I=!1}=y;return C=>{if(!e(C))return!1;A[0]=C;const b=f.getChildren(C),L=I?[...b,...vd(C,f)]:b;return f.existsOne(_,L)}}return I=>e(I)&&f.existsOne(_,f.getChildren(I))}};function dv(e,t,r,n,a){var f;const{name:E,data:A}=t;if(Array.isArray(A)){if(!(E in ko))throw new Error(`Unknown pseudo-class :${E}(${A})`);return ko[E](e,A,r,n,a)}const y=(f=r.pseudos)===null||f===void 0?void 0:f[E],_=typeof y=="string"?y:hv[E];if(typeof _=="string"){if(A!=null)throw new Error(`Pseudo ${E} doesn't have any arguments`);const I=La(_);return ko.is(e,I,r,n,a)}if(typeof y=="function")return oh(y,E,A,1),I=>y(I,A)&&e(I);if(E in uu)return uu[E](e,A,r,n);if(E in ah){const I=ah[E];return oh(I,E,A,2),C=>I(C,r,A)&&e(C)}throw new Error(`Unknown pseudo-class :${E}`)}function Po(e,t){const r=t.getParent(e);return r&&t.isTag(r)?r:null}function gv(e,t,r,n,a){const{adapter:f,equals:E}=r;switch(t.type){case ut.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case ut.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case ut.Attribute:{if(t.namespace!=null)throw new Error("Namespaced attributes are not yet supported by css-select");return(!r.xmlMode||r.lowerCaseAttributeNames)&&(t.name=t.name.toLowerCase()),av[t.action](e,t,r)}case ut.Pseudo:return dv(e,t,r,n,a);case ut.Tag:{if(t.namespace!=null)throw new Error("Namespaced tag names are not yet supported by css-select");let{name:A}=t;return(!r.xmlMode||r.lowerCaseTags)&&(A=A.toLowerCase()),function(_){return f.getName(_)===A&&e(_)}}case ut.Descendant:{if(r.cacheResults===!1||typeof WeakSet>"u")return function(_){let I=_;for(;I=Po(I,f);)if(e(I))return!0;return!1};const A=new WeakSet;return function(_){let I=_;for(;I=Po(I,f);)if(!A.has(I)){if(f.isTag(I)&&e(I))return!0;A.add(I)}return!1}}case"_flexibleDescendant":return function(y){let _=y;do if(e(_))return!0;while(_=Po(_,f));return!1};case ut.Parent:return function(y){return f.getChildren(y).some(_=>f.isTag(_)&&e(_))};case ut.Child:return function(y){const _=f.getParent(y);return _!=null&&f.isTag(_)&&e(_)};case ut.Sibling:return function(y){const _=f.getSiblings(y);for(let I=0;I<_.length;I++){const C=_[I];if(E(y,C))break;if(f.isTag(C)&&e(C))return!0}return!1};case ut.Adjacent:return f.prevElementSibling?function(y){const _=f.prevElementSibling(y);return _!=null&&e(_)}:function(y){const _=f.getSiblings(y);let I;for(let C=0;C<_.length;C++){const b=_[C];if(E(y,b))break;f.isTag(b)&&(I=b)}return!!I&&e(I)};case ut.Universal:{if(t.namespace!=null&&t.namespace!=="*")throw new Error("Namespaced universal selectors are not yet supported by css-select");return e}}}function bd(e){return e.type===ut.Pseudo&&(e.name==="scope"||Array.isArray(e.data)&&e.data.some(t=>t.some(bd)))}const mv={type:ut.Descendant},pv={type:"_flexibleDescendant"},Ev={type:ut.Pseudo,name:"scope",data:null};function Tv(e,{adapter:t},r){const n=!!(r!=null&&r.every(a=>{const f=t.isTag(a)&&t.getParent(a);return a===Td||f&&t.isTag(f)}));for(const a of e){if(!(a.length>0&&Xu(a[0])&&a[0].type!==ut.Descendant))if(n&&!a.some(bd))a.unshift(mv);else continue;a.unshift(Ev)}}function yd(e,t,r){var n;e.forEach(nv),r=(n=t.context)!==null&&n!==void 0?n:r;const a=Array.isArray(r),f=r&&(Array.isArray(r)?r:[r]);if(t.relativeSelector!==!1)Tv(e,t,f);else if(e.some(y=>y.length>0&&Xu(y[0])))throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled");let E=!1;const A=e.map(y=>{if(y.length>=2){const[_,I]=y;_.type!==ut.Pseudo||_.name!=="scope"||(a&&I.type===ut.Descendant?y[1]=pv:(I.type===ut.Adjacent||I.type===ut.Sibling)&&(E=!0))}return vv(y,t,f)}).reduce(bv,yt.falseFunc);return A.shouldTestNextSiblings=E,A}function vv(e,t,r){var n;return e.reduce((a,f)=>a===yt.falseFunc?yt.falseFunc:gv(a,f,t,r,yd),(n=t.rootFunc)!==null&&n!==void 0?n:yt.trueFunc)}function bv(e,t){return t===yt.falseFunc||e===yt.trueFunc?e:e===yt.falseFunc||t===yt.trueFunc?t:function(n){return e(n)||t(n)}}const Ad=(e,t)=>e===t,yv={adapter:Ca,equals:Ad};function Av(e){var t,r,n,a;const f=e??yv;return(t=f.adapter)!==null&&t!==void 0||(f.adapter=Ca),(r=f.equals)!==null&&r!==void 0||(f.equals=(a=(n=f.adapter)===null||n===void 0?void 0:n.equals)!==null&&a!==void 0?a:Ad),f}function _v(e){return function(r,n,a){const f=Av(n);return e(r,f,a)}}const $u=_v(yd);function _d(e,t,r=!1){return r&&(e=Sv(e,t)),Array.isArray(e)?t.removeSubsets(e):t.getChildren(e)}function Sv(e,t){const r=Array.isArray(e)?e.slice(0):[e],n=r.length;for(let a=0;a<n;a++){const f=vd(r[a],t);r.push(...f)}return r}const Iv=new Set(["first","last","eq","gt","nth","lt","even","odd"]);function ia(e){return e.type!=="pseudo"?!1:Iv.has(e.name)?!0:e.name==="not"&&Array.isArray(e.data)?e.data.some(t=>t.some(ia)):!1}function Cv(e,t,r){const n=t!=null?parseInt(t,10):NaN;switch(e){case"first":return 1;case"nth":case"eq":return isFinite(n)?n>=0?n+1:1/0:0;case"lt":return isFinite(n)?n>=0?Math.min(n,r):1/0:0;case"gt":return isFinite(n)?1/0:0;case"odd":return 2*r;case"even":return 2*r-1;case"last":case"not":return 1/0}}function Lv(e){for(;e.parent;)e=e.parent;return e}function Qu(e){const t=[],r=[];for(const n of e)n.some(ia)?t.push(n):r.push(n);return[r,t]}const Rv={type:ut.Universal,namespace:null},Dv={type:ut.Pseudo,name:"scope",data:null};function Sd(e,t,r={}){return Id([e],t,r)}function Id(e,t,r={}){if(typeof t=="function")return e.some(t);const[n,a]=Qu(La(t));return n.length>0&&e.some($u(n,r))||a.some(f=>Rd(f,e,r).length>0)}function Nv(e,t,r,n){const a=typeof r=="string"?parseInt(r,10):NaN;switch(e){case"first":case"lt":return t;case"last":return t.length>0?[t[t.length-1]]:t;case"nth":case"eq":return isFinite(a)&&Math.abs(a)<t.length?[a<0?t[t.length+a]:t[a]]:[];case"gt":return isFinite(a)?t.slice(a+1):[];case"even":return t.filter((f,E)=>E%2===0);case"odd":return t.filter((f,E)=>E%2===1);case"not":{const f=new Set(Ld(r,t,n));return t.filter(E=>!f.has(E))}}}function Cd(e,t,r={}){return Ld(La(e),t,r)}function Ld(e,t,r){if(t.length===0)return[];const[n,a]=Qu(e);let f;if(n.length){const E=hu(t,n,r);if(a.length===0)return E;E.length&&(f=new Set(E))}for(let E=0;E<a.length&&(f==null?void 0:f.size)!==t.length;E++){const A=a[E];if((f?t.filter(I=>dt(I)&&!f.has(I)):t).length===0)break;const _=Rd(A,t,r);if(_.length)if(f)_.forEach(I=>f.add(I));else{if(E===a.length-1)return _;f=new Set(_)}}return typeof f<"u"?f.size===t.length?t:t.filter(E=>f.has(E)):[]}function Rd(e,t,r){var n;if(e.some(qi)){const a=(n=r.root)!==null&&n!==void 0?n:Lv(t[0]),f={...r,context:t,relativeSelector:!1};return e.push(Dv),sa(a,e,f,!0,t.length)}return sa(t,e,r,!1,t.length)}function Ov(e,t,r={},n=1/0){if(typeof e=="function")return Dd(t,e);const[a,f]=Qu(La(e)),E=f.map(A=>sa(t,A,r,!0,n));return a.length&&E.push(lu(t,a,r,n)),E.length===0?[]:E.length===1?E[0]:Si(E.reduce((A,y)=>[...A,...y]))}function sa(e,t,r,n,a){const f=t.findIndex(ia),E=t.slice(0,f),A=t[f],y=t.length-1===f?a:1/0,_=Cv(A.name,A.data,y);if(_===0)return[];const C=(E.length===0&&!Array.isArray(e)?_a(e).filter(dt):E.length===0?(Array.isArray(e)?e:[e]).filter(dt):n||E.some(qi)?lu(e,[E],r,_):hu(e,[E],r)).slice(0,_);let b=Nv(A.name,C,A.data,r);if(b.length===0||t.length===f+1)return b;const L=t.slice(f+1),O=L.some(qi);if(O){if(qi(L[0])){const{type:oe}=L[0];(oe===ut.Sibling||oe===ut.Adjacent)&&(b=_d(b,Ca,!0)),L.unshift(Rv)}r={...r,relativeSelector:!1,rootFunc:oe=>b.includes(oe)}}else r.rootFunc&&r.rootFunc!==yt.trueFunc&&(r={...r,rootFunc:yt.trueFunc});return L.some(ia)?sa(b,L,r,!1,a):O?lu(b,[L],r,a):hu(b,[L],r)}function lu(e,t,r,n){const a=$u(t,r,e);return Dd(e,a,n)}function Dd(e,t,r=1/0){const n=_d(e,Ca,t.shouldTestNextSiblings);return Ia(a=>dt(a)&&t(a),n,!0,r)}function hu(e,t,r){const n=(Array.isArray(e)?e:[e]).filter(dt);if(n.length===0)return n;const a=$u(t,r);return a===yt.trueFunc?n:n.filter(a)}const xv=/^\s*[~+]/;function kv(e){var t;if(!e)return this._make([]);const r=this.toArray();if(typeof e!="string"){const f=Wr(e)?e.toArray():[e];return this._make(f.filter(E=>r.some(A=>ld(A,E))))}const n=xv.test(e)?r:this.children().toArray(),a={context:r,root:(t=this._root)===null||t===void 0?void 0:t[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(Ov(e,n,a))}function zu(e){return function(t,...r){return function(n){var a;let f=e(t,this);return n&&(f=ec(f,n,this.options.xmlMode,(a=this._root)===null||a===void 0?void 0:a[0])),this._make(this.length>1&&f.length>1?r.reduce((E,A)=>A(E),f):f)}}}const fs=zu((e,t)=>{const r=[];for(let n=0;n<t.length;n++){const a=e(t[n]);r.push(a)}return new Array().concat(...r)}),Ju=zu((e,t)=>{const r=[];for(let n=0;n<t.length;n++){const a=e(t[n]);a!==null&&r.push(a)}return r});function Zu(e,...t){let r=null;const n=zu((a,f)=>{const E=[];return qt(f,A=>{for(let y;(y=a(A))&&!(r!=null&&r(y,E.length));A=y)E.push(y)}),E})(e,...t);return function(a,f){r=typeof a=="string"?A=>Sd(A,a,this.options):a?ds(a):null;const E=n.call(this,f);return r=null,E}}function Ii(e){return Array.from(new Set(e))}const Pv=Ju(({parent:e})=>e&&!Vn(e)?e:null,Ii),wv=fs(e=>{const t=[];for(;e.parent&&!Vn(e.parent);)t.push(e.parent),e=e.parent;return t},Si,e=>e.reverse()),Mv=Zu(({parent:e})=>e&&!Vn(e)?e:null,Si,e=>e.reverse());function Fv(e){var t;const r=[];if(!e)return this._make(r);const n={xmlMode:this.options.xmlMode,root:(t=this._root)===null||t===void 0?void 0:t[0]},a=typeof e=="string"?f=>Sd(f,e,n):ds(e);return qt(this,f=>{for(;f&&dt(f);){if(a(f,0)){r.includes(f)||r.push(f);break}f=f.parent}}),this._make(r)}const Bv=Ju(e=>ju(e)),Uv=fs(e=>{const t=[];for(;e.next;)e=e.next,dt(e)&&t.push(e);return t},Ii),Hv=Zu(e=>ju(e),Ii),Gv=Ju(e=>Vu(e)),Kv=fs(e=>{const t=[];for(;e.prev;)e=e.prev,dt(e)&&t.push(e);return t},Ii),Yv=Zu(e=>Vu(e),Ii),jv=fs(e=>nd(e).filter(t=>dt(t)&&t!==e),Si),Vv=fs(e=>_a(e).filter(dt),Ii);function qv(){const e=this.toArray().reduce((t,r)=>er(r)?t.concat(r.children):t,[]);return this._make(e)}function Wv(e){let t=0;const r=this.length;for(;t<r&&e.call(this[t],t,this[t])!==!1;)++t;return this}function Xv(e){let t=[];for(let r=0;r<this.length;r++){const n=this[r],a=e.call(n,r,n);a!=null&&(t=t.concat(a))}return this._make(t)}function ds(e){return typeof e=="function"?(t,r)=>e.call(t,r,t):Wr(e)?t=>Array.prototype.includes.call(e,t):function(t){return e===t}}function $v(e){var t;return this._make(ec(this.toArray(),e,this.options.xmlMode,(t=this._root)===null||t===void 0?void 0:t[0]))}function ec(e,t,r,n){return typeof t=="string"?Cd(t,e,{xmlMode:r,root:n}):e.filter(ds(t))}function Qv(e){const t=this.toArray();return typeof e=="string"?Id(t.filter(dt),e,this.options):e?t.some(ds(e)):!1}function zv(e){let t=this.toArray();if(typeof e=="string"){const r=new Set(Cd(e,t,this.options));t=t.filter(n=>!r.has(n))}else{const r=ds(e);t=t.filter((n,a)=>!r(n,a))}return this._make(t)}function Jv(e){return this.filter(typeof e=="string"?`:has(${e})`:(t,r)=>this._make(r).find(e).length>0)}function Zv(){return this.length>1?this._make(this[0]):this}function eb(){return this.length>0?this._make(this[this.length-1]):this}function tb(e){var t;return e=+e,e===0&&this.length<=1?this:(e<0&&(e=this.length+e),this._make((t=this[e])!==null&&t!==void 0?t:[]))}function rb(e){return e==null?this.toArray():this[e<0?this.length+e:e]}function nb(){return Array.prototype.slice.call(this)}function ib(e){let t,r;return e==null?(t=this.parent().children(),r=this[0]):typeof e=="string"?(t=this._make(e),r=this[0]):(t=this,r=Wr(e)?e[0]:e),Array.prototype.indexOf.call(t,r)}function sb(e,t){return this._make(Array.prototype.slice.call(this,e,t))}function ab(){var e;return(e=this.prevObject)!==null&&e!==void 0?e:this._make([])}function ob(e,t){const r=this._make(e,t),n=Si([...this.get(),...r.get()]);return this._make(n)}function ub(e){return this.prevObject?this.add(e?this.prevObject.filter(e):this.prevObject):this}const cb=Object.freeze(Object.defineProperty({__proto__:null,add:ob,addBack:ub,children:Vv,closest:Fv,contents:qv,each:Wv,end:ab,eq:tb,filter:$v,filterArray:ec,find:kv,first:Zv,get:rb,has:Jv,index:ib,is:Qv,last:eb,map:Xv,next:Bv,nextAll:Uv,nextUntil:Hv,not:zv,parent:Pv,parents:wv,parentsUntil:Mv,prev:Gv,prevAll:Kv,prevUntil:Yv,siblings:jv,slice:sb,toArray:nb},Symbol.toStringTag,{value:"Module"}));function lb(e){return function(r,n,a,f){if(typeof Buffer<"u"&&Buffer.isBuffer(r)&&(r=r.toString()),typeof r=="string")return e(r,n,a,f);const E=r;if(!Array.isArray(E)&&Vn(E))return E;const A=new Yn([]);return jn(E,A),A}}function jn(e,t){const r=Array.isArray(e)?e:[e];t?t.children=r:t=null;for(let n=0;n<r.length;n++){const a=r[n];a.parent&&a.parent.children!==r&&qn(a),t?(a.prev=r[n-1]||null,a.next=r[n+1]||null):a.prev=a.next=null,a.parent=t}return t}function hb(e,t){return e==null?[]:Wr(e)?t?au(e.get()):e.get():Array.isArray(e)?e.reduce((r,n)=>r.concat(this._makeDomArray(n,t)),[]):typeof e=="string"?this._parse(e,this.options,!1,null).children:t?au([e]):[e]}function Nd(e){return function(...t){const r=this.length-1;return qt(this,(n,a)=>{if(!er(n))return;const f=typeof t[0]=="function"?t[0].call(n,a,this._render(n.children)):t,E=this._makeDomArray(f,a<r);e(E,n.children,n)})}}function _n(e,t,r,n,a){var f,E;const A=[t,r,...n],y=t===0?null:e[t-1],_=t+r>=e.length?null:e[t+r];for(let I=0;I<n.length;++I){const C=n[I],b=C.parent;if(b){const O=b.children.indexOf(C);O>-1&&(b.children.splice(O,1),a===b&&t>O&&A[0]--)}C.parent=a,C.prev&&(C.prev.next=(f=C.next)!==null&&f!==void 0?f:null),C.next&&(C.next.prev=(E=C.prev)!==null&&E!==void 0?E:null),C.prev=I===0?y:n[I-1],C.next=I===n.length-1?_:n[I+1]}return y&&(y.next=n[0]),_&&(_.prev=n[n.length-1]),e.splice(...A)}function fb(e){return(Wr(e)?e:this._make(e)).append(this),this}function db(e){return(Wr(e)?e:this._make(e)).prepend(this),this}const gb=Nd((e,t,r)=>{_n(t,t.length,0,e,r)}),mb=Nd((e,t,r)=>{_n(t,0,0,e,r)});function Od(e){return function(t){const r=this.length-1,n=this.parents().last();for(let a=0;a<this.length;a++){const f=this[a],E=typeof t=="function"?t.call(f,a,f):typeof t=="string"&&!ou(t)?n.find(t).clone():t,[A]=this._makeDomArray(E,a<r);if(!A||!er(A))continue;let y=A,_=0;for(;_<y.children.length;){const I=y.children[_];dt(I)?(y=I,_=0):_++}e(f,y,[A])}return this}}const pb=Od((e,t,r)=>{const{parent:n}=e;if(!n)return;const a=n.children,f=a.indexOf(e);jn([e],t),_n(a,f,0,r,n)}),Eb=Od((e,t,r)=>{er(e)&&(jn(e.children,t),jn(r,e))});function Tb(e){return this.parent(e).not("body").each((t,r)=>{this._make(r).replaceWith(r.children)}),this}function vb(e){const t=this[0];if(t){const r=this._make(typeof e=="function"?e.call(t,0,t):e).insertBefore(t);let n;for(let f=0;f<r.length;f++)r[f].type==="tag"&&(n=r[f]);let a=0;for(;n&&a<n.children.length;){const f=n.children[a];f.type==="tag"?(n=f,a=0):a++}n&&this._make(n).append(this)}return this}function bb(...e){const t=this.length-1;return qt(this,(r,n)=>{const{parent:a}=r;if(!er(r)||!a)return;const f=a.children,E=f.indexOf(r);if(E<0)return;const A=typeof e[0]=="function"?e[0].call(r,n,this._render(r.children)):e,y=this._makeDomArray(A,n<t);_n(f,E+1,0,y,a)})}function yb(e){typeof e=="string"&&(e=this._make(e)),this.remove();const t=[];return this._makeDomArray(e).forEach(r=>{const n=this.clone().toArray(),{parent:a}=r;if(!a)return;const f=a.children,E=f.indexOf(r);E<0||(_n(f,E+1,0,n,a),t.push(...n))}),this._make(t)}function Ab(...e){const t=this.length-1;return qt(this,(r,n)=>{const{parent:a}=r;if(!er(r)||!a)return;const f=a.children,E=f.indexOf(r);if(E<0)return;const A=typeof e[0]=="function"?e[0].call(r,n,this._render(r.children)):e,y=this._makeDomArray(A,n<t);_n(f,E,0,y,a)})}function _b(e){const t=this._make(e);this.remove();const r=[];return qt(t,n=>{const a=this.clone().toArray(),{parent:f}=n;if(!f)return;const E=f.children,A=E.indexOf(n);A<0||(_n(E,A,0,a,f),r.push(...a))}),this._make(r)}function Sb(e){const t=e?this.filter(e):this;return qt(t,r=>{qn(r),r.prev=r.next=r.parent=null}),this}function Ib(e){return qt(this,(t,r)=>{const{parent:n}=t;if(!n)return;const a=n.children,f=typeof e=="function"?e.call(t,r,t):e,E=this._makeDomArray(f);jn(E,null);const A=a.indexOf(t);_n(a,A,1,E,n),E.includes(t)||(t.parent=t.prev=t.next=null)})}function Cb(){return qt(this,e=>{er(e)&&(e.children.forEach(t=>{t.next=t.prev=t.parent=null}),e.children.length=0)})}function Lb(e){if(e===void 0){const t=this[0];return!t||!er(t)?null:this._render(t.children)}return qt(this,t=>{if(!er(t))return;t.children.forEach(n=>{n.next=n.prev=n.parent=null});const r=Wr(e)?e.toArray():this._parse(`${e}`,this.options,!1,t).children;jn(r,t)})}function Rb(){return this._render(this)}function Db(e){return e===void 0?os(this):typeof e=="function"?qt(this,(t,r)=>this._make(t).text(e.call(t,r,os([t])))):qt(this,t=>{if(!er(t))return;t.children.forEach(n=>{n.next=n.prev=n.parent=null});const r=new as(`${e}`);jn(r,t)})}function Nb(){return this._make(au(this.get()))}const Ob=Object.freeze(Object.defineProperty({__proto__:null,_makeDomArray:hb,after:bb,append:gb,appendTo:fb,before:Ab,clone:Nb,empty:Cb,html:Lb,insertAfter:yb,insertBefore:_b,prepend:mb,prependTo:db,remove:Sb,replaceWith:Ib,text:Db,toString:Rb,unwrap:Tb,wrap:pb,wrapAll:vb,wrapInner:Eb},Symbol.toStringTag,{value:"Module"}));function xb(e,t){if(e!=null&&t!=null||typeof e=="object"&&!Array.isArray(e))return qt(this,(r,n)=>{dt(r)&&xd(r,e,t,n)});if(this.length!==0)return kd(this[0],e)}function xd(e,t,r,n){if(typeof t=="string"){const a=kd(e),f=typeof r=="function"?r.call(e,n,a[t]):r;f===""?delete a[t]:f!=null&&(a[t]=f),e.attribs.style=kb(a)}else typeof t=="object"&&Object.keys(t).forEach((a,f)=>{xd(e,a,t[a],f)})}function kd(e,t){if(!e||!dt(e))return;const r=Pb(e.attribs.style);if(typeof t=="string")return r[t];if(Array.isArray(t)){const n={};return t.forEach(a=>{r[a]!=null&&(n[a]=r[a])}),n}return r}function kb(e){return Object.keys(e).reduce((t,r)=>`${t}${t?" ":""}${r}: ${e[r]};`,"")}function Pb(e){if(e=(e||"").trim(),!e)return{};const t={};let r;for(const n of e.split(";")){const a=n.indexOf(":");if(a<1||a===n.length-1){const f=n.trimEnd();f.length>0&&r!==void 0&&(t[r]+=`;${f}`)}else r=n.slice(0,a).trim(),t[r]=n.slice(a+1).trim()}return t}const wb=Object.freeze(Object.defineProperty({__proto__:null,css:xb},Symbol.toStringTag,{value:"Module"})),uh="input,select,textarea,keygen",Mb=/%20/g,ch=/\r?\n/g;function Fb(){return this.serializeArray().map(r=>`${encodeURIComponent(r.name)}=${encodeURIComponent(r.value)}`).join("&").replace(Mb,"+")}function Bb(){return this.map((e,t)=>{const r=this._make(t);return dt(t)&&t.name==="form"?r.find(uh).toArray():r.filter(uh).toArray()}).filter('[name!=""]:enabled:not(:submit, :button, :image, :reset, :file):matches([checked], :not(:checkbox, :radio))').map((e,t)=>{var r;const n=this._make(t),a=n.attr("name"),f=(r=n.val())!==null&&r!==void 0?r:"";return Array.isArray(f)?f.map(E=>({name:a,value:E.replace(ch,`\r
`)})):{name:a,value:f.replace(ch,`\r
`)}}).toArray()}const Ub=Object.freeze(Object.defineProperty({__proto__:null,serialize:Fb,serializeArray:Bb},Symbol.toStringTag,{value:"Module"}));class gs{constructor(t,r,n){if(this.length=0,this.options=n,this._root=r,t){for(let a=0;a<t.length;a++)this[a]=t[a];this.length=t.length}}}gs.prototype.cheerio="[cheerio object]";gs.prototype.splice=Array.prototype.splice;gs.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];Object.assign(gs.prototype,X1,cb,Ob,wb,Ub);function Hb(e,t){return function r(n,a,f=!0){if(n==null)throw new Error("cheerio.load() expects a string");const E={...Bu,...iu(a)},A=e(n,E,f,null);class y extends gs{_make(C,b){const L=_(C,b);return L.prevObject=this,L}_parse(C,b,L,O){return e(C,b,L,O)}_render(C){return t(C,this.options)}}function _(I,C,b=A,L){if(I&&Wr(I))return I;const O={...E,...iu(L)},oe=typeof b=="string"?[e(b,O,!1,null)]:"length"in b?b:[b],z=Wr(oe)?oe:new y(oe,null,O);if(z._root=z,!I)return new y(void 0,z,O);const ee=typeof I=="string"&&ou(I)?e(I,O,!1,null).children:Gb(I)?[I]:Array.isArray(I)?I:void 0,le=new y(ee,z,O);if(ee)return le;if(typeof I!="string")throw new Error("Unexpected type of selector");let $=I;const fe=C?typeof C=="string"?ou(C)?new y([e(C,O,!1,null)],z,O):($=`${C} ${$}`,z):Wr(C)?C:new y(Array.isArray(C)?C:[C],z,O):z;return fe?fe.find($):le}return Object.assign(_,B1,{load:r,_root:A,_options:E,fn:y.prototype,prototype:y.prototype}),_}}function Gb(e){return!!e.name||e.type==="root"||e.type==="text"||e.type==="comment"}const Kb=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),Kt="";var w;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.NUMBER_SIGN=35]="NUMBER_SIGN",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",e[e.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_F=102]="LATIN_SMALL_F",e[e.LATIN_SMALL_X=120]="LATIN_SMALL_X",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",e[e.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"})(w=w||(w={}));const lr={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function Pd(e){return e>=55296&&e<=57343}function Yb(e){return e>=56320&&e<=57343}function jb(e,t){return(e-55296)*1024+9216+t}function wd(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function Md(e){return e>=64976&&e<=65007||Kb.has(e)}var be;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(be=be||(be={}));const Vb=1<<16;class qb{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=Vb,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t){const{line:r,col:n,offset:a}=this;return{code:t,startLine:r,endLine:r,startCol:n,endCol:n,startOffset:a,endOffset:a}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const r=this.html.charCodeAt(this.pos+1);if(Yb(r))return this.pos++,this._addGap(),jb(t,r)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,w.EOF;return this._err(be.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,r){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=r}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,r){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(r)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){const r=this.pos+t;if(r>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,w.EOF;const n=this.html.charCodeAt(r);return n===w.CARRIAGE_RETURN?w.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,w.EOF;let t=this.html.charCodeAt(this.pos);return t===w.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,w.LINE_FEED):t===w.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,Pd(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===w.LINE_FEED||t===w.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){wd(t)?this._err(be.controlCharacterInInputStream):Md(t)&&this._err(be.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var Dt;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(Dt=Dt||(Dt={}));function Fd(e,t){for(let r=e.attrs.length-1;r>=0;r--)if(e.attrs[r].name===t)return e.attrs[r].value;return null}var Re;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(Re=Re||(Re={}));var bn;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(bn=bn||(bn={}));var gr;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(gr=gr||(gr={}));var he;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(he=he||(he={}));var m;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SECTION=94]="SECTION",e[e.SELECT=95]="SELECT",e[e.SOURCE=96]="SOURCE",e[e.SMALL=97]="SMALL",e[e.SPAN=98]="SPAN",e[e.STRIKE=99]="STRIKE",e[e.STRONG=100]="STRONG",e[e.STYLE=101]="STYLE",e[e.SUB=102]="SUB",e[e.SUMMARY=103]="SUMMARY",e[e.SUP=104]="SUP",e[e.TABLE=105]="TABLE",e[e.TBODY=106]="TBODY",e[e.TEMPLATE=107]="TEMPLATE",e[e.TEXTAREA=108]="TEXTAREA",e[e.TFOOT=109]="TFOOT",e[e.TD=110]="TD",e[e.TH=111]="TH",e[e.THEAD=112]="THEAD",e[e.TITLE=113]="TITLE",e[e.TR=114]="TR",e[e.TRACK=115]="TRACK",e[e.TT=116]="TT",e[e.U=117]="U",e[e.UL=118]="UL",e[e.SVG=119]="SVG",e[e.VAR=120]="VAR",e[e.WBR=121]="WBR",e[e.XMP=122]="XMP"})(m=m||(m={}));const Wb=new Map([[he.A,m.A],[he.ADDRESS,m.ADDRESS],[he.ANNOTATION_XML,m.ANNOTATION_XML],[he.APPLET,m.APPLET],[he.AREA,m.AREA],[he.ARTICLE,m.ARTICLE],[he.ASIDE,m.ASIDE],[he.B,m.B],[he.BASE,m.BASE],[he.BASEFONT,m.BASEFONT],[he.BGSOUND,m.BGSOUND],[he.BIG,m.BIG],[he.BLOCKQUOTE,m.BLOCKQUOTE],[he.BODY,m.BODY],[he.BR,m.BR],[he.BUTTON,m.BUTTON],[he.CAPTION,m.CAPTION],[he.CENTER,m.CENTER],[he.CODE,m.CODE],[he.COL,m.COL],[he.COLGROUP,m.COLGROUP],[he.DD,m.DD],[he.DESC,m.DESC],[he.DETAILS,m.DETAILS],[he.DIALOG,m.DIALOG],[he.DIR,m.DIR],[he.DIV,m.DIV],[he.DL,m.DL],[he.DT,m.DT],[he.EM,m.EM],[he.EMBED,m.EMBED],[he.FIELDSET,m.FIELDSET],[he.FIGCAPTION,m.FIGCAPTION],[he.FIGURE,m.FIGURE],[he.FONT,m.FONT],[he.FOOTER,m.FOOTER],[he.FOREIGN_OBJECT,m.FOREIGN_OBJECT],[he.FORM,m.FORM],[he.FRAME,m.FRAME],[he.FRAMESET,m.FRAMESET],[he.H1,m.H1],[he.H2,m.H2],[he.H3,m.H3],[he.H4,m.H4],[he.H5,m.H5],[he.H6,m.H6],[he.HEAD,m.HEAD],[he.HEADER,m.HEADER],[he.HGROUP,m.HGROUP],[he.HR,m.HR],[he.HTML,m.HTML],[he.I,m.I],[he.IMG,m.IMG],[he.IMAGE,m.IMAGE],[he.INPUT,m.INPUT],[he.IFRAME,m.IFRAME],[he.KEYGEN,m.KEYGEN],[he.LABEL,m.LABEL],[he.LI,m.LI],[he.LINK,m.LINK],[he.LISTING,m.LISTING],[he.MAIN,m.MAIN],[he.MALIGNMARK,m.MALIGNMARK],[he.MARQUEE,m.MARQUEE],[he.MATH,m.MATH],[he.MENU,m.MENU],[he.META,m.META],[he.MGLYPH,m.MGLYPH],[he.MI,m.MI],[he.MO,m.MO],[he.MN,m.MN],[he.MS,m.MS],[he.MTEXT,m.MTEXT],[he.NAV,m.NAV],[he.NOBR,m.NOBR],[he.NOFRAMES,m.NOFRAMES],[he.NOEMBED,m.NOEMBED],[he.NOSCRIPT,m.NOSCRIPT],[he.OBJECT,m.OBJECT],[he.OL,m.OL],[he.OPTGROUP,m.OPTGROUP],[he.OPTION,m.OPTION],[he.P,m.P],[he.PARAM,m.PARAM],[he.PLAINTEXT,m.PLAINTEXT],[he.PRE,m.PRE],[he.RB,m.RB],[he.RP,m.RP],[he.RT,m.RT],[he.RTC,m.RTC],[he.RUBY,m.RUBY],[he.S,m.S],[he.SCRIPT,m.SCRIPT],[he.SECTION,m.SECTION],[he.SELECT,m.SELECT],[he.SOURCE,m.SOURCE],[he.SMALL,m.SMALL],[he.SPAN,m.SPAN],[he.STRIKE,m.STRIKE],[he.STRONG,m.STRONG],[he.STYLE,m.STYLE],[he.SUB,m.SUB],[he.SUMMARY,m.SUMMARY],[he.SUP,m.SUP],[he.TABLE,m.TABLE],[he.TBODY,m.TBODY],[he.TEMPLATE,m.TEMPLATE],[he.TEXTAREA,m.TEXTAREA],[he.TFOOT,m.TFOOT],[he.TD,m.TD],[he.TH,m.TH],[he.THEAD,m.THEAD],[he.TITLE,m.TITLE],[he.TR,m.TR],[he.TRACK,m.TRACK],[he.TT,m.TT],[he.U,m.U],[he.UL,m.UL],[he.SVG,m.SVG],[he.VAR,m.VAR],[he.WBR,m.WBR],[he.XMP,m.XMP]]);function Ra(e){var t;return(t=Wb.get(e))!==null&&t!==void 0?t:m.UNKNOWN}const Ye=m,Xb={[Re.HTML]:new Set([Ye.ADDRESS,Ye.APPLET,Ye.AREA,Ye.ARTICLE,Ye.ASIDE,Ye.BASE,Ye.BASEFONT,Ye.BGSOUND,Ye.BLOCKQUOTE,Ye.BODY,Ye.BR,Ye.BUTTON,Ye.CAPTION,Ye.CENTER,Ye.COL,Ye.COLGROUP,Ye.DD,Ye.DETAILS,Ye.DIR,Ye.DIV,Ye.DL,Ye.DT,Ye.EMBED,Ye.FIELDSET,Ye.FIGCAPTION,Ye.FIGURE,Ye.FOOTER,Ye.FORM,Ye.FRAME,Ye.FRAMESET,Ye.H1,Ye.H2,Ye.H3,Ye.H4,Ye.H5,Ye.H6,Ye.HEAD,Ye.HEADER,Ye.HGROUP,Ye.HR,Ye.HTML,Ye.IFRAME,Ye.IMG,Ye.INPUT,Ye.LI,Ye.LINK,Ye.LISTING,Ye.MAIN,Ye.MARQUEE,Ye.MENU,Ye.META,Ye.NAV,Ye.NOEMBED,Ye.NOFRAMES,Ye.NOSCRIPT,Ye.OBJECT,Ye.OL,Ye.P,Ye.PARAM,Ye.PLAINTEXT,Ye.PRE,Ye.SCRIPT,Ye.SECTION,Ye.SELECT,Ye.SOURCE,Ye.STYLE,Ye.SUMMARY,Ye.TABLE,Ye.TBODY,Ye.TD,Ye.TEMPLATE,Ye.TEXTAREA,Ye.TFOOT,Ye.TH,Ye.THEAD,Ye.TITLE,Ye.TR,Ye.TRACK,Ye.UL,Ye.WBR,Ye.XMP]),[Re.MATHML]:new Set([Ye.MI,Ye.MO,Ye.MN,Ye.MS,Ye.MTEXT,Ye.ANNOTATION_XML]),[Re.SVG]:new Set([Ye.TITLE,Ye.FOREIGN_OBJECT,Ye.DESC]),[Re.XLINK]:new Set,[Re.XML]:new Set,[Re.XMLNS]:new Set};function Bd(e){return e===Ye.H1||e===Ye.H2||e===Ye.H3||e===Ye.H4||e===Ye.H5||e===Ye.H6}const $b=new Set([he.STYLE,he.SCRIPT,he.XMP,he.IFRAME,he.NOEMBED,he.NOFRAMES,he.PLAINTEXT]);function Qb(e,t){return $b.has(e)||t&&e===he.NOSCRIPT}const zb=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);var F;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",e[e.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",e[e.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",e[e.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",e[e.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",e[e.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"})(F||(F={}));const mr={DATA:F.DATA,RCDATA:F.RCDATA,RAWTEXT:F.RAWTEXT,SCRIPT_DATA:F.SCRIPT_DATA,PLAINTEXT:F.PLAINTEXT,CDATA_SECTION:F.CDATA_SECTION};function Wi(e){return e>=w.DIGIT_0&&e<=w.DIGIT_9}function Hi(e){return e>=w.LATIN_CAPITAL_A&&e<=w.LATIN_CAPITAL_Z}function Jb(e){return e>=w.LATIN_SMALL_A&&e<=w.LATIN_SMALL_Z}function mn(e){return Jb(e)||Hi(e)}function fu(e){return mn(e)||Wi(e)}function Ud(e){return e>=w.LATIN_CAPITAL_A&&e<=w.LATIN_CAPITAL_F}function Hd(e){return e>=w.LATIN_SMALL_A&&e<=w.LATIN_SMALL_F}function Zb(e){return Wi(e)||Ud(e)||Hd(e)}function ks(e){return e+32}function Gd(e){return e===w.SPACE||e===w.LINE_FEED||e===w.TABULATION||e===w.FORM_FEED}function ey(e){return e===w.EQUALS_SIGN||fu(e)}function lh(e){return Gd(e)||e===w.SOLIDUS||e===w.GREATER_THAN_SIGN}let ty=class{constructor(t,r){this.options=t,this.handler=r,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=F.DATA,this.returnState=F.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new qb(r),this.currentLocation=this.getCurrentLocation(-1)}_err(t){var r,n;(n=(r=this.handler).onParseError)===null||n===void 0||n.call(r,this.preprocessor.getError(t))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,r,n){this.active=!0,this.preprocessor.write(t,r),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume(t){this.consumedAfterSnapshot-=t,this.preprocessor.retreat(t)}_reconsumeInState(t,r){this.state=t,this._callState(r)}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let r=0;r<t;r++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,r){return this.preprocessor.startsWith(t,r)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:Dt.START_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:Dt.END_TAG,tagName:"",tagID:m.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:Dt.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:Dt.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,r){this.currentCharacterToken={type:t,chars:r,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,r;const n=this.currentToken;if(Fd(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const a=(t=(r=n.location).attrs)!==null&&t!==void 0?t:r.attrs=Object.create(null);a[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(be.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=Ra(t.tagName),t.type===Dt.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(be.endTagWithAttributes),t.selfClosing&&this._err(be.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case Dt.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case Dt.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case Dt.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:Dt.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,r){if(this.currentCharacterToken)if(this.currentCharacterToken.type!==t)this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();else{this.currentCharacterToken.chars+=r;return}this._createCharacterToken(t,r)}_emitCodePoint(t){const r=Gd(t)?Dt.WHITESPACE_CHARACTER:t===w.NULL?Dt.NULL_CHARACTER:Dt.CHARACTER;this._appendCharToCurrentCharacterToken(r,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(Dt.CHARACTER,t)}_matchNamedCharacterReference(t){let r=null,n=0,a=!1;for(let f=0,E=gn[0];f>=0&&(f=Qf(gn,E,f+1,t),!(f<0));t=this._consume()){n+=1,E=gn[f];const A=E&an.VALUE_LENGTH;if(A){const y=(A>>14)-1;if(t!==w.SEMICOLON&&this._isCharacterReferenceInAttribute()&&ey(this.preprocessor.peek(1))?(r=[w.AMPERSAND],f+=y):(r=y===0?[gn[f]&~an.VALUE_LENGTH]:y===1?[gn[++f]]:[gn[++f],gn[++f]],n=0,a=t!==w.SEMICOLON),y===0){this._consume();break}}}return this._unconsume(n),a&&!this.preprocessor.endOfChunkHit&&this._err(be.missingSemicolonAfterCharacterReference),this._unconsume(1),r}_isCharacterReferenceInAttribute(){return this.returnState===F.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===F.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===F.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case F.DATA:{this._stateData(t);break}case F.RCDATA:{this._stateRcdata(t);break}case F.RAWTEXT:{this._stateRawtext(t);break}case F.SCRIPT_DATA:{this._stateScriptData(t);break}case F.PLAINTEXT:{this._statePlaintext(t);break}case F.TAG_OPEN:{this._stateTagOpen(t);break}case F.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case F.TAG_NAME:{this._stateTagName(t);break}case F.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case F.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case F.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case F.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case F.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case F.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case F.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case F.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case F.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case F.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case F.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case F.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case F.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case F.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case F.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case F.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case F.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case F.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case F.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case F.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case F.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case F.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case F.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case F.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case F.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case F.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case F.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case F.BOGUS_COMMENT:{this._stateBogusComment(t);break}case F.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case F.COMMENT_START:{this._stateCommentStart(t);break}case F.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case F.COMMENT:{this._stateComment(t);break}case F.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case F.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case F.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case F.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case F.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case F.COMMENT_END:{this._stateCommentEnd(t);break}case F.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case F.DOCTYPE:{this._stateDoctype(t);break}case F.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case F.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case F.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case F.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case F.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case F.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case F.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case F.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case F.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case F.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case F.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case F.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case F.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case F.CDATA_SECTION:{this._stateCdataSection(t);break}case F.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case F.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case F.CHARACTER_REFERENCE:{this._stateCharacterReference(t);break}case F.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference(t);break}case F.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}case F.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference(t);break}case F.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart(t);break}case F.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference(t);break}case F.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference(t);break}case F.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case w.LESS_THAN_SIGN:{this.state=F.TAG_OPEN;break}case w.AMPERSAND:{this.returnState=F.DATA,this.state=F.CHARACTER_REFERENCE;break}case w.NULL:{this._err(be.unexpectedNullCharacter),this._emitCodePoint(t);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case w.AMPERSAND:{this.returnState=F.RCDATA,this.state=F.CHARACTER_REFERENCE;break}case w.LESS_THAN_SIGN:{this.state=F.RCDATA_LESS_THAN_SIGN;break}case w.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Kt);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case w.LESS_THAN_SIGN:{this.state=F.RAWTEXT_LESS_THAN_SIGN;break}case w.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Kt);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case w.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_LESS_THAN_SIGN;break}case w.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Kt);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case w.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Kt);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(mn(t))this._createStartTagToken(),this.state=F.TAG_NAME,this._stateTagName(t);else switch(t){case w.EXCLAMATION_MARK:{this.state=F.MARKUP_DECLARATION_OPEN;break}case w.SOLIDUS:{this.state=F.END_TAG_OPEN;break}case w.QUESTION_MARK:{this._err(be.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=F.BOGUS_COMMENT,this._stateBogusComment(t);break}case w.EOF:{this._err(be.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(be.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=F.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(mn(t))this._createEndTagToken(),this.state=F.TAG_NAME,this._stateTagName(t);else switch(t){case w.GREATER_THAN_SIGN:{this._err(be.missingEndTagName),this.state=F.DATA;break}case w.EOF:{this._err(be.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(be.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=F.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=F.BEFORE_ATTRIBUTE_NAME;break}case w.SOLIDUS:{this.state=F.SELF_CLOSING_START_TAG;break}case w.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentTagToken();break}case w.NULL:{this._err(be.unexpectedNullCharacter),r.tagName+=Kt;break}case w.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:r.tagName+=String.fromCodePoint(Hi(t)?ks(t):t)}}_stateRcdataLessThanSign(t){t===w.SOLIDUS?this.state=F.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=F.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){mn(t)?(this.state=F.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=F.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const r=this.currentToken;switch(r.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=F.BEFORE_ATTRIBUTE_NAME,!1;case w.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=F.SELF_CLOSING_START_TAG,!1;case w.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=F.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=F.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===w.SOLIDUS?this.state=F.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=F.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){mn(t)?(this.state=F.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=F.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=F.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case w.SOLIDUS:{this.state=F.SCRIPT_DATA_END_TAG_OPEN;break}case w.EXCLAMATION_MARK:{this.state=F.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=F.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){mn(t)?(this.state=F.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=F.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=F.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===w.HYPHEN_MINUS?(this.state=F.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=F.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===w.HYPHEN_MINUS?(this.state=F.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=F.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case w.HYPHEN_MINUS:{this.state=F.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case w.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Kt);break}case w.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case w.HYPHEN_MINUS:{this.state=F.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case w.NULL:{this._err(be.unexpectedNullCharacter),this.state=F.SCRIPT_DATA_ESCAPED,this._emitChars(Kt);break}case w.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=F.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case w.HYPHEN_MINUS:{this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case w.GREATER_THAN_SIGN:{this.state=F.SCRIPT_DATA,this._emitChars(">");break}case w.NULL:{this._err(be.unexpectedNullCharacter),this.state=F.SCRIPT_DATA_ESCAPED,this._emitChars(Kt);break}case w.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=F.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===w.SOLIDUS?this.state=F.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:mn(t)?(this._emitChars("<"),this.state=F.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=F.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){mn(t)?(this.state=F.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=F.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=F.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(lr.SCRIPT,!1)&&lh(this.preprocessor.peek(lr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<lr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=F.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case w.HYPHEN_MINUS:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case w.NULL:{this._err(be.unexpectedNullCharacter),this._emitChars(Kt);break}case w.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case w.HYPHEN_MINUS:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case w.NULL:{this._err(be.unexpectedNullCharacter),this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(Kt);break}case w.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case w.HYPHEN_MINUS:{this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case w.GREATER_THAN_SIGN:{this.state=F.SCRIPT_DATA,this._emitChars(">");break}case w.NULL:{this._err(be.unexpectedNullCharacter),this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(Kt);break}case w.EOF:{this._err(be.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===w.SOLIDUS?(this.state=F.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(lr.SCRIPT,!1)&&lh(this.preprocessor.peek(lr.SCRIPT.length))){this._emitCodePoint(t);for(let r=0;r<lr.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=F.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=F.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.SOLIDUS:case w.GREATER_THAN_SIGN:case w.EOF:{this.state=F.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case w.EQUALS_SIGN:{this._err(be.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=F.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=F.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:case w.SOLIDUS:case w.GREATER_THAN_SIGN:case w.EOF:{this._leaveAttrName(),this.state=F.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case w.EQUALS_SIGN:{this._leaveAttrName(),this.state=F.BEFORE_ATTRIBUTE_VALUE;break}case w.QUOTATION_MARK:case w.APOSTROPHE:case w.LESS_THAN_SIGN:{this._err(be.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case w.NULL:{this._err(be.unexpectedNullCharacter),this.currentAttr.name+=Kt;break}default:this.currentAttr.name+=String.fromCodePoint(Hi(t)?ks(t):t)}}_stateAfterAttributeName(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.SOLIDUS:{this.state=F.SELF_CLOSING_START_TAG;break}case w.EQUALS_SIGN:{this.state=F.BEFORE_ATTRIBUTE_VALUE;break}case w.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentTagToken();break}case w.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=F.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.QUOTATION_MARK:{this.state=F.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this.state=F.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(be.missingAttributeValue),this.state=F.DATA,this.emitCurrentTagToken();break}default:this.state=F.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case w.QUOTATION_MARK:{this.state=F.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case w.AMPERSAND:{this.returnState=F.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=F.CHARACTER_REFERENCE;break}case w.NULL:{this._err(be.unexpectedNullCharacter),this.currentAttr.value+=Kt;break}case w.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case w.APOSTROPHE:{this.state=F.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case w.AMPERSAND:{this.returnState=F.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=F.CHARACTER_REFERENCE;break}case w.NULL:{this._err(be.unexpectedNullCharacter),this.currentAttr.value+=Kt;break}case w.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this._leaveAttrValue(),this.state=F.BEFORE_ATTRIBUTE_NAME;break}case w.AMPERSAND:{this.returnState=F.ATTRIBUTE_VALUE_UNQUOTED,this.state=F.CHARACTER_REFERENCE;break}case w.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=F.DATA,this.emitCurrentTagToken();break}case w.NULL:{this._err(be.unexpectedNullCharacter),this.currentAttr.value+=Kt;break}case w.QUOTATION_MARK:case w.APOSTROPHE:case w.LESS_THAN_SIGN:case w.EQUALS_SIGN:case w.GRAVE_ACCENT:{this._err(be.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case w.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this._leaveAttrValue(),this.state=F.BEFORE_ATTRIBUTE_NAME;break}case w.SOLIDUS:{this._leaveAttrValue(),this.state=F.SELF_CLOSING_START_TAG;break}case w.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=F.DATA,this.emitCurrentTagToken();break}case w.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this._err(be.missingWhitespaceBetweenAttributes),this.state=F.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case w.GREATER_THAN_SIGN:{const r=this.currentToken;r.selfClosing=!0,this.state=F.DATA,this.emitCurrentTagToken();break}case w.EOF:{this._err(be.eofInTag),this._emitEOFToken();break}default:this._err(be.unexpectedSolidusInTag),this.state=F.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const r=this.currentToken;switch(t){case w.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentComment(r);break}case w.EOF:{this.emitCurrentComment(r),this._emitEOFToken();break}case w.NULL:{this._err(be.unexpectedNullCharacter),r.data+=Kt;break}default:r.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(lr.DASH_DASH,!0)?(this._createCommentToken(lr.DASH_DASH.length+1),this.state=F.COMMENT_START):this._consumeSequenceIfMatch(lr.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(lr.DOCTYPE.length+1),this.state=F.DOCTYPE):this._consumeSequenceIfMatch(lr.CDATA_START,!0)?this.inForeignNode?this.state=F.CDATA_SECTION:(this._err(be.cdataInHtmlContent),this._createCommentToken(lr.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=F.BOGUS_COMMENT):this._ensureHibernation()||(this._err(be.incorrectlyOpenedComment),this._createCommentToken(2),this.state=F.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case w.HYPHEN_MINUS:{this.state=F.COMMENT_START_DASH;break}case w.GREATER_THAN_SIGN:{this._err(be.abruptClosingOfEmptyComment),this.state=F.DATA;const r=this.currentToken;this.emitCurrentComment(r);break}default:this.state=F.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const r=this.currentToken;switch(t){case w.HYPHEN_MINUS:{this.state=F.COMMENT_END;break}case w.GREATER_THAN_SIGN:{this._err(be.abruptClosingOfEmptyComment),this.state=F.DATA,this.emitCurrentComment(r);break}case w.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=F.COMMENT,this._stateComment(t)}}_stateComment(t){const r=this.currentToken;switch(t){case w.HYPHEN_MINUS:{this.state=F.COMMENT_END_DASH;break}case w.LESS_THAN_SIGN:{r.data+="<",this.state=F.COMMENT_LESS_THAN_SIGN;break}case w.NULL:{this._err(be.unexpectedNullCharacter),r.data+=Kt;break}case w.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const r=this.currentToken;switch(t){case w.EXCLAMATION_MARK:{r.data+="!",this.state=F.COMMENT_LESS_THAN_SIGN_BANG;break}case w.LESS_THAN_SIGN:{r.data+="<";break}default:this.state=F.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===w.HYPHEN_MINUS?this.state=F.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=F.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===w.HYPHEN_MINUS?this.state=F.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=F.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==w.GREATER_THAN_SIGN&&t!==w.EOF&&this._err(be.nestedComment),this.state=F.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const r=this.currentToken;switch(t){case w.HYPHEN_MINUS:{this.state=F.COMMENT_END;break}case w.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=F.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const r=this.currentToken;switch(t){case w.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentComment(r);break}case w.EXCLAMATION_MARK:{this.state=F.COMMENT_END_BANG;break}case w.HYPHEN_MINUS:{r.data+="-";break}case w.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--",this.state=F.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const r=this.currentToken;switch(t){case w.HYPHEN_MINUS:{r.data+="--!",this.state=F.COMMENT_END_DASH;break}case w.GREATER_THAN_SIGN:{this._err(be.incorrectlyClosedComment),this.state=F.DATA,this.emitCurrentComment(r);break}case w.EOF:{this._err(be.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--!",this.state=F.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=F.BEFORE_DOCTYPE_NAME;break}case w.GREATER_THAN_SIGN:{this.state=F.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case w.EOF:{this._err(be.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingWhitespaceBeforeDoctypeName),this.state=F.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(Hi(t))this._createDoctypeToken(String.fromCharCode(ks(t))),this.state=F.DOCTYPE_NAME;else switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.NULL:{this._err(be.unexpectedNullCharacter),this._createDoctypeToken(Kt),this.state=F.DOCTYPE_NAME;break}case w.GREATER_THAN_SIGN:{this._err(be.missingDoctypeName),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case w.EOF:{this._err(be.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=F.DOCTYPE_NAME}}_stateDoctypeName(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=F.AFTER_DOCTYPE_NAME;break}case w.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentDoctype(r);break}case w.NULL:{this._err(be.unexpectedNullCharacter),r.name+=Kt;break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.name+=String.fromCodePoint(Hi(t)?ks(t):t)}}_stateAfterDoctypeName(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentDoctype(r);break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(lr.PUBLIC,!1)?this.state=F.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(lr.SYSTEM,!1)?this.state=F.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(be.invalidCharacterSequenceAfterDoctypeName),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=F.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case w.QUOTATION_MARK:{this._err(be.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=F.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this._err(be.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=F.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(be.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=F.DATA,this.emitCurrentDoctype(r);break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.QUOTATION_MARK:{r.publicId="",this.state=F.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{r.publicId="",this.state=F.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(be.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=F.DATA,this.emitCurrentDoctype(r);break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case w.QUOTATION_MARK:{this.state=F.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case w.NULL:{this._err(be.unexpectedNullCharacter),r.publicId+=Kt;break}case w.GREATER_THAN_SIGN:{this._err(be.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case w.APOSTROPHE:{this.state=F.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case w.NULL:{this._err(be.unexpectedNullCharacter),r.publicId+=Kt;break}case w.GREATER_THAN_SIGN:{this._err(be.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=F.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case w.GREATER_THAN_SIGN:{this.state=F.DATA,this.emitCurrentDoctype(r);break}case w.QUOTATION_MARK:{this._err(be.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this._err(be.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=F.DATA;break}case w.QUOTATION_MARK:{r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=F.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case w.QUOTATION_MARK:{this._err(be.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this._err(be.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(be.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.DATA,this.emitCurrentDoctype(r);break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.QUOTATION_MARK:{r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{r.systemId="",this.state=F.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(be.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.DATA,this.emitCurrentDoctype(r);break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const r=this.currentToken;switch(t){case w.QUOTATION_MARK:{this.state=F.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case w.NULL:{this._err(be.unexpectedNullCharacter),r.systemId+=Kt;break}case w.GREATER_THAN_SIGN:{this._err(be.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const r=this.currentToken;switch(t){case w.APOSTROPHE:{this.state=F.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case w.NULL:{this._err(be.unexpectedNullCharacter),r.systemId+=Kt;break}case w.GREATER_THAN_SIGN:{this._err(be.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=F.DATA;break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const r=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=F.DATA;break}case w.EOF:{this._err(be.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(be.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=F.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const r=this.currentToken;switch(t){case w.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=F.DATA;break}case w.NULL:{this._err(be.unexpectedNullCharacter);break}case w.EOF:{this.emitCurrentDoctype(r),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case w.RIGHT_SQUARE_BRACKET:{this.state=F.CDATA_SECTION_BRACKET;break}case w.EOF:{this._err(be.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===w.RIGHT_SQUARE_BRACKET?this.state=F.CDATA_SECTION_END:(this._emitChars("]"),this.state=F.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case w.GREATER_THAN_SIGN:{this.state=F.DATA;break}case w.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=F.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(t){t===w.NUMBER_SIGN?this.state=F.NUMERIC_CHARACTER_REFERENCE:fu(t)?(this.state=F.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference(t)):(this._flushCodePointConsumedAsCharacterReference(w.AMPERSAND),this._reconsumeInState(this.returnState,t))}_stateNamedCharacterReference(t){const r=this._matchNamedCharacterReference(t);if(!this._ensureHibernation())if(r){for(let n=0;n<r.length;n++)this._flushCodePointConsumedAsCharacterReference(r[n]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(w.AMPERSAND),this.state=F.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand(t){fu(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===w.SEMICOLON&&this._err(be.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,t))}_stateNumericCharacterReference(t){this.charRefCode=0,t===w.LATIN_SMALL_X||t===w.LATIN_CAPITAL_X?this.state=F.HEXADEMICAL_CHARACTER_REFERENCE_START:Wi(t)?(this.state=F.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference(t)):(this._err(be.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(w.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(w.NUMBER_SIGN),this._reconsumeInState(this.returnState,t))}_stateHexademicalCharacterReferenceStart(t){Zb(t)?(this.state=F.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference(t)):(this._err(be.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(w.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(w.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState)}_stateHexademicalCharacterReference(t){Ud(t)?this.charRefCode=this.charRefCode*16+t-55:Hd(t)?this.charRefCode=this.charRefCode*16+t-87:Wi(t)?this.charRefCode=this.charRefCode*16+t-48:t===w.SEMICOLON?this.state=F.NUMERIC_CHARACTER_REFERENCE_END:(this._err(be.missingSemicolonAfterCharacterReference),this.state=F.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateDecimalCharacterReference(t){Wi(t)?this.charRefCode=this.charRefCode*10+t-48:t===w.SEMICOLON?this.state=F.NUMERIC_CHARACTER_REFERENCE_END:(this._err(be.missingSemicolonAfterCharacterReference),this.state=F.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateNumericCharacterReferenceEnd(t){if(this.charRefCode===w.NULL)this._err(be.nullCharacterReference),this.charRefCode=w.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(be.characterReferenceOutsideUnicodeRange),this.charRefCode=w.REPLACEMENT_CHARACTER;else if(Pd(this.charRefCode))this._err(be.surrogateCharacterReference),this.charRefCode=w.REPLACEMENT_CHARACTER;else if(Md(this.charRefCode))this._err(be.noncharacterCharacterReference);else if(wd(this.charRefCode)||this.charRefCode===w.CARRIAGE_RETURN){this._err(be.controlCharacterReference);const r=zb.get(this.charRefCode);r!==void 0&&(this.charRefCode=r)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,t)}};const Kd=new Set([m.DD,m.DT,m.LI,m.OPTGROUP,m.OPTION,m.P,m.RB,m.RP,m.RT,m.RTC]),hh=new Set([...Kd,m.CAPTION,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]),Ps=new Map([[m.APPLET,Re.HTML],[m.CAPTION,Re.HTML],[m.HTML,Re.HTML],[m.MARQUEE,Re.HTML],[m.OBJECT,Re.HTML],[m.TABLE,Re.HTML],[m.TD,Re.HTML],[m.TEMPLATE,Re.HTML],[m.TH,Re.HTML],[m.ANNOTATION_XML,Re.MATHML],[m.MI,Re.MATHML],[m.MN,Re.MATHML],[m.MO,Re.MATHML],[m.MS,Re.MATHML],[m.MTEXT,Re.MATHML],[m.DESC,Re.SVG],[m.FOREIGN_OBJECT,Re.SVG],[m.TITLE,Re.SVG]]),ry=[m.H1,m.H2,m.H3,m.H4,m.H5,m.H6],ny=[m.TR,m.TEMPLATE,m.HTML],iy=[m.TBODY,m.TFOOT,m.THEAD,m.TEMPLATE,m.HTML],sy=[m.TABLE,m.TEMPLATE,m.HTML],ay=[m.TD,m.TH];class oy{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,r,n){this.treeAdapter=r,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=m.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===m.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===Re.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,r){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=r,this.currentTagId=r,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,r,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,r){const n=this._indexOf(t);this.items[n]=r,n===this.stackTop&&(this.current=r)}insertAfter(t,r,n){const a=this._indexOf(t)+1;this.items.splice(a,0,r),this.tagIDs.splice(a,0,n),this.stackTop++,a===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,a===this.stackTop)}popUntilTagNamePopped(t){let r=this.stackTop+1;do r=this.tagIDs.lastIndexOf(t,r-1);while(r>0&&this.treeAdapter.getNamespaceURI(this.items[r])!==Re.HTML);this.shortenToLength(r<0?0:r)}shortenToLength(t){for(;this.stackTop>=t;){const r=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(r,this.stackTop<t)}}popUntilElementPopped(t){const r=this._indexOf(t);this.shortenToLength(r<0?0:r)}popUntilPopped(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(ry,Re.HTML)}popUntilTableCellPopped(){this.popUntilPopped(ay,Re.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,r){for(let n=this.stackTop;n>=0;n--)if(t.includes(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===r)return n;return-1}clearBackTo(t,r){const n=this._indexOfTagNames(t,r);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(sy,Re.HTML)}clearBackToTableBodyContext(){this.clearBackTo(iy,Re.HTML)}clearBackToTableRowContext(){this.clearBackTo(ny,Re.HTML)}remove(t){const r=this._indexOf(t);r>=0&&(r===this.stackTop?this.pop():(this.items.splice(r,1),this.tagIDs.splice(r,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===m.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const r=this._indexOf(t)-1;return r>=0?this.items[r]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===m.HTML}hasInScope(t){for(let r=this.stackTop;r>=0;r--){const n=this.tagIDs[r],a=this.treeAdapter.getNamespaceURI(this.items[r]);if(n===t&&a===Re.HTML)return!0;if(Ps.get(n)===a)return!1}return!0}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const r=this.tagIDs[t],n=this.treeAdapter.getNamespaceURI(this.items[t]);if(Bd(r)&&n===Re.HTML)return!0;if(Ps.get(r)===n)return!1}return!0}hasInListItemScope(t){for(let r=this.stackTop;r>=0;r--){const n=this.tagIDs[r],a=this.treeAdapter.getNamespaceURI(this.items[r]);if(n===t&&a===Re.HTML)return!0;if((n===m.UL||n===m.OL)&&a===Re.HTML||Ps.get(n)===a)return!1}return!0}hasInButtonScope(t){for(let r=this.stackTop;r>=0;r--){const n=this.tagIDs[r],a=this.treeAdapter.getNamespaceURI(this.items[r]);if(n===t&&a===Re.HTML)return!0;if(n===m.BUTTON&&a===Re.HTML||Ps.get(n)===a)return!1}return!0}hasInTableScope(t){for(let r=this.stackTop;r>=0;r--){const n=this.tagIDs[r];if(this.treeAdapter.getNamespaceURI(this.items[r])===Re.HTML){if(n===t)return!0;if(n===m.TABLE||n===m.TEMPLATE||n===m.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--){const r=this.tagIDs[t];if(this.treeAdapter.getNamespaceURI(this.items[t])===Re.HTML){if(r===m.TBODY||r===m.THEAD||r===m.TFOOT)return!0;if(r===m.TABLE||r===m.HTML)return!1}}return!0}hasInSelectScope(t){for(let r=this.stackTop;r>=0;r--){const n=this.tagIDs[r];if(this.treeAdapter.getNamespaceURI(this.items[r])===Re.HTML){if(n===t)return!0;if(n!==m.OPTION&&n!==m.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;Kd.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;hh.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&hh.has(this.currentTagId);)this.pop()}}const wo=3;var Dr;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(Dr=Dr||(Dr={}));const fh={type:Dr.Marker};class uy{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,r){const n=[],a=r.length,f=this.treeAdapter.getTagName(t),E=this.treeAdapter.getNamespaceURI(t);for(let A=0;A<this.entries.length;A++){const y=this.entries[A];if(y.type===Dr.Marker)break;const{element:_}=y;if(this.treeAdapter.getTagName(_)===f&&this.treeAdapter.getNamespaceURI(_)===E){const I=this.treeAdapter.getAttrList(_);I.length===a&&n.push({idx:A,attrs:I})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<wo)return;const r=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,r);if(n.length<wo)return;const a=new Map(r.map(E=>[E.name,E.value]));let f=0;for(let E=0;E<n.length;E++){const A=n[E];A.attrs.every(y=>a.get(y.name)===y.value)&&(f+=1,f>=wo&&this.entries.splice(A.idx,1))}}insertMarker(){this.entries.unshift(fh)}pushElement(t,r){this._ensureNoahArkCondition(t),this.entries.unshift({type:Dr.Element,element:t,token:r})}insertElementAfterBookmark(t,r){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:Dr.Element,element:t,token:r})}removeEntry(t){const r=this.entries.indexOf(t);r>=0&&this.entries.splice(r,1)}clearToLastMarker(){const t=this.entries.indexOf(fh);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){const r=this.entries.find(n=>n.type===Dr.Marker||this.treeAdapter.getTagName(n.element)===t);return r&&r.type===Dr.Element?r:null}getElementEntry(t){return this.entries.find(r=>r.type===Dr.Element&&r.element===t)}}function dh(e){return{nodeName:"#text",value:e,parentNode:null}}const Fn={createDocument(){return{nodeName:"#document",mode:gr.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,r){return{nodeName:e,tagName:e,attrs:r,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,r){const n=e.childNodes.indexOf(r);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,r,n){const a=e.childNodes.find(f=>f.nodeName==="#documentType");if(a)a.name=t,a.publicId=r,a.systemId=n;else{const f={nodeName:"#documentType",name:t,publicId:r,systemId:n,parentNode:null};Fn.appendChild(e,f)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const r=e.childNodes[e.childNodes.length-1];if(Fn.isTextNode(r)){r.value+=t;return}}Fn.appendChild(e,dh(t))},insertTextBefore(e,t,r){const n=e.childNodes[e.childNodes.indexOf(r)-1];n&&Fn.isTextNode(n)?n.value+=t:Fn.insertBefore(e,dh(t),r)},adoptAttributes(e,t){const r=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)r.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},Yd="html",cy="about:legacy-compat",ly="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",jd=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],hy=[...jd,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],fy=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),Vd=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],dy=[...Vd,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function gh(e,t){return t.some(r=>e.startsWith(r))}function gy(e){return e.name===Yd&&e.publicId===null&&(e.systemId===null||e.systemId===cy)}function my(e){if(e.name!==Yd)return gr.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===ly)return gr.QUIRKS;let{publicId:r}=e;if(r!==null){if(r=r.toLowerCase(),fy.has(r))return gr.QUIRKS;let n=t===null?hy:jd;if(gh(r,n))return gr.QUIRKS;if(n=t===null?Vd:dy,gh(r,n))return gr.LIMITED_QUIRKS}return gr.NO_QUIRKS}const mh={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},py="definitionurl",Ey="definitionURL",Ty=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),vy=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:Re.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:Re.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:Re.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:Re.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:Re.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:Re.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:Re.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:Re.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:Re.XML}],["xml:space",{prefix:"xml",name:"space",namespace:Re.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:Re.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:Re.XMLNS}]]),by=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),yy=new Set([m.B,m.BIG,m.BLOCKQUOTE,m.BODY,m.BR,m.CENTER,m.CODE,m.DD,m.DIV,m.DL,m.DT,m.EM,m.EMBED,m.H1,m.H2,m.H3,m.H4,m.H5,m.H6,m.HEAD,m.HR,m.I,m.IMG,m.LI,m.LISTING,m.MENU,m.META,m.NOBR,m.OL,m.P,m.PRE,m.RUBY,m.S,m.SMALL,m.SPAN,m.STRONG,m.STRIKE,m.SUB,m.SUP,m.TABLE,m.TT,m.U,m.UL,m.VAR]);function Ay(e){const t=e.tagID;return t===m.FONT&&e.attrs.some(({name:n})=>n===bn.COLOR||n===bn.SIZE||n===bn.FACE)||yy.has(t)}function qd(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===py){e.attrs[t].name=Ey;break}}function Wd(e){for(let t=0;t<e.attrs.length;t++){const r=Ty.get(e.attrs[t].name);r!=null&&(e.attrs[t].name=r)}}function tc(e){for(let t=0;t<e.attrs.length;t++){const r=vy.get(e.attrs[t].name);r&&(e.attrs[t].prefix=r.prefix,e.attrs[t].name=r.name,e.attrs[t].namespace=r.namespace)}}function _y(e){const t=by.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=Ra(e.tagName))}function Sy(e,t){return t===Re.MATHML&&(e===m.MI||e===m.MO||e===m.MN||e===m.MS||e===m.MTEXT)}function Iy(e,t,r){if(t===Re.MATHML&&e===m.ANNOTATION_XML){for(let n=0;n<r.length;n++)if(r[n].name===bn.ENCODING){const a=r[n].value.toLowerCase();return a===mh.TEXT_HTML||a===mh.APPLICATION_XML}}return t===Re.SVG&&(e===m.FOREIGN_OBJECT||e===m.DESC||e===m.TITLE)}function Cy(e,t,r,n){return(!n||n===Re.HTML)&&Iy(e,t,r)||(!n||n===Re.MATHML)&&Sy(e,t)}const Ly="hidden",Ry=8,Dy=3;var Y;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(Y||(Y={}));const Ny={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},Xd=new Set([m.TABLE,m.TBODY,m.TFOOT,m.THEAD,m.TR]),ph={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Fn,onParseError:null};let $d=class{constructor(t,r,n=null,a=null){this.fragmentContext=n,this.scriptHandler=a,this.currentToken=null,this.stopped=!1,this.insertionMode=Y.INITIAL,this.originalInsertionMode=Y.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...ph,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=r??this.treeAdapter.createDocument(),this.tokenizer=new ty(this.options,this),this.activeFormattingElements=new uy(this.treeAdapter),this.fragmentContextID=n?Ra(this.treeAdapter.getTagName(n)):m.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new oy(this.document,this.treeAdapter,this)}static parse(t,r){const n=new this(r);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,r){const n={...ph,...r};t??(t=n.treeAdapter.createElement(he.TEMPLATE,Re.HTML,[]));const a=n.treeAdapter.createElement("documentmock",Re.HTML,[]),f=new this(n,a,t);return f.fragmentContextID===m.TEMPLATE&&f.tmplInsertionModeStack.unshift(Y.IN_TEMPLATE),f._initTokenizerForFragmentParsing(),f._insertFakeRootElement(),f._resetInsertionMode(),f._findFormInFragmentContext(),f}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,r),r}_err(t,r,n){var a;if(!this.onParseError)return;const f=(a=t.location)!==null&&a!==void 0?a:Ny,E={code:r,startLine:f.startLine,startCol:f.startCol,startOffset:f.startOffset,endLine:n?f.startLine:f.endLine,endCol:n?f.startCol:f.endCol,endOffset:n?f.startOffset:f.endOffset};this.onParseError(E)}onItemPush(t,r,n){var a,f;(f=(a=this.treeAdapter).onItemPush)===null||f===void 0||f.call(a,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,r)}onItemPop(t,r){var n,a;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(a=(n=this.treeAdapter).onItemPop)===null||a===void 0||a.call(n,t,this.openElements.current),r){let f,E;this.openElements.stackTop===0&&this.fragmentContext?(f=this.fragmentContext,E=this.fragmentContextID):{current:f,currentTagId:E}=this.openElements,this._setContextModes(f,E)}}_setContextModes(t,r){const n=t===this.document||this.treeAdapter.getNamespaceURI(t)===Re.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(r,t)}_switchToTextParsing(t,r){this._insertElement(t,Re.HTML),this.tokenizer.state=r,this.originalInsertionMode=this.insertionMode,this.insertionMode=Y.TEXT}switchToPlaintextParsing(){this.insertionMode=Y.TEXT,this.originalInsertionMode=Y.IN_BODY,this.tokenizer.state=mr.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===he.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==Re.HTML))switch(this.fragmentContextID){case m.TITLE:case m.TEXTAREA:{this.tokenizer.state=mr.RCDATA;break}case m.STYLE:case m.XMP:case m.IFRAME:case m.NOEMBED:case m.NOFRAMES:case m.NOSCRIPT:{this.tokenizer.state=mr.RAWTEXT;break}case m.SCRIPT:{this.tokenizer.state=mr.SCRIPT_DATA;break}case m.PLAINTEXT:{this.tokenizer.state=mr.PLAINTEXT;break}}}_setDocumentType(t){const r=t.name||"",n=t.publicId||"",a=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,r,n,a),t.location){const E=this.treeAdapter.getChildNodes(this.document).find(A=>this.treeAdapter.isDocumentTypeNode(A));E&&this.treeAdapter.setNodeSourceCodeLocation(E,t.location)}}_attachElementToTree(t,r){if(this.options.sourceCodeLocationInfo){const n=r&&{...r,startTag:r};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,r){const n=this.treeAdapter.createElement(t.tagName,r,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,r){const n=this.treeAdapter.createElement(t,Re.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,r)}_insertTemplate(t){const r=this.treeAdapter.createElement(t.tagName,Re.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(r,n),this._attachElementToTree(r,t.location),this.openElements.push(r,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(he.HTML,Re.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,m.HTML)}_appendCommentNode(t,r){const n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(r,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let r,n;if(this._shouldFosterParentOnInsertion()?({parent:r,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(r,t.chars,n):this.treeAdapter.insertText(r,t.chars)):(r=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(r,t.chars)),!t.location)return;const a=this.treeAdapter.getChildNodes(r),f=n?a.lastIndexOf(n):a.length,E=a[f-1];if(this.treeAdapter.getNodeSourceCodeLocation(E)){const{endLine:y,endCol:_,endOffset:I}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(E,{endLine:y,endCol:_,endOffset:I})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(E,t.location)}_adoptNodes(t,r){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(r,n)}_setEndLocation(t,r){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&r.location){const n=r.location,a=this.treeAdapter.getTagName(t),f=r.type===Dt.END_TAG&&a===r.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,f)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let r,n;return this.openElements.stackTop===0&&this.fragmentContext?(r=this.fragmentContext,n=this.fragmentContextID):{current:r,currentTagId:n}=this.openElements,t.tagID===m.SVG&&this.treeAdapter.getTagName(r)===he.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(r)===Re.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===m.MGLYPH||t.tagID===m.MALIGNMARK)&&!this._isIntegrationPoint(n,r,Re.HTML)}_processToken(t){switch(t.type){case Dt.CHARACTER:{this.onCharacter(t);break}case Dt.NULL_CHARACTER:{this.onNullCharacter(t);break}case Dt.COMMENT:{this.onComment(t);break}case Dt.DOCTYPE:{this.onDoctype(t);break}case Dt.START_TAG:{this._processStartTag(t);break}case Dt.END_TAG:{this.onEndTag(t);break}case Dt.EOF:{this.onEof(t);break}case Dt.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,r,n){const a=this.treeAdapter.getNamespaceURI(r),f=this.treeAdapter.getAttrList(r);return Cy(t,a,f,n)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const r=this.activeFormattingElements.entries.findIndex(a=>a.type===Dr.Marker||this.openElements.contains(a.element)),n=r<0?t-1:r-1;for(let a=n;a>=0;a--){const f=this.activeFormattingElements.entries[a];this._insertElement(f.token,this.treeAdapter.getNamespaceURI(f.element)),f.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=Y.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(m.P),this.openElements.popUntilTagNamePopped(m.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case m.TR:{this.insertionMode=Y.IN_ROW;return}case m.TBODY:case m.THEAD:case m.TFOOT:{this.insertionMode=Y.IN_TABLE_BODY;return}case m.CAPTION:{this.insertionMode=Y.IN_CAPTION;return}case m.COLGROUP:{this.insertionMode=Y.IN_COLUMN_GROUP;return}case m.TABLE:{this.insertionMode=Y.IN_TABLE;return}case m.BODY:{this.insertionMode=Y.IN_BODY;return}case m.FRAMESET:{this.insertionMode=Y.IN_FRAMESET;return}case m.SELECT:{this._resetInsertionModeForSelect(t);return}case m.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case m.HTML:{this.insertionMode=this.headElement?Y.AFTER_HEAD:Y.BEFORE_HEAD;return}case m.TD:case m.TH:{if(t>0){this.insertionMode=Y.IN_CELL;return}break}case m.HEAD:{if(t>0){this.insertionMode=Y.IN_HEAD;return}break}}this.insertionMode=Y.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let r=t-1;r>0;r--){const n=this.openElements.tagIDs[r];if(n===m.TEMPLATE)break;if(n===m.TABLE){this.insertionMode=Y.IN_SELECT_IN_TABLE;return}}this.insertionMode=Y.IN_SELECT}_isElementCausesFosterParenting(t){return Xd.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const r=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case m.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(r)===Re.HTML)return{parent:this.treeAdapter.getTemplateContent(r),beforeElement:null};break}case m.TABLE:{const n=this.treeAdapter.getParentNode(r);return n?{parent:n,beforeElement:r}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const r=this._findFosterParentingLocation();r.beforeElement?this.treeAdapter.insertBefore(r.parent,t,r.beforeElement):this.treeAdapter.appendChild(r.parent,t)}_isSpecialElement(t,r){const n=this.treeAdapter.getNamespaceURI(t);return Xb[n].has(r)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){a_(this,t);return}switch(this.insertionMode){case Y.INITIAL:{Fi(this,t);break}case Y.BEFORE_HTML:{Xi(this,t);break}case Y.BEFORE_HEAD:{$i(this,t);break}case Y.IN_HEAD:{Qi(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{zi(this,t);break}case Y.AFTER_HEAD:{Ji(this,t);break}case Y.IN_BODY:case Y.IN_CAPTION:case Y.IN_CELL:case Y.IN_TEMPLATE:{zd(this,t);break}case Y.TEXT:case Y.IN_SELECT:case Y.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case Y.IN_TABLE:case Y.IN_TABLE_BODY:case Y.IN_ROW:{Mo(this,t);break}case Y.IN_TABLE_TEXT:{n0(this,t);break}case Y.IN_COLUMN_GROUP:{aa(this,t);break}case Y.AFTER_BODY:{oa(this,t);break}case Y.AFTER_AFTER_BODY:{js(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){s_(this,t);return}switch(this.insertionMode){case Y.INITIAL:{Fi(this,t);break}case Y.BEFORE_HTML:{Xi(this,t);break}case Y.BEFORE_HEAD:{$i(this,t);break}case Y.IN_HEAD:{Qi(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{zi(this,t);break}case Y.AFTER_HEAD:{Ji(this,t);break}case Y.TEXT:{this._insertCharacters(t);break}case Y.IN_TABLE:case Y.IN_TABLE_BODY:case Y.IN_ROW:{Mo(this,t);break}case Y.IN_COLUMN_GROUP:{aa(this,t);break}case Y.AFTER_BODY:{oa(this,t);break}case Y.AFTER_AFTER_BODY:{js(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){du(this,t);return}switch(this.insertionMode){case Y.INITIAL:case Y.BEFORE_HTML:case Y.BEFORE_HEAD:case Y.IN_HEAD:case Y.IN_HEAD_NO_SCRIPT:case Y.AFTER_HEAD:case Y.IN_BODY:case Y.IN_TABLE:case Y.IN_CAPTION:case Y.IN_COLUMN_GROUP:case Y.IN_TABLE_BODY:case Y.IN_ROW:case Y.IN_CELL:case Y.IN_SELECT:case Y.IN_SELECT_IN_TABLE:case Y.IN_TEMPLATE:case Y.IN_FRAMESET:case Y.AFTER_FRAMESET:{du(this,t);break}case Y.IN_TABLE_TEXT:{Bi(this,t);break}case Y.AFTER_BODY:{Fy(this,t);break}case Y.AFTER_AFTER_BODY:case Y.AFTER_AFTER_FRAMESET:{By(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case Y.INITIAL:{Uy(this,t);break}case Y.BEFORE_HEAD:case Y.IN_HEAD:case Y.IN_HEAD_NO_SCRIPT:case Y.AFTER_HEAD:{this._err(t,be.misplacedDoctype);break}case Y.IN_TABLE_TEXT:{Bi(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,be.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?o_(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case Y.INITIAL:{Fi(this,t);break}case Y.BEFORE_HTML:{Hy(this,t);break}case Y.BEFORE_HEAD:{Ky(this,t);break}case Y.IN_HEAD:{wr(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{Vy(this,t);break}case Y.AFTER_HEAD:{Wy(this,t);break}case Y.IN_BODY:{ar(this,t);break}case Y.IN_TABLE:{vi(this,t);break}case Y.IN_TABLE_TEXT:{Bi(this,t);break}case Y.IN_CAPTION:{YA(this,t);break}case Y.IN_COLUMN_GROUP:{ic(this,t);break}case Y.IN_TABLE_BODY:{Oa(this,t);break}case Y.IN_ROW:{xa(this,t);break}case Y.IN_CELL:{qA(this,t);break}case Y.IN_SELECT:{a0(this,t);break}case Y.IN_SELECT_IN_TABLE:{XA(this,t);break}case Y.IN_TEMPLATE:{QA(this,t);break}case Y.AFTER_BODY:{JA(this,t);break}case Y.IN_FRAMESET:{ZA(this,t);break}case Y.AFTER_FRAMESET:{t_(this,t);break}case Y.AFTER_AFTER_BODY:{n_(this,t);break}case Y.AFTER_AFTER_FRAMESET:{i_(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?u_(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case Y.INITIAL:{Fi(this,t);break}case Y.BEFORE_HTML:{Gy(this,t);break}case Y.BEFORE_HEAD:{Yy(this,t);break}case Y.IN_HEAD:{jy(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{qy(this,t);break}case Y.AFTER_HEAD:{Xy(this,t);break}case Y.IN_BODY:{Na(this,t);break}case Y.TEXT:{kA(this,t);break}case Y.IN_TABLE:{cs(this,t);break}case Y.IN_TABLE_TEXT:{Bi(this,t);break}case Y.IN_CAPTION:{jA(this,t);break}case Y.IN_COLUMN_GROUP:{VA(this,t);break}case Y.IN_TABLE_BODY:{gu(this,t);break}case Y.IN_ROW:{s0(this,t);break}case Y.IN_CELL:{WA(this,t);break}case Y.IN_SELECT:{o0(this,t);break}case Y.IN_SELECT_IN_TABLE:{$A(this,t);break}case Y.IN_TEMPLATE:{zA(this,t);break}case Y.AFTER_BODY:{c0(this,t);break}case Y.IN_FRAMESET:{e_(this,t);break}case Y.AFTER_FRAMESET:{r_(this,t);break}case Y.AFTER_AFTER_BODY:{js(this,t);break}}}onEof(t){switch(this.insertionMode){case Y.INITIAL:{Fi(this,t);break}case Y.BEFORE_HTML:{Xi(this,t);break}case Y.BEFORE_HEAD:{$i(this,t);break}case Y.IN_HEAD:{Qi(this,t);break}case Y.IN_HEAD_NO_SCRIPT:{zi(this,t);break}case Y.AFTER_HEAD:{Ji(this,t);break}case Y.IN_BODY:case Y.IN_TABLE:case Y.IN_CAPTION:case Y.IN_COLUMN_GROUP:case Y.IN_TABLE_BODY:case Y.IN_ROW:case Y.IN_CELL:case Y.IN_SELECT:case Y.IN_SELECT_IN_TABLE:{t0(this,t);break}case Y.TEXT:{PA(this,t);break}case Y.IN_TABLE_TEXT:{Bi(this,t);break}case Y.IN_TEMPLATE:{u0(this,t);break}case Y.AFTER_BODY:case Y.IN_FRAMESET:case Y.AFTER_FRAMESET:case Y.AFTER_AFTER_BODY:case Y.AFTER_AFTER_FRAMESET:{nc(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===w.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case Y.IN_HEAD:case Y.IN_HEAD_NO_SCRIPT:case Y.AFTER_HEAD:case Y.TEXT:case Y.IN_COLUMN_GROUP:case Y.IN_SELECT:case Y.IN_SELECT_IN_TABLE:case Y.IN_FRAMESET:case Y.AFTER_FRAMESET:{this._insertCharacters(t);break}case Y.IN_BODY:case Y.IN_CAPTION:case Y.IN_CELL:case Y.IN_TEMPLATE:case Y.AFTER_BODY:case Y.AFTER_AFTER_BODY:case Y.AFTER_AFTER_FRAMESET:{Qd(this,t);break}case Y.IN_TABLE:case Y.IN_TABLE_BODY:case Y.IN_ROW:{Mo(this,t);break}case Y.IN_TABLE_TEXT:{r0(this,t);break}}}};function Oy(e,t){let r=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return r?e.openElements.contains(r.element)?e.openElements.hasInScope(t.tagID)||(r=null):(e.activeFormattingElements.removeEntry(r),r=null):e0(e,t),r}function xy(e,t){let r=null,n=e.openElements.stackTop;for(;n>=0;n--){const a=e.openElements.items[n];if(a===t.element)break;e._isSpecialElement(a,e.openElements.tagIDs[n])&&(r=a)}return r||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),r}function ky(e,t,r){let n=t,a=e.openElements.getCommonAncestor(t);for(let f=0,E=a;E!==r;f++,E=a){a=e.openElements.getCommonAncestor(E);const A=e.activeFormattingElements.getElementEntry(E),y=A&&f>=Dy;!A||y?(y&&e.activeFormattingElements.removeEntry(A),e.openElements.remove(E)):(E=Py(e,A),n===t&&(e.activeFormattingElements.bookmark=A),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(E,n),n=E)}return n}function Py(e,t){const r=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,r,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function wy(e,t,r){const n=e.treeAdapter.getTagName(t),a=Ra(n);if(e._isElementCausesFosterParenting(a))e._fosterParentElement(r);else{const f=e.treeAdapter.getNamespaceURI(t);a===m.TEMPLATE&&f===Re.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,r)}}function My(e,t,r){const n=e.treeAdapter.getNamespaceURI(r.element),{token:a}=r,f=e.treeAdapter.createElement(a.tagName,n,a.attrs);e._adoptNodes(t,f),e.treeAdapter.appendChild(t,f),e.activeFormattingElements.insertElementAfterBookmark(f,a),e.activeFormattingElements.removeEntry(r),e.openElements.remove(r.element),e.openElements.insertAfter(t,f,a.tagID)}function rc(e,t){for(let r=0;r<Ry;r++){const n=Oy(e,t);if(!n)break;const a=xy(e,n);if(!a)break;e.activeFormattingElements.bookmark=n;const f=ky(e,a,n.element),E=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(f),E&&wy(e,E,f),My(e,a,n)}}function du(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function Fy(e,t){e._appendCommentNode(t,e.openElements.items[0])}function By(e,t){e._appendCommentNode(t,e.document)}function nc(e,t){if(e.stopped=!0,t.location){const r=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=r;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const n=e.openElements.items[0],a=e.treeAdapter.getNodeSourceCodeLocation(n);if(a&&!a.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){const f=e.openElements.items[1],E=e.treeAdapter.getNodeSourceCodeLocation(f);E&&!E.endTag&&e._setEndLocation(f,t)}}}}function Uy(e,t){e._setDocumentType(t);const r=t.forceQuirks?gr.QUIRKS:my(t);gy(t)||e._err(t,be.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,r),e.insertionMode=Y.BEFORE_HTML}function Fi(e,t){e._err(t,be.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,gr.QUIRKS),e.insertionMode=Y.BEFORE_HTML,e._processToken(t)}function Hy(e,t){t.tagID===m.HTML?(e._insertElement(t,Re.HTML),e.insertionMode=Y.BEFORE_HEAD):Xi(e,t)}function Gy(e,t){const r=t.tagID;(r===m.HTML||r===m.HEAD||r===m.BODY||r===m.BR)&&Xi(e,t)}function Xi(e,t){e._insertFakeRootElement(),e.insertionMode=Y.BEFORE_HEAD,e._processToken(t)}function Ky(e,t){switch(t.tagID){case m.HTML:{ar(e,t);break}case m.HEAD:{e._insertElement(t,Re.HTML),e.headElement=e.openElements.current,e.insertionMode=Y.IN_HEAD;break}default:$i(e,t)}}function Yy(e,t){const r=t.tagID;r===m.HEAD||r===m.BODY||r===m.HTML||r===m.BR?$i(e,t):e._err(t,be.endTagWithoutMatchingOpenElement)}function $i(e,t){e._insertFakeElement(he.HEAD,m.HEAD),e.headElement=e.openElements.current,e.insertionMode=Y.IN_HEAD,e._processToken(t)}function wr(e,t){switch(t.tagID){case m.HTML:{ar(e,t);break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:{e._appendElement(t,Re.HTML),t.ackSelfClosing=!0;break}case m.TITLE:{e._switchToTextParsing(t,mr.RCDATA);break}case m.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,mr.RAWTEXT):(e._insertElement(t,Re.HTML),e.insertionMode=Y.IN_HEAD_NO_SCRIPT);break}case m.NOFRAMES:case m.STYLE:{e._switchToTextParsing(t,mr.RAWTEXT);break}case m.SCRIPT:{e._switchToTextParsing(t,mr.SCRIPT_DATA);break}case m.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=Y.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(Y.IN_TEMPLATE);break}case m.HEAD:{e._err(t,be.misplacedStartTagForHeadElement);break}default:Qi(e,t)}}function jy(e,t){switch(t.tagID){case m.HEAD:{e.openElements.pop(),e.insertionMode=Y.AFTER_HEAD;break}case m.BODY:case m.BR:case m.HTML:{Qi(e,t);break}case m.TEMPLATE:{Wn(e,t);break}default:e._err(t,be.endTagWithoutMatchingOpenElement)}}function Wn(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==m.TEMPLATE&&e._err(t,be.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,be.endTagWithoutMatchingOpenElement)}function Qi(e,t){e.openElements.pop(),e.insertionMode=Y.AFTER_HEAD,e._processToken(t)}function Vy(e,t){switch(t.tagID){case m.HTML:{ar(e,t);break}case m.BASEFONT:case m.BGSOUND:case m.HEAD:case m.LINK:case m.META:case m.NOFRAMES:case m.STYLE:{wr(e,t);break}case m.NOSCRIPT:{e._err(t,be.nestedNoscriptInHead);break}default:zi(e,t)}}function qy(e,t){switch(t.tagID){case m.NOSCRIPT:{e.openElements.pop(),e.insertionMode=Y.IN_HEAD;break}case m.BR:{zi(e,t);break}default:e._err(t,be.endTagWithoutMatchingOpenElement)}}function zi(e,t){const r=t.type===Dt.EOF?be.openElementsLeftAfterEof:be.disallowedContentInNoscriptInHead;e._err(t,r),e.openElements.pop(),e.insertionMode=Y.IN_HEAD,e._processToken(t)}function Wy(e,t){switch(t.tagID){case m.HTML:{ar(e,t);break}case m.BODY:{e._insertElement(t,Re.HTML),e.framesetOk=!1,e.insertionMode=Y.IN_BODY;break}case m.FRAMESET:{e._insertElement(t,Re.HTML),e.insertionMode=Y.IN_FRAMESET;break}case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{e._err(t,be.abandonedHeadElementChild),e.openElements.push(e.headElement,m.HEAD),wr(e,t),e.openElements.remove(e.headElement);break}case m.HEAD:{e._err(t,be.misplacedStartTagForHeadElement);break}default:Ji(e,t)}}function Xy(e,t){switch(t.tagID){case m.BODY:case m.HTML:case m.BR:{Ji(e,t);break}case m.TEMPLATE:{Wn(e,t);break}default:e._err(t,be.endTagWithoutMatchingOpenElement)}}function Ji(e,t){e._insertFakeElement(he.BODY,m.BODY),e.insertionMode=Y.IN_BODY,Da(e,t)}function Da(e,t){switch(t.type){case Dt.CHARACTER:{zd(e,t);break}case Dt.WHITESPACE_CHARACTER:{Qd(e,t);break}case Dt.COMMENT:{du(e,t);break}case Dt.START_TAG:{ar(e,t);break}case Dt.END_TAG:{Na(e,t);break}case Dt.EOF:{t0(e,t);break}}}function Qd(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function zd(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function $y(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function Qy(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(r,t.attrs))}function zy(e,t){const r=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&r&&(e.treeAdapter.detachNode(r),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,Re.HTML),e.insertionMode=Y.IN_FRAMESET)}function Jy(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Re.HTML)}function Zy(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),Bd(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,Re.HTML)}function eA(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Re.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function tA(e,t){const r=e.openElements.tmplCount>0;(!e.formElement||r)&&(e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Re.HTML),r||(e.formElement=e.openElements.current))}function rA(e,t){e.framesetOk=!1;const r=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){const a=e.openElements.tagIDs[n];if(r===m.LI&&a===m.LI||(r===m.DD||r===m.DT)&&(a===m.DD||a===m.DT)){e.openElements.generateImpliedEndTagsWithExclusion(a),e.openElements.popUntilTagNamePopped(a);break}if(a!==m.ADDRESS&&a!==m.DIV&&a!==m.P&&e._isSpecialElement(e.openElements.items[n],a))break}e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Re.HTML)}function nA(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Re.HTML),e.tokenizer.state=mr.PLAINTEXT}function iA(e,t){e.openElements.hasInScope(m.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,Re.HTML),e.framesetOk=!1}function sA(e,t){const r=e.activeFormattingElements.getElementEntryInScopeWithTagName(he.A);r&&(rc(e,t),e.openElements.remove(r.element),e.activeFormattingElements.removeEntry(r)),e._reconstructActiveFormattingElements(),e._insertElement(t,Re.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function aA(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,Re.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function oA(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(m.NOBR)&&(rc(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,Re.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function uA(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,Re.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function cA(e,t){e.treeAdapter.getDocumentMode(e.document)!==gr.QUIRKS&&e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._insertElement(t,Re.HTML),e.framesetOk=!1,e.insertionMode=Y.IN_TABLE}function Jd(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,Re.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function Zd(e){const t=Fd(e,bn.TYPE);return t!=null&&t.toLowerCase()===Ly}function lA(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,Re.HTML),Zd(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function hA(e,t){e._appendElement(t,Re.HTML),t.ackSelfClosing=!0}function fA(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._appendElement(t,Re.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function dA(e,t){t.tagName=he.IMG,t.tagID=m.IMG,Jd(e,t)}function gA(e,t){e._insertElement(t,Re.HTML),e.skipNextNewLine=!0,e.tokenizer.state=mr.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=Y.TEXT}function mA(e,t){e.openElements.hasInButtonScope(m.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,mr.RAWTEXT)}function pA(e,t){e.framesetOk=!1,e._switchToTextParsing(t,mr.RAWTEXT)}function Eh(e,t){e._switchToTextParsing(t,mr.RAWTEXT)}function EA(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,Re.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===Y.IN_TABLE||e.insertionMode===Y.IN_CAPTION||e.insertionMode===Y.IN_TABLE_BODY||e.insertionMode===Y.IN_ROW||e.insertionMode===Y.IN_CELL?Y.IN_SELECT_IN_TABLE:Y.IN_SELECT}function TA(e,t){e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,Re.HTML)}function vA(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,Re.HTML)}function bA(e,t){e.openElements.hasInScope(m.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(m.RTC),e._insertElement(t,Re.HTML)}function yA(e,t){e._reconstructActiveFormattingElements(),qd(t),tc(t),t.selfClosing?e._appendElement(t,Re.MATHML):e._insertElement(t,Re.MATHML),t.ackSelfClosing=!0}function AA(e,t){e._reconstructActiveFormattingElements(),Wd(t),tc(t),t.selfClosing?e._appendElement(t,Re.SVG):e._insertElement(t,Re.SVG),t.ackSelfClosing=!0}function Th(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,Re.HTML)}function ar(e,t){switch(t.tagID){case m.I:case m.S:case m.B:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.SMALL:case m.STRIKE:case m.STRONG:{aA(e,t);break}case m.A:{sA(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{Zy(e,t);break}case m.P:case m.DL:case m.OL:case m.UL:case m.DIV:case m.DIR:case m.NAV:case m.MAIN:case m.MENU:case m.ASIDE:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.DETAILS:case m.ADDRESS:case m.ARTICLE:case m.SECTION:case m.SUMMARY:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{Jy(e,t);break}case m.LI:case m.DD:case m.DT:{rA(e,t);break}case m.BR:case m.IMG:case m.WBR:case m.AREA:case m.EMBED:case m.KEYGEN:{Jd(e,t);break}case m.HR:{fA(e,t);break}case m.RB:case m.RTC:{vA(e,t);break}case m.RT:case m.RP:{bA(e,t);break}case m.PRE:case m.LISTING:{eA(e,t);break}case m.XMP:{mA(e,t);break}case m.SVG:{AA(e,t);break}case m.HTML:{$y(e,t);break}case m.BASE:case m.LINK:case m.META:case m.STYLE:case m.TITLE:case m.SCRIPT:case m.BGSOUND:case m.BASEFONT:case m.TEMPLATE:{wr(e,t);break}case m.BODY:{Qy(e,t);break}case m.FORM:{tA(e,t);break}case m.NOBR:{oA(e,t);break}case m.MATH:{yA(e,t);break}case m.TABLE:{cA(e,t);break}case m.INPUT:{lA(e,t);break}case m.PARAM:case m.TRACK:case m.SOURCE:{hA(e,t);break}case m.IMAGE:{dA(e,t);break}case m.BUTTON:{iA(e,t);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{uA(e,t);break}case m.IFRAME:{pA(e,t);break}case m.SELECT:{EA(e,t);break}case m.OPTION:case m.OPTGROUP:{TA(e,t);break}case m.NOEMBED:{Eh(e,t);break}case m.FRAMESET:{zy(e,t);break}case m.TEXTAREA:{gA(e,t);break}case m.NOSCRIPT:{e.options.scriptingEnabled?Eh(e,t):Th(e,t);break}case m.PLAINTEXT:{nA(e,t);break}case m.COL:case m.TH:case m.TD:case m.TR:case m.HEAD:case m.FRAME:case m.TBODY:case m.TFOOT:case m.THEAD:case m.CAPTION:case m.COLGROUP:break;default:Th(e,t)}}function _A(e,t){if(e.openElements.hasInScope(m.BODY)&&(e.insertionMode=Y.AFTER_BODY,e.options.sourceCodeLocationInfo)){const r=e.openElements.tryPeekProperlyNestedBodyElement();r&&e._setEndLocation(r,t)}}function SA(e,t){e.openElements.hasInScope(m.BODY)&&(e.insertionMode=Y.AFTER_BODY,c0(e,t))}function IA(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r))}function CA(e){const t=e.openElements.tmplCount>0,{formElement:r}=e;t||(e.formElement=null),(r||t)&&e.openElements.hasInScope(m.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(m.FORM):r&&e.openElements.remove(r))}function LA(e){e.openElements.hasInButtonScope(m.P)||e._insertFakeElement(he.P,m.P),e._closePElement()}function RA(e){e.openElements.hasInListItemScope(m.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(m.LI),e.openElements.popUntilTagNamePopped(m.LI))}function DA(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.popUntilTagNamePopped(r))}function NA(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function OA(e,t){const r=t.tagID;e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker())}function xA(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(he.BR,m.BR),e.openElements.pop(),e.framesetOk=!1}function e0(e,t){const r=t.tagName,n=t.tagID;for(let a=e.openElements.stackTop;a>0;a--){const f=e.openElements.items[a],E=e.openElements.tagIDs[a];if(n===E&&(n!==m.UNKNOWN||e.treeAdapter.getTagName(f)===r)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=a&&e.openElements.shortenToLength(a);break}if(e._isSpecialElement(f,E))break}}function Na(e,t){switch(t.tagID){case m.A:case m.B:case m.I:case m.S:case m.U:case m.EM:case m.TT:case m.BIG:case m.CODE:case m.FONT:case m.NOBR:case m.SMALL:case m.STRIKE:case m.STRONG:{rc(e,t);break}case m.P:{LA(e);break}case m.DL:case m.UL:case m.OL:case m.DIR:case m.DIV:case m.NAV:case m.PRE:case m.MAIN:case m.MENU:case m.ASIDE:case m.BUTTON:case m.CENTER:case m.FIGURE:case m.FOOTER:case m.HEADER:case m.HGROUP:case m.DIALOG:case m.ADDRESS:case m.ARTICLE:case m.DETAILS:case m.SECTION:case m.SUMMARY:case m.LISTING:case m.FIELDSET:case m.BLOCKQUOTE:case m.FIGCAPTION:{IA(e,t);break}case m.LI:{RA(e);break}case m.DD:case m.DT:{DA(e,t);break}case m.H1:case m.H2:case m.H3:case m.H4:case m.H5:case m.H6:{NA(e);break}case m.BR:{xA(e);break}case m.BODY:{_A(e,t);break}case m.HTML:{SA(e,t);break}case m.FORM:{CA(e);break}case m.APPLET:case m.OBJECT:case m.MARQUEE:{OA(e,t);break}case m.TEMPLATE:{Wn(e,t);break}default:e0(e,t)}}function t0(e,t){e.tmplInsertionModeStack.length>0?u0(e,t):nc(e,t)}function kA(e,t){var r;t.tagID===m.SCRIPT&&((r=e.scriptHandler)===null||r===void 0||r.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function PA(e,t){e._err(t,be.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function Mo(e,t){if(Xd.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=Y.IN_TABLE_TEXT,t.type){case Dt.CHARACTER:{n0(e,t);break}case Dt.WHITESPACE_CHARACTER:{r0(e,t);break}}else ms(e,t)}function wA(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,Re.HTML),e.insertionMode=Y.IN_CAPTION}function MA(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,Re.HTML),e.insertionMode=Y.IN_COLUMN_GROUP}function FA(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(he.COLGROUP,m.COLGROUP),e.insertionMode=Y.IN_COLUMN_GROUP,ic(e,t)}function BA(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,Re.HTML),e.insertionMode=Y.IN_TABLE_BODY}function UA(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(he.TBODY,m.TBODY),e.insertionMode=Y.IN_TABLE_BODY,Oa(e,t)}function HA(e,t){e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function GA(e,t){Zd(t)?e._appendElement(t,Re.HTML):ms(e,t),t.ackSelfClosing=!0}function KA(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,Re.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function vi(e,t){switch(t.tagID){case m.TD:case m.TH:case m.TR:{UA(e,t);break}case m.STYLE:case m.SCRIPT:case m.TEMPLATE:{wr(e,t);break}case m.COL:{FA(e,t);break}case m.FORM:{KA(e,t);break}case m.TABLE:{HA(e,t);break}case m.TBODY:case m.TFOOT:case m.THEAD:{BA(e,t);break}case m.INPUT:{GA(e,t);break}case m.CAPTION:{wA(e,t);break}case m.COLGROUP:{MA(e,t);break}default:ms(e,t)}}function cs(e,t){switch(t.tagID){case m.TABLE:{e.openElements.hasInTableScope(m.TABLE)&&(e.openElements.popUntilTagNamePopped(m.TABLE),e._resetInsertionMode());break}case m.TEMPLATE:{Wn(e,t);break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:ms(e,t)}}function ms(e,t){const r=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,Da(e,t),e.fosterParentingEnabled=r}function r0(e,t){e.pendingCharacterTokens.push(t)}function n0(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function Bi(e,t){let r=0;if(e.hasNonWhitespacePendingCharacterToken)for(;r<e.pendingCharacterTokens.length;r++)ms(e,e.pendingCharacterTokens[r]);else for(;r<e.pendingCharacterTokens.length;r++)e._insertCharacters(e.pendingCharacterTokens[r]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const i0=new Set([m.CAPTION,m.COL,m.COLGROUP,m.TBODY,m.TD,m.TFOOT,m.TH,m.THEAD,m.TR]);function YA(e,t){const r=t.tagID;i0.has(r)?e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=Y.IN_TABLE,vi(e,t)):ar(e,t)}function jA(e,t){const r=t.tagID;switch(r){case m.CAPTION:case m.TABLE:{e.openElements.hasInTableScope(m.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(m.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=Y.IN_TABLE,r===m.TABLE&&cs(e,t));break}case m.BODY:case m.COL:case m.COLGROUP:case m.HTML:case m.TBODY:case m.TD:case m.TFOOT:case m.TH:case m.THEAD:case m.TR:break;default:Na(e,t)}}function ic(e,t){switch(t.tagID){case m.HTML:{ar(e,t);break}case m.COL:{e._appendElement(t,Re.HTML),t.ackSelfClosing=!0;break}case m.TEMPLATE:{wr(e,t);break}default:aa(e,t)}}function VA(e,t){switch(t.tagID){case m.COLGROUP:{e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=Y.IN_TABLE);break}case m.TEMPLATE:{Wn(e,t);break}case m.COL:break;default:aa(e,t)}}function aa(e,t){e.openElements.currentTagId===m.COLGROUP&&(e.openElements.pop(),e.insertionMode=Y.IN_TABLE,e._processToken(t))}function Oa(e,t){switch(t.tagID){case m.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,Re.HTML),e.insertionMode=Y.IN_ROW;break}case m.TH:case m.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(he.TR,m.TR),e.insertionMode=Y.IN_ROW,xa(e,t);break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE,vi(e,t));break}default:vi(e,t)}}function gu(e,t){const r=t.tagID;switch(t.tagID){case m.TBODY:case m.TFOOT:case m.THEAD:{e.openElements.hasInTableScope(r)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE);break}case m.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE,cs(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:case m.TR:break;default:cs(e,t)}}function xa(e,t){switch(t.tagID){case m.TH:case m.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,Re.HTML),e.insertionMode=Y.IN_CELL,e.activeFormattingElements.insertMarker();break}case m.CAPTION:case m.COL:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE_BODY,Oa(e,t));break}default:vi(e,t)}}function s0(e,t){switch(t.tagID){case m.TR:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE_BODY);break}case m.TABLE:{e.openElements.hasInTableScope(m.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE_BODY,gu(e,t));break}case m.TBODY:case m.TFOOT:case m.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(m.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=Y.IN_TABLE_BODY,gu(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:case m.TD:case m.TH:break;default:cs(e,t)}}function qA(e,t){const r=t.tagID;i0.has(r)?(e.openElements.hasInTableScope(m.TD)||e.openElements.hasInTableScope(m.TH))&&(e._closeTableCell(),xa(e,t)):ar(e,t)}function WA(e,t){const r=t.tagID;switch(r){case m.TD:case m.TH:{e.openElements.hasInTableScope(r)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=Y.IN_ROW);break}case m.TABLE:case m.TBODY:case m.TFOOT:case m.THEAD:case m.TR:{e.openElements.hasInTableScope(r)&&(e._closeTableCell(),s0(e,t));break}case m.BODY:case m.CAPTION:case m.COL:case m.COLGROUP:case m.HTML:break;default:Na(e,t)}}function a0(e,t){switch(t.tagID){case m.HTML:{ar(e,t);break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e._insertElement(t,Re.HTML);break}case m.OPTGROUP:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop(),e._insertElement(t,Re.HTML);break}case m.INPUT:case m.KEYGEN:case m.TEXTAREA:case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),t.tagID!==m.SELECT&&e._processStartTag(t));break}case m.SCRIPT:case m.TEMPLATE:{wr(e,t);break}}}function o0(e,t){switch(t.tagID){case m.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===m.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===m.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===m.OPTGROUP&&e.openElements.pop();break}case m.OPTION:{e.openElements.currentTagId===m.OPTION&&e.openElements.pop();break}case m.SELECT:{e.openElements.hasInSelectScope(m.SELECT)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode());break}case m.TEMPLATE:{Wn(e,t);break}}}function XA(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e._processStartTag(t)):a0(e,t)}function $A(e,t){const r=t.tagID;r===m.CAPTION||r===m.TABLE||r===m.TBODY||r===m.TFOOT||r===m.THEAD||r===m.TR||r===m.TD||r===m.TH?e.openElements.hasInTableScope(r)&&(e.openElements.popUntilTagNamePopped(m.SELECT),e._resetInsertionMode(),e.onEndTag(t)):o0(e,t)}function QA(e,t){switch(t.tagID){case m.BASE:case m.BASEFONT:case m.BGSOUND:case m.LINK:case m.META:case m.NOFRAMES:case m.SCRIPT:case m.STYLE:case m.TEMPLATE:case m.TITLE:{wr(e,t);break}case m.CAPTION:case m.COLGROUP:case m.TBODY:case m.TFOOT:case m.THEAD:{e.tmplInsertionModeStack[0]=Y.IN_TABLE,e.insertionMode=Y.IN_TABLE,vi(e,t);break}case m.COL:{e.tmplInsertionModeStack[0]=Y.IN_COLUMN_GROUP,e.insertionMode=Y.IN_COLUMN_GROUP,ic(e,t);break}case m.TR:{e.tmplInsertionModeStack[0]=Y.IN_TABLE_BODY,e.insertionMode=Y.IN_TABLE_BODY,Oa(e,t);break}case m.TD:case m.TH:{e.tmplInsertionModeStack[0]=Y.IN_ROW,e.insertionMode=Y.IN_ROW,xa(e,t);break}default:e.tmplInsertionModeStack[0]=Y.IN_BODY,e.insertionMode=Y.IN_BODY,ar(e,t)}}function zA(e,t){t.tagID===m.TEMPLATE&&Wn(e,t)}function u0(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(m.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):nc(e,t)}function JA(e,t){t.tagID===m.HTML?ar(e,t):oa(e,t)}function c0(e,t){var r;if(t.tagID===m.HTML){if(e.fragmentContext||(e.insertionMode=Y.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===m.HTML){e._setEndLocation(e.openElements.items[0],t);const n=e.openElements.items[1];n&&!(!((r=e.treeAdapter.getNodeSourceCodeLocation(n))===null||r===void 0)&&r.endTag)&&e._setEndLocation(n,t)}}else oa(e,t)}function oa(e,t){e.insertionMode=Y.IN_BODY,Da(e,t)}function ZA(e,t){switch(t.tagID){case m.HTML:{ar(e,t);break}case m.FRAMESET:{e._insertElement(t,Re.HTML);break}case m.FRAME:{e._appendElement(t,Re.HTML),t.ackSelfClosing=!0;break}case m.NOFRAMES:{wr(e,t);break}}}function e_(e,t){t.tagID===m.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==m.FRAMESET&&(e.insertionMode=Y.AFTER_FRAMESET))}function t_(e,t){switch(t.tagID){case m.HTML:{ar(e,t);break}case m.NOFRAMES:{wr(e,t);break}}}function r_(e,t){t.tagID===m.HTML&&(e.insertionMode=Y.AFTER_AFTER_FRAMESET)}function n_(e,t){t.tagID===m.HTML?ar(e,t):js(e,t)}function js(e,t){e.insertionMode=Y.IN_BODY,Da(e,t)}function i_(e,t){switch(t.tagID){case m.HTML:{ar(e,t);break}case m.NOFRAMES:{wr(e,t);break}}}function s_(e,t){t.chars=Kt,e._insertCharacters(t)}function a_(e,t){e._insertCharacters(t),e.framesetOk=!1}function l0(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==Re.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function o_(e,t){if(Ay(t))l0(e),e._startTagOutsideForeignContent(t);else{const r=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(r);n===Re.MATHML?qd(t):n===Re.SVG&&(_y(t),Wd(t)),tc(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function u_(e,t){if(t.tagID===m.P||t.tagID===m.BR){l0(e),e._endTagOutsideForeignContent(t);return}for(let r=e.openElements.stackTop;r>0;r--){const n=e.openElements.items[r];if(e.treeAdapter.getNamespaceURI(n)===Re.HTML){e._endTagOutsideForeignContent(t);break}const a=e.treeAdapter.getTagName(n);if(a.toLowerCase()===t.tagName){t.tagName=a,e.openElements.shortenToLength(r);break}}}const c_=new Set([he.AREA,he.BASE,he.BASEFONT,he.BGSOUND,he.BR,he.COL,he.EMBED,he.FRAME,he.HR,he.IMG,he.INPUT,he.KEYGEN,he.LINK,he.META,he.PARAM,he.SOURCE,he.TRACK,he.WBR]);function l_(e,t){return t.treeAdapter.isElementNode(e)&&t.treeAdapter.getNamespaceURI(e)===Re.HTML&&c_.has(t.treeAdapter.getTagName(e))}const h_={treeAdapter:Fn,scriptingEnabled:!0};function f_(e,t){const r={...h_,...t};return h0(e,r)}function d_(e,t){let r="";const n=t.treeAdapter.isElementNode(e)&&t.treeAdapter.getTagName(e)===he.TEMPLATE&&t.treeAdapter.getNamespaceURI(e)===Re.HTML?t.treeAdapter.getTemplateContent(e):e,a=t.treeAdapter.getChildNodes(n);if(a)for(const f of a)r+=h0(f,t);return r}function h0(e,t){return t.treeAdapter.isElementNode(e)?g_(e,t):t.treeAdapter.isTextNode(e)?p_(e,t):t.treeAdapter.isCommentNode(e)?E_(e,t):t.treeAdapter.isDocumentTypeNode(e)?T_(e,t):""}function g_(e,t){const r=t.treeAdapter.getTagName(e);return`<${r}${m_(e,t)}>${l_(e,t)?"":`${d_(e,t)}</${r}>`}`}function m_(e,{treeAdapter:t}){let r="";for(const n of t.getAttrList(e)){if(r+=" ",!n.namespace)r+=n.name;else switch(n.namespace){case Re.XML:{r+=`xml:${n.name}`;break}case Re.XMLNS:{n.name!=="xmlns"&&(r+="xmlns:"),r+=n.name;break}case Re.XLINK:{r+=`xlink:${n.name}`;break}default:r+=`${n.prefix}:${n.name}`}r+=`="${Zf(n.value)}"`}return r}function p_(e,t){const{treeAdapter:r}=t,n=r.getTextNodeContent(e),a=r.getParentNode(e),f=a&&r.isElementNode(a)&&r.getTagName(a);return f&&r.getNamespaceURI(a)===Re.HTML&&Qb(f,t.scriptingEnabled)?n:ed(n)}function E_(e,{treeAdapter:t}){return`<!--${t.getCommentNodeContent(e)}-->`}function T_(e,{treeAdapter:t}){return`<!DOCTYPE ${t.getDocumentTypeNodeName(e)}>`}function v_(e,t){return $d.parse(e,t)}function b_(e,t,r){typeof e=="string"&&(r=t,t=e,e=null);const n=$d.getFragmentParser(e,r);return n.tokenizer.write(t,!0),n.getFragment()}function vh(e){return new as(e)}function bh(e){const t=e.includes('"')?"'":'"';return t+e+t}function y_(e,t,r){let n="!DOCTYPE ";return e&&(n+=e),t?n+=` PUBLIC ${bh(t)}`:r&&(n+=" SYSTEM"),r&&(n+=` ${bh(r)}`),n}const si={isCommentNode:ya,isElementNode:dt,isTextNode:qr,createDocument(){const e=new Yn([]);return e["x-mode"]=gr.NO_QUIRKS,e},createDocumentFragment(){return new Yn([])},createElement(e,t,r){const n=Object.create(null),a=Object.create(null),f=Object.create(null);for(let A=0;A<r.length;A++){const y=r[A].name;n[y]=r[A].value,a[y]=r[A].namespace,f[y]=r[A].prefix}const E=new Yu(e,n,[]);return E.namespace=t,E["x-attribsNamespace"]=a,E["x-attribsPrefix"]=f,E},createCommentNode(e){return new Hu(e)},appendChild(e,t){const r=e.children[e.children.length-1];r&&(r.next=t,t.prev=r),e.children.push(t),t.parent=e},insertBefore(e,t,r){const n=e.children.indexOf(r),{prev:a}=r;a&&(a.next=t,t.prev=a),r.prev=t,t.next=r,e.children.splice(n,0,t),t.parent=e},setTemplateContent(e,t){si.appendChild(e,t)},getTemplateContent(e){return e.children[0]},setDocumentType(e,t,r,n){const a=y_(t,r,n);let f=e.children.find(E=>su(E)&&E.name==="!doctype");f?f.data=a??null:(f=new Gu("!doctype",a),si.appendChild(e,f)),f["x-name"]=t??void 0,f["x-publicId"]=r??void 0,f["x-systemId"]=n??void 0},setDocumentMode(e,t){e["x-mode"]=t},getDocumentMode(e){return e["x-mode"]},detachNode(e){if(e.parent){const t=e.parent.children.indexOf(e),{prev:r,next:n}=e;e.prev=null,e.next=null,r&&(r.next=n),n&&(n.prev=r),e.parent.children.splice(t,1),e.parent=null}},insertText(e,t){const r=e.children[e.children.length-1];r&&qr(r)?r.data+=t:si.appendChild(e,vh(t))},insertTextBefore(e,t,r){const n=e.children[e.children.indexOf(r)-1];n&&qr(n)?n.data+=t:si.insertBefore(e,vh(t),r)},adoptAttributes(e,t){for(let r=0;r<t.length;r++){const n=t[r].name;typeof e.attribs[n]>"u"&&(e.attribs[n]=t[r].value,e["x-attribsNamespace"][n]=t[r].namespace,e["x-attribsPrefix"][n]=t[r].prefix)}},getFirstChild(e){return e.children[0]},getChildNodes(e){return e.children},getParentNode(e){return e.parent},getAttrList(e){return e.attributes},getTagName(e){return e.name},getNamespaceURI(e){return e.namespace},getTextNodeContent(e){return e.data},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){var t;return(t=e["x-name"])!==null&&t!==void 0?t:""},getDocumentTypeNodePublicId(e){var t;return(t=e["x-publicId"])!==null&&t!==void 0?t:""},getDocumentTypeNodeSystemId(e){var t;return(t=e["x-systemId"])!==null&&t!==void 0?t:""},isDocumentTypeNode(e){return su(e)&&e.name==="!doctype"},setNodeSourceCodeLocation(e,t){t&&(e.startIndex=t.startOffset,e.endIndex=t.endOffset),e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){t.endOffset!=null&&(e.endIndex=t.endOffset),e.sourceCodeLocation={...e.sourceCodeLocation,...t}}};function A_(e,t,r,n){const a={scriptingEnabled:typeof t.scriptingEnabled=="boolean"?t.scriptingEnabled:!0,treeAdapter:si,sourceCodeLocationInfo:t.sourceCodeLocationInfo};return r?v_(e,a):b_(n,e,a)}const __={treeAdapter:si};function S_(e){const t="length"in e?e:[e];for(let n=0;n<t.length;n+=1){const a=t[n];Vn(a)&&Array.prototype.splice.call(t,n,1,...a.children)}let r="";for(let n=0;n<t.length;n+=1){const a=t[n];r+=f_(a,__)}return r}var rt;(function(e){e[e.Tab=9]="Tab",e[e.NewLine=10]="NewLine",e[e.FormFeed=12]="FormFeed",e[e.CarriageReturn=13]="CarriageReturn",e[e.Space=32]="Space",e[e.ExclamationMark=33]="ExclamationMark",e[e.Num=35]="Num",e[e.Amp=38]="Amp",e[e.SingleQuote=39]="SingleQuote",e[e.DoubleQuote=34]="DoubleQuote",e[e.Dash=45]="Dash",e[e.Slash=47]="Slash",e[e.Zero=48]="Zero",e[e.Nine=57]="Nine",e[e.Semi=59]="Semi",e[e.Lt=60]="Lt",e[e.Eq=61]="Eq",e[e.Gt=62]="Gt",e[e.Questionmark=63]="Questionmark",e[e.UpperA=65]="UpperA",e[e.LowerA=97]="LowerA",e[e.UpperF=70]="UpperF",e[e.LowerF=102]="LowerF",e[e.UpperZ=90]="UpperZ",e[e.LowerZ=122]="LowerZ",e[e.LowerX=120]="LowerX",e[e.OpeningSquareBracket=91]="OpeningSquareBracket"})(rt||(rt={}));var Be;(function(e){e[e.Text=1]="Text",e[e.BeforeTagName=2]="BeforeTagName",e[e.InTagName=3]="InTagName",e[e.InSelfClosingTag=4]="InSelfClosingTag",e[e.BeforeClosingTagName=5]="BeforeClosingTagName",e[e.InClosingTagName=6]="InClosingTagName",e[e.AfterClosingTagName=7]="AfterClosingTagName",e[e.BeforeAttributeName=8]="BeforeAttributeName",e[e.InAttributeName=9]="InAttributeName",e[e.AfterAttributeName=10]="AfterAttributeName",e[e.BeforeAttributeValue=11]="BeforeAttributeValue",e[e.InAttributeValueDq=12]="InAttributeValueDq",e[e.InAttributeValueSq=13]="InAttributeValueSq",e[e.InAttributeValueNq=14]="InAttributeValueNq",e[e.BeforeDeclaration=15]="BeforeDeclaration",e[e.InDeclaration=16]="InDeclaration",e[e.InProcessingInstruction=17]="InProcessingInstruction",e[e.BeforeComment=18]="BeforeComment",e[e.CDATASequence=19]="CDATASequence",e[e.InSpecialComment=20]="InSpecialComment",e[e.InCommentLike=21]="InCommentLike",e[e.BeforeSpecialS=22]="BeforeSpecialS",e[e.SpecialStartSequence=23]="SpecialStartSequence",e[e.InSpecialTag=24]="InSpecialTag",e[e.BeforeEntity=25]="BeforeEntity",e[e.BeforeNumericEntity=26]="BeforeNumericEntity",e[e.InNamedEntity=27]="InNamedEntity",e[e.InNumericEntity=28]="InNumericEntity",e[e.InHexEntity=29]="InHexEntity"})(Be||(Be={}));function tn(e){return e===rt.Space||e===rt.NewLine||e===rt.Tab||e===rt.FormFeed||e===rt.CarriageReturn}function ws(e){return e===rt.Slash||e===rt.Gt||tn(e)}function yh(e){return e>=rt.Zero&&e<=rt.Nine}function I_(e){return e>=rt.LowerA&&e<=rt.LowerZ||e>=rt.UpperA&&e<=rt.UpperZ}function C_(e){return e>=rt.UpperA&&e<=rt.UpperF||e>=rt.LowerA&&e<=rt.LowerF}var jr;(function(e){e[e.NoValue=0]="NoValue",e[e.Unquoted=1]="Unquoted",e[e.Single=2]="Single",e[e.Double=3]="Double"})(jr||(jr={}));const hr={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])};class L_{constructor({xmlMode:t=!1,decodeEntities:r=!0},n){this.cbs=n,this.state=Be.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=Be.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=t,this.decodeEntities=r,this.entityTrie=t?VT:gn}reset(){this.state=Be.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=Be.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(t){this.offset+=this.buffer.length,this.buffer=t,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}getIndex(){return this.index}getSectionStart(){return this.sectionStart}stateText(t){t===rt.Lt||!this.decodeEntities&&this.fastForwardTo(rt.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=Be.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&t===rt.Amp&&(this.state=Be.BeforeEntity)}stateSpecialStartSequence(t){const r=this.sequenceIndex===this.currentSequence.length;if(!(r?ws(t):(t|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!r){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=Be.InTagName,this.stateInTagName(t)}stateInSpecialTag(t){if(this.sequenceIndex===this.currentSequence.length){if(t===rt.Gt||tn(t)){const r=this.index-this.currentSequence.length;if(this.sectionStart<r){const n=this.index;this.index=r,this.cbs.ontext(this.sectionStart,r),this.index=n}this.isSpecial=!1,this.sectionStart=r+2,this.stateInClosingTagName(t);return}this.sequenceIndex=0}(t|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===hr.TitleEnd?this.decodeEntities&&t===rt.Amp&&(this.state=Be.BeforeEntity):this.fastForwardTo(rt.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=Number(t===rt.Lt)}stateCDATASequence(t){t===hr.Cdata[this.sequenceIndex]?++this.sequenceIndex===hr.Cdata.length&&(this.state=Be.InCommentLike,this.currentSequence=hr.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=Be.InDeclaration,this.stateInDeclaration(t))}fastForwardTo(t){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===t)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(t){t===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===hr.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=Be.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):t!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(t){return this.xmlMode?!ws(t):I_(t)}startSpecial(t,r){this.isSpecial=!0,this.currentSequence=t,this.sequenceIndex=r,this.state=Be.SpecialStartSequence}stateBeforeTagName(t){if(t===rt.ExclamationMark)this.state=Be.BeforeDeclaration,this.sectionStart=this.index+1;else if(t===rt.Questionmark)this.state=Be.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(t)){const r=t|32;this.sectionStart=this.index,!this.xmlMode&&r===hr.TitleEnd[2]?this.startSpecial(hr.TitleEnd,3):this.state=!this.xmlMode&&r===hr.ScriptEnd[2]?Be.BeforeSpecialS:Be.InTagName}else t===rt.Slash?this.state=Be.BeforeClosingTagName:(this.state=Be.Text,this.stateText(t))}stateInTagName(t){ws(t)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=Be.BeforeAttributeName,this.stateBeforeAttributeName(t))}stateBeforeClosingTagName(t){tn(t)||(t===rt.Gt?this.state=Be.Text:(this.state=this.isTagStartChar(t)?Be.InClosingTagName:Be.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(t){(t===rt.Gt||tn(t))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=Be.AfterClosingTagName,this.stateAfterClosingTagName(t))}stateAfterClosingTagName(t){(t===rt.Gt||this.fastForwardTo(rt.Gt))&&(this.state=Be.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(t){t===rt.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=Be.InSpecialTag,this.sequenceIndex=0):this.state=Be.Text,this.baseState=this.state,this.sectionStart=this.index+1):t===rt.Slash?this.state=Be.InSelfClosingTag:tn(t)||(this.state=Be.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(t){t===rt.Gt?(this.cbs.onselfclosingtag(this.index),this.state=Be.Text,this.baseState=Be.Text,this.sectionStart=this.index+1,this.isSpecial=!1):tn(t)||(this.state=Be.BeforeAttributeName,this.stateBeforeAttributeName(t))}stateInAttributeName(t){(t===rt.Eq||ws(t))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=Be.AfterAttributeName,this.stateAfterAttributeName(t))}stateAfterAttributeName(t){t===rt.Eq?this.state=Be.BeforeAttributeValue:t===rt.Slash||t===rt.Gt?(this.cbs.onattribend(jr.NoValue,this.index),this.state=Be.BeforeAttributeName,this.stateBeforeAttributeName(t)):tn(t)||(this.cbs.onattribend(jr.NoValue,this.index),this.state=Be.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(t){t===rt.DoubleQuote?(this.state=Be.InAttributeValueDq,this.sectionStart=this.index+1):t===rt.SingleQuote?(this.state=Be.InAttributeValueSq,this.sectionStart=this.index+1):tn(t)||(this.sectionStart=this.index,this.state=Be.InAttributeValueNq,this.stateInAttributeValueNoQuotes(t))}handleInAttributeValue(t,r){t===r||!this.decodeEntities&&this.fastForwardTo(r)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(r===rt.DoubleQuote?jr.Double:jr.Single,this.index),this.state=Be.BeforeAttributeName):this.decodeEntities&&t===rt.Amp&&(this.baseState=this.state,this.state=Be.BeforeEntity)}stateInAttributeValueDoubleQuotes(t){this.handleInAttributeValue(t,rt.DoubleQuote)}stateInAttributeValueSingleQuotes(t){this.handleInAttributeValue(t,rt.SingleQuote)}stateInAttributeValueNoQuotes(t){tn(t)||t===rt.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(jr.Unquoted,this.index),this.state=Be.BeforeAttributeName,this.stateBeforeAttributeName(t)):this.decodeEntities&&t===rt.Amp&&(this.baseState=this.state,this.state=Be.BeforeEntity)}stateBeforeDeclaration(t){t===rt.OpeningSquareBracket?(this.state=Be.CDATASequence,this.sequenceIndex=0):this.state=t===rt.Dash?Be.BeforeComment:Be.InDeclaration}stateInDeclaration(t){(t===rt.Gt||this.fastForwardTo(rt.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=Be.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(t){(t===rt.Gt||this.fastForwardTo(rt.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=Be.Text,this.sectionStart=this.index+1)}stateBeforeComment(t){t===rt.Dash?(this.state=Be.InCommentLike,this.currentSequence=hr.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=Be.InDeclaration}stateInSpecialComment(t){(t===rt.Gt||this.fastForwardTo(rt.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=Be.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(t){const r=t|32;r===hr.ScriptEnd[3]?this.startSpecial(hr.ScriptEnd,4):r===hr.StyleEnd[3]?this.startSpecial(hr.StyleEnd,4):(this.state=Be.InTagName,this.stateInTagName(t))}stateBeforeEntity(t){this.entityExcess=1,this.entityResult=0,t===rt.Num?this.state=Be.BeforeNumericEntity:t===rt.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=Be.InNamedEntity,this.stateInNamedEntity(t))}stateInNamedEntity(t){if(this.entityExcess+=1,this.trieIndex=Qf(this.entityTrie,this.trieCurrent,this.trieIndex+1,t),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];const r=this.trieCurrent&an.VALUE_LENGTH;if(r){const n=(r>>14)-1;if(!this.allowLegacyEntity()&&t!==rt.Semi)this.trieIndex+=n;else{const a=this.index-this.entityExcess+1;a>this.sectionStart&&this.emitPartial(this.sectionStart,a),this.entityResult=this.trieIndex,this.trieIndex+=n,this.entityExcess=0,this.sectionStart=this.index+1,n===0&&this.emitNamedEntity()}}}emitNamedEntity(){if(this.state=this.baseState,this.entityResult===0)return;switch((this.entityTrie[this.entityResult]&an.VALUE_LENGTH)>>14){case 1:this.emitCodePoint(this.entityTrie[this.entityResult]&~an.VALUE_LENGTH);break;case 2:this.emitCodePoint(this.entityTrie[this.entityResult+1]);break;case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}stateBeforeNumericEntity(t){(t|32)===rt.LowerX?(this.entityExcess++,this.state=Be.InHexEntity):(this.state=Be.InNumericEntity,this.stateInNumericEntity(t))}emitNumericEntity(t){const r=this.index-this.entityExcess-1;r+2+Number(this.state===Be.InHexEntity)!==this.index&&(r>this.sectionStart&&this.emitPartial(this.sectionStart,r),this.sectionStart=this.index+Number(t),this.emitCodePoint(WT(this.entityResult))),this.state=this.baseState}stateInNumericEntity(t){t===rt.Semi?this.emitNumericEntity(!0):yh(t)?(this.entityResult=this.entityResult*10+(t-rt.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)}stateInHexEntity(t){t===rt.Semi?this.emitNumericEntity(!0):yh(t)?(this.entityResult=this.entityResult*16+(t-rt.Zero),this.entityExcess++):C_(t)?(this.entityResult=this.entityResult*16+((t|32)-rt.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)}allowLegacyEntity(){return!this.xmlMode&&(this.baseState===Be.Text||this.baseState===Be.InSpecialTag)}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===Be.Text||this.state===Be.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===Be.InAttributeValueDq||this.state===Be.InAttributeValueSq||this.state===Be.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const t=this.buffer.charCodeAt(this.index-this.offset);this.state===Be.Text?this.stateText(t):this.state===Be.SpecialStartSequence?this.stateSpecialStartSequence(t):this.state===Be.InSpecialTag?this.stateInSpecialTag(t):this.state===Be.CDATASequence?this.stateCDATASequence(t):this.state===Be.InAttributeValueDq?this.stateInAttributeValueDoubleQuotes(t):this.state===Be.InAttributeName?this.stateInAttributeName(t):this.state===Be.InCommentLike?this.stateInCommentLike(t):this.state===Be.InSpecialComment?this.stateInSpecialComment(t):this.state===Be.BeforeAttributeName?this.stateBeforeAttributeName(t):this.state===Be.InTagName?this.stateInTagName(t):this.state===Be.InClosingTagName?this.stateInClosingTagName(t):this.state===Be.BeforeTagName?this.stateBeforeTagName(t):this.state===Be.AfterAttributeName?this.stateAfterAttributeName(t):this.state===Be.InAttributeValueSq?this.stateInAttributeValueSingleQuotes(t):this.state===Be.BeforeAttributeValue?this.stateBeforeAttributeValue(t):this.state===Be.BeforeClosingTagName?this.stateBeforeClosingTagName(t):this.state===Be.AfterClosingTagName?this.stateAfterClosingTagName(t):this.state===Be.BeforeSpecialS?this.stateBeforeSpecialS(t):this.state===Be.InAttributeValueNq?this.stateInAttributeValueNoQuotes(t):this.state===Be.InSelfClosingTag?this.stateInSelfClosingTag(t):this.state===Be.InDeclaration?this.stateInDeclaration(t):this.state===Be.BeforeDeclaration?this.stateBeforeDeclaration(t):this.state===Be.BeforeComment?this.stateBeforeComment(t):this.state===Be.InProcessingInstruction?this.stateInProcessingInstruction(t):this.state===Be.InNamedEntity?this.stateInNamedEntity(t):this.state===Be.BeforeEntity?this.stateBeforeEntity(t):this.state===Be.InHexEntity?this.stateInHexEntity(t):this.state===Be.InNumericEntity?this.stateInNumericEntity(t):this.stateBeforeNumericEntity(t),this.index++}this.cleanup()}finish(){this.state===Be.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const t=this.buffer.length+this.offset;this.state===Be.InCommentLike?this.currentSequence===hr.CdataEnd?this.cbs.oncdata(this.sectionStart,t,0):this.cbs.oncomment(this.sectionStart,t,0):this.state===Be.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===Be.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===Be.InTagName||this.state===Be.BeforeAttributeName||this.state===Be.BeforeAttributeValue||this.state===Be.AfterAttributeName||this.state===Be.InAttributeName||this.state===Be.InAttributeValueSq||this.state===Be.InAttributeValueDq||this.state===Be.InAttributeValueNq||this.state===Be.InClosingTagName||this.cbs.ontext(this.sectionStart,t)}emitPartial(t,r){this.baseState!==Be.Text&&this.baseState!==Be.InSpecialTag?this.cbs.onattribdata(t,r):this.cbs.ontext(t,r)}emitCodePoint(t){this.baseState!==Be.Text&&this.baseState!==Be.InSpecialTag?this.cbs.onattribentity(t):this.cbs.ontextentity(t)}}const ri=new Set(["input","option","optgroup","select","button","datalist","textarea"]),Mt=new Set(["p"]),Ah=new Set(["thead","tbody"]),_h=new Set(["dd","dt"]),Sh=new Set(["rt","rp"]),R_=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",Mt],["h1",Mt],["h2",Mt],["h3",Mt],["h4",Mt],["h5",Mt],["h6",Mt],["select",ri],["input",ri],["output",ri],["button",ri],["datalist",ri],["textarea",ri],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",_h],["dt",_h],["address",Mt],["article",Mt],["aside",Mt],["blockquote",Mt],["details",Mt],["div",Mt],["dl",Mt],["fieldset",Mt],["figcaption",Mt],["figure",Mt],["footer",Mt],["form",Mt],["header",Mt],["hr",Mt],["main",Mt],["nav",Mt],["ol",Mt],["pre",Mt],["section",Mt],["table",Mt],["ul",Mt],["rt",Sh],["rp",Sh],["tbody",Ah],["tfoot",Ah]]),D_=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),Ih=new Set(["math","svg"]),Ch=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),N_=/\s|\//;class O_{constructor(t,r={}){var n,a,f,E,A;this.options=r,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=t??{},this.lowerCaseTagNames=(n=r.lowerCaseTags)!==null&&n!==void 0?n:!r.xmlMode,this.lowerCaseAttributeNames=(a=r.lowerCaseAttributeNames)!==null&&a!==void 0?a:!r.xmlMode,this.tokenizer=new((f=r.Tokenizer)!==null&&f!==void 0?f:L_)(this.options,this),(A=(E=this.cbs).onparserinit)===null||A===void 0||A.call(E,this)}ontext(t,r){var n,a;const f=this.getSlice(t,r);this.endIndex=r-1,(a=(n=this.cbs).ontext)===null||a===void 0||a.call(n,f),this.startIndex=r}ontextentity(t){var r,n;const a=this.tokenizer.getSectionStart();this.endIndex=a-1,(n=(r=this.cbs).ontext)===null||n===void 0||n.call(r,Wl(t)),this.startIndex=a}isVoidElement(t){return!this.options.xmlMode&&D_.has(t)}onopentagname(t,r){this.endIndex=r;let n=this.getSlice(t,r);this.lowerCaseTagNames&&(n=n.toLowerCase()),this.emitOpenTag(n)}emitOpenTag(t){var r,n,a,f;this.openTagStart=this.startIndex,this.tagname=t;const E=!this.options.xmlMode&&R_.get(t);if(E)for(;this.stack.length>0&&E.has(this.stack[this.stack.length-1]);){const A=this.stack.pop();(n=(r=this.cbs).onclosetag)===null||n===void 0||n.call(r,A,!0)}this.isVoidElement(t)||(this.stack.push(t),Ih.has(t)?this.foreignContext.push(!0):Ch.has(t)&&this.foreignContext.push(!1)),(f=(a=this.cbs).onopentagname)===null||f===void 0||f.call(a,t),this.cbs.onopentag&&(this.attribs={})}endOpenTag(t){var r,n;this.startIndex=this.openTagStart,this.attribs&&((n=(r=this.cbs).onopentag)===null||n===void 0||n.call(r,this.tagname,this.attribs,t),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(t){this.endIndex=t,this.endOpenTag(!1),this.startIndex=t+1}onclosetag(t,r){var n,a,f,E,A,y;this.endIndex=r;let _=this.getSlice(t,r);if(this.lowerCaseTagNames&&(_=_.toLowerCase()),(Ih.has(_)||Ch.has(_))&&this.foreignContext.pop(),this.isVoidElement(_))!this.options.xmlMode&&_==="br"&&((a=(n=this.cbs).onopentagname)===null||a===void 0||a.call(n,"br"),(E=(f=this.cbs).onopentag)===null||E===void 0||E.call(f,"br",{},!0),(y=(A=this.cbs).onclosetag)===null||y===void 0||y.call(A,"br",!1));else{const I=this.stack.lastIndexOf(_);if(I!==-1)if(this.cbs.onclosetag){let C=this.stack.length-I;for(;C--;)this.cbs.onclosetag(this.stack.pop(),C!==0)}else this.stack.length=I;else!this.options.xmlMode&&_==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=r+1}onselfclosingtag(t){this.endIndex=t,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=t+1):this.onopentagend(t)}closeCurrentTag(t){var r,n;const a=this.tagname;this.endOpenTag(t),this.stack[this.stack.length-1]===a&&((n=(r=this.cbs).onclosetag)===null||n===void 0||n.call(r,a,!t),this.stack.pop())}onattribname(t,r){this.startIndex=t;const n=this.getSlice(t,r);this.attribname=this.lowerCaseAttributeNames?n.toLowerCase():n}onattribdata(t,r){this.attribvalue+=this.getSlice(t,r)}onattribentity(t){this.attribvalue+=Wl(t)}onattribend(t,r){var n,a;this.endIndex=r,(a=(n=this.cbs).onattribute)===null||a===void 0||a.call(n,this.attribname,this.attribvalue,t===jr.Double?'"':t===jr.Single?"'":t===jr.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(t){const r=t.search(N_);let n=r<0?t:t.substr(0,r);return this.lowerCaseTagNames&&(n=n.toLowerCase()),n}ondeclaration(t,r){this.endIndex=r;const n=this.getSlice(t,r);if(this.cbs.onprocessinginstruction){const a=this.getInstructionName(n);this.cbs.onprocessinginstruction(`!${a}`,`!${n}`)}this.startIndex=r+1}onprocessinginstruction(t,r){this.endIndex=r;const n=this.getSlice(t,r);if(this.cbs.onprocessinginstruction){const a=this.getInstructionName(n);this.cbs.onprocessinginstruction(`?${a}`,`?${n}`)}this.startIndex=r+1}oncomment(t,r,n){var a,f,E,A;this.endIndex=r,(f=(a=this.cbs).oncomment)===null||f===void 0||f.call(a,this.getSlice(t,r-n)),(A=(E=this.cbs).oncommentend)===null||A===void 0||A.call(E),this.startIndex=r+1}oncdata(t,r,n){var a,f,E,A,y,_,I,C,b,L;this.endIndex=r;const O=this.getSlice(t,r-n);this.options.xmlMode||this.options.recognizeCDATA?((f=(a=this.cbs).oncdatastart)===null||f===void 0||f.call(a),(A=(E=this.cbs).ontext)===null||A===void 0||A.call(E,O),(_=(y=this.cbs).oncdataend)===null||_===void 0||_.call(y)):((C=(I=this.cbs).oncomment)===null||C===void 0||C.call(I,`[CDATA[${O}]]`),(L=(b=this.cbs).oncommentend)===null||L===void 0||L.call(b)),this.startIndex=r+1}onend(){var t,r;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let n=this.stack.length;n>0;this.cbs.onclosetag(this.stack[--n],!0));}(r=(t=this.cbs).onend)===null||r===void 0||r.call(t)}reset(){var t,r,n,a;(r=(t=this.cbs).onreset)===null||r===void 0||r.call(t),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(a=(n=this.cbs).onparserinit)===null||a===void 0||a.call(n,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(t){this.reset(),this.end(t)}getSlice(t,r){for(;t-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let n=this.buffers[0].slice(t-this.bufferOffset,r-this.bufferOffset);for(;r-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),n+=this.buffers[0].slice(0,r-this.bufferOffset);return n}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(t){var r,n;if(this.ended){(n=(r=this.cbs).onerror)===null||n===void 0||n.call(r,new Error(".write() after done!"));return}this.buffers.push(t),this.tokenizer.running&&(this.tokenizer.write(t),this.writeIndex++)}end(t){var r,n;if(this.ended){(n=(r=this.cbs).onerror)===null||n===void 0||n.call(r,Error(".end() after done!"));return}t&&this.write(t),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(t){this.write(t)}done(t){this.end(t)}}function x_(e,t){const r=new jT(void 0,t);return new O_(r,t).end(e),r.root}const k_=lb((e,t,r,n)=>t.xmlMode||t._useHtmlParser2?x_(e,t):A_(e,t,r,n)),P_=Hb(k_,(e,t)=>t.xmlMode||t._useHtmlParser2?Aa(e,t):S_(e));P_([]);var mu={},w_={get exports(){return mu},set exports(e){mu=e}};(function(e,t){typeof window<"u"&&function(r,n){e.exports=n()}(ev,()=>(()=>{var r={21:(E,A,y)=>{y.r(A),y.d(A,{default:()=>oe});var _=function(){function z(ee,le){this.subtle=void 0,this.aesIV=void 0,this.subtle=ee,this.aesIV=le}return z.prototype.decrypt=function(ee,le){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},le,ee)},z}(),I=function(){function z(ee,le){this.subtle=void 0,this.key=void 0,this.subtle=ee,this.key=le}return z.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},z}(),C=y(145),b=function(){function z(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var ee=z.prototype;return ee.uint8ArrayToUint32Array_=function(le){for(var $=new DataView(le),fe=new Uint32Array(4),ue=0;ue<4;ue++)fe[ue]=$.getUint32(4*ue);return fe},ee.initTable=function(){var le=this.sBox,$=this.invSBox,fe=this.subMix,ue=fe[0],se=fe[1],re=fe[2],Ne=fe[3],Pe=this.invSubMix,Ze=Pe[0],ce=Pe[1],P=Pe[2],Q=Pe[3],U=new Uint32Array(256),pe=0,Le=0,ve=0;for(ve=0;ve<256;ve++)U[ve]=ve<128?ve<<1:ve<<1^283;for(ve=0;ve<256;ve++){var Ee=Le^Le<<1^Le<<2^Le<<3^Le<<4;Ee=Ee>>>8^255&Ee^99,le[pe]=Ee,$[Ee]=pe;var We=U[pe],Je=U[We],$e=U[Je],je=257*U[Ee]^16843008*Ee;ue[pe]=je<<24|je>>>8,se[pe]=je<<16|je>>>16,re[pe]=je<<8|je>>>24,Ne[pe]=je,je=16843009*$e^65537*Je^257*We^16843008*pe,Ze[Ee]=je<<24|je>>>8,ce[Ee]=je<<16|je>>>16,P[Ee]=je<<8|je>>>24,Q[Ee]=je,pe?(pe=We^U[U[U[$e^We]]],Le^=U[U[Le]]):pe=Le=1}},ee.expandKey=function(le){for(var $=this.uint8ArrayToUint32Array_(le),fe=!0,ue=0;ue<$.length&&fe;)fe=$[ue]===this.key[ue],ue++;if(!fe){this.key=$;var se=this.keySize=$.length;if(se!==4&&se!==6&&se!==8)throw new Error("Invalid aes key size="+se);var re,Ne,Pe,Ze,ce=this.ksRows=4*(se+6+1),P=this.keySchedule=new Uint32Array(ce),Q=this.invKeySchedule=new Uint32Array(ce),U=this.sBox,pe=this.rcon,Le=this.invSubMix,ve=Le[0],Ee=Le[1],We=Le[2],Je=Le[3];for(re=0;re<ce;re++)re<se?Pe=P[re]=$[re]:(Ze=Pe,re%se==0?(Ze=U[(Ze=Ze<<8|Ze>>>24)>>>24]<<24|U[Ze>>>16&255]<<16|U[Ze>>>8&255]<<8|U[255&Ze],Ze^=pe[re/se|0]<<24):se>6&&re%se==4&&(Ze=U[Ze>>>24]<<24|U[Ze>>>16&255]<<16|U[Ze>>>8&255]<<8|U[255&Ze]),P[re]=Pe=(P[re-se]^Ze)>>>0);for(Ne=0;Ne<ce;Ne++)re=ce-Ne,Ze=3&Ne?P[re]:P[re-4],Q[Ne]=Ne<4||re<=4?Ze:ve[U[Ze>>>24]]^Ee[U[Ze>>>16&255]]^We[U[Ze>>>8&255]]^Je[U[255&Ze]],Q[Ne]=Q[Ne]>>>0}},ee.networkToHostOrderSwap=function(le){return le<<24|(65280&le)<<8|(16711680&le)>>8|le>>>24},ee.decrypt=function(le,$,fe){for(var ue,se,re,Ne,Pe,Ze,ce,P,Q,U,pe,Le,ve,Ee,We=this.keySize+6,Je=this.invKeySchedule,$e=this.invSBox,je=this.invSubMix,ct=je[0],_t=je[1],B=je[2],J=je[3],q=this.uint8ArrayToUint32Array_(fe),ge=q[0],Ae=q[1],ke=q[2],Ie=q[3],N=new Int32Array(le),x=new Int32Array(N.length),j=this.networkToHostOrderSwap;$<N.length;){for(Q=j(N[$]),U=j(N[$+1]),pe=j(N[$+2]),Le=j(N[$+3]),Pe=Q^Je[0],Ze=Le^Je[1],ce=pe^Je[2],P=U^Je[3],ve=4,Ee=1;Ee<We;Ee++)ue=ct[Pe>>>24]^_t[Ze>>16&255]^B[ce>>8&255]^J[255&P]^Je[ve],se=ct[Ze>>>24]^_t[ce>>16&255]^B[P>>8&255]^J[255&Pe]^Je[ve+1],re=ct[ce>>>24]^_t[P>>16&255]^B[Pe>>8&255]^J[255&Ze]^Je[ve+2],Ne=ct[P>>>24]^_t[Pe>>16&255]^B[Ze>>8&255]^J[255&ce]^Je[ve+3],Pe=ue,Ze=se,ce=re,P=Ne,ve+=4;ue=$e[Pe>>>24]<<24^$e[Ze>>16&255]<<16^$e[ce>>8&255]<<8^$e[255&P]^Je[ve],se=$e[Ze>>>24]<<24^$e[ce>>16&255]<<16^$e[P>>8&255]<<8^$e[255&Pe]^Je[ve+1],re=$e[ce>>>24]<<24^$e[P>>16&255]<<16^$e[Pe>>8&255]<<8^$e[255&Ze]^Je[ve+2],Ne=$e[P>>>24]<<24^$e[Pe>>16&255]<<16^$e[Ze>>8&255]<<8^$e[255&ce]^Je[ve+3],x[$]=j(ue^ge),x[$+1]=j(Ne^Ae),x[$+2]=j(re^ke),x[$+3]=j(se^Ie),ge=Q,Ae=U,ke=pe,Ie=Le,$+=4}return x.buffer},z}(),L=y(93),O=y(63),oe=function(){function z(le,$){var fe=($===void 0?{}:$).removePKCS7Padding,ue=fe===void 0||fe;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=le.enableSoftwareAES,this.removePKCS7Padding=ue,ue)try{var se=self.crypto;se&&(this.subtle=se.subtle||se.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}var ee=z.prototype;return ee.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},ee.isSync=function(){return this.useSoftware},ee.flush=function(){var le=this.currentResult,$=this.remainderData;if(!le||$)return L.logger.error("[softwareDecrypt] "+($?"overflow bytes: "+$.byteLength:"no result")),this.reset(),null;var fe,ue,se,re=new Uint8Array(le);return this.reset(),this.removePKCS7Padding?(se=(ue=(fe=re).byteLength)&&new DataView(fe.buffer).getUint8(ue-1))?(0,C.sliceUint8)(fe,0,ue-se):fe:re},ee.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},ee.decrypt=function(le,$,fe){var ue=this;return this.useSoftware?new Promise(function(se,re){ue.softwareDecrypt(new Uint8Array(le),$,fe);var Ne=ue.flush();Ne?se(Ne.buffer):re(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(le),$,fe)},ee.softwareDecrypt=function(le,$,fe){var ue=this.currentIV,se=this.currentResult,re=this.remainderData;this.logOnce("JS AES decrypt"),re&&(le=(0,O.appendUint8Array)(re,le),this.remainderData=null);var Ne=this.getValidChunk(le);if(!Ne.length)return null;ue&&(fe=ue);var Pe=this.softwareDecrypter;Pe||(Pe=this.softwareDecrypter=new b),Pe.expandKey($);var Ze=se;return this.currentResult=Pe.decrypt(Ne.buffer,0,fe),this.currentIV=(0,C.sliceUint8)(Ne,-16).buffer,Ze||null},ee.webCryptoDecrypt=function(le,$,fe){var ue=this,se=this.subtle;return this.key===$&&this.fastAesKey||(this.key=$,this.fastAesKey=new I(se,$)),this.fastAesKey.expandKey().then(function(re){return se?(ue.logOnce("WebCrypto AES decrypt"),new _(se,new Uint8Array(fe)).decrypt(le.buffer,re)):Promise.reject(new Error("web crypto not initialized"))}).catch(function(re){return L.logger.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+re.name+": "+re.message),ue.onWebCryptoError(le,$,fe)})},ee.onWebCryptoError=function(le,$,fe){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(le,$,fe);var ue=this.flush();if(ue)return ue.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},ee.getValidChunk=function(le){var $=le,fe=le.length-le.length%16;return fe!==le.length&&($=(0,C.sliceUint8)(le,0,fe),this.remainderData=(0,C.sliceUint8)(le,fe)),$},ee.logOnce=function(le){this.logEnabled&&(L.logger.log("[decrypter]: "+le),this.logEnabled=!1)},z}()},181:(E,A,y)=>{y.r(A),y.d(A,{canParse:()=>O,decodeFrame:()=>$,getID3Data:()=>b,getID3Frames:()=>le,getTimeStamp:()=>oe,isFooter:()=>C,isHeader:()=>I,isTimeStampFrame:()=>z,testables:()=>Pe,utf8ArrayToStr:()=>Ne});var _,I=function(ce,P){return P+10<=ce.length&&ce[P]===73&&ce[P+1]===68&&ce[P+2]===51&&ce[P+3]<255&&ce[P+4]<255&&ce[P+6]<128&&ce[P+7]<128&&ce[P+8]<128&&ce[P+9]<128},C=function(ce,P){return P+10<=ce.length&&ce[P]===51&&ce[P+1]===68&&ce[P+2]===73&&ce[P+3]<255&&ce[P+4]<255&&ce[P+6]<128&&ce[P+7]<128&&ce[P+8]<128&&ce[P+9]<128},b=function(ce,P){for(var Q=P,U=0;I(ce,P);)U+=10,U+=L(ce,P+6),C(ce,P+10)&&(U+=10),P+=U;if(U>0)return ce.subarray(Q,Q+U)},L=function(ce,P){var Q=0;return Q=(127&ce[P])<<21,Q|=(127&ce[P+1])<<14,(Q|=(127&ce[P+2])<<7)|127&ce[P+3]},O=function(ce,P){return I(ce,P)&&L(ce,P+6)+10<=ce.length-P},oe=function(ce){for(var P=le(ce),Q=0;Q<P.length;Q++){var U=P[Q];if(z(U))return re(U)}},z=function(ce){return ce&&ce.key==="PRIV"&&ce.info==="com.apple.streaming.transportStreamTimestamp"},ee=function(ce){var P=String.fromCharCode(ce[0],ce[1],ce[2],ce[3]),Q=L(ce,4);return{type:P,size:Q,data:ce.subarray(10,10+Q)}},le=function(ce){for(var P=0,Q=[];I(ce,P);){for(var U=L(ce,P+6),pe=(P+=10)+U;P+8<pe;){var Le=ee(ce.subarray(P)),ve=$(Le);ve&&Q.push(ve),P+=Le.size+10}C(ce,P)&&(P+=10)}return Q},$=function(ce){return ce.type==="PRIV"?fe(ce):ce.type[0]==="W"?se(ce):ue(ce)},fe=function(ce){if(!(ce.size<2)){var P=Ne(ce.data,!0),Q=new Uint8Array(ce.data.subarray(P.length+1));return{key:ce.type,info:P,data:Q.buffer}}},ue=function(ce){if(!(ce.size<2)){if(ce.type==="TXXX"){var P=1,Q=Ne(ce.data.subarray(P),!0);P+=Q.length+1;var U=Ne(ce.data.subarray(P));return{key:ce.type,info:Q,data:U}}var pe=Ne(ce.data.subarray(1));return{key:ce.type,data:pe}}},se=function(ce){if(ce.type==="WXXX"){if(ce.size<2)return;var P=1,Q=Ne(ce.data.subarray(P),!0);P+=Q.length+1;var U=Ne(ce.data.subarray(P));return{key:ce.type,info:Q,data:U}}var pe=Ne(ce.data);return{key:ce.type,data:pe}},re=function(ce){if(ce.data.byteLength===8){var P=new Uint8Array(ce.data),Q=1&P[3],U=(P[4]<<23)+(P[5]<<15)+(P[6]<<7)+P[7];return U/=45,Q&&(U+=4772185884e-2),Math.round(U)}},Ne=function(ce,P){P===void 0&&(P=!1);var Q=Ze();if(Q){var U=Q.decode(ce);if(P){var pe=U.indexOf("\0");return pe!==-1?U.substring(0,pe):U}return U.replace(/\0/g,"")}for(var Le,ve,Ee,We=ce.length,Je="",$e=0;$e<We;){if((Le=ce[$e++])===0&&P)return Je;if(Le!==0&&Le!==3)switch(Le>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:Je+=String.fromCharCode(Le);break;case 12:case 13:ve=ce[$e++],Je+=String.fromCharCode((31&Le)<<6|63&ve);break;case 14:ve=ce[$e++],Ee=ce[$e++],Je+=String.fromCharCode((15&Le)<<12|(63&ve)<<6|(63&Ee)<<0)}}return Je},Pe={decodeTextFrame:ue};function Ze(){return _||self.TextDecoder===void 0||(_=new self.TextDecoder("utf-8")),_}},182:(E,A,y)=>{y.r(A),y.d(A,{default:()=>O});var _=y(544),I=y(851),C=y(93),b=y(729),L=y(973);function O(le){var $=new b.EventEmitter,fe=function(ue,se){le.postMessage({event:ue,data:se})};$.on(I.Events.FRAG_DECRYPTED,fe),$.on(I.Events.ERROR,fe),le.addEventListener("message",function(ue){var se=ue.data;switch(se.cmd){case"init":var re=JSON.parse(se.config);le.transmuxer=new _.default($,se.typeSupported,re,se.vendor,se.id),(0,C.enableLogs)(re.debug,se.id),function(){var ce=function(Q){C.logger[Q]=function(U){fe("workerLog",{logType:Q,message:U})}};for(var P in C.logger)ce(P)}(),fe("init",null);break;case"configure":le.transmuxer.configure(se.config);break;case"demux":var Ne=le.transmuxer.push(se.data,se.decryptdata,se.chunkMeta,se.state);(0,_.isPromise)(Ne)?(le.transmuxer.async=!0,Ne.then(function(ce){oe(le,ce)}).catch(function(ce){fe(I.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:se.chunkMeta,fatal:!1,error:ce,err:ce,reason:"transmuxer-worker push error"})})):(le.transmuxer.async=!1,oe(le,Ne));break;case"flush":var Pe=se.chunkMeta,Ze=le.transmuxer.flush(Pe);(0,_.isPromise)(Ze)||le.transmuxer.async?((0,_.isPromise)(Ze)||(Ze=Promise.resolve(Ze)),Ze.then(function(ce){ee(le,ce,Pe)}).catch(function(ce){fe(I.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:se.chunkMeta,fatal:!1,error:ce,err:ce,reason:"transmuxer-worker flush error"})})):ee(le,Ze,Pe)}})}function oe(le,$){if(!((fe=$.remuxResult).audio||fe.video||fe.text||fe.id3||fe.initSegment))return!1;var fe,ue=[],se=$.remuxResult,re=se.audio,Ne=se.video;return re&&z(ue,re),Ne&&z(ue,Ne),le.postMessage({event:"transmuxComplete",data:$},ue),!0}function z(le,$){$.data1&&le.push($.data1.buffer),$.data2&&le.push($.data2.buffer)}function ee(le,$,fe){$.reduce(function(ue,se){return oe(le,se)||ue},!1)||le.postMessage({event:"transmuxComplete",data:$[0]}),le.postMessage({event:"flush",data:fe})}},544:(E,A,y)=>{y.r(A),y.d(A,{TransmuxConfig:()=>Tt,TransmuxState:()=>Bt,default:()=>nt,isPromise:()=>ft});var _=y(851),I=y(973),C=y(21),b=y(965),L=y(181),O=y(856);function oe(ne,W){return ne===void 0&&(ne=""),W===void 0&&(W=9e4),{type:ne,id:-1,pid:-1,inputTimeScale:W,sequenceNumber:-1,samples:[],dropped:0}}var z=y(63),ee=y(145),le=function(){function ne(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var W=ne.prototype;return W.resetInitSegment=function(D,G,H,X){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},W.resetTimeStamp=function(D){this.initPTS=D,this.resetContiguity()},W.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},W.canParse=function(D,G){return!1},W.appendFrame=function(D,G,H){},W.demux=function(D,G){this.cachedData&&(D=(0,z.appendUint8Array)(this.cachedData,D),this.cachedData=null);var H,X=L.getID3Data(D,0),te=X?X.length:0,ae=this._audioTrack,ye=this._id3Track,xe=X?L.getTimeStamp(X):void 0,Me=D.length;for((this.basePTS===null||this.frameIndex===0&&(0,b.isFiniteNumber)(xe))&&(this.basePTS=$(xe,G,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),X&&X.length>0&&ye.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:X,type:O.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});te<Me;){if(this.canParse(D,te)){var Ke=this.appendFrame(ae,D,te);Ke?(this.frameIndex++,this.lastPTS=Ke.sample.pts,H=te+=Ke.length):te=Me}else L.canParse(D,te)?(X=L.getID3Data(D,te),ye.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:X,type:O.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),H=te+=X.length):te++;if(te===Me&&H!==Me){var tt=(0,ee.sliceUint8)(D,H);this.cachedData?this.cachedData=(0,z.appendUint8Array)(this.cachedData,tt):this.cachedData=tt}}return{audioTrack:ae,videoTrack:oe(),id3Track:ye,textTrack:oe()}},W.demuxSampleAes=function(D,G,H){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},W.flush=function(D){var G=this.cachedData;return G&&(this.cachedData=null,this.demux(G,0)),{audioTrack:this._audioTrack,videoTrack:oe(),id3Track:this._id3Track,textTrack:oe()}},W.destroy=function(){},ne}(),$=function(ne,W,D){return(0,b.isFiniteNumber)(ne)?90*ne:9e4*W+(D||0)};const fe=le;var ue=y(93);function se(ne,W){return ne[W]===255&&(246&ne[W+1])==240}function re(ne,W){return 1&ne[W+1]?7:9}function Ne(ne,W){return(3&ne[W+3])<<11|ne[W+4]<<3|(224&ne[W+5])>>>5}function Pe(ne,W){return W+1<ne.length&&se(ne,W)}function Ze(ne,W){if(Pe(ne,W)){var D=re(ne,W);if(W+D>=ne.length)return!1;var G=Ne(ne,W);if(G<=D)return!1;var H=W+G;return H===ne.length||Pe(ne,H)}return!1}function ce(ne,W,D,G,H){if(!ne.samplerate){var X=function(te,ae,ye,xe){var Me,Ke,tt,qe,at=navigator.userAgent.toLowerCase(),mt=xe,Lt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Me=1+((192&ae[ye+2])>>>6);var it=(60&ae[ye+2])>>>2;if(!(it>Lt.length-1))return tt=(1&ae[ye+2])<<2,tt|=(192&ae[ye+3])>>>6,ue.logger.log("manifest codec:"+xe+", ADTS type:"+Me+", samplingIndex:"+it),/firefox/i.test(at)?it>=6?(Me=5,qe=new Array(4),Ke=it-3):(Me=2,qe=new Array(2),Ke=it):at.indexOf("android")!==-1?(Me=2,qe=new Array(2),Ke=it):(Me=5,qe=new Array(4),xe&&(xe.indexOf("mp4a.40.29")!==-1||xe.indexOf("mp4a.40.5")!==-1)||!xe&&it>=6?Ke=it-3:((xe&&xe.indexOf("mp4a.40.2")!==-1&&(it>=6&&tt===1||/vivaldi/i.test(at))||!xe&&tt===1)&&(Me=2,qe=new Array(2)),Ke=it)),qe[0]=Me<<3,qe[0]|=(14&it)>>1,qe[1]|=(1&it)<<7,qe[1]|=tt<<3,Me===5&&(qe[1]|=(14&Ke)>>1,qe[2]=(1&Ke)<<7,qe[2]|=8,qe[3]=0),{config:qe,samplerate:Lt[it],channelCount:tt,codec:"mp4a.40."+Me,manifestCodec:mt};te.trigger(_.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+it})}(W,D,G,H);if(!X)return;ne.config=X.config,ne.samplerate=X.samplerate,ne.channelCount=X.channelCount,ne.codec=X.codec,ne.manifestCodec=X.manifestCodec,ue.logger.log("parsed codec:"+ne.codec+", rate:"+X.samplerate+", channels:"+X.channelCount)}}function P(ne){return 9216e4/ne}function Q(ne,W,D,G,H){var X,te=G+H*P(ne.samplerate),ae=function(at,mt){var Lt=re(at,mt);if(mt+Lt<=at.length){var it=Ne(at,mt)-Lt;if(it>0)return{headerLength:Lt,frameLength:it}}}(W,D);if(ae){var ye=ae.frameLength,xe=ae.headerLength,Me=xe+ye,Ke=Math.max(0,D+Me-W.length);Ke?(X=new Uint8Array(Me-xe)).set(W.subarray(D+xe,W.length),0):X=W.subarray(D+xe,D+Me);var tt={unit:X,pts:te};return Ke||ne.samples.push(tt),{sample:tt,length:Me,missing:Ke}}var qe=W.length-D;return(X=new Uint8Array(qe)).set(W.subarray(D,W.length),0),{sample:{unit:X,pts:te},length:qe,missing:-1}}function U(ne,W){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,G){return D.__proto__=G,D},U(ne,W)}const pe=function(ne){var W,D;function G(X,te){var ae;return(ae=ne.call(this)||this).observer=void 0,ae.config=void 0,ae.observer=X,ae.config=te,ae}D=ne,(W=G).prototype=Object.create(D.prototype),W.prototype.constructor=W,U(W,D);var H=G.prototype;return H.resetInitSegment=function(X,te,ae,ye){ne.prototype.resetInitSegment.call(this,X,te,ae,ye),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:te,duration:ye,inputTimeScale:9e4,dropped:0}},G.probe=function(X){if(!X)return!1;for(var te=(L.getID3Data(X,0)||[]).length,ae=X.length;te<ae;te++)if(Ze(X,te))return ue.logger.log("ADTS sync word found !"),!0;return!1},H.canParse=function(X,te){return function(ae,ye){return function(xe,Me){return Me+5<xe.length}(ae,ye)&&se(ae,ye)&&Ne(ae,ye)<=ae.length-ye}(X,te)},H.appendFrame=function(X,te,ae){ce(X,this.observer,te,ae,X.manifestCodec);var ye=Q(X,te,ae,this.basePTS,this.frameIndex);if(ye&&ye.missing===0)return ye},G}(fe);var Le=/\/emsg[-/]ID3/i;const ve=function(){function ne(D,G){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=G}var W=ne.prototype;return W.resetTimeStamp=function(){},W.resetInitSegment=function(D,G,H,X){var te=this.videoTrack=oe("video",1),ae=this.audioTrack=oe("audio",1),ye=this.txtTrack=oe("text",1);if(this.id3Track=oe("id3",1),this.timeOffset=0,D&&D.byteLength){var xe=(0,z.parseInitSegment)(D);if(xe.video){var Me=xe.video,Ke=Me.id,tt=Me.timescale,qe=Me.codec;te.id=Ke,te.timescale=ye.timescale=tt,te.codec=qe}if(xe.audio){var at=xe.audio,mt=at.id,Lt=at.timescale,it=at.codec;ae.id=mt,ae.timescale=Lt,ae.codec=it}ye.id=z.RemuxerTrackIdConfig.text,te.sampleDuration=0,te.duration=ae.duration=X}},W.resetContiguity=function(){},ne.probe=function(D){return D=D.length>16384?D.subarray(0,16384):D,(0,z.findBox)(D,["moof"]).length>0},W.demux=function(D,G){this.timeOffset=G;var H=D,X=this.videoTrack,te=this.txtTrack;if(this.config.progressive){this.remainderData&&(H=(0,z.appendUint8Array)(this.remainderData,D));var ae=(0,z.segmentValidRange)(H);this.remainderData=ae.remainder,X.samples=ae.valid||new Uint8Array}else X.samples=H;var ye=this.extractID3Track(X,G);return te.samples=(0,z.parseSamples)(G,X),{videoTrack:X,audioTrack:this.audioTrack,id3Track:ye,textTrack:this.txtTrack}},W.flush=function(){var D=this.timeOffset,G=this.videoTrack,H=this.txtTrack;G.samples=this.remainderData||new Uint8Array,this.remainderData=null;var X=this.extractID3Track(G,this.timeOffset);return H.samples=(0,z.parseSamples)(D,G),{videoTrack:G,audioTrack:oe(),id3Track:X,textTrack:oe()}},W.extractID3Track=function(D,G){var H=this.id3Track;if(D.samples.length){var X=(0,z.findBox)(D.samples,["emsg"]);X&&X.forEach(function(te){var ae=(0,z.parseEmsg)(te);if(Le.test(ae.schemeIdUri)){var ye=(0,b.isFiniteNumber)(ae.presentationTime)?ae.presentationTime/ae.timeScale:G+ae.presentationTimeDelta/ae.timeScale,xe=ae.eventDuration===4294967295?Number.POSITIVE_INFINITY:ae.eventDuration/ae.timeScale;xe<=.001&&(xe=Number.POSITIVE_INFINITY);var Me=ae.payload;H.samples.push({data:Me,len:Me.byteLength,dts:ye,pts:ye,type:O.MetadataSchema.emsg,duration:xe})}})}return H},W.demuxSampleAes=function(D,G,H){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},W.destroy=function(){},ne}();var Ee=null,We=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Je=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],$e=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],je=[0,1,1,4];function ct(ne,W,D,G,H){if(!(D+24>W.length)){var X=_t(W,D);if(X&&D+X.frameLength<=W.length){var te=G+H*(9e4*X.samplesPerFrame/X.sampleRate),ae={unit:W.subarray(D,D+X.frameLength),pts:te,dts:te};return ne.config=[],ne.channelCount=X.channelCount,ne.samplerate=X.sampleRate,ne.samples.push(ae),{sample:ae,length:X.frameLength,missing:0}}}}function _t(ne,W){var D=ne[W+1]>>3&3,G=ne[W+1]>>1&3,H=ne[W+2]>>4&15,X=ne[W+2]>>2&3;if(D!==1&&H!==0&&H!==15&&X!==3){var te=ne[W+2]>>1&1,ae=ne[W+3]>>6,ye=1e3*We[14*(D===3?3-G:G===3?3:4)+H-1],xe=Je[3*(D===3?0:D===2?1:2)+X],Me=ae===3?1:2,Ke=$e[D][G],tt=je[G],qe=8*Ke*tt,at=Math.floor(Ke*ye/xe+te)*tt;if(Ee===null){var mt=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ee=mt?parseInt(mt[1]):0}return Ee&&Ee<=87&&G===2&&ye>=224e3&&ae===0&&(ne[W+3]=128|ne[W+3]),{sampleRate:xe,channelCount:Me,frameLength:at,samplesPerFrame:qe}}}function B(ne,W){return ne[W]===255&&(224&ne[W+1])==224&&(6&ne[W+1])!=0}function J(ne,W){return W+1<ne.length&&B(ne,W)}function q(ne,W){if(W+1<ne.length&&B(ne,W)){var D=_t(ne,W),G=4;D!=null&&D.frameLength&&(G=D.frameLength);var H=W+G;return H===ne.length||J(ne,H)}return!1}const ge=function(){function ne(D){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=D,this.bytesAvailable=D.byteLength,this.word=0,this.bitsAvailable=0}var W=ne.prototype;return W.loadWord=function(){var D=this.data,G=this.bytesAvailable,H=D.byteLength-G,X=new Uint8Array(4),te=Math.min(4,G);if(te===0)throw new Error("no bytes available");X.set(D.subarray(H,H+te)),this.word=new DataView(X.buffer).getUint32(0),this.bitsAvailable=8*te,this.bytesAvailable-=te},W.skipBits=function(D){var G;D=Math.min(D,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>D?(this.word<<=D,this.bitsAvailable-=D):(D-=this.bitsAvailable,D-=(G=D>>3)<<3,this.bytesAvailable-=G,this.loadWord(),this.word<<=D,this.bitsAvailable-=D)},W.readBits=function(D){var G=Math.min(this.bitsAvailable,D),H=this.word>>>32-G;if(D>32&&ue.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=G,this.bitsAvailable>0)this.word<<=G;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(G=D-G)>0&&this.bitsAvailable?H<<G|this.readBits(G):H},W.skipLZ=function(){var D;for(D=0;D<this.bitsAvailable;++D)if(this.word&2147483648>>>D)return this.word<<=D,this.bitsAvailable-=D,D;return this.loadWord(),D+this.skipLZ()},W.skipUEG=function(){this.skipBits(1+this.skipLZ())},W.skipEG=function(){this.skipBits(1+this.skipLZ())},W.readUEG=function(){var D=this.skipLZ();return this.readBits(D+1)-1},W.readEG=function(){var D=this.readUEG();return 1&D?1+D>>>1:-1*(D>>>1)},W.readBoolean=function(){return this.readBits(1)===1},W.readUByte=function(){return this.readBits(8)},W.readUShort=function(){return this.readBits(16)},W.readUInt=function(){return this.readBits(32)},W.skipScalingList=function(D){for(var G=8,H=8,X=0;X<D;X++)H!==0&&(H=(G+this.readEG()+256)%256),G=H===0?G:H},W.readSPS=function(){var D,G,H,X=0,te=0,ae=0,ye=0,xe=this.readUByte.bind(this),Me=this.readBits.bind(this),Ke=this.readUEG.bind(this),tt=this.readBoolean.bind(this),qe=this.skipBits.bind(this),at=this.skipEG.bind(this),mt=this.skipUEG.bind(this),Lt=this.skipScalingList.bind(this);xe();var it=xe();if(Me(5),qe(3),xe(),mt(),it===100||it===110||it===122||it===244||it===44||it===83||it===86||it===118||it===128){var Ot=Ke();if(Ot===3&&qe(1),mt(),mt(),qe(1),tt())for(G=Ot!==3?8:12,H=0;H<G;H++)tt()&&Lt(H<6?16:64)}mt();var tr=Ke();if(tr===0)Ke();else if(tr===1)for(qe(1),at(),at(),D=Ke(),H=0;H<D;H++)at();mt(),qe(1);var jt=Ke(),Ft=Ke(),Wt=Me(1);Wt===0&&qe(1),qe(1),tt()&&(X=Ke(),te=Ke(),ae=Ke(),ye=Ke());var ot=[1,1];if(tt()&&tt())switch(xe()){case 1:ot=[1,1];break;case 2:ot=[12,11];break;case 3:ot=[10,11];break;case 4:ot=[16,11];break;case 5:ot=[40,33];break;case 6:ot=[24,11];break;case 7:ot=[20,11];break;case 8:ot=[32,11];break;case 9:ot=[80,33];break;case 10:ot=[18,11];break;case 11:ot=[15,11];break;case 12:ot=[64,33];break;case 13:ot=[160,99];break;case 14:ot=[4,3];break;case 15:ot=[3,2];break;case 16:ot=[2,1];break;case 255:ot=[xe()<<8|xe(),xe()<<8|xe()]}return{width:Math.ceil(16*(jt+1)-2*X-2*te),height:(2-Wt)*(Ft+1)*16-(Wt?2:4)*(ae+ye),pixelRatio:ot}},W.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},ne}(),Ae=function(){function ne(D,G,H){this.keyData=void 0,this.decrypter=void 0,this.keyData=H,this.decrypter=new C.default(G,{removePKCS7Padding:!1})}var W=ne.prototype;return W.decryptBuffer=function(D){return this.decrypter.decrypt(D,this.keyData.key.buffer,this.keyData.iv.buffer)},W.decryptAacSample=function(D,G,H){var X=this,te=D[G].unit;if(!(te.length<=16)){var ae=te.subarray(16,te.length-te.length%16),ye=ae.buffer.slice(ae.byteOffset,ae.byteOffset+ae.length);this.decryptBuffer(ye).then(function(xe){var Me=new Uint8Array(xe);te.set(Me,16),X.decrypter.isSync()||X.decryptAacSamples(D,G+1,H)})}},W.decryptAacSamples=function(D,G,H){for(;;G++){if(G>=D.length)return void H();if(!(D[G].unit.length<32||(this.decryptAacSample(D,G,H),this.decrypter.isSync())))return}},W.getAvcEncryptedData=function(D){for(var G=16*Math.floor((D.length-48)/160)+16,H=new Int8Array(G),X=0,te=32;te<D.length-16;te+=160,X+=16)H.set(D.subarray(te,te+16),X);return H},W.getAvcDecryptedUnit=function(D,G){for(var H=new Uint8Array(G),X=0,te=32;te<D.length-16;te+=160,X+=16)D.set(H.subarray(X,X+16),te);return D},W.decryptAvcSample=function(D,G,H,X,te){var ae=this,ye=(0,z.discardEPB)(te.data),xe=this.getAvcEncryptedData(ye);this.decryptBuffer(xe.buffer).then(function(Me){te.data=ae.getAvcDecryptedUnit(ye,Me),ae.decrypter.isSync()||ae.decryptAvcSamples(D,G,H+1,X)})},W.decryptAvcSamples=function(D,G,H,X){if(D instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;G++,H=0){if(G>=D.length)return void X();for(var te=D[G].units;!(H>=te.length);H++){var ae=te[H];if(!(ae.data.length<=48||ae.type!==1&&ae.type!==5||(this.decryptAvcSample(D,G,H,X,ae),this.decrypter.isSync())))return}}},ne}();function ke(){return ke=Object.assign?Object.assign.bind():function(ne){for(var W=1;W<arguments.length;W++){var D=arguments[W];for(var G in D)Object.prototype.hasOwnProperty.call(D,G)&&(ne[G]=D[G])}return ne},ke.apply(this,arguments)}var Ie=188;function N(ne,W,D,G){return{key:ne,frame:!1,pts:W,dts:D,units:[],debug:G,length:0}}function x(ne,W){return(31&ne[W+10])<<8|ne[W+11]}function j(ne,W,D,G){var H={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},X=W+3+((15&ne[W+1])<<8|ne[W+2])-4;for(W+=12+((15&ne[W+10])<<8|ne[W+11]);W<X;){var te=(31&ne[W+1])<<8|ne[W+2];switch(ne[W]){case 207:if(!G){ue.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:H.audio===-1&&(H.audio=te);break;case 21:H.id3===-1&&(H.id3=te);break;case 219:if(!G){ue.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:H.avc===-1&&(H.avc=te);break;case 3:case 4:D.mpeg!==!0&&D.mp3!==!0?ue.logger.log("MPEG audio found, not supported in this browser"):H.audio===-1&&(H.audio=te,H.segmentCodec="mp3");break;case 36:ue.logger.warn("Unsupported HEVC stream type found")}W+=5+((15&ne[W+3])<<8|ne[W+4])}return H}function ie(ne){var W,D,G,H,X,te=0,ae=ne.data;if(!ne||ne.size===0)return null;for(;ae[0].length<19&&ae.length>1;){var ye=new Uint8Array(ae[0].length+ae[1].length);ye.set(ae[0]),ye.set(ae[1],ae[0].length),ae[0]=ye,ae.splice(1,1)}if(((W=ae[0])[0]<<16)+(W[1]<<8)+W[2]===1){if((D=(W[4]<<8)+W[5])&&D>ne.size-6)return null;var xe=W[7];192&xe&&(H=536870912*(14&W[9])+4194304*(255&W[10])+16384*(254&W[11])+128*(255&W[12])+(254&W[13])/2,64&xe?H-(X=536870912*(14&W[14])+4194304*(255&W[15])+16384*(254&W[16])+128*(255&W[17])+(254&W[18])/2)>54e5&&(ue.logger.warn(Math.round((H-X)/9e4)+"s delta between PTS and DTS, align them"),H=X):X=H);var Me=(G=W[8])+9;if(ne.size<=Me)return null;ne.size-=Me;for(var Ke=new Uint8Array(ne.size),tt=0,qe=ae.length;tt<qe;tt++){var at=(W=ae[tt]).byteLength;if(Me){if(Me>at){Me-=at;continue}W=W.subarray(Me),at-=Me,Me=0}Ke.set(W,te),te+=at}return D&&(D-=G+3),{data:Ke,pts:H,dts:X,len:D}}return null}function me(ne,W){if(ne.units.length&&ne.frame){if(ne.pts===void 0){var D=W.samples,G=D.length;if(!G)return void W.dropped++;var H=D[G-1];ne.pts=H.pts,ne.dts=H.dts}W.samples.push(ne)}ne.debug.length&&ue.logger.log(ne.pts+"/"+ne.dts+":"+ne.debug)}const Oe=function(){function ne(D,G,H){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=D,this.config=G,this.typeSupported=H}ne.probe=function(D){var G=ne.syncOffset(D);return G>0&&ue.logger.warn("MPEG2-TS detected but first sync word found @ offset "+G),G!==-1},ne.syncOffset=function(D){for(var G=Math.min(940,D.length-376)+1,H=0;H<G;){if(D[H]===71&&D[H+Ie]===71)return H;H++}return-1},ne.createTrack=function(D,G){return{container:D==="video"||D==="audio"?"video/mp2t":void 0,type:D,id:z.RemuxerTrackIdConfig[D],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:D==="audio"?G:void 0}};var W=ne.prototype;return W.resetInitSegment=function(D,G,H,X){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=ne.createTrack("video"),this._audioTrack=ne.createTrack("audio",X),this._id3Track=ne.createTrack("id3"),this._txtTrack=ne.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=G,this.videoCodec=H,this._duration=X},W.resetTimeStamp=function(){},W.resetContiguity=function(){var D=this._audioTrack,G=this._avcTrack,H=this._id3Track;D&&(D.pesData=null),G&&(G.pesData=null),H&&(H.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},W.demux=function(D,G,H,X){var te;H===void 0&&(H=!1),X===void 0&&(X=!1),H||(this.sampleAes=null);var ae=this._avcTrack,ye=this._audioTrack,xe=this._id3Track,Me=this._txtTrack,Ke=ae.pid,tt=ae.pesData,qe=ye.pid,at=xe.pid,mt=ye.pesData,Lt=xe.pesData,it=null,Ot=this.pmtParsed,tr=this._pmtId,jt=D.length;if(this.remainderData&&(jt=(D=(0,z.appendUint8Array)(this.remainderData,D)).length,this.remainderData=null),jt<Ie&&!X)return this.remainderData=D,{audioTrack:ye,videoTrack:ae,id3Track:xe,textTrack:Me};var Ft=Math.max(0,ne.syncOffset(D));(jt-=(jt-Ft)%Ie)<D.byteLength&&!X&&(this.remainderData=new Uint8Array(D.buffer,jt,D.buffer.byteLength-jt));for(var Wt=0,ot=Ft;ot<jt;ot+=Ie)if(D[ot]===71){var cr=!!(64&D[ot+1]),$r=((31&D[ot+1])<<8)+D[ot+2],Vt=void 0;if((48&D[ot+3])>>4>1){if((Vt=ot+5+D[ot+4])===ot+Ie)continue}else Vt=ot+4;switch($r){case Ke:cr&&(tt&&(te=ie(tt))&&this.parseAVCPES(ae,Me,te,!1),tt={data:[],size:0}),tt&&(tt.data.push(D.subarray(Vt,ot+Ie)),tt.size+=ot+Ie-Vt);break;case qe:if(cr){if(mt&&(te=ie(mt)))switch(ye.segmentCodec){case"aac":this.parseAACPES(ye,te);break;case"mp3":this.parseMPEGPES(ye,te)}mt={data:[],size:0}}mt&&(mt.data.push(D.subarray(Vt,ot+Ie)),mt.size+=ot+Ie-Vt);break;case at:cr&&(Lt&&(te=ie(Lt))&&this.parseID3PES(xe,te),Lt={data:[],size:0}),Lt&&(Lt.data.push(D.subarray(Vt,ot+Ie)),Lt.size+=ot+Ie-Vt);break;case 0:cr&&(Vt+=D[Vt]+1),tr=this._pmtId=x(D,Vt);break;case tr:cr&&(Vt+=D[Vt]+1);var zt=j(D,Vt,this.typeSupported,H);(Ke=zt.avc)>0&&(ae.pid=Ke),(qe=zt.audio)>0&&(ye.pid=qe,ye.segmentCodec=zt.segmentCodec),(at=zt.id3)>0&&(xe.pid=at),it===null||Ot||(ue.logger.log("unknown PID '"+it+"' in TS found"),it=null,ot=Ft-188),Ot=this.pmtParsed=!0;break;case 17:case 8191:break;default:it=$r}}else Wt++;Wt>0&&this.observer.emit(_.Events.ERROR,_.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+Wt+" TS packet/s that do not start with 0x47"}),ae.pesData=tt,ye.pesData=mt,xe.pesData=Lt;var Sr={audioTrack:ye,videoTrack:ae,id3Track:xe,textTrack:Me};return X&&this.extractRemainingSamples(Sr),Sr},W.flush=function(){var D,G=this.remainderData;return this.remainderData=null,D=G?this.demux(G,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(D),this.sampleAes?this.decrypt(D,this.sampleAes):D},W.extractRemainingSamples=function(D){var G,H=D.audioTrack,X=D.videoTrack,te=D.id3Track,ae=D.textTrack,ye=X.pesData,xe=H.pesData,Me=te.pesData;if(ye&&(G=ie(ye))?(this.parseAVCPES(X,ae,G,!0),X.pesData=null):X.pesData=ye,xe&&(G=ie(xe))){switch(H.segmentCodec){case"aac":this.parseAACPES(H,G);break;case"mp3":this.parseMPEGPES(H,G)}H.pesData=null}else xe!=null&&xe.size&&ue.logger.log("last AAC PES packet truncated,might overlap between fragments"),H.pesData=xe;Me&&(G=ie(Me))?(this.parseID3PES(te,G),te.pesData=null):te.pesData=Me},W.demuxSampleAes=function(D,G,H){var X=this.demux(D,H,!0,!this.config.progressive),te=this.sampleAes=new Ae(this.observer,this.config,G);return this.decrypt(X,te)},W.decrypt=function(D,G){return new Promise(function(H){var X=D.audioTrack,te=D.videoTrack;X.samples&&X.segmentCodec==="aac"?G.decryptAacSamples(X.samples,0,function(){te.samples?G.decryptAvcSamples(te.samples,0,0,function(){H(D)}):H(D)}):te.samples&&G.decryptAvcSamples(te.samples,0,0,function(){H(D)})})},W.destroy=function(){this._duration=0},W.parseAVCPES=function(D,G,H,X){var te,ae=this,ye=this.parseAVCNALu(D,H.data),xe=this.avcSample,Me=!1;H.data=null,xe&&ye.length&&!D.audFound&&(me(xe,D),xe=this.avcSample=N(!1,H.pts,H.dts,"")),ye.forEach(function(Ke){switch(Ke.type){case 1:te=!0,xe||(xe=ae.avcSample=N(!0,H.pts,H.dts,"")),xe.frame=!0;var tt=Ke.data;if(Me&&tt.length>4){var qe=new ge(tt).readSliceType();qe!==2&&qe!==4&&qe!==7&&qe!==9||(xe.key=!0)}break;case 5:te=!0,xe||(xe=ae.avcSample=N(!0,H.pts,H.dts,"")),xe.key=!0,xe.frame=!0;break;case 6:te=!0,(0,z.parseSEIMessageFromNALu)(Ke.data,1,H.pts,G.samples);break;case 7:if(te=!0,Me=!0,!D.sps){var at=new ge(Ke.data).readSPS();D.width=at.width,D.height=at.height,D.pixelRatio=at.pixelRatio,D.sps=[Ke.data],D.duration=ae._duration;for(var mt=Ke.data.subarray(1,4),Lt="avc1.",it=0;it<3;it++){var Ot=mt[it].toString(16);Ot.length<2&&(Ot="0"+Ot),Lt+=Ot}D.codec=Lt}break;case 8:te=!0,D.pps||(D.pps=[Ke.data]);break;case 9:te=!1,D.audFound=!0,xe&&me(xe,D),xe=ae.avcSample=N(!1,H.pts,H.dts,"");break;case 12:te=!0;break;default:te=!1,xe&&(xe.debug+="unknown NAL "+Ke.type+" ")}xe&&te&&xe.units.push(Ke)}),X&&xe&&(me(xe,D),this.avcSample=null)},W.getLastNalUnit=function(D){var G,H,X=this.avcSample;if(X&&X.units.length!==0||(X=D[D.length-1]),(G=X)!==null&&G!==void 0&&G.units){var te=X.units;H=te[te.length-1]}return H},W.parseAVCNALu=function(D,G){var H,X,te=G.byteLength,ae=D.naluState||0,ye=ae,xe=[],Me=0,Ke=-1,tt=0;for(ae===-1&&(Ke=0,tt=31&G[0],ae=0,Me=1);Me<te;)if(H=G[Me++],ae)if(ae!==1)if(H)if(H===1){if(Ke>=0){var qe={data:G.subarray(Ke,Me-ae-1),type:tt};xe.push(qe)}else{var at=this.getLastNalUnit(D.samples);if(at&&(ye&&Me<=4-ye&&at.state&&(at.data=at.data.subarray(0,at.data.byteLength-ye)),(X=Me-ae-1)>0)){var mt=new Uint8Array(at.data.byteLength+X);mt.set(at.data,0),mt.set(G.subarray(0,X),at.data.byteLength),at.data=mt,at.state=0}}Me<te?(Ke=Me,tt=31&G[Me],ae=0):ae=-1}else ae=0;else ae=3;else ae=H?0:2;else ae=H?0:1;if(Ke>=0&&ae>=0){var Lt={data:G.subarray(Ke,te),type:tt,state:ae};xe.push(Lt)}if(xe.length===0){var it=this.getLastNalUnit(D.samples);if(it){var Ot=new Uint8Array(it.data.byteLength+G.byteLength);Ot.set(it.data,0),Ot.set(G,it.data.byteLength),it.data=Ot}}return D.naluState=ae,xe},W.parseAACPES=function(D,G){var H,X,te,ae,ye,xe=0,Me=this.aacOverFlow,Ke=G.data;if(Me){this.aacOverFlow=null;var tt=Me.missing,qe=Me.sample.unit.byteLength;if(tt===-1){var at=new Uint8Array(qe+Ke.byteLength);at.set(Me.sample.unit,0),at.set(Ke,qe),Ke=at}else{var mt=qe-tt;Me.sample.unit.set(Ke.subarray(0,tt),mt),D.samples.push(Me.sample),xe=Me.missing}}for(H=xe,X=Ke.length;H<X-1&&!Pe(Ke,H);H++);if(H===xe||(H<X-1?(te="AAC PES did not start with ADTS header,offset:"+H,ae=!1):(te="no ADTS header found in AAC PES",ae=!0),ue.logger.warn("parsing error:"+te),this.observer.emit(_.Events.ERROR,_.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,fatal:ae,reason:te}),!ae)){if(ce(D,this.observer,Ke,H,this.audioCodec),G.pts!==void 0)ye=G.pts;else{if(!Me)return void ue.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var Lt=P(D.samplerate);ye=Me.sample.pts+Lt}for(var it,Ot=0;H<X;){if(H+=(it=Q(D,Ke,H,ye,Ot)).length,it.missing){this.aacOverFlow=it;break}for(Ot++;H<X-1&&!Pe(Ke,H);H++);}}},W.parseMPEGPES=function(D,G){var H=G.data,X=H.length,te=0,ae=0,ye=G.pts;if(ye!==void 0)for(;ae<X;)if(J(H,ae)){var xe=ct(D,H,ae,ye,te);if(!xe)break;ae+=xe.length,te++}else ae++;else ue.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},W.parseID3PES=function(D,G){if(G.pts!==void 0){var H=ke({},G,{type:this._avcTrack?O.MetadataSchema.emsg:O.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});D.samples.push(H)}else ue.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},ne}();function Fe(ne,W){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,G){return D.__proto__=G,D},Fe(ne,W)}const we=function(ne){var W,D;function G(){return ne.apply(this,arguments)||this}D=ne,(W=G).prototype=Object.create(D.prototype),W.prototype.constructor=W,Fe(W,D);var H=G.prototype;return H.resetInitSegment=function(X,te,ae,ye){ne.prototype.resetInitSegment.call(this,X,te,ae,ye),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:te,duration:ye,inputTimeScale:9e4,dropped:0}},G.probe=function(X){if(!X)return!1;for(var te=(L.getID3Data(X,0)||[]).length,ae=X.length;te<ae;te++)if(q(X,te))return ue.logger.log("MPEG Audio sync word found !"),!0;return!1},H.canParse=function(X,te){return function(ae,ye){return B(ae,ye)&&4<=ae.length-ye}(X,te)},H.appendFrame=function(X,te,ae){if(this.basePTS!==null)return ct(X,te,ae,this.basePTS,this.frameIndex)},G}(fe);var Ue=y(524),Ce=y(923);function Qe(ne,W){var D=ne==null?void 0:ne.codec;return D&&D.length>4?D:D==="hvc1"||D==="hev1"?"hvc1.1.c.L120.90":D==="av01"?"av01.0.04M.08":D==="avc1"||W===Ce.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const He=function(){function ne(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var W=ne.prototype;return W.destroy=function(){},W.resetTimeStamp=function(D){this.initPTS=D,this.lastEndTime=null},W.resetNextTimestamp=function(){this.lastEndTime=null},W.resetInitSegment=function(D,G,H,X){this.audioCodec=G,this.videoCodec=H,this.generateInitSegment((0,z.patchEncyptionData)(D,X)),this.emitInitSegment=!0},W.generateInitSegment=function(D){var G=this.audioCodec,H=this.videoCodec;if(!D||!D.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var X=this.initData=(0,z.parseInitSegment)(D);G||(G=Qe(X.audio,Ce.ElementaryStreamTypes.AUDIO)),H||(H=Qe(X.video,Ce.ElementaryStreamTypes.VIDEO));var te={};X.audio&&X.video?te.audiovideo={container:"video/mp4",codec:G+","+H,initSegment:D,id:"main"}:X.audio?te.audio={container:"audio/mp4",codec:G,initSegment:D,id:"audio"}:X.video?te.video={container:"video/mp4",codec:H,initSegment:D,id:"main"}:ue.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=te},W.remux=function(D,G,H,X,te){var ae,ye=this.initPTS,xe=this.lastEndTime,Me={audio:void 0,video:void 0,text:X,id3:H,initSegment:void 0};(0,b.isFiniteNumber)(xe)||(xe=this.lastEndTime=te||0);var Ke=G.samples;if(!Ke||!Ke.length)return Me;var tt={initPTS:void 0,timescale:1},qe=this.initData;if(qe&&qe.length||(this.generateInitSegment(Ke),qe=this.initData),!qe||!qe.length)return ue.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),Me;this.emitInitSegment&&(tt.tracks=this.initTracks,this.emitInitSegment=!1);var at=(0,z.getStartDTS)(qe,Ke);(0,b.isFiniteNumber)(ye)||(this.initPTS=tt.initPTS=ye=at-te);var mt=(0,z.getDuration)(Ke,qe),Lt=D?at-ye:xe,it=Lt+mt;(0,z.offsetStartDTS)(qe,Ke,ye),mt>0?this.lastEndTime=it:(ue.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var Ot=!!qe.audio,tr=!!qe.video,jt="";Ot&&(jt+="audio"),tr&&(jt+="video");var Ft={data1:Ke,startPTS:Lt,startDTS:Lt,endPTS:it,endDTS:it,type:jt,hasAudio:Ot,hasVideo:tr,nb:1,dropped:0};Me.audio=Ft.type==="audio"?Ft:void 0,Me.video=Ft.type!=="audio"?Ft:void 0,Me.initSegment=tt;var Wt=(ae=this.initPTS)!=null?ae:0;return Me.id3=(0,Ue.flushTextTrackMetadataCueSamples)(H,te,Wt,Wt),X.samples.length&&(Me.text=(0,Ue.flushTextTrackUserdataCueSamples)(X,te,Wt)),Me},ne}();var Ge;try{Ge=self.performance.now.bind(self.performance)}catch{ue.logger.debug("Unable to use Performance API on this environment"),Ge=self.Date.now}var et=[{demux:ve,remux:He},{demux:Oe,remux:Ue.default},{demux:pe,remux:Ue.default},{demux:we,remux:Ue.default}],nt=function(){function ne(D,G,H,X,te){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=D,this.typeSupported=G,this.config=H,this.vendor=X,this.id=te}var W=ne.prototype;return W.configure=function(D){this.transmuxConfig=D,this.decrypter&&this.decrypter.reset()},W.push=function(D,G,H,X){var te=this,ae=H.transmuxing;ae.executeStart=Ge();var ye=new Uint8Array(D),xe=this.currentTransmuxState,Me=this.transmuxConfig;X&&(this.currentTransmuxState=X);var Ke=X||xe,tt=Ke.contiguous,qe=Ke.discontinuity,at=Ke.trackSwitch,mt=Ke.accurateTimeOffset,Lt=Ke.timeOffset,it=Ke.initSegmentChange,Ot=Me.audioCodec,tr=Me.videoCodec,jt=Me.defaultInitPts,Ft=Me.duration,Wt=Me.initSegmentData,ot=function(Sn,Ir){var Ht=null;return Sn.byteLength>0&&Ir!=null&&Ir.key!=null&&Ir.iv!==null&&Ir.method!=null&&(Ht=Ir),Ht}(ye,G);if(ot&&ot.method==="AES-128"){var cr=this.getDecrypter();if(!cr.isSync())return this.decryptionPromise=cr.webCryptoDecrypt(ye,ot.key.buffer,ot.iv.buffer).then(function(Sn){var Ir=te.push(Sn,null,H);return te.decryptionPromise=null,Ir}),this.decryptionPromise;var $r=cr.softwareDecrypt(ye,ot.key.buffer,ot.iv.buffer);if(!$r)return ae.executeEnd=Ge(),ht(H);ye=new Uint8Array($r)}var Vt=this.needsProbing(qe,at);Vt&&this.configureTransmuxer(ye),(qe||at||it||Vt)&&this.resetInitSegment(Wt,Ot,tr,Ft,G),(qe||it||Vt)&&this.resetInitialTimestamp(jt),tt||this.resetContiguity();var zt=this.transmux(ye,ot,Lt,mt,H),Sr=this.currentTransmuxState;return Sr.contiguous=!0,Sr.discontinuity=!1,Sr.trackSwitch=!1,ae.executeEnd=Ge(),zt},W.flush=function(D){var G=this,H=D.transmuxing;H.executeStart=Ge();var X=this.decrypter,te=this.currentTransmuxState,ae=this.decryptionPromise;if(ae)return ae.then(function(){return G.flush(D)});var ye=[],xe=te.timeOffset;if(X){var Me=X.flush();Me&&ye.push(this.push(Me,null,D))}var Ke=this.demuxer,tt=this.remuxer;if(!Ke||!tt)return this.observer.emit(_.Events.ERROR,_.Events.ERROR,{type:I.ErrorTypes.MEDIA_ERROR,details:I.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),H.executeEnd=Ge(),[ht(D)];var qe=Ke.flush(xe);return ft(qe)?qe.then(function(at){return G.flushRemux(ye,at,D),ye}):(this.flushRemux(ye,qe,D),ye)},W.flushRemux=function(D,G,H){var X=G.audioTrack,te=G.videoTrack,ae=G.id3Track,ye=G.textTrack,xe=this.currentTransmuxState,Me=xe.accurateTimeOffset,Ke=xe.timeOffset;ue.logger.log("[transmuxer.ts]: Flushed fragment "+H.sn+(H.part>-1?" p: "+H.part:"")+" of level "+H.level);var tt=this.remuxer.remux(X,te,ae,ye,Ke,Me,!0,this.id);D.push({remuxResult:tt,chunkMeta:H}),H.transmuxing.executeEnd=Ge()},W.resetInitialTimestamp=function(D){var G=this.demuxer,H=this.remuxer;G&&H&&(G.resetTimeStamp(D),H.resetTimeStamp(D))},W.resetContiguity=function(){var D=this.demuxer,G=this.remuxer;D&&G&&(D.resetContiguity(),G.resetNextTimestamp())},W.resetInitSegment=function(D,G,H,X,te){var ae=this.demuxer,ye=this.remuxer;ae&&ye&&(ae.resetInitSegment(D,G,H,X),ye.resetInitSegment(D,G,H,te))},W.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},W.transmux=function(D,G,H,X,te){return G&&G.method==="SAMPLE-AES"?this.transmuxSampleAes(D,G,H,X,te):this.transmuxUnencrypted(D,H,X,te)},W.transmuxUnencrypted=function(D,G,H,X){var te=this.demuxer.demux(D,G,!1,!this.config.progressive),ae=te.audioTrack,ye=te.videoTrack,xe=te.id3Track,Me=te.textTrack;return{remuxResult:this.remuxer.remux(ae,ye,xe,Me,G,H,!1,this.id),chunkMeta:X}},W.transmuxSampleAes=function(D,G,H,X,te){var ae=this;return this.demuxer.demuxSampleAes(D,G,H).then(function(ye){return{remuxResult:ae.remuxer.remux(ye.audioTrack,ye.videoTrack,ye.id3Track,ye.textTrack,H,X,!1,ae.id),chunkMeta:te}})},W.configureTransmuxer=function(D){for(var G,H=this.config,X=this.observer,te=this.typeSupported,ae=this.vendor,ye=0,xe=et.length;ye<xe;ye++)if(et[ye].demux.probe(D)){G=et[ye];break}G||(ue.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),G={demux:ve,remux:He});var Me=this.demuxer,Ke=this.remuxer,tt=G.remux,qe=G.demux;Ke&&Ke instanceof tt||(this.remuxer=new tt(X,H,te,ae)),Me&&Me instanceof qe||(this.demuxer=new qe(X,H,te),this.probe=qe.probe)},W.needsProbing=function(D,G){return!this.demuxer||!this.remuxer||D||G},W.getDecrypter=function(){var D=this.decrypter;return D||(D=this.decrypter=new C.default(this.config)),D},ne}(),ht=function(ne){return{remuxResult:{},chunkMeta:ne}};function ft(ne){return"then"in ne&&ne.then instanceof Function}var Tt=function(ne,W,D,G,H){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=ne,this.videoCodec=W,this.initSegmentData=D,this.duration=G,this.defaultInitPts=H},Bt=function(ne,W,D,G,H,X){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=ne,this.contiguous=W,this.accurateTimeOffset=D,this.trackSwitch=G,this.timeOffset=H,this.initSegmentChange=X}},973:(E,A,y)=>{var _,I;y.r(A),y.d(A,{ErrorDetails:()=>I,ErrorTypes:()=>_}),function(C){C.NETWORK_ERROR="networkError",C.MEDIA_ERROR="mediaError",C.KEY_SYSTEM_ERROR="keySystemError",C.MUX_ERROR="muxError",C.OTHER_ERROR="otherError"}(_||(_={})),function(C){C.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",C.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",C.KEY_SYSTEM_NO_SESSION="keySystemNoSession",C.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",C.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",C.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",C.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",C.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",C.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",C.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",C.MANIFEST_LOAD_ERROR="manifestLoadError",C.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",C.MANIFEST_PARSING_ERROR="manifestParsingError",C.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",C.LEVEL_EMPTY_ERROR="levelEmptyError",C.LEVEL_LOAD_ERROR="levelLoadError",C.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",C.LEVEL_SWITCH_ERROR="levelSwitchError",C.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",C.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",C.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",C.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",C.FRAG_LOAD_ERROR="fragLoadError",C.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",C.FRAG_DECRYPT_ERROR="fragDecryptError",C.FRAG_PARSING_ERROR="fragParsingError",C.REMUX_ALLOC_ERROR="remuxAllocError",C.KEY_LOAD_ERROR="keyLoadError",C.KEY_LOAD_TIMEOUT="keyLoadTimeOut",C.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",C.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",C.BUFFER_APPEND_ERROR="bufferAppendError",C.BUFFER_APPENDING_ERROR="bufferAppendingError",C.BUFFER_STALLED_ERROR="bufferStalledError",C.BUFFER_FULL_ERROR="bufferFullError",C.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",C.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",C.INTERNAL_EXCEPTION="internalException",C.INTERNAL_ABORTED="aborted",C.UNKNOWN="unknown"}(I||(I={}))},851:(E,A,y)=>{var _;y.r(A),y.d(A,{Events:()=>_}),function(I){I.MEDIA_ATTACHING="hlsMediaAttaching",I.MEDIA_ATTACHED="hlsMediaAttached",I.MEDIA_DETACHING="hlsMediaDetaching",I.MEDIA_DETACHED="hlsMediaDetached",I.BUFFER_RESET="hlsBufferReset",I.BUFFER_CODECS="hlsBufferCodecs",I.BUFFER_CREATED="hlsBufferCreated",I.BUFFER_APPENDING="hlsBufferAppending",I.BUFFER_APPENDED="hlsBufferAppended",I.BUFFER_EOS="hlsBufferEos",I.BUFFER_FLUSHING="hlsBufferFlushing",I.BUFFER_FLUSHED="hlsBufferFlushed",I.MANIFEST_LOADING="hlsManifestLoading",I.MANIFEST_LOADED="hlsManifestLoaded",I.MANIFEST_PARSED="hlsManifestParsed",I.LEVEL_SWITCHING="hlsLevelSwitching",I.LEVEL_SWITCHED="hlsLevelSwitched",I.LEVEL_LOADING="hlsLevelLoading",I.LEVEL_LOADED="hlsLevelLoaded",I.LEVEL_UPDATED="hlsLevelUpdated",I.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",I.LEVELS_UPDATED="hlsLevelsUpdated",I.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",I.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",I.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",I.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",I.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",I.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",I.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",I.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",I.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",I.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",I.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",I.CUES_PARSED="hlsCuesParsed",I.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",I.INIT_PTS_FOUND="hlsInitPtsFound",I.FRAG_LOADING="hlsFragLoading",I.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",I.FRAG_LOADED="hlsFragLoaded",I.FRAG_DECRYPTED="hlsFragDecrypted",I.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",I.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",I.FRAG_PARSING_METADATA="hlsFragParsingMetadata",I.FRAG_PARSED="hlsFragParsed",I.FRAG_BUFFERED="hlsFragBuffered",I.FRAG_CHANGED="hlsFragChanged",I.FPS_DROP="hlsFpsDrop",I.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",I.ERROR="hlsError",I.DESTROYING="hlsDestroying",I.KEY_LOADING="hlsKeyLoading",I.KEY_LOADED="hlsKeyLoaded",I.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",I.BACK_BUFFER_REACHED="hlsBackBufferReached"}(_||(_={}))},76:(E,A,y)=>{y.r(A),y.d(A,{default:()=>qc});var _,I=y(945),C=y(965),b=y(851),L=y(973),O=y(93),oe=/^(\d+)x(\d+)$/,z=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,ee=function(){function T(i){for(var s in typeof i=="string"&&(i=T.parseAttrList(i)),i)i.hasOwnProperty(s)&&(this[s]=i[s])}var d=T.prototype;return d.decimalInteger=function(i){var s=parseInt(this[i],10);return s>Number.MAX_SAFE_INTEGER?1/0:s},d.hexadecimalInteger=function(i){if(this[i]){var s=(this[i]||"0x").slice(2);s=(1&s.length?"0":"")+s;for(var u=new Uint8Array(s.length/2),c=0;c<s.length/2;c++)u[c]=parseInt(s.slice(2*c,2*c+2),16);return u}return null},d.hexadecimalIntegerAsNumber=function(i){var s=parseInt(this[i],16);return s>Number.MAX_SAFE_INTEGER?1/0:s},d.decimalFloatingPoint=function(i){return parseFloat(this[i])},d.optionalFloat=function(i,s){var u=this[i];return u?parseFloat(u):s},d.enumeratedString=function(i){return this[i]},d.bool=function(i){return this[i]==="YES"},d.decimalResolution=function(i){var s=oe.exec(this[i]);if(s!==null)return{width:parseInt(s[1],10),height:parseInt(s[2],10)}},T.parseAttrList=function(i){var s,u={};for(z.lastIndex=0;(s=z.exec(i))!==null;){var c=s[2];c.indexOf('"')===0&&c.lastIndexOf('"')===c.length-1&&(c=c.slice(1,-1)),u[s[1]]=c}return u},T}();function le(){return le=Object.assign?Object.assign.bind():function(T){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(T[s]=i[s])}return T},le.apply(this,arguments)}function $(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}(function(T){T.ID="ID",T.CLASS="CLASS",T.START_DATE="START-DATE",T.DURATION="DURATION",T.END_DATE="END-DATE",T.END_ON_NEXT="END-ON-NEXT",T.PLANNED_DURATION="PLANNED-DURATION",T.SCTE35_OUT="SCTE35-OUT",T.SCTE35_IN="SCTE35-IN"})(_||(_={}));var fe=function(){function T(s,u){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,u){var c=u.attr;for(var l in c)if(Object.prototype.hasOwnProperty.call(s,l)&&s[l]!==c[l]){O.logger.warn('DATERANGE tag attribute: "'+l+'" does not match for tags with ID: "'+s.ID+'"'),this._badValueForSameId=l;break}s=le(new ee({}),c,s)}if(this.attr=s,this._startDate=new Date(s[_.START_DATE]),_.END_DATE in this.attr){var o=new Date(this.attr[_.END_DATE]);(0,C.isFiniteNumber)(o.getTime())&&(this._endDate=o)}}var d,i;return d=T,(i=[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var s=this.duration;return s!==null?new Date(this._startDate.getTime()+1e3*s):null}},{key:"duration",get:function(){if(_.DURATION in this.attr){var s=this.attr.decimalFloatingPoint(_.DURATION);if((0,C.isFiniteNumber)(s))return s}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return _.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(_.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(_.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,C.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}])&&$(d.prototype,i),Object.defineProperty(d,"prototype",{writable:!1}),T}(),ue=y(923);function se(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}var re,Ne,Pe,Ze=function(){function T(s){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=s}var d,i;return T.prototype.reloaded=function(s){if(!s)return this.advanced=!0,void(this.updated=!0);var u=this.lastPartSn-s.lastPartSn,c=this.lastPartIndex-s.lastPartIndex;this.updated=this.endSN!==s.endSN||!!c||!!u,this.advanced=this.endSN>s.endSN||u>0||u===0&&c>0,this.updated||this.advanced?this.misses=Math.floor(.6*s.misses):this.misses=s.misses+1,this.availabilityDelay=s.availabilityDelay},d=T,(i=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&(0,C.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var s=this.driftEndTime-this.driftStartTime;return s>0?1e3*(this.driftEnd-this.driftStart)/s:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var s;return(s=this.partList)!==null&&s!==void 0&&s.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var s;return(s=this.fragments)!==null&&s!==void 0&&s.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var s;return(s=this.partList)!==null&&s!==void 0&&s.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var s;return(s=this.partList)!==null&&s!==void 0&&s.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&se(d.prototype,i),Object.defineProperty(d,"prototype",{writable:!1}),T}();function ce(T){return Uint8Array.from(atob(T),function(d){return d.charCodeAt(0)})}function P(T){return Uint8Array.from(unescape(encodeURIComponent(T)),function(d){return d.charCodeAt(0)})}function Q(T){switch(T){case Ne.FAIRPLAY:return re.FAIRPLAY;case Ne.PLAYREADY:return re.PLAYREADY;case Ne.WIDEVINE:return re.WIDEVINE;case Ne.CLEARKEY:return re.CLEARKEY}}function U(T){switch(T){case re.FAIRPLAY:return Ne.FAIRPLAY;case re.PLAYREADY:return Ne.PLAYREADY;case re.WIDEVINE:return Ne.WIDEVINE;case re.CLEARKEY:return Ne.CLEARKEY}}function pe(T){var d=T.drmSystems,i=T.widevineLicenseUrl,s=d?[re.FAIRPLAY,re.WIDEVINE,re.PLAYREADY,re.CLEARKEY].filter(function(u){return!!d[u]}):[];return!s[re.WIDEVINE]&&i&&s.push(re.WIDEVINE),s}(function(T){T.CLEARKEY="org.w3.clearkey",T.FAIRPLAY="com.apple.fps",T.PLAYREADY="com.microsoft.playready",T.WIDEVINE="com.widevine.alpha"})(re||(re={})),function(T){T.CLEARKEY="org.w3.clearkey",T.FAIRPLAY="com.apple.streamingkeydelivery",T.PLAYREADY="com.microsoft.playready",T.WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"}(Ne||(Ne={})),function(T){T.WIDEVINE="edef8ba979d64acea3c827dcd51d21ed"}(Pe||(Pe={}));var Le=typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null,ve=y(63),Ee={},We=function(){function T(i,s,u,c,l){c===void 0&&(c=[1]),l===void 0&&(l=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=i,this.uri=s,this.keyFormat=u,this.keyFormatVersions=c,this.iv=l,this.encrypted=!!i&&i!=="NONE",this.isCommonEncryption=this.encrypted&&i!=="AES-128"}T.clearKeyUriToKeyIdMap=function(){Ee={}};var d=T.prototype;return d.isSupported=function(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;switch(this.keyFormat){case"identity":return this.method==="SAMPLE-AES";case Ne.FAIRPLAY:case Ne.WIDEVINE:case Ne.PLAYREADY:case Ne.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1},d.getDecryptData=function(i){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof i!="number"&&(this.method!=="AES-128"||this.iv||O.logger.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),i=0);var s=function(V){for(var K=new Uint8Array(16),Z=12;Z<16;Z++)K[Z]=V>>8*(15-Z)&255;return K}(i);return new T(this.method,this.uri,"identity",this.keyFormatVersions,s)}var u=function(V){var K,Z,de=V.split(":"),_e=null;if(de[0]==="data"&&de.length===2){var Te=de[1].split(";"),De=Te[Te.length-1].split(",");if(De.length===2){var ze=De[0]==="base64",st=De[1];ze?(Te.splice(-1,1),_e=ce(st)):(K=P(st).subarray(0,16),(Z=new Uint8Array(16)).set(K,16-K.length),_e=Z)}}return _e}(this.uri);if(u)switch(this.keyFormat){case Ne.WIDEVINE:this.pssh=u,u.length>=22&&(this.keyId=u.subarray(u.length-22,u.length-6));break;case Ne.PLAYREADY:var c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=(0,ve.mp4pssh)(c,null,u);var l=new Uint16Array(u.buffer,u.byteOffset,u.byteLength/2),o=String.fromCharCode.apply(null,Array.from(l)),h=o.substring(o.indexOf("<"),o.length),g=new DOMParser().parseFromString(h,"text/xml").getElementsByTagName("KID")[0];if(g){var p=g.childNodes[0]?g.childNodes[0].nodeValue:g.getAttribute("VALUE");if(p){var v=ce(p).subarray(0,16);(function(V){var K=function(Z,de,_e){var Te=Z[de];Z[de]=Z[_e],Z[_e]=Te};K(V,0,3),K(V,1,2),K(V,4,5),K(V,6,7)})(v),this.keyId=v}}break;default:var S=u.subarray(0,16);if(S.length!==16){var R=new Uint8Array(16);R.set(S,16-S.length),S=R}this.keyId=S}if(!this.keyId||this.keyId.byteLength!==16){var k=Ee[this.uri];if(!k){var M=Object.keys(Ee).length%Number.MAX_SAFE_INTEGER;k=new Uint8Array(16),new DataView(k.buffer,12,4).setUint32(0,M),Ee[this.uri]=k}this.keyId=k}return this},T}(),Je={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function $e(T,d){return MediaSource.isTypeSupported((d||"video")+'/mp4;codecs="'+T+'"')}function je(){return je=Object.assign?Object.assign.bind():function(T){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(T[s]=i[s])}return T},je.apply(this,arguments)}var ct=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+|#EXT-X-SESSION-KEY:([^\n\r]*)[\r\n]+/g,_t=/#EXT-X-MEDIA:(.*)/g,B=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),J=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),q=function(){function T(){}return T.findGroup=function(d,i){for(var s=0;s<d.length;s++){var u=d[s];if(u.id===i)return u}},T.convertAVC1ToAVCOTI=function(d){var i=d.split(".");if(i.length>2){var s=i.shift()+".";return(s+=parseInt(i.shift()).toString(16))+("000"+parseInt(i.shift()).toString(16)).slice(-4)}return d},T.resolve=function(d,i){return(0,I.buildAbsoluteURL)(i,d,{alwaysNormalize:!0})},T.parseMasterPlaylist=function(d,i){var s,u=[],c=[],l={},o=[],h=!1;for(ct.lastIndex=0;(s=ct.exec(d))!=null;)if(s[1]){var g,p=new ee(s[1]),v={attrs:p,bitrate:p.decimalInteger("AVERAGE-BANDWIDTH")||p.decimalInteger("BANDWIDTH"),name:p.NAME,url:T.resolve(s[2],i)},S=p.decimalResolution("RESOLUTION");S&&(v.width=S.width,v.height=S.height),Ae((p.CODECS||"").split(/[ ,]+/).filter(function(V){return V}),v),v.videoCodec&&v.videoCodec.indexOf("avc1")!==-1&&(v.videoCodec=T.convertAVC1ToAVCOTI(v.videoCodec)),(g=v.unknownCodecs)!==null&&g!==void 0&&g.length||c.push(v),u.push(v)}else if(s[3]){var R=new ee(s[3]);R["DATA-ID"]&&(h=!0,l[R["DATA-ID"]]=R)}else if(s[4]){var k=s[4],M=ge(k,i);M.encrypted&&M.isSupported()?o.push(M):O.logger.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+k+'"')}return{levels:c.length>0&&c.length<u.length?c:u,sessionData:h?l:null,sessionKeys:o.length?o:null}},T.parseMasterPlaylistMedia=function(d,i,s,u){var c;u===void 0&&(u=[]);var l=[],o=0;for(_t.lastIndex=0;(c=_t.exec(d))!==null;){var h=new ee(c[1]);if(h.TYPE===s){var g={attrs:h,bitrate:0,id:o++,groupId:h["GROUP-ID"],instreamId:h["INSTREAM-ID"],name:h.NAME||h.LANGUAGE||"",type:s,default:h.bool("DEFAULT"),autoselect:h.bool("AUTOSELECT"),forced:h.bool("FORCED"),lang:h.LANGUAGE,url:h.URI?T.resolve(h.URI,i):""};if(u.length){var p=T.findGroup(u,g.groupId)||u[0];ke(g,p,"audioCodec"),ke(g,p,"textCodec")}l.push(g)}}return l},T.parseLevelPlaylist=function(d,i,s,u,c){var l,o,h,g=new Ze(i),p=g.fragments,v=null,S=0,R=0,k=0,M=0,V=null,K=new ue.Fragment(u,i),Z=-1,de=!1;for(B.lastIndex=0,g.m3u8=d;(l=B.exec(d))!==null;){de&&(de=!1,(K=new ue.Fragment(u,i)).start=k,K.sn=S,K.cc=M,K.level=s,v&&(K.initSegment=v,K.rawProgramDateTime=v.rawProgramDateTime,v.rawProgramDateTime=null));var _e=l[1];if(_e){K.duration=parseFloat(_e);var Te=(" "+l[2]).slice(1);K.title=Te||null,K.tagList.push(Te?["INF",_e,Te]:["INF",_e])}else if(l[3]){if((0,C.isFiniteNumber)(K.duration)){if(K.start=k,h){K.levelkeys=h;var De=g.encryptedFragments;!K.levelkeys||!Object.keys(K.levelkeys).some(function(Rr){return K.levelkeys[Rr].isCommonEncryption})||De.length&&De[De.length-1].levelkeys===h||De.push(K)}K.sn=S,K.level=s,K.cc=M,K.urlId=c,p.push(K),K.relurl=(" "+l[3]).slice(1),Ie(K,V),V=K,k+=K.duration,S++,R=0,de=!0}}else if(l[4]){var ze=(" "+l[4]).slice(1);V?K.setByteRange(ze,V):K.setByteRange(ze)}else if(l[5])K.rawProgramDateTime=(" "+l[5]).slice(1),K.tagList.push(["PROGRAM-DATE-TIME",K.rawProgramDateTime]),Z===-1&&(Z=p.length);else{if(!(l=l[0].match(J))){O.logger.warn("No matches on slow regex match for level playlist!");continue}for(o=1;o<l.length&&l[o]===void 0;o++);var st=(" "+l[o]).slice(1),Se=(" "+l[o+1]).slice(1),Xe=l[o+2]?(" "+l[o+2]).slice(1):"";switch(st){case"PLAYLIST-TYPE":g.type=Se.toUpperCase();break;case"MEDIA-SEQUENCE":S=g.startSN=parseInt(Se);break;case"SKIP":var Ve=new ee(Se),pt=Ve.decimalInteger("SKIPPED-SEGMENTS");if((0,C.isFiniteNumber)(pt)){g.skippedSegments=pt;for(var kt=pt;kt--;)p.unshift(null);S+=pt}var vt=Ve.enumeratedString("RECENTLY-REMOVED-DATERANGES");vt&&(g.recentlyRemovedDateranges=vt.split("	"));break;case"TARGETDURATION":g.targetduration=parseFloat(Se);break;case"VERSION":g.version=parseInt(Se);break;case"EXTM3U":break;case"ENDLIST":g.live=!1;break;case"#":(Se||Xe)&&K.tagList.push(Xe?[Se,Xe]:[Se]);break;case"DISCONTINUITY":M++,K.tagList.push(["DIS"]);break;case"GAP":K.tagList.push([st]);break;case"BITRATE":K.tagList.push([st,Se]);break;case"DATERANGE":var St=new ee(Se),Rt=new fe(St,g.dateRanges[St.ID]);Rt.isValid||g.skippedSegments?g.dateRanges[Rt.id]=Rt:O.logger.warn('Ignoring invalid DATERANGE tag: "'+Se+'"'),K.tagList.push(["EXT-X-DATERANGE",Se]);break;case"DISCONTINUITY-SEQUENCE":M=parseInt(Se);break;case"KEY":var $t=ge(Se,i);if($t.isSupported()){if($t.method==="NONE"){h=void 0;break}h||(h={}),h[$t.keyFormat]&&(h=je({},h)),h[$t.keyFormat]=$t}else O.logger.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+Se+'"');break;case"START":var Xt=new ee(Se).decimalFloatingPoint("TIME-OFFSET");(0,C.isFiniteNumber)(Xt)&&(g.startTimeOffset=Xt);break;case"MAP":var Gt=new ee(Se);if(K.duration){var Qt=new ue.Fragment(u,i);N(Qt,Gt,s,h),v=Qt,K.initSegment=v,v.rawProgramDateTime&&!K.rawProgramDateTime&&(K.rawProgramDateTime=v.rawProgramDateTime)}else N(K,Gt,s,h),v=K,de=!0;break;case"SERVER-CONTROL":var Er=new ee(Se);g.canBlockReload=Er.bool("CAN-BLOCK-RELOAD"),g.canSkipUntil=Er.optionalFloat("CAN-SKIP-UNTIL",0),g.canSkipDateRanges=g.canSkipUntil>0&&Er.bool("CAN-SKIP-DATERANGES"),g.partHoldBack=Er.optionalFloat("PART-HOLD-BACK",0),g.holdBack=Er.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var po=new ee(Se);g.partTarget=po.decimalFloatingPoint("PART-TARGET");break;case"PART":var Fr=g.partList;Fr||(Fr=g.partList=[]);var Oi=R>0?Fr[Fr.length-1]:void 0,xi=R++,ki=new ue.Part(new ee(Se),K,i,xi,Oi);Fr.push(ki),K.duration+=ki.duration;break;case"PRELOAD-HINT":var lt=new ee(Se);g.preloadHint=lt;break;case"RENDITION-REPORT":var bt=new ee(Se);g.renditionReports=g.renditionReports||[],g.renditionReports.push(bt);break;default:O.logger.warn("line parsed but not handled: "+l)}}}V&&!V.relurl?(p.pop(),k-=V.duration,g.partList&&(g.fragmentHint=V)):g.partList&&(Ie(K,V),K.cc=M,g.fragmentHint=K);var Jn=p.length,Jr=p[0],Br=p[Jn-1];if((k+=g.skippedSegments*g.targetduration)>0&&Jn&&Br){g.averagetargetduration=k/Jn;var Zn=Br.sn;g.endSN=Zn!=="initSegment"?Zn:0,g.live||(Br.endList=!0),Jr&&(g.startCC=Jr.cc)}else g.endSN=0,g.startCC=0;return g.fragmentHint&&(k+=g.fragmentHint.duration),g.totalduration=k,g.endCC=M,Z>0&&function(Rr,Zr){for(var ln=Rr[Zr],br=Zr;br--;){var hn=Rr[br];if(!hn)return;hn.programDateTime=ln.programDateTime-1e3*hn.duration,ln=hn}}(p,Z),g},T}();function ge(T,d){var i,s,u=new ee(T),c=(i=u.enumeratedString("METHOD"))!=null?i:"",l=u.URI,o=u.hexadecimalInteger("IV"),h=u.enumeratedString("KEYFORMATVERSIONS"),g=(s=u.enumeratedString("KEYFORMAT"))!=null?s:"identity";l&&u.IV&&!o&&O.logger.error("Invalid IV: "+u.IV);var p=l?q.resolve(l,d):"",v=(h||"1").split("/").map(Number).filter(Number.isFinite);return new We(c,p,g,v,o)}function Ae(T,d){["video","audio","text"].forEach(function(i){var s=T.filter(function(c){return function(l,o){var h=Je[o];return!!h&&h[l.slice(0,4)]===!0}(c,i)});if(s.length){var u=s.filter(function(c){return c.lastIndexOf("avc1",0)===0||c.lastIndexOf("mp4a",0)===0});d[i+"Codec"]=u.length>0?u[0]:s[0],T=T.filter(function(c){return s.indexOf(c)===-1})}}),d.unknownCodecs=T}function ke(T,d,i){var s=d[i];s&&(T[i]=s)}function Ie(T,d){T.rawProgramDateTime?T.programDateTime=Date.parse(T.rawProgramDateTime):d!=null&&d.programDateTime&&(T.programDateTime=d.endProgramDateTime),(0,C.isFiniteNumber)(T.programDateTime)||(T.programDateTime=null,T.rawProgramDateTime=null)}function N(T,d,i,s){T.relurl=d.URI,d.BYTERANGE&&T.setByteRange(d.BYTERANGE),T.level=i,T.sn="initSegment",s&&(T.levelkeys=s),T.initSegment=null}var x=y(308);function j(T,d){var i=T.url;return i!==void 0&&i.indexOf("data:")!==0||(i=d.url),i}const ie=function(){function T(i){this.hls=void 0,this.loaders=Object.create(null),this.hls=i,this.registerListeners()}var d=T.prototype;return d.startLoad=function(i){},d.stopLoad=function(){this.destroyInternalLoaders()},d.registerListeners=function(){var i=this.hls;i.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(b.Events.LEVEL_LOADING,this.onLevelLoading,this),i.on(b.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),i.on(b.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},d.unregisterListeners=function(){var i=this.hls;i.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(b.Events.LEVEL_LOADING,this.onLevelLoading,this),i.off(b.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),i.off(b.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},d.createInternalLoader=function(i){var s=this.hls.config,u=s.pLoader,c=s.loader,l=new(u||c)(s);return i.loader=l,this.loaders[i.type]=l,l},d.getInternalLoader=function(i){return this.loaders[i.type]},d.resetInternalLoader=function(i){this.loaders[i]&&delete this.loaders[i]},d.destroyInternalLoaders=function(){for(var i in this.loaders){var s=this.loaders[i];s&&s.destroy(),this.resetInternalLoader(i)}},d.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},d.onManifestLoading=function(i,s){var u=s.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:x.PlaylistContextType.MANIFEST,url:u,deliveryDirectives:null})},d.onLevelLoading=function(i,s){var u=s.id,c=s.level,l=s.url,o=s.deliveryDirectives;this.load({id:u,groupId:null,level:c,responseType:"text",type:x.PlaylistContextType.LEVEL,url:l,deliveryDirectives:o})},d.onAudioTrackLoading=function(i,s){var u=s.id,c=s.groupId,l=s.url,o=s.deliveryDirectives;this.load({id:u,groupId:c,level:null,responseType:"text",type:x.PlaylistContextType.AUDIO_TRACK,url:l,deliveryDirectives:o})},d.onSubtitleTrackLoading=function(i,s){var u=s.id,c=s.groupId,l=s.url,o=s.deliveryDirectives;this.load({id:u,groupId:c,level:null,responseType:"text",type:x.PlaylistContextType.SUBTITLE_TRACK,url:l,deliveryDirectives:o})},d.load=function(i){var s,u,c,l,o,h,g=this.hls.config,p=this.getInternalLoader(i);if(p){var v=p.context;if(v&&v.url===i.url)return void O.logger.trace("[playlist-loader]: playlist request ongoing");O.logger.log("[playlist-loader]: aborting previous loader for type: "+i.type),p.abort()}switch(i.type){case x.PlaylistContextType.MANIFEST:u=g.manifestLoadingMaxRetry,c=g.manifestLoadingTimeOut,l=g.manifestLoadingRetryDelay,o=g.manifestLoadingMaxRetryTimeout;break;case x.PlaylistContextType.LEVEL:case x.PlaylistContextType.AUDIO_TRACK:case x.PlaylistContextType.SUBTITLE_TRACK:u=0,c=g.levelLoadingTimeOut;break;default:u=g.levelLoadingMaxRetry,c=g.levelLoadingTimeOut,l=g.levelLoadingRetryDelay,o=g.levelLoadingMaxRetryTimeout}if(p=this.createInternalLoader(i),(s=i.deliveryDirectives)!==null&&s!==void 0&&s.part&&(i.type===x.PlaylistContextType.LEVEL&&i.level!==null?h=this.hls.levels[i.level].details:i.type===x.PlaylistContextType.AUDIO_TRACK&&i.id!==null?h=this.hls.audioTracks[i.id].details:i.type===x.PlaylistContextType.SUBTITLE_TRACK&&i.id!==null&&(h=this.hls.subtitleTracks[i.id].details),h)){var S=h.partTarget,R=h.targetduration;S&&R&&(c=Math.min(1e3*Math.max(3*S,.8*R),c))}var k={timeout:c,maxRetry:u,retryDelay:l,maxRetryDelay:o,highWaterMark:0},M={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};p.load(i,k,M)},d.loadsuccess=function(i,s,u,c){c===void 0&&(c=null),this.resetInternalLoader(u.type);var l=i.data;l.indexOf("#EXTM3U")===0?(s.parsing.start=performance.now(),l.indexOf("#EXTINF:")>0||l.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(i,s,u,c):this.handleMasterPlaylist(i,s,u,c)):this.handleManifestParsingError(i,u,"no EXTM3U delimiter",c)},d.loaderror=function(i,s,u){u===void 0&&(u=null),this.handleNetworkError(s,u,!1,i)},d.loadtimeout=function(i,s,u){u===void 0&&(u=null),this.handleNetworkError(s,u,!0)},d.handleMasterPlaylist=function(i,s,u,c){var l=this.hls,o=i.data,h=j(i,u),g=q.parseMasterPlaylist(o,h),p=g.levels,v=g.sessionData,S=g.sessionKeys;if(p.length){var R=p.map(function(Z){return{id:Z.attrs.AUDIO,audioCodec:Z.audioCodec}}),k=p.map(function(Z){return{id:Z.attrs.SUBTITLES,textCodec:Z.textCodec}}),M=q.parseMasterPlaylistMedia(o,h,"AUDIO",R),V=q.parseMasterPlaylistMedia(o,h,"SUBTITLES",k),K=q.parseMasterPlaylistMedia(o,h,"CLOSED-CAPTIONS");M.length&&(M.some(function(Z){return!Z.url})||!p[0].audioCodec||p[0].attrs.AUDIO||(O.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),M.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ee({}),bitrate:0,url:""}))),l.trigger(b.Events.MANIFEST_LOADED,{levels:p,audioTracks:M,subtitles:V,captions:K,url:h,stats:s,networkDetails:c,sessionData:v,sessionKeys:S})}else this.handleManifestParsingError(i,u,"no level found in manifest",c)},d.handleTrackOrLevelPlaylist=function(i,s,u,c){var l=this.hls,o=u.id,h=u.level,g=u.type,p=j(i,u),v=(0,C.isFiniteNumber)(o)?o:0,S=(0,C.isFiniteNumber)(h)?h:v,R=function(V){switch(V.type){case x.PlaylistContextType.AUDIO_TRACK:return x.PlaylistLevelType.AUDIO;case x.PlaylistContextType.SUBTITLE_TRACK:return x.PlaylistLevelType.SUBTITLE;default:return x.PlaylistLevelType.MAIN}}(u),k=q.parseLevelPlaylist(i.data,p,S,R,v);if(k.fragments.length){if(g===x.PlaylistContextType.MANIFEST){var M={attrs:new ee({}),bitrate:0,details:k,name:"",url:p};l.trigger(b.Events.MANIFEST_LOADED,{levels:[M],audioTracks:[],url:p,stats:s,networkDetails:c,sessionData:null,sessionKeys:null})}s.parsing.end=performance.now(),u.levelDetails=k,this.handlePlaylistLoaded(i,s,u,c)}else l.trigger(b.Events.ERROR,{type:L.ErrorTypes.NETWORK_ERROR,details:L.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:p,reason:"no fragments found in level",level:typeof u.level=="number"?u.level:void 0})},d.handleManifestParsingError=function(i,s,u,c){this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.NETWORK_ERROR,details:L.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:s.type===x.PlaylistContextType.MANIFEST,url:i.url,reason:u,response:i,context:s,networkDetails:c})},d.handleNetworkError=function(i,s,u,c){u===void 0&&(u=!1),O.logger.warn("[playlist-loader]: A network "+(u?"timeout":"error")+" occurred while loading "+i.type+" level: "+i.level+" id: "+i.id+' group-id: "'+i.groupId+'"');var l=L.ErrorDetails.UNKNOWN,o=!1,h=this.getInternalLoader(i);switch(i.type){case x.PlaylistContextType.MANIFEST:l=u?L.ErrorDetails.MANIFEST_LOAD_TIMEOUT:L.ErrorDetails.MANIFEST_LOAD_ERROR,o=!0;break;case x.PlaylistContextType.LEVEL:l=u?L.ErrorDetails.LEVEL_LOAD_TIMEOUT:L.ErrorDetails.LEVEL_LOAD_ERROR,o=!1;break;case x.PlaylistContextType.AUDIO_TRACK:l=u?L.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:L.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,o=!1;break;case x.PlaylistContextType.SUBTITLE_TRACK:l=u?L.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:L.ErrorDetails.SUBTITLE_LOAD_ERROR,o=!1}h&&this.resetInternalLoader(i.type);var g={type:L.ErrorTypes.NETWORK_ERROR,details:l,fatal:o,url:i.url,loader:h,context:i,networkDetails:s};c&&(g.response=c),this.hls.trigger(b.Events.ERROR,g)},d.handlePlaylistLoaded=function(i,s,u,c){var l=u.type,o=u.level,h=u.id,g=u.groupId,p=u.loader,v=u.levelDetails,S=u.deliveryDirectives;if(v!=null&&v.targetduration){if(p)switch(v.live&&(p.getCacheAge&&(v.ageHeader=p.getCacheAge()||0),p.getCacheAge&&!isNaN(v.ageHeader)||(v.ageHeader=0)),l){case x.PlaylistContextType.MANIFEST:case x.PlaylistContextType.LEVEL:this.hls.trigger(b.Events.LEVEL_LOADED,{details:v,level:o||0,id:h||0,stats:s,networkDetails:c,deliveryDirectives:S});break;case x.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(b.Events.AUDIO_TRACK_LOADED,{details:v,id:h||0,groupId:g||"",stats:s,networkDetails:c,deliveryDirectives:S});break;case x.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(b.Events.SUBTITLE_TRACK_LOADED,{details:v,id:h||0,groupId:g||"",stats:s,networkDetails:c,deliveryDirectives:S})}}else this.handleManifestParsingError(i,u,"invalid target duration",c)},T}();function me(T,d){var i;try{i=new Event("addtrack")}catch{(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=T,d.dispatchEvent(i)}function Oe(T,d){var i=T.mode;if(i==="disabled"&&(T.mode="hidden"),T.cues&&!T.cues.getCueById(d.id))try{if(T.addCue(d),!T.cues.getCueById(d.id))throw new Error("addCue is failed for: "+d)}catch(u){O.logger.debug("[texttrack-utils]: "+u);var s=new self.TextTrackCue(d.startTime,d.endTime,d.text);s.id=d.id,T.addCue(s)}i==="disabled"&&(T.mode=i)}function Fe(T){var d=T.mode;if(d==="disabled"&&(T.mode="hidden"),T.cues)for(var i=T.cues.length;i--;)T.removeCue(T.cues[i]);d==="disabled"&&(T.mode=d)}function we(T,d,i,s){var u=T.mode;if(u==="disabled"&&(T.mode="hidden"),T.cues&&T.cues.length>0)for(var c=function(o,h,g){var p=[],v=function(M,V){if(V<M[0].startTime)return 0;var K=M.length-1;if(V>M[K].endTime)return-1;for(var Z=0,de=K;Z<=de;){var _e=Math.floor((de+Z)/2);if(V<M[_e].startTime)de=_e-1;else{if(!(V>M[_e].startTime&&Z<K))return _e;Z=_e+1}}return M[Z].startTime-V<V-M[de].startTime?Z:de}(o,h);if(v>-1)for(var S=v,R=o.length;S<R;S++){var k=o[S];if(k.startTime>=h&&k.endTime<=g)p.push(k);else if(k.startTime>g)return p}return p}(T.cues,d,i),l=0;l<c.length;l++)s&&!s(c[l])||T.removeCue(c[l]);u==="disabled"&&(T.mode=u)}var Ue=y(181),Ce=y(856);function Qe(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var He=function(){var T=Qe();try{new T(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function Ge(T,d){return T.getTime()/1e3-d}const et=function(){function T(i){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=i,this._registerListeners()}var d=T.prototype;return d.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},d._registerListeners=function(){var i=this.hls;i.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(b.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),i.on(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.on(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},d._unregisterListeners=function(){var i=this.hls;i.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(b.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),i.off(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.off(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},d.onMediaAttached=function(i,s){this.media=s.media},d.onMediaDetaching=function(){this.id3Track&&(Fe(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},d.onManifestLoading=function(){this.dateRangeCuesAppended={}},d.createTrack=function(i){var s=this.getID3Track(i.textTracks);return s.mode="hidden",s},d.getID3Track=function(i){if(this.media){for(var s=0;s<i.length;s++){var u=i[s];if(u.kind==="metadata"&&u.label==="id3")return me(u,this.media),u}return this.media.addTextTrack("metadata","id3")}},d.onFragParsingMetadata=function(i,s){if(this.media){var u=this.hls.config,c=u.enableEmsgMetadataCues,l=u.enableID3MetadataCues;if(c||l){var o=s.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var h=Qe(),g=0;g<o.length;g++){var p=o[g].type;if((p!==Ce.MetadataSchema.emsg||c)&&l){var v=Ue.getID3Frames(o[g].data);if(v){var S=o[g].pts,R=S+o[g].duration;R>He&&(R=He),R-S<=0&&(R=S+.25);for(var k=0;k<v.length;k++){var M=v[k];if(!Ue.isTimeStampFrame(M)){this.updateId3CueEnds(S);var V=new h(S,R,"");V.value=M,p&&(V.type=p),this.id3Track.addCue(V)}}}}}}}},d.updateId3CueEnds=function(i){var s,u=(s=this.id3Track)===null||s===void 0?void 0:s.cues;if(u)for(var c=u.length;c--;){var l=u[c];l.startTime<i&&l.endTime===He&&(l.endTime=i)}},d.onBufferFlushing=function(i,s){var u=s.startOffset,c=s.endOffset,l=s.type,o=this.id3Track,h=this.hls;if(h){var g=h.config,p=g.enableEmsgMetadataCues,v=g.enableID3MetadataCues;o&&(p||v)&&we(o,u,c,l==="audio"?function(S){return S.type===Ce.MetadataSchema.audioId3&&v}:l==="video"?function(S){return S.type===Ce.MetadataSchema.emsg&&p}:function(S){return S.type===Ce.MetadataSchema.audioId3&&v||S.type===Ce.MetadataSchema.emsg&&p})}},d.onLevelUpdated=function(i,s){var u=this,c=s.details;if(this.media&&c.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var l=this.dateRangeCuesAppended,o=this.id3Track,h=c.dateRanges,g=Object.keys(h);if(o)for(var p=Object.keys(l).filter(function(Z){return!g.includes(Z)}),v=function(Z){var de=p[Z];Object.keys(l[de].cues).forEach(function(_e){o.removeCue(l[de].cues[_e])}),delete l[de]},S=p.length;S--;)v(S);var R=c.fragments[c.fragments.length-1];if(g.length!==0&&(0,C.isFiniteNumber)(R==null?void 0:R.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var k=R.programDateTime/1e3-R.start,M=Qe(),V=function(Z){var de=g[Z],_e=h[de],Te=l[de],De=(Te==null?void 0:Te.cues)||{},ze=(Te==null?void 0:Te.durationKnown)||!1,st=Ge(_e.startDate,k),Se=He,Xe=_e.endDate;if(Xe)Se=Ge(Xe,k),ze=!0;else if(_e.endOnNext&&!ze){var Ve=g.reduce(function(Xt,Gt){var Qt=h[Gt];return Qt.class===_e.class&&Qt.id!==Gt&&Qt.startDate>_e.startDate&&Xt.push(Qt),Xt},[]).sort(function(Xt,Gt){return Xt.startDate.getTime()-Gt.startDate.getTime()})[0];Ve&&(Se=Ge(Ve.startDate,k),ze=!0)}for(var pt,kt=Object.keys(_e.attr),vt=0;vt<kt.length;vt++){var St=kt[vt];if(St!==_.ID&&St!==_.CLASS&&St!==_.START_DATE&&St!==_.DURATION&&St!==_.END_DATE&&St!==_.END_ON_NEXT){var Rt=De[St];if(Rt)ze&&!Te.durationKnown&&(Rt.endTime=Se);else{var $t=_e.attr[St];Rt=new M(st,Se,""),St!==_.SCTE35_OUT&&St!==_.SCTE35_IN||(pt=$t,$t=Uint8Array.from(pt.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),Rt.value={key:St,data:$t},Rt.type=Ce.MetadataSchema.dateRange,u.id3Track.addCue(Rt),De[St]=Rt}}}l[de]={cues:De,dateRange:_e,durationKnown:ze}},K=0;K<g.length;K++)V(K)}}},T}();function nt(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}var ht=function(){function T(u){var c=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return c.timeupdate()},this.hls=u,this.config=u.config,this.registerListeners()}var d,i,s=T.prototype;return s.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},s.registerListeners=function(){this.hls.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(b.Events.ERROR,this.onError,this)},s.unregisterListeners=function(){this.hls.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(b.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(b.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(b.Events.ERROR,this.onError)},s.onMediaAttached=function(u,c){this.media=c.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},s.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},s.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},s.onLevelUpdated=function(u,c){var l=c.details;this.levelDetails=l,l.advanced&&this.timeupdate(),!l.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},s.onError=function(u,c){c.details===L.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,O.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},s.timeupdate=function(){var u=this.media,c=this.levelDetails;if(u&&c){this.currentTime=u.currentTime;var l=this.computeLatency();if(l!==null){this._latency=l;var o=this.config,h=o.lowLatencyMode,g=o.maxLiveSyncPlaybackRate;if(h&&g!==1){var p=this.targetLatency;if(p!==null){var v=l-p,S=v<Math.min(this.maxLatency,p+c.targetduration);if(c.live&&S&&v>.05&&this.forwardBufferLength>1){var R=Math.min(2,Math.max(1,g)),k=Math.round(2/(1+Math.exp(-.75*v-this.edgeStalled))*20)/20;u.playbackRate=Math.min(R,Math.max(1,k))}else u.playbackRate!==1&&u.playbackRate!==0&&(u.playbackRate=1)}}}}},s.estimateLiveEdge=function(){var u=this.levelDetails;return u===null?null:u.edge+u.age},s.computeLatency=function(){var u=this.estimateLiveEdge();return u===null?null:u-this.currentTime},d=T,(i=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var u=this.config,c=this.levelDetails;return u.liveMaxLatencyDuration!==void 0?u.liveMaxLatencyDuration:c?u.liveMaxLatencyDurationCount*c.targetduration:0}},{key:"targetLatency",get:function(){var u=this.levelDetails;if(u===null)return null;var c=u.holdBack,l=u.partHoldBack,o=u.targetduration,h=this.config,g=h.liveSyncDuration,p=h.liveSyncDurationCount,v=h.lowLatencyMode,S=this.hls.userConfig,R=v&&l||c;(S.liveSyncDuration||S.liveSyncDurationCount||R===0)&&(R=g!==void 0?g:p*o);var k=o;return R+Math.min(1*this.stallCount,k)}},{key:"liveSyncPosition",get:function(){var u=this.estimateLiveEdge(),c=this.targetLatency,l=this.levelDetails;if(u===null||c===null||l===null)return null;var o=l.edge,h=u-c-this.edgeStalled,g=o-l.totalduration,p=o-(this.config.lowLatencyMode&&l.partTarget||l.targetduration);return Math.min(Math.max(g,h),p)}},{key:"drift",get:function(){var u=this.levelDetails;return u===null?1:u.drift}},{key:"edgeStalled",get:function(){var u=this.levelDetails;if(u===null)return 0;var c=3*(this.config.lowLatencyMode&&u.partTarget||u.targetduration);return Math.max(u.age-c,0)}},{key:"forwardBufferLength",get:function(){var u=this.media,c=this.levelDetails;if(!u||!c)return 0;var l=u.buffered.length;return(l?u.buffered.end(l-1):c.edge)-this.currentTime}}])&&nt(d.prototype,i),Object.defineProperty(d,"prototype",{writable:!1}),T}();function ft(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}var Tt,Bt=["NONE","TYPE-0","TYPE-1","TYPE-2",null];(function(T){T.No="",T.Yes="YES",T.v2="v2"})(Tt||(Tt={}));var ne=function(){function T(d,i,s){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=d,this.part=i,this.skip=s}return T.prototype.addDirectives=function(d){var i=new self.URL(d);return this.msn!==void 0&&i.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&i.searchParams.set("_HLS_part",this.part.toString()),this.skip&&i.searchParams.set("_HLS_skip",this.skip),i.href},T}(),W=function(){function T(s){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[s.url],this.attrs=s.attrs,this.bitrate=s.bitrate,s.details&&(this.details=s.details),this.id=s.id||0,this.name=s.name,this.width=s.width||0,this.height=s.height||0,this.audioCodec=s.audioCodec,this.videoCodec=s.videoCodec,this.unknownCodecs=s.unknownCodecs,this.codecSet=[s.videoCodec,s.audioCodec].filter(function(u){return u}).join(",").replace(/\.[^.,]+/g,"")}var d,i;return d=T,(i=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(s){var u=s%this.url.length;this._urlId!==u&&(this.details=void 0,this._urlId=u)}}])&&ft(d.prototype,i),Object.defineProperty(d,"prototype",{writable:!1}),T}();function D(){return D=Object.assign?Object.assign.bind():function(T){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(T[s]=i[s])}return T},D.apply(this,arguments)}function G(T,d,i){switch(d){case"audio":T.audioGroupIds||(T.audioGroupIds=[]),T.audioGroupIds.push(i);break;case"text":T.textGroupIds||(T.textGroupIds=[]),T.textGroupIds.push(i)}}function H(T){var d={};T.forEach(function(i){var s=i.groupId||"";i.id=d[s]=d[s]||0,d[s]++})}function X(T,d){var i=d.startPTS;if((0,C.isFiniteNumber)(i)){var s,u=0;d.sn>T.sn?(u=i-T.start,s=T):(u=T.start-i,s=d),s.duration!==u&&(s.duration=u)}else d.sn>T.sn?T.cc===d.cc&&T.minEndPTS?d.start=T.start+(T.minEndPTS-T.start):d.start=T.start+T.duration:d.start=Math.max(T.start-d.duration,0)}function te(T,d,i,s,u,c){s-i<=0&&(O.logger.warn("Fragment should have a positive duration",d),s=i+d.duration,c=u+d.duration);var l=i,o=s,h=d.startPTS,g=d.endPTS;if((0,C.isFiniteNumber)(h)){var p=Math.abs(h-i);(0,C.isFiniteNumber)(d.deltaPTS)?d.deltaPTS=Math.max(p,d.deltaPTS):d.deltaPTS=p,l=Math.max(i,h),i=Math.min(i,h),u=Math.min(u,d.startDTS),o=Math.min(s,g),s=Math.max(s,g),c=Math.max(c,d.endDTS)}d.duration=s-i;var v=i-d.start;d.start=d.startPTS=i,d.maxStartPTS=l,d.startDTS=u,d.endPTS=s,d.minEndPTS=o,d.endDTS=c;var S,R=d.sn;if(!T||R<T.startSN||R>T.endSN)return 0;var k=R-T.startSN,M=T.fragments;for(M[k]=d,S=k;S>0;S--)X(M[S],M[S-1]);for(S=k;S<M.length-1;S++)X(M[S],M[S+1]);return T.fragmentHint&&X(M[M.length-1],T.fragmentHint),T.PTSKnown=T.alignedSliding=!0,v}function ae(T,d){var i=d.startSN+d.skippedSegments-T.startSN,s=T.fragments;i<0||i>=s.length||ye(d,s[i].start)}function ye(T,d){if(d){for(var i=T.fragments,s=T.skippedSegments;s<i.length;s++)i[s].start+=d;T.fragmentHint&&(T.fragmentHint.start+=d)}}var xe=function(){function T(i,s){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=O.logger.log.bind(O.logger,s+":"),this.warn=O.logger.warn.bind(O.logger,s+":"),this.hls=i}var d=T.prototype;return d.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},d.onError=function(i,s){!s.fatal||s.type!==L.ErrorTypes.NETWORK_ERROR&&s.type!==L.ErrorTypes.KEY_SYSTEM_ERROR||this.stopLoad()},d.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},d.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.requestScheduled=-1,this.loadPlaylist()},d.stopLoad=function(){this.canLoad=!1,this.clearTimer()},d.switchParams=function(i,s){var u=s==null?void 0:s.renditionReports;if(u)for(var c=0;c<u.length;c++){var l=u[c],o=void 0;try{o=new self.URL(l.URI,s.url).href}catch(v){O.logger.warn("Could not construct new URL for Rendition Report: "+v),o=l.URI||""}if(o===i.slice(-o.length)){var h=parseInt(l["LAST-MSN"])||(s==null?void 0:s.lastPartSn),g=parseInt(l["LAST-PART"])||(s==null?void 0:s.lastPartIndex);if(this.hls.config.lowLatencyMode){var p=Math.min(s.age-s.partTarget,s.targetduration);g>=0&&p>s.partTarget&&(g+=1)}return new ne(h,g>=0?g:void 0,Tt.No)}}},d.loadPlaylist=function(i){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())},d.shouldLoadTrack=function(i){return this.canLoad&&i&&!!i.url&&(!i.details||i.details.live)},d.playlistLoaded=function(i,s,u){var c=this,l=s.details,o=s.stats,h=self.performance.now(),g=o.loading.first?Math.max(0,h-o.loading.first):0;if(l.advancedDateTime=Date.now()-g,l.live||u!=null&&u.live){if(l.reloaded(u),u&&this.log("live playlist "+i+" "+(l.advanced?"REFRESHED "+l.lastPartSn+"-"+l.lastPartIndex:"MISSED")),u&&l.fragments.length>0&&function(Xe,Ve){for(var pt=null,kt=Xe.fragments,vt=kt.length-1;vt>=0;vt--){var St=kt[vt].initSegment;if(St){pt=St;break}}Xe.fragmentHint&&delete Xe.fragmentHint.endPTS;var Rt,$t,Xt,Gt,Qt,Er=0;if(function(lt,bt,Jn){for(var Jr=bt.skippedSegments,Br=Math.max(lt.startSN,bt.startSN)-bt.startSN,Zn=(lt.fragmentHint?1:0)+(Jr?bt.endSN:Math.min(lt.endSN,bt.endSN))-bt.startSN,Rr=bt.startSN-lt.startSN,Zr=bt.fragmentHint?bt.fragments.concat(bt.fragmentHint):bt.fragments,ln=lt.fragmentHint?lt.fragments.concat(lt.fragmentHint):lt.fragments,br=Br;br<=Zn;br++){var hn=ln[Rr+br],_s=Zr[br];Jr&&!_s&&br<Jr&&(_s=bt.fragments[br]=hn),hn&&_s&&Jn(hn,_s)}}(Xe,Ve,function(lt,bt){lt.relurl&&(Er=lt.cc-bt.cc),(0,C.isFiniteNumber)(lt.startPTS)&&(0,C.isFiniteNumber)(lt.endPTS)&&(bt.start=bt.startPTS=lt.startPTS,bt.startDTS=lt.startDTS,bt.appendedPTS=lt.appendedPTS,bt.maxStartPTS=lt.maxStartPTS,bt.endPTS=lt.endPTS,bt.endDTS=lt.endDTS,bt.minEndPTS=lt.minEndPTS,bt.duration=lt.endPTS-lt.startPTS,bt.duration&&(Rt=bt),Ve.PTSKnown=Ve.alignedSliding=!0),bt.elementaryStreams=lt.elementaryStreams,bt.loader=lt.loader,bt.stats=lt.stats,bt.urlId=lt.urlId,lt.initSegment&&(bt.initSegment=lt.initSegment,pt=lt.initSegment)}),pt&&(Ve.fragmentHint?Ve.fragments.concat(Ve.fragmentHint):Ve.fragments).forEach(function(lt){var bt;lt.initSegment&&lt.initSegment.relurl!==((bt=pt)===null||bt===void 0?void 0:bt.relurl)||(lt.initSegment=pt)}),Ve.skippedSegments)if(Ve.deltaUpdateFailed=Ve.fragments.some(function(lt){return!lt}),Ve.deltaUpdateFailed){O.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var po=Ve.skippedSegments;po--;)Ve.fragments.shift();Ve.startSN=Ve.fragments[0].sn,Ve.startCC=Ve.fragments[0].cc}else Ve.canSkipDateRanges&&(Ve.dateRanges=($t=Xe.dateRanges,Xt=Ve.dateRanges,Gt=Ve.recentlyRemovedDateranges,Qt=D({},$t),Gt&&Gt.forEach(function(lt){delete Qt[lt]}),Object.keys(Xt).forEach(function(lt){var bt=new fe(Xt[lt].attr,Qt[lt]);bt.isValid?Qt[lt]=bt:O.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(Xt[lt].attr)+'"')}),Qt));var Fr=Ve.fragments;if(Er){O.logger.warn("discontinuity sliding from playlist, take drift into account");for(var Oi=0;Oi<Fr.length;Oi++)Fr[Oi].cc+=Er}Ve.skippedSegments&&(Ve.startCC=Ve.fragments[0].cc),function(lt,bt,Jn){if(lt&&bt)for(var Jr=0,Br=0,Zn=lt.length;Br<=Zn;Br++){var Rr=lt[Br],Zr=bt[Br+Jr];Rr&&Zr&&Rr.index===Zr.index&&Rr.fragment.sn===Zr.fragment.sn?(ln=Rr,(br=Zr).elementaryStreams=ln.elementaryStreams,br.stats=ln.stats):Jr--}var ln,br}(Xe.partList,Ve.partList),Rt?te(Ve,Rt,Rt.startPTS,Rt.endPTS,Rt.startDTS,Rt.endDTS):ae(Xe,Ve),Fr.length&&(Ve.totalduration=Ve.edge-Fr[0].start),Ve.driftStartTime=Xe.driftStartTime,Ve.driftStart=Xe.driftStart;var xi=Ve.advancedDateTime;if(Ve.advanced&&xi){var ki=Ve.edge;Ve.driftStart||(Ve.driftStartTime=xi,Ve.driftStart=ki),Ve.driftEndTime=xi,Ve.driftEnd=ki}else Ve.driftEndTime=Xe.driftEndTime,Ve.driftEnd=Xe.driftEnd,Ve.advancedDateTime=Xe.advancedDateTime}(u,l),!this.canLoad||!l.live)return;var p,v=void 0,S=void 0;if(l.canBlockReload&&l.endSN&&l.advanced){var R=this.hls.config.lowLatencyMode,k=l.lastPartSn,M=l.endSN,V=l.lastPartIndex,K=k===M;V!==-1?(v=K?M+1:k,S=K?R?0:V:V+1):v=M+1;var Z=l.age,de=Z+l.ageHeader,_e=Math.min(de-l.partTarget,1.5*l.targetduration);if(_e>0){if(u&&_e>u.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+u.tuneInGoal+" to: "+_e+" with playlist age: "+l.age),_e=0;else{var Te=Math.floor(_e/l.targetduration);v+=Te,S!==void 0&&(S+=Math.round(_e%l.targetduration/l.partTarget)),this.log("CDN Tune-in age: "+l.ageHeader+"s last advanced "+Z.toFixed(2)+"s goal: "+_e+" skip sn "+Te+" to part "+S)}l.tuneInGoal=_e}if(p=this.getDeliveryDirectives(l,s.deliveryDirectives,v,S),R||!K)return void this.loadPlaylist(p)}else p=this.getDeliveryDirectives(l,s.deliveryDirectives,v,S);var De=this.hls.mainForwardBufferInfo,ze=De?De.end-De.len:0,st=function(Xe,Ve){Ve===void 0&&(Ve=1/0);var pt=1e3*Xe.targetduration;if(Xe.updated){var kt=Xe.fragments;if(kt.length&&4*pt>Ve){var vt=1e3*kt[kt.length-1].duration;vt<pt&&(pt=vt)}}else pt/=2;return Math.round(pt)}(l,1e3*(l.edge-ze));l.updated?h>this.requestScheduled+st&&(this.requestScheduled=o.loading.start):this.requestScheduled=-1,v!==void 0&&l.canBlockReload?this.requestScheduled=o.loading.first+st-(1e3*l.partTarget||1e3):this.requestScheduled=(this.requestScheduled===-1?h:this.requestScheduled)+st;var Se=this.requestScheduled-h;Se=Math.max(0,Se),this.log("reload live playlist "+i+" in "+Math.round(Se)+" ms"),this.timer=self.setTimeout(function(){return c.loadPlaylist(p)},Se)}else this.clearTimer()},d.getDeliveryDirectives=function(i,s,u,c){var l=function(o,h){var g=o.canSkipUntil,p=o.canSkipDateRanges,v=o.endSN;return g&&(h!==void 0?h-v:0)<g?p?Tt.v2:Tt.Yes:Tt.No}(i,u);return s!=null&&s.skip&&i.deltaUpdateFailed&&(u=s.msn,c=s.part,l=Tt.No),new ne(u,c,l)},d.retryLoadingOrFail=function(i){var s,u=this,c=this.hls.config,l=this.retryCount<c.levelLoadingMaxRetry;if(l)if(this.requestScheduled=-1,this.retryCount++,i.details.indexOf("LoadTimeOut")>-1&&(s=i.context)!==null&&s!==void 0&&s.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+i.details+'"'),this.loadPlaylist();else{var o=Math.min(Math.pow(2,this.retryCount)*c.levelLoadingRetryDelay,c.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return u.loadPlaylist()},o),this.warn("retry playlist loading #"+this.retryCount+" in "+o+' ms after "'+i.details+'"')}else this.warn('cannot recover from error "'+i.details+'"'),this.clearTimer(),i.fatal=!0;return l},T}();function Me(){return Me=Object.assign?Object.assign.bind():function(T){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(T[s]=i[s])}return T},Me.apply(this,arguments)}function Ke(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}function tt(T,d){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},tt(T,d)}var qe,at=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),mt=function(T){var d,i;function s(o){var h;return(h=T.call(this,o,"[level-controller]")||this)._levels=[],h._firstLevel=-1,h._startLevel=void 0,h.currentLevelIndex=-1,h.manualLevelIndex=-1,h.onParsedComplete=void 0,h._registerListeners(),h}i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,tt(d,i);var u,c,l=s.prototype;return l._registerListeners=function(){var o=this.hls;o.on(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(b.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(b.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(b.Events.ERROR,this.onError,this)},l._unregisterListeners=function(){var o=this.hls;o.off(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(b.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(b.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(b.Events.ERROR,this.onError,this)},l.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,T.prototype.destroy.call(this)},l.startLoad=function(){this._levels.forEach(function(o){o.loadError=0}),T.prototype.startLoad.call(this)},l.onManifestLoaded=function(o,h){var g,p,v=[],S=[],R=[],k={},M=!1,V=!1,K=!1;if(h.levels.forEach(function(Te){var De=Te.attrs;M=M||!(!Te.width||!Te.height),V=V||!!Te.videoCodec,K=K||!!Te.audioCodec,at&&Te.audioCodec&&Te.audioCodec.indexOf("mp4a.40.34")!==-1&&(Te.audioCodec=void 0);var ze=Te.bitrate+"-"+Te.attrs.RESOLUTION+"-"+Te.attrs.CODECS;(p=k[ze])?p.url.push(Te.url):(p=new W(Te),k[ze]=p,v.push(p)),De&&(De.AUDIO&&G(p,"audio",De.AUDIO),De.SUBTITLES&&G(p,"text",De.SUBTITLES))}),(M||V)&&K&&(v=v.filter(function(Te){var De=Te.videoCodec,ze=Te.width,st=Te.height;return!!De||!(!ze||!st)})),v=v.filter(function(Te){var De=Te.audioCodec,ze=Te.videoCodec;return(!De||$e(De,"audio"))&&(!ze||$e(ze,"video"))}),h.audioTracks&&H(S=h.audioTracks.filter(function(Te){return!Te.audioCodec||$e(Te.audioCodec,"audio")})),h.subtitles&&H(R=h.subtitles),v.length>0){g=v[0].bitrate,v.sort(function(Te,De){return Te.attrs["HDCP-LEVEL"]!==De.attrs["HDCP-LEVEL"]?(Te.attrs["HDCP-LEVEL"]||"")>(De.attrs["HDCP-LEVEL"]||"")?1:-1:Te.bitrate!==De.bitrate?Te.bitrate-De.bitrate:Te.attrs.SCORE!==De.attrs.SCORE?Te.attrs.decimalFloatingPoint("SCORE")-De.attrs.decimalFloatingPoint("SCORE"):M&&Te.height!==De.height?Te.height-De.height:0}),this._levels=v;for(var Z=0;Z<v.length;Z++)if(v[Z].bitrate===g){this._firstLevel=Z,this.log("manifest loaded, "+v.length+" level(s) found, first bitrate: "+g);break}var de=K&&!V,_e={levels:v,audioTracks:S,subtitleTracks:R,sessionData:h.sessionData,sessionKeys:h.sessionKeys,firstLevel:this._firstLevel,stats:h.stats,audio:K,video:V,altAudio:!de&&S.some(function(Te){return!!Te.url})};this.hls.trigger(b.Events.MANIFEST_PARSED,_e),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:h.url,reason:"no level with compatible codecs found in manifest"})},l.onError=function(o,h){var g,p;if(T.prototype.onError.call(this,o,h),!h.fatal){var v=h.context,S=this._levels[this.currentLevelIndex];if(v&&(v.type===x.PlaylistContextType.AUDIO_TRACK&&S.audioGroupIds&&v.groupId===S.audioGroupIds[S.urlId]||v.type===x.PlaylistContextType.SUBTITLE_TRACK&&S.textGroupIds&&v.groupId===S.textGroupIds[S.urlId]))this.redundantFailover(this.currentLevelIndex);else{var R,k=!1,M=!0;switch(h.details){case L.ErrorDetails.FRAG_LOAD_ERROR:case L.ErrorDetails.FRAG_LOAD_TIMEOUT:case L.ErrorDetails.KEY_LOAD_ERROR:case L.ErrorDetails.KEY_LOAD_TIMEOUT:if(h.frag){var V=h.frag.type===x.PlaylistLevelType.MAIN?h.frag.level:this.currentLevelIndex,K=this._levels[V];K?(K.fragmentError++,K.fragmentError>this.hls.config.fragLoadingMaxRetry&&(R=V)):R=V}break;case L.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var Z=S.attrs["HDCP-LEVEL"];Z&&(this.hls.maxHdcpLevel=Bt[Bt.indexOf(Z)-1],this.warn('Restricting playback to HDCP-LEVEL of "'+this.hls.maxHdcpLevel+'" or lower'));case L.ErrorDetails.FRAG_PARSING_ERROR:case L.ErrorDetails.KEY_SYSTEM_NO_SESSION:R=((g=h.frag)===null||g===void 0?void 0:g.type)===x.PlaylistLevelType.MAIN?h.frag.level:this.currentLevelIndex,h.levelRetry=!1;break;case L.ErrorDetails.LEVEL_LOAD_ERROR:case L.ErrorDetails.LEVEL_LOAD_TIMEOUT:v&&(v.deliveryDirectives&&(M=!1),R=v.level),k=!0;break;case L.ErrorDetails.REMUX_ALLOC_ERROR:R=(p=h.level)!=null?p:this.currentLevelIndex,k=!0}R!==void 0&&this.recoverLevel(h,R,k,M)}}},l.recoverLevel=function(o,h,g,p){var v=o.details,S=this._levels[h];if(S.loadError++,g){if(!this.retryLoadingOrFail(o))return void(this.currentLevelIndex=-1);o.levelRetry=!0}if(p){var R=S.url.length;if(R>1&&S.loadError<R)o.levelRetry=!0,this.redundantFailover(h);else if(this.manualLevelIndex===-1){for(var k=-1,M=this._levels,V=M.length;V--;){var K=(V+this.currentLevelIndex)%M.length;if(K!==this.currentLevelIndex&&M[K].loadError===0){k=K;break}}k>-1&&this.currentLevelIndex!==k?(this.warn(v+": switch to "+k),o.levelRetry=!0,this.hls.nextAutoLevel=k):o.levelRetry===!1&&(o.fatal=!0)}}},l.redundantFailover=function(o){var h=this._levels[o],g=h.url.length;if(g>1){var p=(h.urlId+1)%g;this.warn("Switching to redundant URL-id "+p),this._levels.forEach(function(v){v.urlId=p}),this.level=o}},l.onFragLoaded=function(o,h){var g=h.frag;if(g!==void 0&&g.type===x.PlaylistLevelType.MAIN){var p=this._levels[g.level];p!==void 0&&(p.fragmentError=0,p.loadError=0)}},l.onLevelLoaded=function(o,h){var g,p,v=h.level,S=h.details,R=this._levels[v];if(!R)return this.warn("Invalid level index "+v),void((p=h.deliveryDirectives)!==null&&p!==void 0&&p.skip&&(S.deltaUpdateFailed=!0));v===this.currentLevelIndex?(R.fragmentError===0&&(R.loadError=0,this.retryCount=0),this.playlistLoaded(v,h,R.details)):(g=h.deliveryDirectives)!==null&&g!==void 0&&g.skip&&(S.deltaUpdateFailed=!0)},l.onAudioTrackSwitched=function(o,h){var g=this.hls.levels[this.currentLevelIndex];if(g&&g.audioGroupIds){for(var p=-1,v=this.hls.audioTracks[h.id].groupId,S=0;S<g.audioGroupIds.length;S++)if(g.audioGroupIds[S]===v){p=S;break}p!==g.urlId&&(g.urlId=p,this.startLoad())}},l.loadPlaylist=function(o){T.prototype.loadPlaylist.call(this);var h=this.currentLevelIndex,g=this._levels[h];if(this.canLoad&&g&&g.url.length>0){var p=g.urlId,v=g.url[p];if(o)try{v=o.addDirectives(v)}catch(S){this.warn("Could not construct new URL with HLS Delivery Directives: "+S)}this.log("Attempt loading level index "+h+(o?" at sn "+o.msn+" part "+o.part:"")+" with URL-id "+p+" "+v),this.clearTimer(),this.hls.trigger(b.Events.LEVEL_LOADING,{url:v,level:h,id:p,deliveryDirectives:o||null})}},l.removeLevel=function(o,h){var g=function(v,S){return S!==h},p=this._levels.filter(function(v,S){return S!==o||v.url.length>1&&h!==void 0&&(v.url=v.url.filter(g),v.audioGroupIds&&(v.audioGroupIds=v.audioGroupIds.filter(g)),v.textGroupIds&&(v.textGroupIds=v.textGroupIds.filter(g)),v.urlId=0,!0)}).map(function(v,S){var R=v.details;return R!=null&&R.fragments&&R.fragments.forEach(function(k){k.level=S}),v});this._levels=p,this.hls.trigger(b.Events.LEVELS_UPDATED,{levels:p})},u=s,(c=[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(o){var h,g=this._levels;if(g.length!==0&&(this.currentLevelIndex!==o||(h=g[o])===null||h===void 0||!h.details)){if(o<0||o>=g.length){var p=o<0;if(this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.OTHER_ERROR,details:L.ErrorDetails.LEVEL_SWITCH_ERROR,level:o,fatal:p,reason:"invalid level idx"}),p)return;o=Math.min(o,g.length-1)}this.clearTimer();var v=this.currentLevelIndex,S=g[v],R=g[o];this.log("switching to level "+o+" from "+v),this.currentLevelIndex=o;var k=Me({},R,{level:o,maxBitrate:R.maxBitrate,uri:R.uri,urlId:R.urlId});delete k._urlId,this.hls.trigger(b.Events.LEVEL_SWITCHING,k);var M=R.details;if(!M||M.live){var V=this.switchParams(R.uri,S==null?void 0:S.details);this.loadPlaylist(V)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(o){this.manualLevelIndex=o,this._startLevel===void 0&&(this._startLevel=o),o!==-1&&(this.level=o)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(o){this._firstLevel=o}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var o=this.hls.config.startLevel;return o!==void 0?o:this._firstLevel}return this._startLevel},set:function(o){this._startLevel=o}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(o){this.level=o,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=o)}}])&&Ke(u.prototype,c),Object.defineProperty(u,"prototype",{writable:!1}),s}(xe);(function(T){T.NOT_LOADED="NOT_LOADED",T.APPENDING="APPENDING",T.PARTIAL="PARTIAL",T.OK="OK"})(qe||(qe={}));var Lt=function(){function T(i){this.activeFragment=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=i,this._registerListeners()}var d=T.prototype;return d._registerListeners=function(){var i=this.hls;i.on(b.Events.BUFFER_APPENDED,this.onBufferAppended,this),i.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this),i.on(b.Events.FRAG_LOADED,this.onFragLoaded,this)},d._unregisterListeners=function(){var i=this.hls;i.off(b.Events.BUFFER_APPENDED,this.onBufferAppended,this),i.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this),i.off(b.Events.FRAG_LOADED,this.onFragLoaded,this)},d.destroy=function(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.activeFragment=this.activeParts=null},d.getAppendedFrag=function(i,s){if(s===x.PlaylistLevelType.MAIN){var u=this.activeFragment,c=this.activeParts;if(!u)return null;if(c)for(var l=c.length;l--;){var o=c[l],h=o?o.end:u.appendedPTS;if(o.start<=i&&h!==void 0&&i<=h)return l>9&&(this.activeParts=c.slice(l-9)),o}else if(u.start<=i&&u.appendedPTS!==void 0&&i<=u.appendedPTS)return u}return this.getBufferedFrag(i,s)},d.getBufferedFrag=function(i,s){for(var u=this.fragments,c=Object.keys(u),l=c.length;l--;){var o=u[c[l]];if((o==null?void 0:o.body.type)===s&&o.buffered){var h=o.body;if(h.start<=i&&i<=h.end)return h}}return null},d.detectEvictedFragments=function(i,s,u){var c=this;this.timeRanges&&(this.timeRanges[i]=s),Object.keys(this.fragments).forEach(function(l){var o=c.fragments[l];if(o)if(o.buffered||o.loaded){var h=o.range[i];h&&h.time.some(function(g){var p=!c.isTimeBuffered(g.startPTS,g.endPTS,s);return p&&c.removeFragment(o.body),p})}else o.body.type===u&&c.removeFragment(o.body)})},d.detectPartialFragments=function(i){var s=this,u=this.timeRanges,c=i.frag,l=i.part;if(u&&c.sn!=="initSegment"){var o=Ot(c),h=this.fragments[o];h&&(Object.keys(u).forEach(function(g){var p=c.elementaryStreams[g];if(p){var v=u[g],S=l!==null||p.partial===!0;h.range[g]=s.getBufferedTimes(c,l,S,v)}}),h.loaded=null,Object.keys(h.range).length?(h.buffered=!0,h.body.endList&&(this.endListFragments[h.body.type]=h)):this.removeFragment(h.body))}},d.fragBuffered=function(i){var s=Ot(i),u=this.fragments[s];u&&(u.loaded=null,u.buffered=!0)},d.getBufferedTimes=function(i,s,u,c){for(var l={time:[],partial:u},o=s?s.start:i.start,h=s?s.end:i.end,g=i.minEndPTS||h,p=i.maxStartPTS||o,v=0;v<c.length;v++){var S=c.start(v)-this.bufferPadding,R=c.end(v)+this.bufferPadding;if(p>=S&&g<=R){l.time.push({startPTS:Math.max(o,c.start(v)),endPTS:Math.min(h,c.end(v))});break}if(o<R&&h>S)l.partial=!0,l.time.push({startPTS:Math.max(o,c.start(v)),endPTS:Math.min(h,c.end(v))});else if(h<=S)break}return l},d.getPartialFragment=function(i){var s,u,c,l=null,o=0,h=this.bufferPadding,g=this.fragments;return Object.keys(g).forEach(function(p){var v=g[p];v&&it(v)&&(u=v.body.start-h,c=v.body.end+h,i>=u&&i<=c&&(s=Math.min(i-u,c-i),o<=s&&(l=v.body,o=s)))}),l},d.isEndListAppended=function(i){var s=this.endListFragments[i];return s!==void 0&&(s.buffered||it(s))},d.getState=function(i){var s=Ot(i),u=this.fragments[s];return u?u.buffered?it(u)?qe.PARTIAL:qe.OK:qe.APPENDING:qe.NOT_LOADED},d.isTimeBuffered=function(i,s,u){for(var c,l,o=0;o<u.length;o++){if(c=u.start(o)-this.bufferPadding,l=u.end(o)+this.bufferPadding,i>=c&&s<=l)return!0;if(s<=c)return!1}return!1},d.onFragLoaded=function(i,s){var u=s.frag,c=s.part;if(u.sn!=="initSegment"&&!u.bitrateTest&&!c){var l=Ot(u);this.fragments[l]={body:u,loaded:s,buffered:!1,range:Object.create(null)}}},d.onBufferAppended=function(i,s){var u=this,c=s.frag,l=s.part,o=s.timeRanges;if(c.type===x.PlaylistLevelType.MAIN)if(this.activeFragment!==c&&(this.activeFragment=c,c.appendedPTS=void 0),l){var h=this.activeParts;h||(this.activeParts=h=[]),h.push(l)}else this.activeParts=null;this.timeRanges=o,Object.keys(o).forEach(function(g){var p=o[g];if(u.detectEvictedFragments(g,p),!l&&c.type===x.PlaylistLevelType.MAIN){var v=c.elementaryStreams[g];if(!v)return;for(var S=0;S<p.length;S++){var R=p.end(S);R<=v.endPTS&&R>v.startPTS?c.appendedPTS=Math.max(R,c.appendedPTS||0):c.appendedPTS=v.endPTS}}})},d.onFragBuffered=function(i,s){this.detectPartialFragments(s)},d.hasFragment=function(i){var s=Ot(i);return!!this.fragments[s]},d.removeFragmentsInRange=function(i,s,u){var c=this;Object.keys(this.fragments).forEach(function(l){var o=c.fragments[l];if(o&&o.buffered){var h=o.body;h.type===u&&h.start<s&&h.end>i&&c.removeFragment(h)}})},d.removeFragment=function(i){var s=Ot(i);i.stats.loaded=0,i.clearElementaryStreamInfo(),i.appendedPTS=void 0,delete this.fragments[s],i.endList&&delete this.endListFragments[i.type]},d.removeAllFragments=function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activeFragment=null,this.activeParts=null},T}();function it(T){var d,i;return T.buffered&&(((d=T.range.video)===null||d===void 0?void 0:d.partial)||((i=T.range.audio)===null||i===void 0?void 0:i.partial))}function Ot(T){return T.type+"_"+T.level+"_"+T.urlId+"_"+T.sn}function tr(T){var d=typeof Map=="function"?new Map:void 0;return tr=function(i){if(i===null||(s=i,Function.toString.call(s).indexOf("[native code]")===-1))return i;var s;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(d!==void 0){if(d.has(i))return d.get(i);d.set(i,u)}function u(){return jt(i,arguments,ot(this).constructor)}return u.prototype=Object.create(i.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),Wt(u,i)},tr(T)}function jt(T,d,i){return jt=Ft()?Reflect.construct.bind():function(s,u,c){var l=[null];l.push.apply(l,u);var o=new(Function.bind.apply(s,l));return c&&Wt(o,c.prototype),o},jt.apply(null,arguments)}function Ft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wt(T,d){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Wt(T,d)}function ot(T){return ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(d){return d.__proto__||Object.getPrototypeOf(d)},ot(T)}var cr=Math.pow(2,17),$r=function(){function T(i){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=i}var d=T.prototype;return d.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},d.abort=function(){this.loader&&this.loader.abort()},d.load=function(i,s){var u=this,c=i.url;if(!c)return Promise.reject(new zt({type:L.ErrorTypes.NETWORK_ERROR,details:L.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:i,networkDetails:null},"Fragment does not have a "+(c?"part list":"url")));this.abort();var l=this.config,o=l.fLoader,h=l.loader;return new Promise(function(g,p){u.loader&&u.loader.destroy();var v=u.loader=i.loader=o?new o(l):new h(l),S=Vt(i),R={timeout:l.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:l.fragLoadingMaxRetryTimeout,highWaterMark:i.sn==="initSegment"?1/0:cr};i.stats=v.stats,v.load(S,R,{onSuccess:function(k,M,V,K){u.resetLoader(i,v);var Z=k.data;V.resetIV&&i.decryptdata&&(i.decryptdata.iv=new Uint8Array(Z.slice(0,16)),Z=Z.slice(16)),g({frag:i,part:null,payload:Z,networkDetails:K})},onError:function(k,M,V){u.resetLoader(i,v),p(new zt({type:L.ErrorTypes.NETWORK_ERROR,details:L.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:i,response:k,networkDetails:V}))},onAbort:function(k,M,V){u.resetLoader(i,v),p(new zt({type:L.ErrorTypes.NETWORK_ERROR,details:L.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:i,networkDetails:V}))},onTimeout:function(k,M,V){u.resetLoader(i,v),p(new zt({type:L.ErrorTypes.NETWORK_ERROR,details:L.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:i,networkDetails:V}))},onProgress:function(k,M,V,K){s&&s({frag:i,part:null,payload:V,networkDetails:K})}})})},d.loadPart=function(i,s,u){var c=this;this.abort();var l=this.config,o=l.fLoader,h=l.loader;return new Promise(function(g,p){c.loader&&c.loader.destroy();var v=c.loader=i.loader=o?new o(l):new h(l),S=Vt(i,s),R={timeout:l.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:l.fragLoadingMaxRetryTimeout,highWaterMark:cr};s.stats=v.stats,v.load(S,R,{onSuccess:function(k,M,V,K){c.resetLoader(i,v),c.updateStatsFromPart(i,s);var Z={frag:i,part:s,payload:k.data,networkDetails:K};u(Z),g(Z)},onError:function(k,M,V){c.resetLoader(i,v),p(new zt({type:L.ErrorTypes.NETWORK_ERROR,details:L.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:i,part:s,response:k,networkDetails:V}))},onAbort:function(k,M,V){i.stats.aborted=s.stats.aborted,c.resetLoader(i,v),p(new zt({type:L.ErrorTypes.NETWORK_ERROR,details:L.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:i,part:s,networkDetails:V}))},onTimeout:function(k,M,V){c.resetLoader(i,v),p(new zt({type:L.ErrorTypes.NETWORK_ERROR,details:L.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:i,part:s,networkDetails:V}))}})})},d.updateStatsFromPart=function(i,s){var u=i.stats,c=s.stats,l=c.total;if(u.loaded+=c.loaded,l){var o=Math.round(i.duration/s.duration),h=Math.min(Math.round(u.loaded/l),o),g=(o-h)*Math.round(u.loaded/h);u.total=u.loaded+g}else u.total=Math.max(u.loaded,u.total);var p=u.loading,v=c.loading;p.start?p.first+=v.first-v.start:(p.start=v.start,p.first=v.first),p.end=v.end},d.resetLoader=function(i,s){i.loader=null,this.loader===s&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),s.destroy()},T}();function Vt(T,d){d===void 0&&(d=null);var i=d||T,s={frag:T,part:d,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},u=i.byteRangeStartOffset,c=i.byteRangeEndOffset;if((0,C.isFiniteNumber)(u)&&(0,C.isFiniteNumber)(c)){var l,o=u,h=c;if(T.sn==="initSegment"&&((l=T.decryptdata)===null||l===void 0?void 0:l.method)==="AES-128"){var g=c-u;g%16&&(h=c+(16-g%16)),u!==0&&(s.resetIV=!0,o=u-16)}s.rangeStart=o,s.rangeEnd=h}return s}var zt=function(T){var d,i;function s(u){for(var c,l=arguments.length,o=new Array(l>1?l-1:0),h=1;h<l;h++)o[h-1]=arguments[h];return(c=T.call.apply(T,[this].concat(o))||this).data=void 0,c.data=u,c}return i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,Wt(d,i),s}(tr(Error)),Sr=function(){function T(i){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=i}var d=T.prototype;return d.abort=function(){for(var i in this.keyUriToKeyInfo){var s=this.keyUriToKeyInfo[i].loader;s&&s.abort()}},d.detach=function(){for(var i in this.keyUriToKeyInfo){var s=this.keyUriToKeyInfo[i];(s.mediaKeySessionContext||s.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[i]}},d.destroy=function(){for(var i in this.detach(),this.keyUriToKeyInfo){var s=this.keyUriToKeyInfo[i].loader;s&&s.destroy()}this.keyUriToKeyInfo={}},d.createKeyLoadError=function(i,s,u,c){return s===void 0&&(s=L.ErrorDetails.KEY_LOAD_ERROR),new zt({type:L.ErrorTypes.NETWORK_ERROR,details:s,fatal:!1,frag:i,networkDetails:u})},d.loadClear=function(i,s){var u=this;if(this.emeController&&this.config.emeEnabled)for(var c=i.sn,l=i.cc,o=function(g){var p=s[g];if(l<=p.cc&&(c==="initSegment"||c<p.sn))return u.emeController.selectKeySystemFormat(p).then(function(v){p.setKeyFormat(v)}),"break"},h=0;h<s.length&&o(h)!=="break";h++);},d.load=function(i){var s=this;return!i.decryptdata&&i.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(i).then(function(u){return s.loadInternal(i,u)}):this.loadInternal(i)},d.loadInternal=function(i,s){var u,c;s&&i.setKeyFormat(s);var l=i.decryptdata;if(!l){var o=s?"Expected frag.decryptdata to be defined after setting format "+s:"Missing decryption data on fragment in onKeyLoading";return Promise.reject(this.createKeyLoadError(i,L.ErrorDetails.KEY_LOAD_ERROR,null,o))}var h=l.uri;if(!h)return Promise.reject(this.createKeyLoadError(i,L.ErrorDetails.KEY_LOAD_ERROR,null,'Invalid key URI: "'+h+'"'));var g,p=this.keyUriToKeyInfo[h];if((u=p)!==null&&u!==void 0&&u.decryptdata.key)return l.key=p.decryptdata.key,Promise.resolve({frag:i,keyInfo:p});if((c=p)!==null&&c!==void 0&&c.keyLoadPromise)switch((g=p.mediaKeySessionContext)===null||g===void 0?void 0:g.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return p.keyLoadPromise}switch(p=this.keyUriToKeyInfo[h]={decryptdata:l,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},l.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return l.keyFormat==="identity"?this.loadKeyHTTP(p,i):this.loadKeyEME(p,i);case"AES-128":return this.loadKeyHTTP(p,i);default:return Promise.reject(this.createKeyLoadError(i,L.ErrorDetails.KEY_LOAD_ERROR,null,'Key supplied with unsupported METHOD: "'+l.method+'"'))}},d.loadKeyEME=function(i,s){var u={frag:s,keyInfo:i};if(this.emeController&&this.config.emeEnabled){var c=this.emeController.loadKey(u);if(c)return(i.keyLoadPromise=c.then(function(l){return i.mediaKeySessionContext=l,u})).catch(function(l){throw i.keyLoadPromise=null,l})}return Promise.resolve(u)},d.loadKeyHTTP=function(i,s){var u=this,c=this.config,l=new c.loader(c);return s.keyLoader=i.loader=l,i.keyLoadPromise=new Promise(function(o,h){var g={keyInfo:i,frag:s,responseType:"arraybuffer",url:i.decryptdata.uri},p={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:c.fragLoadingRetryDelay,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:0},v={onSuccess:function(S,R,k,M){var V=k.frag,K=k.keyInfo,Z=k.url;if(!V.decryptdata||K!==u.keyUriToKeyInfo[Z])return h(u.createKeyLoadError(V,L.ErrorDetails.KEY_LOAD_ERROR,M,"after key load, decryptdata unset or changed"));K.decryptdata.key=V.decryptdata.key=new Uint8Array(S.data),V.keyLoader=null,K.loader=null,o({frag:V,keyInfo:K})},onError:function(S,R,k){u.resetLoader(R),h(u.createKeyLoadError(s,L.ErrorDetails.KEY_LOAD_ERROR,k))},onTimeout:function(S,R,k){u.resetLoader(R),h(u.createKeyLoadError(s,L.ErrorDetails.KEY_LOAD_TIMEOUT,k))},onAbort:function(S,R,k){u.resetLoader(R),h(u.createKeyLoadError(s,L.ErrorDetails.INTERNAL_ABORTED,k))}};l.load(g,p,v)})},d.resetLoader=function(i){var s=i.frag,u=i.keyInfo,c=i.url,l=u.loader;s.keyLoader===l&&(s.keyLoader=null,u.loader=null),delete this.keyUriToKeyInfo[c],l&&l.destroy()},T}(),Sn=function(){function T(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var d=T.prototype;return d.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},d.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},d.onHandlerDestroyed=function(){},d.hasInterval=function(){return!!this._tickInterval},d.hasNextTick=function(){return!!this._tickTimer},d.setInterval=function(i){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,i),!0)},d.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},d.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},d.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},d.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},d.doTick=function(){},T}(),Ir={length:0,start:function(){return 0},end:function(){return 0}},Ht=function(){function T(){}return T.isBuffered=function(d,i){try{if(d){for(var s=T.getBuffered(d),u=0;u<s.length;u++)if(i>=s.start(u)&&i<=s.end(u))return!0}}catch{}return!1},T.bufferInfo=function(d,i,s){try{if(d){var u,c=T.getBuffered(d),l=[];for(u=0;u<c.length;u++)l.push({start:c.start(u),end:c.end(u)});return this.bufferedInfo(l,i,s)}}catch{}return{len:0,start:i,end:i,nextStart:void 0}},T.bufferedInfo=function(d,i,s){i=Math.max(0,i),d.sort(function(M,V){return M.start-V.start||V.end-M.end});var u=[];if(s)for(var c=0;c<d.length;c++){var l=u.length;if(l){var o=u[l-1].end;d[c].start-o<s?d[c].end>o&&(u[l-1].end=d[c].end):u.push(d[c])}else u.push(d[c])}else u=d;for(var h,g=0,p=i,v=i,S=0;S<u.length;S++){var R=u[S].start,k=u[S].end;if(i+s>=R&&i<k)p=R,g=(v=k)-i;else if(i+s<R){h=R;break}}return{len:g,start:p||0,end:v||0,nextStart:h}},T.getBuffered=function(d){try{return d.buffered}catch(i){return O.logger.log("failed to get media.buffered",i),Ir}},T}(),ka=function(T,d,i,s,u,c){s===void 0&&(s=0),u===void 0&&(u=-1),c===void 0&&(c=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=T,this.sn=d,this.id=i,this.size=s,this.part=u,this.partial=c};function sc(T,d){for(var i=null,s=0,u=T.length;s<u;s++){var c=T[s];if(c&&c.cc===d){i=c;break}}return i}function ac(T,d){if(T){var i=T.start+d;T.start=T.startPTS=i,T.endPTS=i+T.duration}}function Pa(T,d){for(var i=d.fragments,s=0,u=i.length;s<u;s++)ac(i[s],T);d.fragmentHint&&ac(d.fragmentHint,T),d.alignedSliding=!0}function oc(T,d){if(T.hasProgramDateTime&&d.hasProgramDateTime){var i=T.fragments,s=d.fragments;if(i.length&&s.length){var u=s[Math.round(s.length/2)-1],c=sc(i,u.cc)||i[Math.round(i.length/2)-1],l=u.programDateTime,o=c.programDateTime;l!==null&&o!==null&&Pa((o-l)/1e3-(c.start-u.start),T)}}}const uc=function(T,d){for(var i=0,s=T.length-1,u=null,c=null;i<=s;){var l=d(c=T[u=(i+s)/2|0]);if(l>0)i=u+1;else{if(!(l<0))return c;s=u-1}}return null};function wa(T,d,i,s){i===void 0&&(i=0),s===void 0&&(s=0);var u=null;if(T?u=d[T.sn-d[0].sn+1]||null:i===0&&d[0].start===0&&(u=d[0]),u&&Ma(i,s,u)===0)return u;var c=uc(d,Ma.bind(null,i,s));return!c||c===T&&u?u:c}function Ma(T,d,i){if(T===void 0&&(T=0),d===void 0&&(d=0),i.start<=T&&i.start+i.duration>T)return 0;var s=Math.min(d,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-s<=T?1:i.start-s>T&&i.start?-1:0}function f0(T,d,i){var s=1e3*Math.min(d,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-s>T}var d0=y(21);const g0=function(T){for(var d="",i=T.length,s=0;s<i;s++)d+="["+T.start(s).toFixed(3)+","+T.end(s).toFixed(3)+"]";return d};function m0(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}function Fa(T,d){return Fa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Fa(T,d)}var Cr="STOPPED",Ct="IDLE",cc="KEY_LOADING",Xn="FRAG_LOADING",$n="FRAG_LOADING_WAITING_RETRY",ps="WAITING_TRACK",Mr="PARSING",Ci="PARSED",Li="ENDED",Qr="ERROR",Ri="WAITING_INIT_PTS",Qn="WAITING_LEVEL",Ba=function(T){var d,i;function s(o,h,g,p){var v;return(v=T.call(this)||this).hls=void 0,v.fragPrevious=null,v.fragCurrent=null,v.fragmentTracker=void 0,v.transmuxer=null,v._state=Cr,v.media=null,v.mediaBuffer=null,v.config=void 0,v.bitrateTest=!1,v.lastCurrentTime=0,v.nextLoadPosition=0,v.startPosition=0,v.loadedmetadata=!1,v.fragLoadError=0,v.retryDate=0,v.levels=null,v.fragmentLoader=void 0,v.keyLoader=void 0,v.levelLastLoaded=null,v.startFragRequested=!1,v.decrypter=void 0,v.initPTS=[],v.onvseeking=null,v.onvended=null,v.logPrefix="",v.log=void 0,v.warn=void 0,v.logPrefix=p,v.log=O.logger.log.bind(O.logger,p+":"),v.warn=O.logger.warn.bind(O.logger,p+":"),v.hls=o,v.fragmentLoader=new $r(o.config),v.keyLoader=g,v.fragmentTracker=h,v.config=o.config,v.decrypter=new d0.default(o.config),o.on(b.Events.LEVEL_SWITCHING,v.onLevelSwitching,function(S){if(S===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S}(v)),v}i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,Fa(d,i);var u,c,l=s.prototype;return l.doTick=function(){this.onTickEnd()},l.onTickEnd=function(){},l.startLoad=function(o){},l.stopLoad=function(){this.fragmentLoader.abort(),this.keyLoader.abort();var o=this.fragCurrent;o&&(o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Cr},l._streamEnded=function(o,h){if(h.live||o.nextStart||!o.end||!this.media)return!1;var g=h.partList;if(g!=null&&g.length){var p=g[g.length-1];return Ht.isBuffered(this.media,p.start+p.duration/2)}var v=h.fragments[h.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(v)},l.getLevelDetails=function(){var o;if(this.levels&&this.levelLastLoaded!==null)return(o=this.levels[this.levelLastLoaded])===null||o===void 0?void 0:o.details},l.onMediaAttached=function(o,h){var g=this.media=this.mediaBuffer=h.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),g.addEventListener("seeking",this.onvseeking),g.addEventListener("ended",this.onvended);var p=this.config;this.levels&&p.autoStartLoad&&this.state===Cr&&this.startLoad(p.startPosition)},l.onMediaDetaching=function(){var o=this.media;o!=null&&o.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),o&&this.onvseeking&&this.onvended&&(o.removeEventListener("seeking",this.onvseeking),o.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},l.onMediaSeeking=function(){var o=this.config,h=this.fragCurrent,g=this.media,p=this.mediaBuffer,v=this.state,S=g?g.currentTime:0,R=Ht.bufferInfo(p||g,S,o.maxBufferHole);if(this.log("media seeking to "+((0,C.isFiniteNumber)(S)?S.toFixed(3):S)+", state: "+v),this.state===Li)this.resetLoadingState();else if(h){var k=o.maxFragLookUpTolerance,M=h.start-k,V=h.start+h.duration+k;if(!R.len||V<R.start||M>R.end){var K=S>V;(S<M||K)&&(K&&h.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),h.abortRequests()),this.resetLoadingState())}}g&&(this.lastCurrentTime=S),this.loadedmetadata||R.len||(this.nextLoadPosition=this.startPosition=S),this.tickImmediate()},l.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},l.onLevelSwitching=function(o,h){this.fragLoadError=0},l.onHandlerDestroying=function(){this.stopLoad(),T.prototype.onHandlerDestroying.call(this)},l.onHandlerDestroyed=function(){this.state=Cr,this.hls.off(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,T.prototype.onHandlerDestroyed.call(this)},l.loadFragment=function(o,h,g){this._loadFragForPlayback(o,h,g)},l._loadFragForPlayback=function(o,h,g){var p=this;this._doFragLoad(o,h,g,function(v){if(p.fragContextChanged(o))return p.warn("Fragment "+o.sn+(v.part?" p: "+v.part.index:"")+" of level "+o.level+" was dropped during download."),void p.fragmentTracker.removeFragment(o);o.stats.chunkCount++,p._handleFragmentLoadProgress(v)}).then(function(v){if(v){p.fragLoadError=0;var S=p.state;p.fragContextChanged(o)?(S===Xn||!p.fragCurrent&&S===Mr)&&(p.fragmentTracker.removeFragment(o),p.state=Ct):("payload"in v&&(p.log("Loaded fragment "+o.sn+" of level "+o.level),p.hls.trigger(b.Events.FRAG_LOADED,v)),p._handleFragmentLoadComplete(v))}}).catch(function(v){p.state!==Cr&&p.state!==Qr&&(p.warn(v),p.resetFragmentLoading(o))})},l.flushMainBuffer=function(o,h,g){if(g===void 0&&(g=null),o-h){var p={startOffset:o,endOffset:h,type:g};this.fragLoadError=0,this.hls.trigger(b.Events.BUFFER_FLUSHING,p)}},l._loadInitSegment=function(o,h){var g=this;this._doFragLoad(o,h).then(function(p){if(!p||g.fragContextChanged(o)||!g.levels)throw new Error("init load aborted");return p}).then(function(p){var v=g.hls,S=p.payload,R=o.decryptdata;if(S&&S.byteLength>0&&R&&R.key&&R.iv&&R.method==="AES-128"){var k=self.performance.now();return g.decrypter.decrypt(new Uint8Array(S),R.key.buffer,R.iv.buffer).then(function(M){var V=self.performance.now();return v.trigger(b.Events.FRAG_DECRYPTED,{frag:o,payload:M,stats:{tstart:k,tdecrypt:V}}),p.payload=M,p})}return p}).then(function(p){var v=g.fragCurrent,S=g.hls,R=g.levels;if(!R)throw new Error("init load aborted, missing levels");R[o.level].details;var k=o.stats;g.state=Ct,g.fragLoadError=0,o.data=new Uint8Array(p.payload),k.parsing.start=k.buffering.start=self.performance.now(),k.parsing.end=k.buffering.end=self.performance.now(),p.frag===v&&S.trigger(b.Events.FRAG_BUFFERED,{stats:k,frag:v,part:null,id:o.type}),g.tick()}).catch(function(p){g.state!==Cr&&g.state!==Qr&&(g.warn(p),g.resetFragmentLoading(o))})},l.fragContextChanged=function(o){var h=this.fragCurrent;return!o||!h||o.level!==h.level||o.sn!==h.sn||o.urlId!==h.urlId},l.fragBufferedComplete=function(o,h){var g,p,v=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+o.type+" sn: "+o.sn+(h?" part: "+h.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+o.level+" "+(v?g0(Ht.getBuffered(v)):"(detached)")),this.state=Ct,v&&(!this.loadedmetadata&&o.type==x.PlaylistLevelType.MAIN&&v.buffered.length&&((g=this.fragCurrent)===null||g===void 0?void 0:g.sn)===((p=this.fragPrevious)===null||p===void 0?void 0:p.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},l.seekToStartPos=function(){},l._handleFragmentLoadComplete=function(o){var h=this.transmuxer;if(h){var g=o.frag,p=o.part,v=o.partsLoaded,S=!v||v.length===0||v.some(function(k){return!k}),R=new ka(g.level,g.sn,g.stats.chunkCount+1,0,p?p.index:-1,!S);h.flush(R)}},l._handleFragmentLoadProgress=function(o){},l._doFragLoad=function(o,h,g,p){var v,S=this;if(g===void 0&&(g=null),!this.levels)throw new Error("frag load aborted, missing levels");var R=null;if(!o.encrypted||(v=o.decryptdata)!==null&&v!==void 0&&v.key?!o.encrypted&&h.encryptedFragments.length&&this.keyLoader.loadClear(o,h.encryptedFragments):(this.log("Loading key for "+o.sn+" of ["+h.startSN+"-"+h.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+o.level),this.state=cc,this.fragCurrent=o,R=this.keyLoader.load(o).then(function(Z){if(!S.fragContextChanged(Z.frag))return S.hls.trigger(b.Events.KEY_LOADED,Z),Z}),this.hls.trigger(b.Events.KEY_LOADING,{frag:o}),this.throwIfFragContextChanged("KEY_LOADING")),g=Math.max(o.start,g||0),this.config.lowLatencyMode&&h){var k=h.partList;if(k&&p){g>o.end&&h.fragmentHint&&(o=h.fragmentHint);var M=this.getNextPart(k,o,g);if(M>-1){var V=k[M];return this.log("Loading part sn: "+o.sn+" p: "+V.index+" cc: "+o.cc+" of playlist ["+h.startSN+"-"+h.endSN+"] parts [0-"+M+"-"+(k.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+o.level+", target: "+parseFloat(g.toFixed(3))),this.nextLoadPosition=V.start+V.duration,this.state=Xn,this.hls.trigger(b.Events.FRAG_LOADING,{frag:o,part:k[M],targetBufferTime:g}),this.throwIfFragContextChanged("FRAG_LOADING parts"),R?R.then(function(Z){return!Z||S.fragContextChanged(Z.frag)?null:S.doFragPartsLoad(o,k,M,p)}).catch(function(Z){return S.handleFragLoadError(Z)}):this.doFragPartsLoad(o,k,M,p).catch(function(Z){return S.handleFragLoadError(Z)})}if(!o.url||this.loadedEndOfParts(k,g))return Promise.resolve(null)}}this.log("Loading fragment "+o.sn+" cc: "+o.cc+" "+(h?"of ["+h.startSN+"-"+h.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+o.level+", target: "+parseFloat(g.toFixed(3))),(0,C.isFiniteNumber)(o.sn)&&!this.bitrateTest&&(this.nextLoadPosition=o.start+o.duration),this.state=Xn,this.hls.trigger(b.Events.FRAG_LOADING,{frag:o,targetBufferTime:g}),this.throwIfFragContextChanged("FRAG_LOADING");var K=this.config.progressive;return K&&R?R.then(function(Z){return!Z||S.fragContextChanged(Z==null?void 0:Z.frag)?null:S.fragmentLoader.load(o,p)}).catch(function(Z){return S.handleFragLoadError(Z)}):Promise.all([this.fragmentLoader.load(o,K?p:void 0),R]).then(function(Z){var de=Z[0];return!K&&de&&p&&p(de),de}).catch(function(Z){return S.handleFragLoadError(Z)})},l.throwIfFragContextChanged=function(o){if(this.fragCurrent===null)throw new Error("frag load aborted, context changed in "+o)},l.doFragPartsLoad=function(o,h,g,p){var v=this;return new Promise(function(S,R){var k=[];(function M(V){var K=h[V];v.fragmentLoader.loadPart(o,K,p).then(function(Z){k[K.index]=Z;var de=Z.part;v.hls.trigger(b.Events.FRAG_LOADED,Z);var _e=h[V+1];if(!_e||_e.fragment!==o)return S({frag:o,part:de,partsLoaded:k});M(V+1)}).catch(R)})(g)})},l.handleFragLoadError=function(o){if("data"in o){var h=o.data;o.data&&h.details===L.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(h.frag,h.part):this.hls.trigger(b.Events.ERROR,h)}else this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.OTHER_ERROR,details:L.ErrorDetails.INTERNAL_EXCEPTION,err:o,fatal:!0});return null},l._handleTransmuxerFlush=function(o){var h=this.getCurrentContext(o);if(h&&this.state===Mr){var g=h.frag,p=h.part,v=h.level,S=self.performance.now();g.stats.parsing.end=S,p&&(p.stats.parsing.end=S),this.updateLevelTiming(g,p,v,o.partial)}else this.fragCurrent||this.state===Cr||this.state===Qr||(this.state=Ct)},l.getCurrentContext=function(o){var h=this.levels,g=o.level,p=o.sn,v=o.part;if(!h||!h[g])return this.warn("Levels object was unset while buffering fragment "+p+" of level "+g+". The current chunk will not be buffered."),null;var S=h[g],R=v>-1?function(M,V,K){if(!M||!M.details)return null;var Z=M.details.partList;if(Z)for(var de=Z.length;de--;){var _e=Z[de];if(_e.index===K&&_e.fragment.sn===V)return _e}return null}(S,p,v):null,k=R?R.fragment:function(M,V,K){if(!M||!M.details)return null;var Z=M.details,de=Z.fragments[V-Z.startSN];return de||((de=Z.fragmentHint)&&de.sn===V?de:V<Z.startSN&&K&&K.sn===V?K:null)}(S,p,this.fragCurrent);return k?{frag:k,part:R,level:S}:null},l.bufferFragmentData=function(o,h,g,p){if(o&&this.state===Mr){var v=o.data1,S=o.data2,R=v;if(v&&S&&(R=(0,ve.appendUint8Array)(v,S)),R&&R.length){var k={type:o.type,frag:h,part:g,chunkMeta:p,parent:h.type,data:R};this.hls.trigger(b.Events.BUFFER_APPENDING,k),o.dropped&&o.independent&&!g&&this.flushBufferGap(h)}}},l.flushBufferGap=function(o){var h=this.media;if(h)if(Ht.isBuffered(h,h.currentTime)){var g=h.currentTime,p=Ht.bufferInfo(h,g,0),v=o.duration,S=Math.min(2*this.config.maxFragLookUpTolerance,.25*v),R=Math.max(Math.min(o.start-S,p.end-S),g+S);o.start-R>S&&this.flushMainBuffer(R,o.start)}else this.flushMainBuffer(0,o.start)},l.getFwdBufferInfo=function(o,h){var g=this.config,p=this.getLoadPosition();if(!(0,C.isFiniteNumber)(p))return null;var v=Ht.bufferInfo(o,p,g.maxBufferHole);if(v.len===0&&v.nextStart!==void 0){var S=this.fragmentTracker.getBufferedFrag(p,h);if(S&&v.nextStart<S.end)return Ht.bufferInfo(o,p,Math.max(v.nextStart,g.maxBufferHole))}return v},l.getMaxBufferLength=function(o){var h,g=this.config;return h=o?Math.max(8*g.maxBufferSize/o,g.maxBufferLength):g.maxBufferLength,Math.min(h,g.maxMaxBufferLength)},l.reduceMaxBufferLength=function(o){var h=this.config,g=o||h.maxBufferLength;return h.maxMaxBufferLength>=g&&(h.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+h.maxMaxBufferLength+"s"),!0)},l.getNextFragment=function(o,h){var g=h.fragments,p=g.length;if(!p)return null;var v,S=this.config,R=g[0].start;if(h.live){var k=S.initialLiveManifestSize;if(p<k)return this.warn("Not enough fragments to start playback (have: "+p+", need: "+k+")"),null;h.PTSKnown||this.startFragRequested||this.startPosition!==-1||(v=this.getInitialLiveFragment(h,g),this.startPosition=v?this.hls.liveSyncPosition||v.start:o)}else o<=R&&(v=g[0]);if(!v){var M=S.lowLatencyMode?h.partEnd:h.fragmentEnd;v=this.getFragmentAtPosition(o,M,h)}return this.mapToInitFragWhenRequired(v)},l.mapToInitFragWhenRequired=function(o){return o==null||!o.initSegment||o!=null&&o.initSegment.data||this.bitrateTest?o:o.initSegment},l.getNextPart=function(o,h,g){for(var p=-1,v=!1,S=!0,R=0,k=o.length;R<k;R++){var M=o[R];if(S=S&&!M.independent,p>-1&&g<M.start)break;var V=M.loaded;V?p=-1:(v||M.independent||S)&&M.fragment===h&&(p=R),v=V}return p},l.loadedEndOfParts=function(o,h){var g=o[o.length-1];return g&&h>g.start&&g.loaded},l.getInitialLiveFragment=function(o,h){var g=this.fragPrevious,p=null;if(g){if(o.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+g.programDateTime),p=function(k,M,V){if(M===null||!Array.isArray(k)||!k.length||!(0,C.isFiniteNumber)(M)||M<(k[0].programDateTime||0)||M>=(k[k.length-1].endProgramDateTime||0))return null;V=V||0;for(var K=0;K<k.length;++K){var Z=k[K];if(f0(M,V,Z))return Z}return null}(h,g.endProgramDateTime,this.config.maxFragLookUpTolerance)),!p){var v=g.sn+1;if(v>=o.startSN&&v<=o.endSN){var S=h[v-o.startSN];g.cc===S.cc&&(p=S,this.log("Live playlist, switching playlist, load frag with next SN: "+p.sn))}p||(p=function(k,M){return uc(k,function(V){return V.cc<M?1:V.cc>M?-1:0})}(h,g.cc),p&&this.log("Live playlist, switching playlist, load frag with same CC: "+p.sn))}}else{var R=this.hls.liveSyncPosition;R!==null&&(p=this.getFragmentAtPosition(R,this.bitrateTest?o.fragmentEnd:o.edge,o))}return p},l.getFragmentAtPosition=function(o,h,g){var p,v=this.config,S=this.fragPrevious,R=g.fragments,k=g.endSN,M=g.fragmentHint,V=v.maxFragLookUpTolerance,K=!!(v.lowLatencyMode&&g.partList&&M);if(K&&M&&!this.bitrateTest&&(R=R.concat(M),k=M.sn),p=o<h?wa(S,R,o,o>h-V?0:V):R[R.length-1]){var Z=p.sn-g.startSN;if(this.fragmentTracker.getState(p)===qe.OK&&(S=p),S&&p.sn===S.sn&&!K&&S&&p.level===S.level){var de=R[Z+1];p.sn<k&&this.fragmentTracker.getState(de)!==qe.OK?(this.log("SN "+p.sn+" just loaded, load next one: "+de.sn),p=de):p=null}}return p},l.synchronizeToLiveEdge=function(o){var h=this.config,g=this.media;if(g){var p=this.hls.liveSyncPosition,v=g.currentTime,S=o.fragments[0].start,R=o.edge,k=v>=S-h.maxFragLookUpTolerance&&v<=R;if(p!==null&&g.duration>p&&(v<p||!k)){var M=h.liveMaxLatencyDuration!==void 0?h.liveMaxLatencyDuration:h.liveMaxLatencyDurationCount*o.targetduration;(!k&&g.readyState<4||v<R-M)&&(this.loadedmetadata||(this.nextLoadPosition=p),g.readyState&&(this.warn("Playback: "+v.toFixed(3)+" is located too far from the end of live sliding playlist: "+R+", reset currentTime to : "+p.toFixed(3)),g.currentTime=p))}}},l.alignPlaylists=function(o,h){var g=this.levels,p=this.levelLastLoaded,v=this.fragPrevious,S=p!==null?g[p]:null,R=o.fragments.length;if(!R)return this.warn("No fragments in live playlist"),0;var k=o.fragments[0].start,M=!h,V=o.alignedSliding&&(0,C.isFiniteNumber)(k);if(M||!V&&!k){(function(Z,de,_e){de&&(function(Te,De,ze){if(function(Se,Xe,Ve){return!(!Xe.details||!(Ve.endCC>Ve.startCC||Se&&Se.cc<Ve.startCC))}(Te,ze,De)){var st=function(Se,Xe,Ve){var pt=Se.fragments,kt=Xe.fragments;if(kt.length&&pt.length){var vt=sc(pt,kt[0].cc);if(vt&&(!vt||vt.startPTS))return vt;O.logger.log("No frag in previous level to align on")}else O.logger.log("No fragments to align")}(ze.details,De);st&&(0,C.isFiniteNumber)(st.start)&&(O.logger.log("Adjusting PTS using last level due to CC increase within current level "+De.url),Pa(st.start,De))}}(Z,_e,de),!_e.alignedSliding&&de.details&&function(Te,De){if(De.fragments.length&&Te.hasProgramDateTime&&De.hasProgramDateTime){var ze=De.fragments[0].programDateTime,st=Te.fragments[0].programDateTime,Se=(st-ze)/1e3+De.fragments[0].start;Se&&(0,C.isFiniteNumber)(Se)&&(O.logger.log("Adjusting PTS using programDateTime delta "+(st-ze)+"ms, sliding:"+Se.toFixed(3)+" "+Te.url+" "),Pa(Se,Te))}}(_e,de.details),_e.alignedSliding||!de.details||_e.skippedSegments||ae(de.details,_e))})(v,S,o);var K=o.fragments[0].start;return this.log("Live playlist sliding: "+K.toFixed(2)+" start-sn: "+(h?h.startSN:"na")+"->"+o.startSN+" prev-sn: "+(v?v.sn:"na")+" fragments: "+R),K}return k},l.waitForCdnTuneIn=function(o){return o.live&&o.canBlockReload&&o.partTarget&&o.tuneInGoal>Math.max(o.partHoldBack,3*o.partTarget)},l.setStartPosition=function(o,h){var g=this.startPosition;if(g<h&&(g=-1),g===-1||this.lastCurrentTime===-1){var p=o.startTimeOffset;(0,C.isFiniteNumber)(p)?(g=h+p,p<0&&(g+=o.totalduration),g=Math.min(Math.max(h,g),h+o.totalduration),this.log("Start time offset "+p+" found in playlist, adjust startPosition to "+g),this.startPosition=g):o.live?g=this.hls.liveSyncPosition||h:this.startPosition=g=0,this.lastCurrentTime=g}this.nextLoadPosition=g},l.getLoadPosition=function(){var o=this.media,h=0;return this.loadedmetadata&&o?h=o.currentTime:this.nextLoadPosition&&(h=this.nextLoadPosition),h},l.handleFragLoadAborted=function(o,h){this.transmuxer&&o.sn!=="initSegment"&&o.stats.aborted&&(this.warn("Fragment "+o.sn+(h?" part"+h.index:"")+" of level "+o.level+" was aborted"),this.resetFragmentLoading(o))},l.resetFragmentLoading=function(o){this.fragCurrent&&(this.fragContextChanged(o)||this.state===$n)||(this.state=Ct)},l.onFragmentOrKeyLoadError=function(o,h){if(h.fatal)return this.stopLoad(),void(this.state=Qr);var g=this.config;if(h.chunkMeta){var p=this.getCurrentContext(h.chunkMeta);p&&(h.frag=p.frag,h.levelRetry=!0,this.fragLoadError=g.fragLoadingMaxRetry)}var v=h.frag;if(v&&v.type===o)if(this.fragCurrent,this.fragLoadError+1<=g.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var S=Math.min(Math.pow(2,this.fragLoadError)*g.fragLoadingRetryDelay,g.fragLoadingMaxRetryTimeout);this.warn("Fragment "+v.sn+" of "+o+" "+v.level+" failed to load, retrying in "+S+"ms"),this.retryDate=self.performance.now()+S,this.fragLoadError++,this.state=$n}else h.levelRetry?(o===x.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=Ct):(O.logger.error(h.details+" reaches max retry, redispatch as fatal ..."),h.fatal=!0,this.hls.stopLoad(),this.state=Qr)},l.afterBufferFlushed=function(o,h,g){if(o){var p=Ht.getBuffered(o);this.fragmentTracker.detectEvictedFragments(h,p,g),this.state===Li&&this.resetLoadingState()}},l.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Ct},l.resetStartWhenNotLoaded=function(o){if(!this.loadedmetadata){this.startFragRequested=!1;var h=this.levels?this.levels[o].details:null;h!=null&&h.live?(this.startPosition=-1,this.setStartPosition(h,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},l.updateLevelTiming=function(o,h,g,p){var v=this,S=g.details;Object.keys(o.elementaryStreams).reduce(function(R,k){var M=o.elementaryStreams[k];if(M){var V=M.endPTS-M.startPTS;if(V<=0)return v.warn("Could not parse fragment "+o.sn+" "+k+" duration reliably ("+V+")"),R||!1;var K=p?0:te(S,o,M.startPTS,M.endPTS,M.startDTS,M.endDTS);return v.hls.trigger(b.Events.LEVEL_PTS_UPDATED,{details:S,level:g,drift:K,type:k,frag:o,start:M.startPTS,end:M.endPTS}),!0}return R},!1)||(this.warn("Found no media in fragment "+o.sn+" of level "+g.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=Ci,this.hls.trigger(b.Events.FRAG_PARSED,{frag:o,part:h})},l.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},u=s,(c=[{key:"state",get:function(){return this._state},set:function(o){var h=this._state;h!==o&&(this._state=o,this.log(h+"->"+o))}}])&&m0(u.prototype,c),Object.defineProperty(u,"prototype",{writable:!1}),s}(Sn);function Ua(){return self.MediaSource||self.WebKitMediaSource}function lc(){return self.SourceBuffer||self.WebKitSourceBuffer}var Ha=function(){var T=ENTRY_MODULE,d={},i=function u(c){var l=d[c];if(l!==void 0)return l.exports;var o=d[c]={exports:{}};return T[c].call(o.exports,o,o.exports,u),o.exports};i.m=T,i.n=function(u){var c=u&&u.__esModule?function(){return u.default}:function(){return u};return i.d(c,{a:c}),c},i.d=function(u,c){for(var l in c)i.o(c,l)&&!i.o(u,l)&&Object.defineProperty(u,l,{enumerable:!0,get:c[l]})},i.o=function(u,c){return Object.prototype.hasOwnProperty.call(u,c)},i.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})};var s=i(ENTRY_MODULE);return s.default||s}.toString().split("ENTRY_MODULE"),hc="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function fc(T){return(T+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function p0(T,d,i){var s={};s[i]=[];var u=d.toString().replace(/^"[^"]+"/,"function"),c=u.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||u.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!c)return s;for(var l,o=c[1],h=new RegExp("(\\\\n|\\W)"+fc(o)+hc,"g");l=h.exec(u);)l[3]!=="dll-reference"&&s[i].push(l[3]);for(h=new RegExp("\\("+fc(o)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+hc,"g");l=h.exec(u);)T[l[2]]||(s[i].push(l[1]),T[l[2]]=y(l[1]).m),s[l[2]]=s[l[2]]||[],s[l[2]].push(l[4]);for(var g,p=Object.keys(s),v=0;v<p.length;v++)for(var S=0;S<s[p[v]].length;S++)g=s[p[v]][S],isNaN(1*g)||(s[p[v]][S]=1*s[p[v]][S]);return s}function E0(T){return Object.keys(T).reduce(function(d,i){return d||T[i].length>0},!1)}function dc(T,d,i,s){var u=T[s].map(function(c){return'"'+c+'": '+d[s][c].toString().replace(/^"[^"]+"/,"function")}).join(",");return Ha[0]+"{"+u+"}"+Ha[1]+'"'+i+'"'+Ha[2]}var In=y(544),Ga=y(729),T0=y.n(Ga),Ka=Ua()||{isTypeSupported:function(){return!1}},gc=function(){function T(i,s,u,c){var l=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var o=i.config;this.hls=i,this.id=s,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=u,this.onFlush=c;var h=function(S,R){(R=R||{}).frag=l.frag,R.id=l.id,l.hls.trigger(S,R)};this.observer=new Ga.EventEmitter,this.observer.on(b.Events.FRAG_DECRYPTED,h),this.observer.on(b.Events.ERROR,h);var g={mp4:Ka.isTypeSupported("video/mp4"),mpeg:Ka.isTypeSupported("audio/mpeg"),mp3:Ka.isTypeSupported('audio/mp4; codecs="mp3"')},p=navigator.vendor;if(this.useWorker&&typeof Worker<"u"){var v;O.logger.log("demuxing in webworker");try{v=this.worker=function(S,R){R=R||{};var k={main:y.m},M=R.all?{main:Object.keys(k.main)}:function(_e,Te){for(var De={main:[Te]},ze={main:[]},st={main:{}};E0(De);)for(var Se=Object.keys(De),Xe=0;Xe<Se.length;Xe++){var Ve=Se[Xe],pt=De[Ve].pop();if(st[Ve]=st[Ve]||{},!st[Ve][pt]&&_e[Ve][pt]){st[Ve][pt]=!0,ze[Ve]=ze[Ve]||[],ze[Ve].push(pt);for(var kt=p0(_e,_e[Ve][pt],Ve),vt=Object.keys(kt),St=0;St<vt.length;St++)De[vt[St]]=De[vt[St]]||[],De[vt[St]]=De[vt[St]].concat(kt[vt[St]])}}return ze}(k,S),V="";Object.keys(M).filter(function(_e){return _e!=="main"}).forEach(function(_e){for(var Te=0;M[_e][Te];)Te++;M[_e].push(Te),k[_e][Te]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",V=V+"var "+_e+" = ("+dc(M,k,Te,modules)+`)();
`}),V=V+"new (("+dc(M,k,S,"main")+")())(self);";var K=new window.Blob([V],{type:"text/javascript"}),Z=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(K),de=new window.Worker(Z);return de.objectURL=Z,de}(182),this.onwmsg=this.onWorkerMessage.bind(this),v.addEventListener("message",this.onwmsg),v.onerror=function(S){l.useWorker=!1,O.logger.warn("Exception in webworker, fallback to inline"),l.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.OTHER_ERROR,details:L.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(S.message+"  ("+S.filename+":"+S.lineno+")")})},v.postMessage({cmd:"init",typeSupported:g,vendor:p,id:s,config:JSON.stringify(o)})}catch(S){O.logger.warn("Error in worker:",S),O.logger.error("Error while initializing DemuxerWorker, fallback to inline"),v&&self.URL.revokeObjectURL(v.objectURL),this.transmuxer=new In.default(this.observer,g,o,p,s),this.worker=null}}else this.transmuxer=new In.default(this.observer,g,o,p,s)}var d=T.prototype;return d.destroy=function(){var i=this.worker;if(i)i.removeEventListener("message",this.onwmsg),i.terminate(),this.worker=null,this.onwmsg=void 0;else{var s=this.transmuxer;s&&(s.destroy(),this.transmuxer=null)}var u=this.observer;u&&u.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},d.push=function(i,s,u,c,l,o,h,g,p,v){var S,R,k=this;p.transmuxing.start=self.performance.now();var M=this.transmuxer,V=this.worker,K=o?o.start:l.start,Z=l.decryptdata,de=this.frag,_e=!(de&&l.cc===de.cc),Te=!(de&&p.level===de.level),De=de?p.sn-de.sn:-1,ze=this.part?p.part-this.part.index:-1,st=De===0&&p.id>1&&p.id===(de==null?void 0:de.stats.chunkCount),Se=!Te&&(De===1||De===0&&(ze===1||st&&ze<=0)),Xe=self.performance.now();(Te||De||l.stats.parsing.start===0)&&(l.stats.parsing.start=Xe),!o||!ze&&Se||(o.stats.parsing.start=Xe);var Ve=!(de&&((S=l.initSegment)===null||S===void 0?void 0:S.url)===((R=de.initSegment)===null||R===void 0?void 0:R.url)),pt=new In.TransmuxState(_e,Se,g,Te,K,Ve);if(!Se||_e||Ve){O.logger.log("[transmuxer-interface, "+l.type+"]: Starting new transmux session for sn: "+p.sn+" p: "+p.part+" level: "+p.level+" id: "+p.id+`
        discontinuity: `+_e+`
        trackSwitch: `+Te+`
        contiguous: `+Se+`
        accurateTimeOffset: `+g+`
        timeOffset: `+K+`
        initSegmentChange: `+Ve);var kt=new In.TransmuxConfig(u,c,s,h,v);this.configureTransmuxer(kt)}if(this.frag=l,this.part=o,V)V.postMessage({cmd:"demux",data:i,decryptdata:Z,chunkMeta:p,state:pt},i instanceof ArrayBuffer?[i]:[]);else if(M){var vt=M.push(i,Z,p,pt);(0,In.isPromise)(vt)?(M.async=!0,vt.then(function(St){k.handleTransmuxComplete(St)}).catch(function(St){k.transmuxerError(St,p,"transmuxer-interface push error")})):(M.async=!1,this.handleTransmuxComplete(vt))}},d.flush=function(i){var s=this;i.transmuxing.start=self.performance.now();var u=this.transmuxer,c=this.worker;if(c)c.postMessage({cmd:"flush",chunkMeta:i});else if(u){var l=u.flush(i);(0,In.isPromise)(l)||u.async?((0,In.isPromise)(l)||(l=Promise.resolve(l)),l.then(function(o){s.handleFlushResult(o,i)}).catch(function(o){s.transmuxerError(o,i,"transmuxer-interface flush error")})):this.handleFlushResult(l,i)}},d.transmuxerError=function(i,s,u){this.hls&&this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:s,fatal:!1,error:i,err:i,reason:u})},d.handleFlushResult=function(i,s){var u=this;i.forEach(function(c){u.handleTransmuxComplete(c)}),this.onFlush(s)},d.onWorkerMessage=function(i){var s=i.data,u=this.hls;switch(s.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(s.data);break;case"flush":this.onFlush(s.data);break;case"workerLog":O.logger[s.data.logType]&&O.logger[s.data.logType](s.data.message);break;default:s.data=s.data||{},s.data.frag=this.frag,s.data.id=this.id,u.trigger(s.event,s.data)}},d.configureTransmuxer=function(i){var s=this.worker,u=this.transmuxer;s?s.postMessage({cmd:"configure",config:i}):u&&u.configure(i)},d.handleTransmuxComplete=function(i){i.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(i)},T}(),v0=function(){function T(i,s,u,c){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=i,this.media=s,this.fragmentTracker=u,this.hls=c}var d=T.prototype;return d.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},d.poll=function(i,s){var u=this.config,c=this.media,l=this.stalled;if(c!==null){var o=c.currentTime,h=c.seeking,g=this.seeking&&!h,p=!this.seeking&&h;if(this.seeking=h,o===i){if((p||g)&&(this.stalled=null),!(c.paused&&!h||c.ended||c.playbackRate===0)&&Ht.getBuffered(c).length){var v=Ht.bufferInfo(c,o,0),S=v.len>0,R=v.nextStart||0;if(S||R){if(h){var k=v.len>2,M=!R||s&&s.start<=o||R-o>2&&!this.fragmentTracker.getPartialFragment(o);if(k||M)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var V,K=Math.max(R,v.start||0)-o,Z=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,de=!(Z==null||(V=Z.details)===null||V===void 0)&&V.live?2*Z.details.targetduration:2;if(K>0&&K<=de)return void this._trySkipBufferHole(null)}var _e=self.performance.now();if(l!==null){var Te=_e-l;if(h||!(Te>=250)||(this._reportStall(v),this.media)){var De=Ht.bufferInfo(c,o,u.maxBufferHole);this._tryFixBufferStall(De,Te)}}else this.stalled=_e}}}else if(this.moved=!0,l!==null){if(this.stallReported){var ze=self.performance.now()-l;O.logger.warn("playback not stuck anymore @"+o+", after "+Math.round(ze)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}}},d._tryFixBufferStall=function(i,s){var u=this.config,c=this.fragmentTracker,l=this.media;if(l!==null){var o=l.currentTime,h=c.getPartialFragment(o);if(h&&(this._trySkipBufferHole(h)||!this.media))return;i.len>u.maxBufferHole&&s>1e3*u.highBufferWatchdogPeriod&&(O.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},d._reportStall=function(i){var s=this.hls,u=this.media;!this.stallReported&&u&&(this.stallReported=!0,O.logger.warn("Playback stalling at @"+u.currentTime+" due to low buffer ("+JSON.stringify(i)+")"),s.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:i.len}))},d._trySkipBufferHole=function(i){var s=this.config,u=this.hls,c=this.media;if(c===null)return 0;for(var l=c.currentTime,o=0,h=Ht.getBuffered(c),g=0;g<h.length;g++){var p=h.start(g);if(l+s.maxBufferHole>=o&&l<p){var v=Math.max(p+.05,c.currentTime+.1);return O.logger.warn("skipping hole, adjusting currentTime from "+l+" to "+v),this.moved=!0,this.stalled=null,c.currentTime=v,i&&u.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+l+" to "+v,frag:i}),v}o=h.end(g)}return 0},d._tryNudgeBuffer=function(){var i=this.config,s=this.hls,u=this.media,c=this.nudgeRetry;if(u!==null){var l=u.currentTime;if(this.nudgeRetry++,c<i.nudgeMaxRetry){var o=l+(c+1)*i.nudgeOffset;O.logger.warn("Nudging 'currentTime' from "+l+" to "+o),u.currentTime=o,s.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else O.logger.error("Playhead still not moving while enough data buffered @"+l+" after "+i.nudgeMaxRetry+" nudges"),s.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},T}();function b0(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}function Ya(T,d){return Ya=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Ya(T,d)}var y0=function(T){var d,i;function s(o,h,g){var p;return(p=T.call(this,o,h,g,"[stream-controller]")||this).audioCodecSwap=!1,p.gapController=null,p.level=-1,p._forceStartLoad=!1,p.altAudio=!1,p.audioOnly=!1,p.fragPlaying=null,p.onvplaying=null,p.onvseeked=null,p.fragLastKbps=0,p.couldBacktrack=!1,p.backtrackFragment=null,p.audioCodecSwitch=!1,p.videoBuffer=null,p._registerListeners(),p}i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,Ya(d,i);var u,c,l=s.prototype;return l._registerListeners=function(){var o=this.hls;o.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(b.Events.LEVEL_LOADING,this.onLevelLoading,this),o.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(b.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),o.on(b.Events.ERROR,this.onError,this),o.on(b.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.on(b.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(b.Events.BUFFER_CREATED,this.onBufferCreated,this),o.on(b.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.on(b.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),o.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},l._unregisterListeners=function(){var o=this.hls;o.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(b.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),o.off(b.Events.ERROR,this.onError,this),o.off(b.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.off(b.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(b.Events.BUFFER_CREATED,this.onBufferCreated,this),o.off(b.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.off(b.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),o.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},l.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},l.startLoad=function(o){if(this.levels){var h=this.lastCurrentTime,g=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var p=g.startLevel;p===-1&&(g.config.testBandwidth&&this.levels.length>1?(p=0,this.bitrateTest=!0):p=g.nextAutoLevel),this.level=g.nextLoadLevel=p,this.loadedmetadata=!1}h>0&&o===-1&&(this.log("Override startPosition with lastCurrentTime @"+h.toFixed(3)),o=h),this.state=Ct,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=o,this.tick()}else this._forceStartLoad=!0,this.state=Cr},l.stopLoad=function(){this._forceStartLoad=!1,T.prototype.stopLoad.call(this)},l.doTick=function(){switch(this.state){case Ct:this.doTickIdle();break;case Qn:var o,h=this.levels,g=this.level,p=h==null||(o=h[g])===null||o===void 0?void 0:o.details;if(p&&(!p.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(p))break;this.state=Ct;break}break;case $n:var v,S=self.performance.now(),R=this.retryDate;(!R||S>=R||(v=this.media)!==null&&v!==void 0&&v.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=Ct)}this.onTickEnd()},l.onTickEnd=function(){T.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},l.doTickIdle=function(){var o=this.hls,h=this.levelLastLoaded,g=this.levels,p=this.media,v=o.config,S=o.nextLoadLevel;if(h!==null&&(p||!this.startFragRequested&&v.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&g&&g[S]){var R=g[S],k=this.getMainFwdBufferInfo();if(k!==null){var M=this.getLevelDetails();if(M&&this._streamEnded(k,M)){var V={};return this.altAudio&&(V.type="video"),this.hls.trigger(b.Events.BUFFER_EOS,V),void(this.state=Li)}this.level=o.nextLoadLevel=S;var K=R.details;if(!K||this.state===Qn||K.live&&this.levelLastLoaded!==S)return this.level=S,void(this.state=Qn);if(!(k.len>=this.getMaxBufferLength(R.maxBitrate))){this.backtrackFragment&&this.backtrackFragment.start>k.end&&(this.backtrackFragment=null);var Z=this.backtrackFragment?this.backtrackFragment.start:k.end,de=this.getNextFragment(Z,K);if(this.couldBacktrack&&!this.fragPrevious&&de&&de.sn!=="initSegment"&&this.fragmentTracker.getState(de)!==qe.OK){var _e,Te=((_e=this.backtrackFragment)!=null?_e:de).sn-K.startSN,De=K.fragments[Te-1];De&&de.cc===De.cc&&(de=De,this.fragmentTracker.removeFragment(De))}else this.backtrackFragment&&k.len&&(this.backtrackFragment=null);if(de&&this.fragmentTracker.getState(de)===qe.OK&&this.nextLoadPosition>Z){var ze=this.audioOnly&&!this.altAudio?ue.ElementaryStreamTypes.AUDIO:ue.ElementaryStreamTypes.VIDEO,st=(ze===ue.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;st&&this.afterBufferFlushed(st,ze,x.PlaylistLevelType.MAIN),de=this.getNextFragment(this.nextLoadPosition,K)}de&&(!de.initSegment||de.initSegment.data||this.bitrateTest||(de=de.initSegment),this.loadFragment(de,K,Z))}}}},l.loadFragment=function(o,h,g){var p,v=this.fragmentTracker.getState(o);this.fragCurrent=o,v===qe.NOT_LOADED?o.sn==="initSegment"?this._loadInitSegment(o,h):this.bitrateTest?(this.log("Fragment "+o.sn+" of level "+o.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(o,h)):(this.startFragRequested=!0,T.prototype.loadFragment.call(this,o,h,g)):v===qe.APPENDING?this.reduceMaxBufferLength(o.duration)&&this.fragmentTracker.removeFragment(o):((p=this.media)===null||p===void 0?void 0:p.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},l.getAppendedFrag=function(o){var h=this.fragmentTracker.getAppendedFrag(o,x.PlaylistLevelType.MAIN);return h&&"fragment"in h?h.fragment:h},l.getBufferedFrag=function(o){return this.fragmentTracker.getBufferedFrag(o,x.PlaylistLevelType.MAIN)},l.followingBufferedFrag=function(o){return o?this.getBufferedFrag(o.end+.5):null},l.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},l.nextLevelSwitch=function(){var o=this.levels,h=this.media;if(h!=null&&h.readyState){var g,p=this.getAppendedFrag(h.currentTime);if(p&&p.start>1&&this.flushMainBuffer(0,p.start-1),!h.paused&&o){var v=o[this.hls.nextLoadLevel],S=this.fragLastKbps;g=S&&this.fragCurrent?this.fragCurrent.duration*v.maxBitrate/(1e3*S)+1:0}else g=0;var R=this.getBufferedFrag(h.currentTime+g);if(R){var k=this.followingBufferedFrag(R);if(k){this.abortCurrentFrag();var M=k.maxStartPTS?k.maxStartPTS:k.start,V=k.duration,K=Math.max(R.end,M+Math.min(Math.max(V-this.config.maxFragLookUpTolerance,.5*V),.75*V));this.flushMainBuffer(K,Number.POSITIVE_INFINITY)}}}},l.abortCurrentFrag=function(){var o=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,o&&o.abortRequests(),this.state){case cc:case Xn:case $n:case Mr:case Ci:this.state=Ct}this.nextLoadPosition=this.getLoadPosition()},l.flushMainBuffer=function(o,h){T.prototype.flushMainBuffer.call(this,o,h,this.altAudio?"video":null)},l.onMediaAttached=function(o,h){T.prototype.onMediaAttached.call(this,o,h);var g=h.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),g.addEventListener("playing",this.onvplaying),g.addEventListener("seeked",this.onvseeked),this.gapController=new v0(this.config,g,this.fragmentTracker,this.hls)},l.onMediaDetaching=function(){var o=this.media;o&&this.onvplaying&&this.onvseeked&&(o.removeEventListener("playing",this.onvplaying),o.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),T.prototype.onMediaDetaching.call(this)},l.onMediaPlaying=function(){this.tick()},l.onMediaSeeked=function(){var o=this.media,h=o?o.currentTime:null;(0,C.isFiniteNumber)(h)&&this.log("Media seeked to "+h.toFixed(3)),this.tick()},l.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(b.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},l.onManifestParsed=function(o,h){var g,p,v,S=!1,R=!1;h.levels.forEach(function(k){(g=k.audioCodec)&&(g.indexOf("mp4a.40.2")!==-1&&(S=!0),g.indexOf("mp4a.40.5")!==-1&&(R=!0))}),this.audioCodecSwitch=S&&R&&typeof((v=lc())==null||(p=v.prototype)===null||p===void 0?void 0:p.changeType)!="function",this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=h.levels,this.startFragRequested=!1},l.onLevelLoading=function(o,h){var g=this.levels;if(g&&this.state===Ct){var p=g[h.level];(!p.details||p.details.live&&this.levelLastLoaded!==h.level||this.waitForCdnTuneIn(p.details))&&(this.state=Qn)}},l.onLevelLoaded=function(o,h){var g,p=this.levels,v=h.level,S=h.details,R=S.totalduration;if(p){this.log("Level "+v+" loaded ["+S.startSN+","+S.endSN+"], cc ["+S.startCC+", "+S.endCC+"] duration:"+R);var k=this.fragCurrent;!k||this.state!==Xn&&this.state!==$n||k.level!==h.level&&k.loader&&(this.state=Ct,this.backtrackFragment=null,k.abortRequests());var M=p[v],V=0;if(S.live||(g=M.details)!==null&&g!==void 0&&g.live){if(S.fragments[0]||(S.deltaUpdateFailed=!0),S.deltaUpdateFailed)return;V=this.alignPlaylists(S,M.details)}if(M.details=S,this.levelLastLoaded=v,this.hls.trigger(b.Events.LEVEL_UPDATED,{details:S,level:v}),this.state===Qn){if(this.waitForCdnTuneIn(S))return;this.state=Ct}this.startFragRequested?S.live&&this.synchronizeToLiveEdge(S):this.setStartPosition(S,V),this.tick()}else this.warn("Levels were reset while loading level "+v)},l._handleFragmentLoadProgress=function(o){var h,g=o.frag,p=o.part,v=o.payload,S=this.levels;if(S){var R=S[g.level],k=R.details;if(k){var M=R.videoCodec,V=k.PTSKnown||!k.live,K=(h=g.initSegment)===null||h===void 0?void 0:h.data,Z=this._getAudioCodec(R),de=this.transmuxer=this.transmuxer||new gc(this.hls,x.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),_e=p?p.index:-1,Te=_e!==-1,De=new ka(g.level,g.sn,g.stats.chunkCount,v.byteLength,_e,Te),ze=this.initPTS[g.cc];de.push(v,K,Z,M,g,p,k.totalduration,V,De,ze)}else this.warn("Dropping fragment "+g.sn+" of level "+g.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+g.sn+" of level "+g.level+" will not be buffered")},l.onAudioTrackSwitching=function(o,h){var g=this.altAudio,p=!!h.url,v=h.id;if(!p){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var S=this.fragCurrent;S&&(this.log("Switching to main audio track, cancel main fragment load"),S.abortRequests()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var R=this.hls;g&&R.trigger(b.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),R.trigger(b.Events.AUDIO_TRACK_SWITCHED,{id:v})}},l.onAudioTrackSwitched=function(o,h){var g=h.id,p=!!this.hls.audioTracks[g].url;if(p){var v=this.videoBuffer;v&&this.mediaBuffer!==v&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=v)}this.altAudio=p,this.tick()},l.onBufferCreated=function(o,h){var g,p,v=h.tracks,S=!1;for(var R in v){var k=v[R];if(k.id==="main"){if(p=R,g=k,R==="video"){var M=v[R];M&&(this.videoBuffer=M.buffer)}}else S=!0}S&&g?(this.log("Alternate track found, use "+p+".buffered to schedule main fragment loading"),this.mediaBuffer=g.buffer):this.mediaBuffer=this.media},l.onFragBuffered=function(o,h){var g=h.frag,p=h.part;if(!g||g.type===x.PlaylistLevelType.MAIN){if(this.fragContextChanged(g))return this.warn("Fragment "+g.sn+(p?" p: "+p.index:"")+" of level "+g.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===Ci&&(this.state=Ct));var v=p?p.stats:g.stats;this.fragLastKbps=Math.round(8*v.total/(v.buffering.end-v.loading.first)),g.sn!=="initSegment"&&(this.fragPrevious=g),this.fragBufferedComplete(g,p)}},l.onError=function(o,h){if(h.type!==L.ErrorTypes.KEY_SYSTEM_ERROR)switch(h.details){case L.ErrorDetails.FRAG_LOAD_ERROR:case L.ErrorDetails.FRAG_LOAD_TIMEOUT:case L.ErrorDetails.FRAG_PARSING_ERROR:case L.ErrorDetails.KEY_LOAD_ERROR:case L.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(x.PlaylistLevelType.MAIN,h);break;case L.ErrorDetails.LEVEL_LOAD_ERROR:case L.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==Qr&&(h.fatal?(this.warn(""+h.details),this.state=Qr):h.levelRetry||this.state!==Qn||(this.state=Ct));break;case L.ErrorDetails.BUFFER_FULL_ERROR:if(h.parent==="main"&&(this.state===Mr||this.state===Ci)){var g=!0,p=this.getFwdBufferInfo(this.media,x.PlaylistLevelType.MAIN);p&&p.len>.5&&(g=!this.reduceMaxBufferLength(p.len)),g&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(x.PlaylistLevelType.MAIN,h)},l.checkBuffer=function(){var o=this.media,h=this.gapController;if(o&&h&&o.readyState){if(this.loadedmetadata||!Ht.getBuffered(o).length){var g=this.state!==Ct?this.fragCurrent:null;h.poll(this.lastCurrentTime,g)}this.lastCurrentTime=o.currentTime}},l.onFragLoadEmergencyAborted=function(){this.state=Ct,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},l.onBufferFlushed=function(o,h){var g=h.type;if(g!==ue.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var p=(g===ue.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(p,g,x.PlaylistLevelType.MAIN)}},l.onLevelsUpdated=function(o,h){this.levels=h.levels},l.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},l.seekToStartPos=function(){var o=this.media;if(o){var h=o.currentTime,g=this.startPosition;if(g>=0&&h<g){if(o.seeking)return void this.log("could not seek to "+g+", already seeking at "+h);var p=Ht.getBuffered(o),v=(p.length?p.start(0):0)-g;v>0&&(v<this.config.maxBufferHole||v<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+v+" to match buffer start"),g+=v,this.startPosition=g),this.log("seek to target start position "+g+" from current time "+h),o.currentTime=g}}},l._getAudioCodec=function(o){var h=this.config.defaultAudioCodec||o.audioCodec;return this.audioCodecSwap&&h&&(this.log("Swapping audio codec"),h=h.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),h},l._loadBitrateTestFrag=function(o,h){var g=this;o.bitrateTest=!0,this._doFragLoad(o,h).then(function(p){var v=g.hls;if(p&&!v.nextLoadLevel&&!g.fragContextChanged(o)){g.fragLoadError=0,g.state=Ct,g.startFragRequested=!1,g.bitrateTest=!1;var S=o.stats;S.parsing.start=S.parsing.end=S.buffering.start=S.buffering.end=self.performance.now(),v.trigger(b.Events.FRAG_LOADED,p),o.bitrateTest=!1}})},l._handleTransmuxComplete=function(o){var h,g="main",p=this.hls,v=o.remuxResult,S=o.chunkMeta,R=this.getCurrentContext(S);if(!R)return this.warn("The loading context changed while buffering fragment "+S.sn+" of level "+S.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(S.level);var k=R.frag,M=R.part,V=R.level,K=v.video,Z=v.text,de=v.id3,_e=v.initSegment,Te=V.details,De=this.altAudio?void 0:v.audio;if(!this.fragContextChanged(k)){if(this.state=Mr,_e){_e.tracks&&(this._bufferInitSegment(V,_e.tracks,k,S),p.trigger(b.Events.FRAG_PARSING_INIT_SEGMENT,{frag:k,id:g,tracks:_e.tracks}));var ze=_e.initPTS,st=_e.timescale;(0,C.isFiniteNumber)(ze)&&(this.initPTS[k.cc]=ze,p.trigger(b.Events.INIT_PTS_FOUND,{frag:k,id:g,initPTS:ze,timescale:st}))}if(K&&v.independent!==!1){if(Te){var Se=K.startPTS,Xe=K.endPTS,Ve=K.startDTS,pt=K.endDTS;if(M)M.elementaryStreams[K.type]={startPTS:Se,endPTS:Xe,startDTS:Ve,endDTS:pt};else if(K.firstKeyFrame&&K.independent&&S.id===1&&(this.couldBacktrack=!0),K.dropped&&K.independent){var kt=this.getMainFwdBufferInfo();if((kt?kt.end:this.getLoadPosition())+this.config.maxBufferHole<(K.firstKeyFramePTS?K.firstKeyFramePTS:Se)-this.config.maxBufferHole)return void this.backtrack(k);k.setElementaryStreamInfo(K.type,k.start,Xe,k.start,pt,!0)}k.setElementaryStreamInfo(K.type,Se,Xe,Ve,pt),this.backtrackFragment&&(this.backtrackFragment=k),this.bufferFragmentData(K,k,M,S)}}else if(v.independent===!1)return void this.backtrack(k);if(De){var vt=De.startPTS,St=De.endPTS,Rt=De.startDTS,$t=De.endDTS;M&&(M.elementaryStreams[ue.ElementaryStreamTypes.AUDIO]={startPTS:vt,endPTS:St,startDTS:Rt,endDTS:$t}),k.setElementaryStreamInfo(ue.ElementaryStreamTypes.AUDIO,vt,St,Rt,$t),this.bufferFragmentData(De,k,M,S)}if(Te&&de!=null&&(h=de.samples)!==null&&h!==void 0&&h.length){var Xt={id:g,frag:k,details:Te,samples:de.samples};p.trigger(b.Events.FRAG_PARSING_METADATA,Xt)}if(Te&&Z){var Gt={id:g,frag:k,details:Te,samples:Z.samples};p.trigger(b.Events.FRAG_PARSING_USERDATA,Gt)}}},l._bufferInitSegment=function(o,h,g,p){var v=this;if(this.state===Mr){this.audioOnly=!!h.audio&&!h.video,this.altAudio&&!this.audioOnly&&delete h.audio;var S=h.audio,R=h.video,k=h.audiovideo;if(S){var M=o.audioCodec,V=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(M&&(M=M.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),S.metadata.channelCount!==1&&V.indexOf("firefox")===-1&&(M="mp4a.40.5")),V.indexOf("android")!==-1&&S.container!=="audio/mpeg"&&(M="mp4a.40.2",this.log("Android: force audio codec to "+M)),o.audioCodec&&o.audioCodec!==M&&this.log('Swapping manifest audio codec "'+o.audioCodec+'" for "'+M+'"'),S.levelCodec=M,S.id="main",this.log("Init audio buffer, container:"+S.container+", codecs[selected/level/parsed]=["+(M||"")+"/"+(o.audioCodec||"")+"/"+S.codec+"]")}R&&(R.levelCodec=o.videoCodec,R.id="main",this.log("Init video buffer, container:"+R.container+", codecs[level/parsed]=["+(o.videoCodec||"")+"/"+R.codec+"]")),k&&this.log("Init audiovideo buffer, container:"+k.container+", codecs[level/parsed]=["+(o.attrs.CODECS||"")+"/"+k.codec+"]"),this.hls.trigger(b.Events.BUFFER_CODECS,h),Object.keys(h).forEach(function(K){var Z=h[K].initSegment;Z!=null&&Z.byteLength&&v.hls.trigger(b.Events.BUFFER_APPENDING,{type:K,data:Z,frag:g,part:null,chunkMeta:p,parent:g.type})}),this.tick()}},l.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,x.PlaylistLevelType.MAIN)},l.backtrack=function(o){this.couldBacktrack=!0,this.backtrackFragment=o,this.resetTransmuxer(),this.flushBufferGap(o),this.fragmentTracker.removeFragment(o),this.fragPrevious=null,this.nextLoadPosition=o.start,this.state=Ct},l.checkFragmentChanged=function(){var o=this.media,h=null;if(o&&o.readyState>1&&o.seeking===!1){var g=o.currentTime;if(Ht.isBuffered(o,g)?h=this.getAppendedFrag(g):Ht.isBuffered(o,g+.1)&&(h=this.getAppendedFrag(g+.1)),h){this.backtrackFragment=null;var p=this.fragPlaying,v=h.level;p&&h.sn===p.sn&&p.level===v&&h.urlId===p.urlId||(this.fragPlaying=h,this.hls.trigger(b.Events.FRAG_CHANGED,{frag:h}),p&&p.level===v||this.hls.trigger(b.Events.LEVEL_SWITCHED,{level:v}))}}},u=s,(c=[{key:"nextLevel",get:function(){var o=this.nextBufferedFrag;return o?o.level:-1}},{key:"currentFrag",get:function(){var o=this.media;return o?this.fragPlaying||this.getAppendedFrag(o.currentTime):null}},{key:"currentProgramDateTime",get:function(){var o=this.media;if(o){var h=o.currentTime,g=this.currentFrag;if(g&&(0,C.isFiniteNumber)(h)&&(0,C.isFiniteNumber)(g.programDateTime)){var p=g.programDateTime+1e3*(h-g.start);return new Date(p)}}return null}},{key:"currentLevel",get:function(){var o=this.currentFrag;return o?o.level:-1}},{key:"nextBufferedFrag",get:function(){var o=this.currentFrag;return o?this.followingBufferedFrag(o):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&b0(u.prototype,c),Object.defineProperty(u,"prototype",{writable:!1}),s}(Ba);const Es=function(){function T(i,s,u){s===void 0&&(s=0),u===void 0&&(u=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=i,this.alpha_=i?Math.exp(Math.log(.5)/i):0,this.estimate_=s,this.totalWeight_=u}var d=T.prototype;return d.sample=function(i,s){var u=Math.pow(this.alpha_,i);this.estimate_=s*(1-u)+u*this.estimate_,this.totalWeight_+=i},d.getTotalWeight=function(){return this.totalWeight_},d.getEstimate=function(){if(this.alpha_){var i=1-Math.pow(this.alpha_,this.totalWeight_);if(i)return this.estimate_/i}return this.estimate_},T}(),A0=function(){function T(i,s,u){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=u,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Es(i),this.fast_=new Es(s)}var d=T.prototype;return d.update=function(i,s){var u=this.slow_,c=this.fast_;this.slow_.halfLife!==i&&(this.slow_=new Es(i,u.getEstimate(),u.getTotalWeight())),this.fast_.halfLife!==s&&(this.fast_=new Es(s,c.getEstimate(),c.getTotalWeight()))},d.sample=function(i,s){var u=(i=Math.max(i,this.minDelayMs_))/1e3,c=8*s/u;this.fast_.sample(u,c),this.slow_.sample(u,c)},d.canEstimate=function(){var i=this.fast_;return i&&i.getTotalWeight()>=this.minWeight_},d.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},d.destroy=function(){},T}();function _0(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}const S0=function(){function T(u){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=u;var c=u.config;this.bwEstimator=new A0(c.abrEwmaSlowVoD,c.abrEwmaFastVoD,c.abrEwmaDefaultEstimate),this.registerListeners()}var d,i,s=T.prototype;return s.registerListeners=function(){var u=this.hls;u.on(b.Events.FRAG_LOADING,this.onFragLoading,this),u.on(b.Events.FRAG_LOADED,this.onFragLoaded,this),u.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this),u.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),u.on(b.Events.ERROR,this.onError,this)},s.unregisterListeners=function(){var u=this.hls;u.off(b.Events.FRAG_LOADING,this.onFragLoading,this),u.off(b.Events.FRAG_LOADED,this.onFragLoaded,this),u.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this),u.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),u.off(b.Events.ERROR,this.onError,this)},s.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},s.onFragLoading=function(u,c){var l,o=c.frag;o.type===x.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=o,this.partCurrent=(l=c.part)!=null?l:null,this.timer=self.setInterval(this.onCheck,100)))},s.onLevelLoaded=function(u,c){var l=this.hls.config;c.details.live?this.bwEstimator.update(l.abrEwmaSlowLive,l.abrEwmaFastLive):this.bwEstimator.update(l.abrEwmaSlowVoD,l.abrEwmaFastVoD)},s._abandonRulesCheck=function(){var u=this.fragCurrent,c=this.partCurrent,l=this.hls,o=l.autoLevelEnabled,h=l.media;if(u&&h){var g=c?c.stats:u.stats,p=c?c.duration:u.duration;if(g.aborted||g.loaded&&g.loaded===g.total||u.level===0)return this.clearTimer(),void(this._nextAutoLevel=-1);if(o&&!h.paused&&h.playbackRate&&h.readyState){var v=l.mainForwardBufferInfo;if(v!==null){var S=performance.now()-g.loading.start,R=Math.abs(h.playbackRate);if(!(S<=500*p/R)){var k=g.loaded&&g.loading.first,M=this.bwEstimator.getEstimate(),V=l.levels,K=l.minAutoLevel,Z=V[u.level],de=g.total||Math.max(g.loaded,Math.round(p*Z.maxBitrate/8)),_e=k?1e3*g.loaded/S:0,Te=_e?(de-g.loaded)/_e:8*de/M,De=v.len/R;if(!(Te<=De)){var ze,st=Number.POSITIVE_INFINITY;for(ze=u.level-1;ze>K;ze--){var Se=V[ze].maxBitrate;if((st=_e?p*Se/(6.4*_e):p*Se/M)<De)break}st>=Te||(O.logger.warn("Fragment "+u.sn+(c?" part "+c.index:"")+" of level "+u.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+ze+`
      Current BW estimate: `+((0,C.isFiniteNumber)(M)?(M/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+Te.toFixed(3)+` s
      Estimated load time for the next fragment: `+st.toFixed(3)+` s
      Time to underbuffer: `+De.toFixed(3)+" s"),l.nextLoadLevel=ze,k&&this.bwEstimator.sample(S,g.loaded),this.clearTimer(),(u.loader||u.keyLoader)&&(this.fragCurrent=this.partCurrent=null,u.abortRequests()),l.trigger(b.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:u,part:c,stats:g}))}}}}}},s.onFragLoaded=function(u,c){var l=c.frag,o=c.part;if(l.type===x.PlaylistLevelType.MAIN&&(0,C.isFiniteNumber)(l.sn)){var h=o?o.stats:l.stats,g=o?o.duration:l.duration;if(this.clearTimer(),this.lastLoadedFragLevel=l.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var p=this.hls.levels[l.level],v=(p.loaded?p.loaded.bytes:0)+h.loaded,S=(p.loaded?p.loaded.duration:0)+g;p.loaded={bytes:v,duration:S},p.realBitrate=Math.round(8*v/S)}if(l.bitrateTest){var R={stats:h,frag:l,part:o,id:l.type};this.onFragBuffered(b.Events.FRAG_BUFFERED,R)}}},s.onFragBuffered=function(u,c){var l=c.frag,o=c.part,h=o?o.stats:l.stats;if(!h.aborted&&l.type===x.PlaylistLevelType.MAIN&&l.sn!=="initSegment"){var g=h.parsing.end-h.loading.start;this.bwEstimator.sample(g,h.loaded),h.bwEstimate=this.bwEstimator.getEstimate(),l.bitrateTest?this.bitrateTestDelay=g/1e3:this.bitrateTestDelay=0}},s.onError=function(u,c){var l;if(((l=c.frag)===null||l===void 0?void 0:l.type)===x.PlaylistLevelType.MAIN){if(c.type===L.ErrorTypes.KEY_SYSTEM_ERROR)return void this.clearTimer();switch(c.details){case L.ErrorDetails.FRAG_LOAD_ERROR:case L.ErrorDetails.FRAG_LOAD_TIMEOUT:case L.ErrorDetails.KEY_LOAD_ERROR:case L.ErrorDetails.KEY_LOAD_TIMEOUT:this.clearTimer()}}},s.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},s.getNextABRAutoLevel=function(){var u=this.fragCurrent,c=this.partCurrent,l=this.hls,o=l.maxAutoLevel,h=l.config,g=l.minAutoLevel,p=l.media,v=c?c.duration:u?u.duration:0,S=p&&p.playbackRate!==0?Math.abs(p.playbackRate):1,R=this.bwEstimator?this.bwEstimator.getEstimate():h.abrEwmaDefaultEstimate,k=l.mainForwardBufferInfo,M=(k?k.len:0)/S,V=this.findBestLevel(R,g,o,M,h.abrBandWidthFactor,h.abrBandWidthUpFactor);if(V>=0)return V;O.logger.trace((M?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var K=v?Math.min(v,h.maxStarvationDelay):h.maxStarvationDelay,Z=h.abrBandWidthFactor,de=h.abrBandWidthUpFactor;if(!M){var _e=this.bitrateTestDelay;_e&&(K=(v?Math.min(v,h.maxLoadingDelay):h.maxLoadingDelay)-_e,O.logger.trace("bitrate test took "+Math.round(1e3*_e)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*K)+" ms"),Z=de=1)}return V=this.findBestLevel(R,g,o,M+K,Z,de),Math.max(V,0)},s.findBestLevel=function(u,c,l,o,h,g){for(var p,v=this.fragCurrent,S=this.partCurrent,R=this.lastLoadedFragLevel,k=this.hls.levels,M=k[R],V=!(M==null||(p=M.details)===null||p===void 0||!p.live),K=M==null?void 0:M.codecSet,Z=S?S.duration:v?v.duration:0,de=l;de>=c;de--){var _e=k[de];if(_e&&(!K||_e.codecSet===K)){var Te,De=_e.details,ze=(S?De==null?void 0:De.partTarget:De==null?void 0:De.averagetargetduration)||Z;Te=de<=R?h*u:g*u;var st=k[de].maxBitrate,Se=st*ze/Te;if(O.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+de+"/"+Math.round(Te)+"/"+st+"/"+ze+"/"+o+"/"+Se),Te>st&&(Se===0||!(0,C.isFiniteNumber)(Se)||V&&!this.bitrateTestDelay||Se<o))return de}}return-1},d=T,(i=[{key:"nextAutoLevel",get:function(){var u=this._nextAutoLevel,c=this.bwEstimator;if(u!==-1&&!c.canEstimate())return u;var l=this.getNextABRAutoLevel();return u!==-1&&this.hls.levels[l].loadError?u:(u!==-1&&(l=Math.min(u,l)),l)},set:function(u){this._nextAutoLevel=u}}])&&_0(d.prototype,i),Object.defineProperty(d,"prototype",{writable:!1}),T}();var mc=function(){function T(){this.chunks=[],this.dataLength=0}var d=T.prototype;return d.push=function(i){this.chunks.push(i),this.dataLength+=i.length},d.flush=function(){var i,s=this.chunks,u=this.dataLength;return s.length?(i=s.length===1?s[0]:function(c,l){for(var o=new Uint8Array(l),h=0,g=0;g<c.length;g++){var p=c[g];o.set(p,h),h+=p.length}return o}(s,u),this.reset(),i):new Uint8Array(0)},d.reset=function(){this.chunks.length=0,this.dataLength=0},T}();function Ts(){return Ts=Object.assign?Object.assign.bind():function(T){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(T[s]=i[s])}return T},Ts.apply(this,arguments)}function ja(T,d){return ja=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},ja(T,d)}var I0=function(T){var d,i;function s(c,l,o){var h;return(h=T.call(this,c,l,o,"[audio-stream-controller]")||this).videoBuffer=null,h.videoTrackCC=-1,h.waitingVideoCC=-1,h.audioSwitch=!1,h.trackId=-1,h.waitingData=null,h.mainDetails=null,h.bufferFlushed=!1,h.cachedTrackLoadedData=null,h._registerListeners(),h}i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,ja(d,i);var u=s.prototype;return u.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},u._registerListeners=function(){var c=this.hls;c.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.on(b.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),c.on(b.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),c.on(b.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.on(b.Events.ERROR,this.onError,this),c.on(b.Events.BUFFER_RESET,this.onBufferReset,this),c.on(b.Events.BUFFER_CREATED,this.onBufferCreated,this),c.on(b.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),c.on(b.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),c.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},u._unregisterListeners=function(){var c=this.hls;c.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.off(b.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),c.off(b.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),c.off(b.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.off(b.Events.ERROR,this.onError,this),c.off(b.Events.BUFFER_RESET,this.onBufferReset,this),c.off(b.Events.BUFFER_CREATED,this.onBufferCreated,this),c.off(b.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),c.off(b.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),c.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},u.onInitPtsFound=function(c,l){var o=l.frag,h=l.id,g=l.initPTS;if(h==="main"){var p=o.cc;this.initPTS[o.cc]=g,this.log("InitPTS for cc: "+p+" found from main: "+g),this.videoTrackCC=p,this.state===Ri&&this.tick()}},u.startLoad=function(c){if(!this.levels)return this.startPosition=c,void(this.state=Cr);var l=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,l>0&&c===-1?(this.log("Override startPosition with lastCurrentTime @"+l.toFixed(3)),c=l,this.state=Ct):(this.loadedmetadata=!1,this.state=ps),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=c,this.tick()},u.doTick=function(){switch(this.state){case Ct:this.doTickIdle();break;case ps:var c,l=this.levels,o=this.trackId,h=l==null||(c=l[o])===null||c===void 0?void 0:c.details;if(h){if(this.waitForCdnTuneIn(h))break;this.state=Ri}break;case $n:var g,p=performance.now(),v=this.retryDate;(!v||p>=v||(g=this.media)!==null&&g!==void 0&&g.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=Ct);break;case Ri:var S=this.waitingData;if(S){var R=S.frag,k=S.part,M=S.cache,V=S.complete;if(this.initPTS[R.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=Xn;var K={frag:R,part:k,payload:M.flush(),networkDetails:null};this._handleFragmentLoadProgress(K),V&&T.prototype._handleFragmentLoadComplete.call(this,K)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+R.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var Z=this.getLoadPosition(),de=Ht.bufferInfo(this.mediaBuffer,Z,this.config.maxBufferHole);Ma(de.end,this.config.maxFragLookUpTolerance,R)<0&&(this.log("Waiting fragment cc ("+R.cc+") @ "+R.start+" cancelled because another fragment at "+de.end+" is needed"),this.clearWaitingFragment())}}else this.state=Ct}this.onTickEnd()},u.clearWaitingFragment=function(){var c=this.waitingData;c&&(this.fragmentTracker.removeFragment(c.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Ct)},u.resetLoadingState=function(){this.clearWaitingFragment(),T.prototype.resetLoadingState.call(this)},u.onTickEnd=function(){var c=this.media;c&&c.readyState&&(this.lastCurrentTime=c.currentTime)},u.doTickIdle=function(){var c=this.hls,l=this.levels,o=this.media,h=this.trackId,g=c.config;if(l&&l[h]&&(o||!this.startFragRequested&&g.startFragPrefetch)){var p=l[h].details;if(!p||p.live&&this.levelLastLoaded!==h||this.waitForCdnTuneIn(p))this.state=ps;else{var v=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&v&&(this.bufferFlushed=!1,this.afterBufferFlushed(v,ue.ElementaryStreamTypes.AUDIO,x.PlaylistLevelType.AUDIO));var S=this.getFwdBufferInfo(v,x.PlaylistLevelType.AUDIO);if(S!==null){var R=this.audioSwitch;if(!R&&this._streamEnded(S,p))return c.trigger(b.Events.BUFFER_EOS,{type:"audio"}),void(this.state=Li);var k=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,x.PlaylistLevelType.MAIN);if(!(S.len>=this.getMaxBufferLength(k==null?void 0:k.len))||R){var M=p.fragments[0].start,V=S.end;if(R&&o){var K=this.getLoadPosition();V=K,p.PTSKnown&&K<M&&(S.end>M||S.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),o.currentTime=M+.05)}if(!(k&&V>k.end+p.targetduration)&&(k&&k.len||!S.len)){var Z=this.getNextFragment(V,p);Z?this.loadFragment(Z,p,V):this.bufferFlushed=!0}}}}}},u.getMaxBufferLength=function(c){var l=T.prototype.getMaxBufferLength.call(this);return c?Math.max(l,c):l},u.onMediaDetaching=function(){this.videoBuffer=null,T.prototype.onMediaDetaching.call(this)},u.onAudioTracksUpdated=function(c,l){var o=l.audioTracks;this.resetTransmuxer(),this.levels=o.map(function(h){return new W(h)})},u.onAudioTrackSwitching=function(c,l){var o=!!l.url;this.trackId=l.id;var h=this.fragCurrent;h&&h.abortRequests(),this.fragCurrent=null,this.clearWaitingFragment(),o?this.setInterval(100):this.resetTransmuxer(),o?(this.audioSwitch=!0,this.state=Ct):this.state=Cr,this.tick()},u.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},u.onLevelLoaded=function(c,l){this.mainDetails=l.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(b.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},u.onAudioTrackLoaded=function(c,l){var o;if(this.mainDetails!=null){var h=this.levels,g=l.details,p=l.id;if(h){this.log("Track "+p+" loaded ["+g.startSN+","+g.endSN+"],duration:"+g.totalduration);var v=h[p],S=0;if(g.live||(o=v.details)!==null&&o!==void 0&&o.live){var R=this.mainDetails;if(g.fragments[0]||(g.deltaUpdateFailed=!0),g.deltaUpdateFailed||!R)return;!v.details&&g.hasProgramDateTime&&R.hasProgramDateTime?(oc(g,R),S=g.fragments[0].start):S=this.alignPlaylists(g,v.details)}v.details=g,this.levelLastLoaded=p,this.startFragRequested||!this.mainDetails&&g.live||this.setStartPosition(v.details,S),this.state!==ps||this.waitForCdnTuneIn(g)||(this.state=Ct),this.tick()}else this.warn("Audio tracks were reset while loading level "+p)}else this.cachedTrackLoadedData=l},u._handleFragmentLoadProgress=function(c){var l,o=c.frag,h=c.part,g=c.payload,p=this.config,v=this.trackId,S=this.levels;if(S){var R=S[v],k=R.details,M=p.defaultAudioCodec||R.audioCodec||"mp4a.40.2",V=this.transmuxer;V||(V=this.transmuxer=new gc(this.hls,x.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var K=this.initPTS[o.cc],Z=(l=o.initSegment)===null||l===void 0?void 0:l.data;if(K!==void 0){var de=h?h.index:-1,_e=de!==-1,Te=new ka(o.level,o.sn,o.stats.chunkCount,g.byteLength,de,_e);V.push(g,Z,M,"",o,h,k.totalduration,!1,Te,K)}else this.log("Unknown video PTS for cc "+o.cc+", waiting for video PTS before demuxing audio frag "+o.sn+" of ["+k.startSN+" ,"+k.endSN+"],track "+v),(this.waitingData=this.waitingData||{frag:o,part:h,cache:new mc,complete:!1}).cache.push(new Uint8Array(g)),this.waitingVideoCC=this.videoTrackCC,this.state=Ri}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+o.sn+" of level "+o.level+" will not be buffered")},u._handleFragmentLoadComplete=function(c){this.waitingData?this.waitingData.complete=!0:T.prototype._handleFragmentLoadComplete.call(this,c)},u.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},u.onBufferCreated=function(c,l){var o=l.tracks.audio;o&&(this.mediaBuffer=o.buffer||null),l.tracks.video&&(this.videoBuffer=l.tracks.video.buffer||null)},u.onFragBuffered=function(c,l){var o,h=l.frag,g=l.part;h.type===x.PlaylistLevelType.AUDIO?this.fragContextChanged(h)?this.warn("Fragment "+h.sn+(g?" p: "+g.index:"")+" of level "+h.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):(h.sn!=="initSegment"&&(this.fragPrevious=h,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(b.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(h,g)):this.loadedmetadata||h.type!==x.PlaylistLevelType.MAIN||(o=this.videoBuffer||this.media)!==null&&o!==void 0&&o.buffered.length&&(this.loadedmetadata=!0)},u.onError=function(c,l){if(l.type!==L.ErrorTypes.KEY_SYSTEM_ERROR)switch(l.details){case L.ErrorDetails.FRAG_LOAD_ERROR:case L.ErrorDetails.FRAG_LOAD_TIMEOUT:case L.ErrorDetails.FRAG_PARSING_ERROR:case L.ErrorDetails.KEY_LOAD_ERROR:case L.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(x.PlaylistLevelType.AUDIO,l);break;case L.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case L.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==Qr&&this.state!==Cr&&(this.state=l.fatal?Qr:Ct,this.warn(l.details+" while loading frag, switching to "+this.state+" state"));break;case L.ErrorDetails.BUFFER_FULL_ERROR:if(l.parent==="audio"&&(this.state===Mr||this.state===Ci)){var o=!0,h=this.getFwdBufferInfo(this.mediaBuffer,x.PlaylistLevelType.AUDIO);h&&h.len>.5&&(o=!this.reduceMaxBufferLength(h.len)),o&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,T.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(x.PlaylistLevelType.AUDIO,l)},u.onBufferFlushed=function(c,l){l.type===ue.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===Li&&(this.state=Ct))},u._handleTransmuxComplete=function(c){var l,o="audio",h=this.hls,g=c.remuxResult,p=c.chunkMeta,v=this.getCurrentContext(p);if(!v)return this.warn("The loading context changed while buffering fragment "+p.sn+" of level "+p.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(p.level);var S=v.frag,R=v.part,k=v.level.details,M=g.audio,V=g.text,K=g.id3,Z=g.initSegment;if(!this.fragContextChanged(S)&&k){if(this.state=Mr,this.audioSwitch&&M&&this.completeAudioSwitch(),Z!=null&&Z.tracks&&(this._bufferInitSegment(Z.tracks,S,p),h.trigger(b.Events.FRAG_PARSING_INIT_SEGMENT,{frag:S,id:o,tracks:Z.tracks})),M){var de=M.startPTS,_e=M.endPTS,Te=M.startDTS,De=M.endDTS;R&&(R.elementaryStreams[ue.ElementaryStreamTypes.AUDIO]={startPTS:de,endPTS:_e,startDTS:Te,endDTS:De}),S.setElementaryStreamInfo(ue.ElementaryStreamTypes.AUDIO,de,_e,Te,De),this.bufferFragmentData(M,S,R,p)}if(K!=null&&(l=K.samples)!==null&&l!==void 0&&l.length){var ze=Ts({id:o,frag:S,details:k},K);h.trigger(b.Events.FRAG_PARSING_METADATA,ze)}if(V){var st=Ts({id:o,frag:S,details:k},V);h.trigger(b.Events.FRAG_PARSING_USERDATA,st)}}},u._bufferInitSegment=function(c,l,o){if(this.state===Mr){c.video&&delete c.video;var h=c.audio;if(h){h.levelCodec=h.codec,h.id="audio",this.log("Init audio buffer, container:"+h.container+", codecs[parsed]=["+h.codec+"]"),this.hls.trigger(b.Events.BUFFER_CODECS,c);var g=h.initSegment;if(g!=null&&g.byteLength){var p={type:"audio",frag:l,part:null,chunkMeta:o,parent:l.type,data:g};this.hls.trigger(b.Events.BUFFER_APPENDING,p)}this.tick()}}},u.loadFragment=function(c,l,o){var h=this.fragmentTracker.getState(c);this.fragCurrent=c,(this.audioSwitch||h===qe.NOT_LOADED||h===qe.PARTIAL)&&(c.sn==="initSegment"?this._loadInitSegment(c,l):l.live&&!(0,C.isFiniteNumber)(this.initPTS[c.cc])?(this.log("Waiting for video PTS in continuity counter "+c.cc+" of live stream before loading audio fragment "+c.sn+" of level "+this.trackId),this.state=Ri):(this.startFragRequested=!0,T.prototype.loadFragment.call(this,c,l,o)))},u.completeAudioSwitch=function(){var c=this.hls,l=this.media,o=this.trackId;l&&(this.log("Switching audio track : flushing all audio"),T.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,c.trigger(b.Events.AUDIO_TRACK_SWITCHED,{id:o})},s}(Ba);const C0=I0;function L0(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}function Va(T,d){return Va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Va(T,d)}const R0=function(T){var d,i;function s(o){var h;return(h=T.call(this,o,"[audio-track-controller]")||this).tracks=[],h.groupId=null,h.tracksInGroup=[],h.trackId=-1,h.trackName="",h.selectDefaultTrack=!0,h.registerListeners(),h}i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,Va(d,i);var u,c,l=s.prototype;return l.registerListeners=function(){var o=this.hls;o.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(b.Events.LEVEL_LOADING,this.onLevelLoading,this),o.on(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.on(b.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.on(b.Events.ERROR,this.onError,this)},l.unregisterListeners=function(){var o=this.hls;o.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(b.Events.LEVEL_LOADING,this.onLevelLoading,this),o.off(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.off(b.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.off(b.Events.ERROR,this.onError,this)},l.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,T.prototype.destroy.call(this)},l.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},l.onManifestParsed=function(o,h){this.tracks=h.audioTracks||[]},l.onAudioTrackLoaded=function(o,h){var g=h.id,p=h.details,v=this.tracksInGroup[g];if(v){var S=v.details;v.details=h.details,this.log("audioTrack "+g+" loaded ["+p.startSN+"-"+p.endSN+"]"),g===this.trackId&&(this.retryCount=0,this.playlistLoaded(g,h,S))}else this.warn("Invalid audio track id "+g)},l.onLevelLoading=function(o,h){this.switchLevel(h.level)},l.onLevelSwitching=function(o,h){this.switchLevel(h.level)},l.switchLevel=function(o){var h=this.hls.levels[o];if(h!=null&&h.audioGroupIds){var g=h.audioGroupIds[h.urlId];if(this.groupId!==g){this.groupId=g;var p=this.tracks.filter(function(S){return!g||S.groupId===g});this.selectDefaultTrack&&!p.some(function(S){return S.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=p;var v={audioTracks:p};this.log("Updating audio tracks, "+p.length+' track(s) found in "'+g+'" group-id'),this.hls.trigger(b.Events.AUDIO_TRACKS_UPDATED,v),this.selectInitialTrack()}}},l.onError=function(o,h){T.prototype.onError.call(this,o,h),!h.fatal&&h.context&&h.context.type===x.PlaylistContextType.AUDIO_TRACK&&h.context.id===this.trackId&&h.context.groupId===this.groupId&&this.retryLoadingOrFail(h)},l.setAudioTrack=function(o){var h=this.tracksInGroup;if(o<0||o>=h.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var g=h[this.trackId];this.log("Now switching to audio-track index "+o);var p=h[o],v=p.id,S=p.groupId,R=S===void 0?"":S,k=p.name,M=p.type,V=p.url;if(this.trackId=o,this.trackName=k,this.selectDefaultTrack=!1,this.hls.trigger(b.Events.AUDIO_TRACK_SWITCHING,{id:v,groupId:R,name:k,type:M,url:V}),!p.details||p.details.live){var K=this.switchParams(p.url,g==null?void 0:g.details);this.loadPlaylist(K)}}},l.selectInitialTrack=function(){this.tracksInGroup;var o=this.trackName,h=this.findTrackId(o)||this.findTrackId();h!==-1?this.setAudioTrack(h):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},l.findTrackId=function(o){for(var h=this.tracksInGroup,g=0;g<h.length;g++){var p=h[g];if((!this.selectDefaultTrack||p.default)&&(!o||o===p.name))return p.id}return-1},l.loadPlaylist=function(o){T.prototype.loadPlaylist.call(this);var h=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(h)){var g=h.id,p=h.groupId,v=h.url;if(o)try{v=o.addDirectives(v)}catch(S){this.warn("Could not construct new URL with HLS Delivery Directives: "+S)}this.log("loading audio-track playlist for id: "+g),this.clearTimer(),this.hls.trigger(b.Events.AUDIO_TRACK_LOADING,{url:v,id:g,groupId:p,deliveryDirectives:o||null})}},u=s,(c=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(o){this.selectDefaultTrack=!1,this.setAudioTrack(o)}}])&&L0(u.prototype,c),Object.defineProperty(u,"prototype",{writable:!1}),s}(xe);function D0(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}function qa(T,d){return qa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},qa(T,d)}var N0=function(T){var d,i;function s(o,h,g){var p;return(p=T.call(this,o,h,g,"[subtitle-stream-controller]")||this).levels=[],p.currentTrackId=-1,p.tracksBuffered=[],p.mainDetails=null,p._registerListeners(),p}i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,qa(d,i);var u,c,l=s.prototype;return l.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},l._registerListeners=function(){var o=this.hls;o.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(b.Events.ERROR,this.onError,this),o.on(b.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.on(b.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),o.on(b.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.on(b.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),o.on(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.on(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},l._unregisterListeners=function(){var o=this.hls;o.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(b.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(b.Events.ERROR,this.onError,this),o.off(b.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.off(b.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),o.off(b.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.off(b.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),o.off(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.off(b.Events.FRAG_BUFFERED,this.onFragBuffered,this)},l.startLoad=function(o){this.stopLoad(),this.state=Ct,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=o,this.tick()},l.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},l.onLevelLoaded=function(o,h){this.mainDetails=h.details},l.onSubtitleFragProcessed=function(o,h){var g=h.frag,p=h.success;if(this.fragPrevious=g,this.state=Ct,p){var v=this.tracksBuffered[this.currentTrackId];if(v){for(var S,R=g.start,k=0;k<v.length;k++)if(R>=v[k].start&&R<=v[k].end){S=v[k];break}var M=g.start+g.duration;S?S.end=M:(S={start:R,end:M},v.push(S)),this.fragmentTracker.fragBuffered(g)}}},l.onBufferFlushing=function(o,h){var g=h.startOffset,p=h.endOffset;if(g===0&&p!==Number.POSITIVE_INFINITY){var v=this.currentTrackId,S=this.levels;if(!S.length||!S[v]||!S[v].details)return;var R=p-S[v].details.targetduration;if(R<=0)return;h.endOffsetSubtitles=Math.max(0,R),this.tracksBuffered.forEach(function(k){for(var M=0;M<k.length;)if(k[M].end<=R)k.shift();else{if(!(k[M].start<R))break;k[M].start=R,M++}}),this.fragmentTracker.removeFragmentsInRange(g,R,x.PlaylistLevelType.SUBTITLE)}},l.onFragBuffered=function(o,h){var g;this.loadedmetadata||h.frag.type!==x.PlaylistLevelType.MAIN||(g=this.media)!==null&&g!==void 0&&g.buffered.length&&(this.loadedmetadata=!0)},l.onError=function(o,h){var g=h.frag;g&&g.type===x.PlaylistLevelType.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state=Ct)},l.onSubtitleTracksUpdated=function(o,h){var g=this,p=h.subtitleTracks;this.tracksBuffered=[],this.levels=p.map(function(v){return new W(v)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(v){g.tracksBuffered[v.id]=[]}),this.mediaBuffer=null},l.onSubtitleTrackSwitch=function(o,h){if(this.currentTrackId=h.id,this.levels.length&&this.currentTrackId!==-1){var g=this.levels[this.currentTrackId];g!=null&&g.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,g&&this.setInterval(500)}else this.clearInterval()},l.onSubtitleTrackLoaded=function(o,h){var g,p=h.details,v=h.id,S=this.currentTrackId,R=this.levels;if(R.length){var k=R[S];if(!(v>=R.length||v!==S)&&k){this.mediaBuffer=this.mediaBufferTimeRanges;var M=0;if(p.live||(g=k.details)!==null&&g!==void 0&&g.live){var V=this.mainDetails;if(p.deltaUpdateFailed||!V)return;var K=V.fragments[0];k.details?(M=this.alignPlaylists(p,k.details))===0&&K&&ye(p,M=K.start):p.hasProgramDateTime&&V.hasProgramDateTime?(oc(p,V),M=p.fragments[0].start):K&&ye(p,M=K.start)}k.details=p,this.levelLastLoaded=v,this.startFragRequested||!this.mainDetails&&p.live||this.setStartPosition(k.details,M),this.tick(),p.live&&!this.fragCurrent&&this.media&&this.state===Ct&&(wa(null,p.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),k.details=void 0))}}},l._handleFragmentLoadComplete=function(o){var h=this,g=o.frag,p=o.payload,v=g.decryptdata,S=this.hls;if(!this.fragContextChanged(g)&&p&&p.byteLength>0&&v&&v.key&&v.iv&&v.method==="AES-128"){var R=performance.now();this.decrypter.decrypt(new Uint8Array(p),v.key.buffer,v.iv.buffer).then(function(k){var M=performance.now();S.trigger(b.Events.FRAG_DECRYPTED,{frag:g,payload:k,stats:{tstart:R,tdecrypt:M}})}).catch(function(k){h.warn(k.name+": "+k.message),h.state=Ct})}},l.doTick=function(){if(this.media){if(this.state===Ct){var o=this.currentTrackId,h=this.levels;if(!h.length||!h[o]||!h[o].details)return;var g=h[o].details,p=g.targetduration,v=this.config,S=this.getLoadPosition(),R=Ht.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],S-p,v.maxBufferHole),k=R.end,M=R.len,V=this.getFwdBufferInfo(this.media,x.PlaylistLevelType.MAIN);if(M>this.getMaxBufferLength(V==null?void 0:V.len)+p)return;var K=g.fragments,Z=K.length,de=g.edge,_e=null,Te=this.fragPrevious;if(k<de){var De=v.maxFragLookUpTolerance;!(_e=wa(Te,K,Math.max(K[0].start,k),De))&&Te&&Te.start<K[0].start&&(_e=K[0])}else _e=K[Z-1];if(!_e)return;_e=this.mapToInitFragWhenRequired(_e),this.fragmentTracker.getState(_e)===qe.NOT_LOADED&&this.loadFragment(_e,g,k)}}else this.state=Ct},l.getMaxBufferLength=function(o){var h=T.prototype.getMaxBufferLength.call(this);return o?Math.max(h,o):h},l.loadFragment=function(o,h,g){this.fragCurrent=o,o.sn==="initSegment"?this._loadInitSegment(o,h):(this.startFragRequested=!0,T.prototype.loadFragment.call(this,o,h,g))},u=s,(c=[{key:"mediaBufferTimeRanges",get:function(){return new O0(this.tracksBuffered[this.currentTrackId]||[])}}])&&D0(u.prototype,c),Object.defineProperty(u,"prototype",{writable:!1}),s}(Ba),O0=function(T){this.buffered=void 0;var d=function(i,s,u){if((s>>>=0)>u-1)throw new DOMException("Failed to execute '"+i+"' on 'TimeRanges': The index provided ("+s+") is greater than the maximum bound ("+u+")");return T[s][i]};this.buffered={get length(){return T.length},end:function(i){return d("end",i,T.length)},start:function(i){return d("start",i,T.length)}}};function x0(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}function Wa(T,d){return Wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Wa(T,d)}function Xa(T){for(var d=[],i=0;i<T.length;i++){var s=T[i];s.kind==="subtitles"&&s.label&&d.push(T[i])}return d}const k0=function(T){var d,i;function s(o){var h;return(h=T.call(this,o,"[subtitle-track-controller]")||this).media=null,h.tracks=[],h.groupId=null,h.tracksInGroup=[],h.trackId=-1,h.selectDefaultTrack=!0,h.queuedDefaultTrack=-1,h.trackChangeListener=function(){return h.onTextTracksChanged()},h.asyncPollTrackChange=function(){return h.pollTrackChange(0)},h.useTextTrackPolling=!1,h.subtitlePollingInterval=-1,h._subtitleDisplay=!0,h.registerListeners(),h}i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,Wa(d,i);var u,c,l=s.prototype;return l.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,T.prototype.destroy.call(this)},l.registerListeners=function(){var o=this.hls;o.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(b.Events.LEVEL_LOADING,this.onLevelLoading,this),o.on(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.on(b.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.on(b.Events.ERROR,this.onError,this)},l.unregisterListeners=function(){var o=this.hls;o.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(b.Events.LEVEL_LOADING,this.onLevelLoading,this),o.off(b.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.off(b.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.off(b.Events.ERROR,this.onError,this)},l.onMediaAttached=function(o,h){this.media=h.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},l.pollTrackChange=function(o){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,o)},l.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Xa(this.media.textTracks).forEach(function(o){Fe(o)}),this.subtitleTrack=-1,this.media=null)},l.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},l.onManifestParsed=function(o,h){this.tracks=h.subtitleTracks},l.onSubtitleTrackLoaded=function(o,h){var g=h.id,p=h.details,v=this.trackId,S=this.tracksInGroup[v];if(S){var R=S.details;S.details=h.details,this.log("subtitle track "+g+" loaded ["+p.startSN+"-"+p.endSN+"]"),g===this.trackId&&(this.retryCount=0,this.playlistLoaded(g,h,R))}else this.warn("Invalid subtitle track id "+g)},l.onLevelLoading=function(o,h){this.switchLevel(h.level)},l.onLevelSwitching=function(o,h){this.switchLevel(h.level)},l.switchLevel=function(o){var h=this.hls.levels[o];if(h!=null&&h.textGroupIds){var g=h.textGroupIds[h.urlId];if(this.groupId!==g){var p=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,v=this.tracks.filter(function(k){return!g||k.groupId===g});this.tracksInGroup=v;var S=this.findTrackId(p==null?void 0:p.name)||this.findTrackId();this.groupId=g;var R={subtitleTracks:v};this.log("Updating subtitle tracks, "+v.length+' track(s) found in "'+g+'" group-id'),this.hls.trigger(b.Events.SUBTITLE_TRACKS_UPDATED,R),S!==-1&&this.setSubtitleTrack(S,p)}}},l.findTrackId=function(o){for(var h=this.tracksInGroup,g=0;g<h.length;g++){var p=h[g];if((!this.selectDefaultTrack||p.default)&&(!o||o===p.name))return p.id}return-1},l.onError=function(o,h){T.prototype.onError.call(this,o,h),!h.fatal&&h.context&&h.context.type===x.PlaylistContextType.SUBTITLE_TRACK&&h.context.id===this.trackId&&h.context.groupId===this.groupId&&this.retryLoadingOrFail(h)},l.loadPlaylist=function(o){T.prototype.loadPlaylist.call(this);var h=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(h)){var g=h.id,p=h.groupId,v=h.url;if(o)try{v=o.addDirectives(v)}catch(S){this.warn("Could not construct new URL with HLS Delivery Directives: "+S)}this.log("Loading subtitle playlist for id "+g),this.hls.trigger(b.Events.SUBTITLE_TRACK_LOADING,{url:v,id:g,groupId:p,deliveryDirectives:o||null})}},l.toggleTrackModes=function(o){var h=this,g=this.media,p=this.trackId;if(g){var v=Xa(g.textTracks),S=v.filter(function(M){return M.groupId===h.groupId});if(o===-1)[].slice.call(v).forEach(function(M){M.mode="disabled"});else{var R=S[p];R&&(R.mode="disabled")}var k=S[o];k&&(k.mode=this.subtitleDisplay?"showing":"hidden")}},l.setSubtitleTrack=function(o,h){var g,p=this.tracksInGroup;if(this.media){if(this.trackId!==o&&this.toggleTrackModes(o),!(this.trackId===o&&(o===-1||(g=p[o])!==null&&g!==void 0&&g.details)||o<-1||o>=p.length)){this.clearTimer();var v=p[o];if(this.log("Switching to subtitle track "+o),this.trackId=o,v){var S=v.id,R=v.groupId,k=R===void 0?"":R,M=v.name,V=v.type,K=v.url;this.hls.trigger(b.Events.SUBTITLE_TRACK_SWITCH,{id:S,groupId:k,name:M,type:V,url:K});var Z=this.switchParams(v.url,h==null?void 0:h.details);this.loadPlaylist(Z)}else this.hls.trigger(b.Events.SUBTITLE_TRACK_SWITCH,{id:o})}}else this.queuedDefaultTrack=o},l.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var o=-1,h=Xa(this.media.textTracks),g=0;g<h.length;g++)if(h[g].mode==="hidden")o=g;else if(h[g].mode==="showing"){o=g;break}this.subtitleTrack!==o&&(this.subtitleTrack=o)}},u=s,(c=[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(o){this._subtitleDisplay=o,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(o){this.selectDefaultTrack=!1;var h=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(o,h)}}])&&x0(u.prototype,c),Object.defineProperty(u,"prototype",{writable:!1}),s}(xe);var It,P0=function(){function T(i){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=i}var d=T.prototype;return d.append=function(i,s){var u=this.queues[s];u.push(i),u.length===1&&this.buffers[s]&&this.executeNext(s)},d.insertAbort=function(i,s){this.queues[s].unshift(i),this.executeNext(s)},d.appendBlocker=function(i){var s,u=new Promise(function(l){s=l}),c={execute:s,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(c,i),u},d.executeNext=function(i){var s=this.buffers,u=this.queues,c=s[i],l=u[i];if(l.length){var o=l[0];try{o.execute()}catch(h){O.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),o.onError(h),c&&c.updating||(l.shift(),this.executeNext(i))}}},d.shiftAndExecuteNext=function(i){this.queues[i].shift(),this.executeNext(i)},d.current=function(i){return this.queues[i][0]},T}(),pc=Ua(),Ec=/([ha]vc.)(?:\.[^.,]+)+/,w0=function(){function T(i){var s=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var u=s.hls,c=s.media,l=s.mediaSource;O.logger.log("[buffer-controller]: Media source opened"),c&&(s.updateMediaElementDuration(),u.trigger(b.Events.MEDIA_ATTACHED,{media:c})),l&&l.removeEventListener("sourceopen",s._onMediaSourceOpen),s.checkPendingTracks()},this._onMediaSourceClose=function(){O.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){O.logger.log("[buffer-controller]: Media source ended")},this.hls=i,this._initSourceBuffer(),this.registerListeners()}var d=T.prototype;return d.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},d.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},d.registerListeners=function(){var i=this.hls;i.on(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(b.Events.BUFFER_RESET,this.onBufferReset,this),i.on(b.Events.BUFFER_APPENDING,this.onBufferAppending,this),i.on(b.Events.BUFFER_CODECS,this.onBufferCodecs,this),i.on(b.Events.BUFFER_EOS,this.onBufferEos,this),i.on(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.on(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.on(b.Events.FRAG_PARSED,this.onFragParsed,this),i.on(b.Events.FRAG_CHANGED,this.onFragChanged,this)},d.unregisterListeners=function(){var i=this.hls;i.off(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(b.Events.BUFFER_RESET,this.onBufferReset,this),i.off(b.Events.BUFFER_APPENDING,this.onBufferAppending,this),i.off(b.Events.BUFFER_CODECS,this.onBufferCodecs,this),i.off(b.Events.BUFFER_EOS,this.onBufferEos,this),i.off(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.off(b.Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.off(b.Events.FRAG_PARSED,this.onFragParsed,this),i.off(b.Events.FRAG_CHANGED,this.onFragChanged,this)},d._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new P0(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null},d.onManifestParsed=function(i,s){var u=2;(s.audio&&!s.video||!s.altAudio)&&(u=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=u,this.details=null,O.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},d.onMediaAttaching=function(i,s){var u=this.media=s.media;if(u&&pc){var c=this.mediaSource=new pc;c.addEventListener("sourceopen",this._onMediaSourceOpen),c.addEventListener("sourceended",this._onMediaSourceEnded),c.addEventListener("sourceclose",this._onMediaSourceClose),u.src=self.URL.createObjectURL(c),this._objectUrl=u.src}},d.onMediaDetaching=function(){var i=this.media,s=this.mediaSource,u=this._objectUrl;if(s){if(O.logger.log("[buffer-controller]: media source detaching"),s.readyState==="open")try{s.endOfStream()}catch(c){O.logger.warn("[buffer-controller]: onMediaDetaching: "+c.message+" while calling endOfStream")}this.onBufferReset(),s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),i&&(u&&self.URL.revokeObjectURL(u),i.src===u?(i.removeAttribute("src"),i.load()):O.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(b.Events.MEDIA_DETACHED,void 0)},d.onBufferReset=function(){var i=this;this.getSourceBufferTypes().forEach(function(s){var u=i.sourceBuffer[s];try{u&&(i.removeBufferListeners(s),i.mediaSource&&i.mediaSource.removeSourceBuffer(u),i.sourceBuffer[s]=void 0)}catch(c){O.logger.warn("[buffer-controller]: Failed to reset the "+s+" buffer",c)}}),this._initSourceBuffer()},d.onBufferCodecs=function(i,s){var u=this,c=this.getSourceBufferTypes().length;Object.keys(s).forEach(function(l){if(c){var o=u.tracks[l];if(o&&typeof o.buffer.changeType=="function"){var h=s[l],g=h.id,p=h.codec,v=h.levelCodec,S=h.container,R=h.metadata,k=(o.levelCodec||o.codec).replace(Ec,"$1"),M=(v||p).replace(Ec,"$1");if(k!==M){var V=S+";codecs="+(v||p);u.appendChangeType(l,V),O.logger.log("[buffer-controller]: switching codec "+k+" to "+M),u.tracks[l]={buffer:o.buffer,codec:p,container:S,levelCodec:v,metadata:R,id:g}}}}else u.pendingTracks[l]=s[l]}),c||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},d.appendChangeType=function(i,s){var u=this,c=this.operationQueue,l={execute:function(){var o=u.sourceBuffer[i];o&&(O.logger.log("[buffer-controller]: changing "+i+" sourceBuffer type to "+s),o.changeType(s)),c.shiftAndExecuteNext(i)},onStart:function(){},onComplete:function(){},onError:function(o){O.logger.warn("[buffer-controller]: Failed to change "+i+" SourceBuffer type",o)}};c.append(l,i)},d.onBufferAppending=function(i,s){var u=this,c=this.hls,l=this.operationQueue,o=this.tracks,h=s.data,g=s.type,p=s.frag,v=s.part,S=s.chunkMeta,R=S.buffering[g],k=self.performance.now();R.start=k;var M=p.stats.buffering,V=v?v.stats.buffering:null;M.start===0&&(M.start=k),V&&V.start===0&&(V.start=k);var K=o.audio,Z=!1;g==="audio"&&(K==null?void 0:K.container)==="audio/mpeg"&&(Z=!this.lastMpegAudioChunk||S.id===1||this.lastMpegAudioChunk.sn!==S.sn,this.lastMpegAudioChunk=S);var de=p.start,_e={execute:function(){if(R.executeStart=self.performance.now(),Z){var Te=u.sourceBuffer[g];if(Te){var De=de-Te.timestampOffset;Math.abs(De)>=.1&&(O.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+de+" (delta: "+De+") sn: "+p.sn+")"),Te.timestampOffset=de)}}u.appendExecutor(h,g)},onStart:function(){},onComplete:function(){var Te=self.performance.now();R.executeEnd=R.end=Te,M.first===0&&(M.first=Te),V&&V.first===0&&(V.first=Te);var De=u.sourceBuffer,ze={};for(var st in De)ze[st]=Ht.getBuffered(De[st]);u.appendError=0,u.hls.trigger(b.Events.BUFFER_APPENDED,{type:g,frag:p,part:v,chunkMeta:S,parent:p.type,timeRanges:ze})},onError:function(Te){O.logger.error("[buffer-controller]: Error encountered while trying to append to the "+g+" SourceBuffer",Te);var De={type:L.ErrorTypes.MEDIA_ERROR,parent:p.type,details:L.ErrorDetails.BUFFER_APPEND_ERROR,err:Te,fatal:!1};Te.code===DOMException.QUOTA_EXCEEDED_ERR?De.details=L.ErrorDetails.BUFFER_FULL_ERROR:(u.appendError++,De.details=L.ErrorDetails.BUFFER_APPEND_ERROR,u.appendError>c.config.appendErrorMaxRetry&&(O.logger.error("[buffer-controller]: Failed "+c.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),De.fatal=!0,c.stopLoad())),c.trigger(b.Events.ERROR,De)}};l.append(_e,g)},d.onBufferFlushing=function(i,s){var u=this,c=this.operationQueue,l=function(o){return{execute:u.removeExecutor.bind(u,o,s.startOffset,s.endOffset),onStart:function(){},onComplete:function(){u.hls.trigger(b.Events.BUFFER_FLUSHED,{type:o})},onError:function(h){O.logger.warn("[buffer-controller]: Failed to remove from "+o+" SourceBuffer",h)}}};s.type?c.append(l(s.type),s.type):this.getSourceBufferTypes().forEach(function(o){c.append(l(o),o)})},d.onFragParsed=function(i,s){var u=this,c=s.frag,l=s.part,o=[],h=l?l.elementaryStreams:c.elementaryStreams;h[ue.ElementaryStreamTypes.AUDIOVIDEO]?o.push("audiovideo"):(h[ue.ElementaryStreamTypes.AUDIO]&&o.push("audio"),h[ue.ElementaryStreamTypes.VIDEO]&&o.push("video")),o.length===0&&O.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+c.type+" level: "+c.level+" sn: "+c.sn),this.blockBuffers(function(){var g=self.performance.now();c.stats.buffering.end=g,l&&(l.stats.buffering.end=g);var p=l?l.stats:c.stats;u.hls.trigger(b.Events.FRAG_BUFFERED,{frag:c,part:l,stats:p,id:c.type})},o)},d.onFragChanged=function(i,s){this.flushBackBuffer()},d.onBufferEos=function(i,s){var u=this;this.getSourceBufferTypes().reduce(function(c,l){var o=u.sourceBuffer[l];return!o||s.type&&s.type!==l||(o.ending=!0,o.ended||(o.ended=!0,O.logger.log("[buffer-controller]: "+l+" sourceBuffer now EOS"))),c&&!(o&&!o.ended)},!0)&&(O.logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(function(){u.getSourceBufferTypes().forEach(function(l){var o=u.sourceBuffer[l];o&&(o.ending=!1)});var c=u.mediaSource;c&&c.readyState==="open"?(O.logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),c.endOfStream()):c&&O.logger.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+c.readyState)}))},d.onLevelUpdated=function(i,s){var u=s.details;u.fragments.length&&(this.details=u,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},d.flushBackBuffer=function(){var i=this.hls,s=this.details,u=this.media,c=this.sourceBuffer;if(u&&s!==null){var l=this.getSourceBufferTypes();if(l.length){var o=s.live&&i.config.liveBackBufferLength!==null?i.config.liveBackBufferLength:i.config.backBufferLength;if((0,C.isFiniteNumber)(o)&&!(o<0)){var h=u.currentTime,g=s.levelTargetDuration,p=Math.max(o,g),v=Math.floor(h/g)*g-p;l.forEach(function(S){var R=c[S];if(R){var k=Ht.getBuffered(R);if(k.length>0&&v>k.start(0)){if(i.trigger(b.Events.BACK_BUFFER_REACHED,{bufferEnd:v}),s.live)i.trigger(b.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:v});else if(R.ended&&k.end(k.length-1)-h<2*g)return void O.logger.info("[buffer-controller]: Cannot flush "+S+" back buffer while SourceBuffer is in ended state");i.trigger(b.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:v,type:S})}}})}}}},d.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&this.mediaSource.readyState==="open"){var i=this.details,s=this.hls,u=this.media,c=this.mediaSource,l=i.fragments[0].start+i.totalduration,o=u.duration,h=(0,C.isFiniteNumber)(c.duration)?c.duration:0;i.live&&s.config.liveDurationInfinity?(O.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),c.duration=1/0,this.updateSeekableRange(i)):(l>h&&l>o||!(0,C.isFiniteNumber)(o))&&(O.logger.log("[buffer-controller]: Updating Media Source duration to "+l.toFixed(3)),c.duration=l)}},d.updateSeekableRange=function(i){var s=this.mediaSource,u=i.fragments;if(u.length&&i.live&&s!=null&&s.setLiveSeekableRange){var c=Math.max(0,u[0].start),l=Math.max(c,c+i.totalduration);s.setLiveSeekableRange(c,l)}},d.checkPendingTracks=function(){var i=this.bufferCodecEventsExpected,s=this.operationQueue,u=this.pendingTracks,c=Object.keys(u).length;if(c&&!i||c===2){this.createSourceBuffers(u),this.pendingTracks={};var l=this.getSourceBufferTypes();if(l.length===0)return void this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});l.forEach(function(o){s.executeNext(o)})}},d.createSourceBuffers=function(i){var s=this.sourceBuffer,u=this.mediaSource;if(!u)throw Error("createSourceBuffers called when mediaSource was null");var c=0;for(var l in i)if(!s[l]){var o=i[l];if(!o)throw Error("source buffer exists for track "+l+", however track does not");var h=o.levelCodec||o.codec,g=o.container+";codecs="+h;O.logger.log("[buffer-controller]: creating sourceBuffer("+g+")");try{var p=s[l]=u.addSourceBuffer(g),v=l;this.addBufferListener(v,"updatestart",this._onSBUpdateStart),this.addBufferListener(v,"updateend",this._onSBUpdateEnd),this.addBufferListener(v,"error",this._onSBUpdateError),this.tracks[l]={buffer:p,codec:h,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id},c++}catch(S){O.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+S.message),this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:S,mimeType:g})}}c&&this.hls.trigger(b.Events.BUFFER_CREATED,{tracks:this.tracks})},d._onSBUpdateStart=function(i){this.operationQueue.current(i).onStart()},d._onSBUpdateEnd=function(i){var s=this.operationQueue;s.current(i).onComplete(),s.shiftAndExecuteNext(i)},d._onSBUpdateError=function(i,s){O.logger.error("[buffer-controller]: "+i+" SourceBuffer error",s),this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.MEDIA_ERROR,details:L.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var u=this.operationQueue.current(i);u&&u.onError(s)},d.removeExecutor=function(i,s,u){var c=this.media,l=this.mediaSource,o=this.operationQueue,h=this.sourceBuffer[i];if(!c||!l||!h)return O.logger.warn("[buffer-controller]: Attempting to remove from the "+i+" SourceBuffer, but it does not exist"),void o.shiftAndExecuteNext(i);var g=(0,C.isFiniteNumber)(c.duration)?c.duration:1/0,p=(0,C.isFiniteNumber)(l.duration)?l.duration:1/0,v=Math.max(0,s),S=Math.min(u,g,p);S>v&&!h.ending?(h.ended=!1,O.logger.log("[buffer-controller]: Removing ["+v+","+S+"] from the "+i+" SourceBuffer"),h.remove(v,S)):o.shiftAndExecuteNext(i)},d.appendExecutor=function(i,s){var u=this.operationQueue,c=this.sourceBuffer[s];if(!c)return O.logger.warn("[buffer-controller]: Attempting to append to the "+s+" SourceBuffer, but it does not exist"),void u.shiftAndExecuteNext(s);c.ended=!1,c.appendBuffer(i)},d.blockBuffers=function(i,s){var u=this;if(s===void 0&&(s=this.getSourceBufferTypes()),!s.length)return O.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(i);var c=this.operationQueue,l=s.map(function(o){return c.appendBlocker(o)});Promise.all(l).then(function(){i(),s.forEach(function(o){var h=u.sourceBuffer[o];h&&h.updating||c.shiftAndExecuteNext(o)})})},d.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},d.addBufferListener=function(i,s,u){var c=this.sourceBuffer[i];if(c){var l=u.bind(this,i);this.listeners[i].push({event:s,listener:l}),c.addEventListener(s,l)}},d.removeBufferListeners=function(i){var s=this.sourceBuffer[i];s&&this.listeners[i].forEach(function(u){s.removeEventListener(u.event,u.listener)})},T}(),Tc={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},vc=function(T){var d=T;return Tc.hasOwnProperty(T)&&(d=Tc[T]),String.fromCharCode(d)},Cn=15,zr=100,M0={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},F0={17:2,18:4,21:6,22:8,23:10,19:13,20:15},B0={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},U0={25:2,26:4,29:6,30:8,31:10,27:13,28:15},H0=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];(function(T){T[T.ERROR=0]="ERROR",T[T.TEXT=1]="TEXT",T[T.WARNING=2]="WARNING",T[T.INFO=2]="INFO",T[T.DEBUG=3]="DEBUG",T[T.DATA=3]="DATA"})(It||(It={}));var G0=function(){function T(){this.time=null,this.verboseLevel=It.ERROR}return T.prototype.log=function(d,i){if(this.verboseLevel>=d){var s=typeof i=="function"?i():i;O.logger.log(this.time+" ["+d+"] "+s)}},T}(),Ln=function(T){for(var d=[],i=0;i<T.length;i++)d.push(T[i].toString(16));return d},bc=function(){function T(i,s,u,c,l){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=i||"white",this.underline=s||!1,this.italics=u||!1,this.background=c||"black",this.flash=l||!1}var d=T.prototype;return d.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},d.setStyles=function(i){for(var s=["foreground","underline","italics","background","flash"],u=0;u<s.length;u++){var c=s[u];i.hasOwnProperty(c)&&(this[c]=i[c])}},d.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},d.equals=function(i){return this.foreground===i.foreground&&this.underline===i.underline&&this.italics===i.italics&&this.background===i.background&&this.flash===i.flash},d.copy=function(i){this.foreground=i.foreground,this.underline=i.underline,this.italics=i.italics,this.background=i.background,this.flash=i.flash},d.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},T}(),K0=function(){function T(i,s,u,c,l,o){this.uchar=void 0,this.penState=void 0,this.uchar=i||" ",this.penState=new bc(s,u,c,l,o)}var d=T.prototype;return d.reset=function(){this.uchar=" ",this.penState.reset()},d.setChar=function(i,s){this.uchar=i,this.penState.copy(s)},d.setPenState=function(i){this.penState.copy(i)},d.equals=function(i){return this.uchar===i.uchar&&this.penState.equals(i.penState)},d.copy=function(i){this.uchar=i.uchar,this.penState.copy(i.penState)},d.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},T}(),Y0=function(){function T(i){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var s=0;s<zr;s++)this.chars.push(new K0);this.logger=i,this.pos=0,this.currPenState=new bc}var d=T.prototype;return d.equals=function(i){for(var s=!0,u=0;u<zr;u++)if(!this.chars[u].equals(i.chars[u])){s=!1;break}return s},d.copy=function(i){for(var s=0;s<zr;s++)this.chars[s].copy(i.chars[s])},d.isEmpty=function(){for(var i=!0,s=0;s<zr;s++)if(!this.chars[s].isEmpty()){i=!1;break}return i},d.setCursor=function(i){this.pos!==i&&(this.pos=i),this.pos<0?(this.logger.log(It.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>zr&&(this.logger.log(It.DEBUG,"Too large cursor position "+this.pos),this.pos=zr)},d.moveCursor=function(i){var s=this.pos+i;if(i>1)for(var u=this.pos+1;u<s+1;u++)this.chars[u].setPenState(this.currPenState);this.setCursor(s)},d.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},d.insertChar=function(i){var s=this;i>=144&&this.backSpace();var u=vc(i);this.pos>=zr?this.logger.log(It.ERROR,function(){return"Cannot insert "+i.toString(16)+" ("+u+") at position "+s.pos+". Skipping it!"}):(this.chars[this.pos].setChar(u,this.currPenState),this.moveCursor(1))},d.clearFromPos=function(i){var s;for(s=i;s<zr;s++)this.chars[s].reset()},d.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},d.clearToEndOfRow=function(){this.clearFromPos(this.pos)},d.getTextString=function(){for(var i=[],s=!0,u=0;u<zr;u++){var c=this.chars[u].uchar;c!==" "&&(s=!1),i.push(c)}return s?"":i.join("")},d.setPenStyles=function(i){this.currPenState.setStyles(i),this.chars[this.pos].setPenState(this.currPenState)},T}(),$a=function(){function T(i){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var s=0;s<Cn;s++)this.rows.push(new Y0(i));this.logger=i,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var d=T.prototype;return d.reset=function(){for(var i=0;i<Cn;i++)this.rows[i].clear();this.currRow=14},d.equals=function(i){for(var s=!0,u=0;u<Cn;u++)if(!this.rows[u].equals(i.rows[u])){s=!1;break}return s},d.copy=function(i){for(var s=0;s<Cn;s++)this.rows[s].copy(i.rows[s])},d.isEmpty=function(){for(var i=!0,s=0;s<Cn;s++)if(!this.rows[s].isEmpty()){i=!1;break}return i},d.backSpace=function(){this.rows[this.currRow].backSpace()},d.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},d.insertChar=function(i){this.rows[this.currRow].insertChar(i)},d.setPen=function(i){this.rows[this.currRow].setPenStyles(i)},d.moveCursor=function(i){this.rows[this.currRow].moveCursor(i)},d.setCursor=function(i){this.logger.log(It.INFO,"setCursor: "+i),this.rows[this.currRow].setCursor(i)},d.setPAC=function(i){this.logger.log(It.INFO,function(){return"pacData = "+JSON.stringify(i)});var s=i.row-1;if(this.nrRollUpRows&&s<this.nrRollUpRows-1&&(s=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==s){for(var u=0;u<Cn;u++)this.rows[u].clear();var c=this.currRow+1-this.nrRollUpRows,l=this.lastOutputScreen;if(l){var o=l.rows[c].cueStartTime,h=this.logger.time;if(o&&h!==null&&o<h)for(var g=0;g<this.nrRollUpRows;g++)this.rows[s-this.nrRollUpRows+g+1].copy(l.rows[c+g])}}this.currRow=s;var p=this.rows[this.currRow];if(i.indent!==null){var v=i.indent,S=Math.max(v-1,0);p.setCursor(i.indent),i.color=p.chars[S].penState.foreground}var R={foreground:i.color,underline:i.underline,italics:i.italics,background:"black",flash:!1};this.setPen(R)},d.setBkgData=function(i){this.logger.log(It.INFO,function(){return"bkgData = "+JSON.stringify(i)}),this.backSpace(),this.setPen(i),this.insertChar(32)},d.setRollUpRows=function(i){this.nrRollUpRows=i},d.rollUp=function(){var i=this;if(this.nrRollUpRows!==null){this.logger.log(It.TEXT,function(){return i.getDisplayText()});var s=this.currRow+1-this.nrRollUpRows,u=this.rows.splice(s,1)[0];u.clear(),this.rows.splice(this.currRow,0,u),this.logger.log(It.INFO,"Rolling up")}else this.logger.log(It.DEBUG,"roll_up but nrRollUpRows not set yet")},d.getDisplayText=function(i){i=i||!1;for(var s=[],u="",c=-1,l=0;l<Cn;l++){var o=this.rows[l].getTextString();o&&(c=l+1,i?s.push("Row "+c+": '"+o+"'"):s.push(o.trim()))}return s.length>0&&(u=i?"["+s.join(" | ")+"]":s.join(`
`)),u},d.getTextAndFormat=function(){return this.rows},T}(),yc=function(){function T(i,s,u){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=i,this.outputFilter=s,this.mode=null,this.verbose=0,this.displayedMemory=new $a(u),this.nonDisplayedMemory=new $a(u),this.lastOutputScreen=new $a(u),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=u}var d=T.prototype;return d.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},d.getHandler=function(){return this.outputFilter},d.setHandler=function(i){this.outputFilter=i},d.setPAC=function(i){this.writeScreen.setPAC(i)},d.setBkgData=function(i){this.writeScreen.setBkgData(i)},d.setMode=function(i){i!==this.mode&&(this.mode=i,this.logger.log(It.INFO,function(){return"MODE="+i}),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=i)},d.insertChars=function(i){for(var s=this,u=0;u<i.length;u++)this.writeScreen.insertChar(i[u]);var c=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(It.INFO,function(){return c+": "+s.writeScreen.getDisplayText(!0)}),this.mode!=="MODE_PAINT-ON"&&this.mode!=="MODE_ROLL-UP"||(this.logger.log(It.TEXT,function(){return"DISPLAYED: "+s.displayedMemory.getDisplayText(!0)}),this.outputDataUpdate())},d.ccRCL=function(){this.logger.log(It.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},d.ccBS=function(){this.logger.log(It.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},d.ccAOF=function(){},d.ccAON=function(){},d.ccDER=function(){this.logger.log(It.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},d.ccRU=function(i){this.logger.log(It.INFO,"RU("+i+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(i)},d.ccFON=function(){this.logger.log(It.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},d.ccRDC=function(){this.logger.log(It.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},d.ccTR=function(){this.logger.log(It.INFO,"TR"),this.setMode("MODE_TEXT")},d.ccRTD=function(){this.logger.log(It.INFO,"RTD"),this.setMode("MODE_TEXT")},d.ccEDM=function(){this.logger.log(It.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},d.ccCR=function(){this.logger.log(It.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},d.ccENM=function(){this.logger.log(It.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},d.ccEOC=function(){var i=this;if(this.logger.log(It.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var s=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=s,this.writeScreen=this.nonDisplayedMemory,this.logger.log(It.TEXT,function(){return"DISP: "+i.displayedMemory.getDisplayText()})}this.outputDataUpdate(!0)},d.ccTO=function(i){this.logger.log(It.INFO,"TO("+i+") - Tab Offset"),this.writeScreen.moveCursor(i)},d.ccMIDROW=function(i){var s={flash:!1};if(s.underline=i%2==1,s.italics=i>=46,s.italics)s.foreground="white";else{var u=Math.floor(i/2)-16;s.foreground=["white","green","blue","cyan","red","yellow","magenta"][u]}this.logger.log(It.INFO,"MIDROW: "+JSON.stringify(s)),this.writeScreen.setPen(s)},d.outputDataUpdate=function(i){i===void 0&&(i=!1);var s=this.logger.time;s!==null&&this.outputFilter&&(this.cueStartTime!==null||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,s,this.lastOutputScreen),i&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:s):this.cueStartTime=s,this.lastOutputScreen.copy(this.displayedMemory))},d.cueSplitAtTime=function(i){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,i,this.displayedMemory),this.cueStartTime=i))},T}(),j0=function(){function T(i,s,u){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var c=new G0;this.channels=[null,new yc(i,s,c),new yc(i+1,u,c)],this.cmdHistory={a:null,b:null},this.logger=c}var d=T.prototype;return d.getHandler=function(i){return this.channels[i].getHandler()},d.setHandler=function(i,s){this.channels[i].setHandler(s)},d.addData=function(i,s){var u,c,l,o=!1;this.logger.time=i;for(var h=0;h<s.length;h+=2)if(c=127&s[h],l=127&s[h+1],c!==0||l!==0){if(this.logger.log(It.DATA,"["+Ln([s[h],s[h+1]])+"] -> ("+Ln([c,l])+")"),(u=this.parseCmd(c,l))||(u=this.parseMidrow(c,l)),u||(u=this.parsePAC(c,l)),u||(u=this.parseBackgroundAttributes(c,l)),!u&&(o=this.parseChars(c,l))){var g=this.currentChannel;g&&g>0?this.channels[g].insertChars(o):this.logger.log(It.WARNING,"No channel found yet. TEXT-MODE?")}u||o||this.logger.log(It.WARNING,"Couldn't parse cleaned data "+Ln([c,l])+" orig: "+Ln([s[h],s[h+1]]))}},d.parseCmd=function(i,s){var u=this.cmdHistory;if(!((i===20||i===28||i===21||i===29)&&s>=32&&s<=47||(i===23||i===31)&&s>=33&&s<=35))return!1;if(Ac(i,s,u))return zn(null,null,u),this.logger.log(It.DEBUG,"Repeated command ("+Ln([i,s])+") is dropped"),!0;var c=i===20||i===21||i===23?1:2,l=this.channels[c];return i===20||i===21||i===28||i===29?s===32?l.ccRCL():s===33?l.ccBS():s===34?l.ccAOF():s===35?l.ccAON():s===36?l.ccDER():s===37?l.ccRU(2):s===38?l.ccRU(3):s===39?l.ccRU(4):s===40?l.ccFON():s===41?l.ccRDC():s===42?l.ccTR():s===43?l.ccRTD():s===44?l.ccEDM():s===45?l.ccCR():s===46?l.ccENM():s===47&&l.ccEOC():l.ccTO(s-32),zn(i,s,u),this.currentChannel=c,!0},d.parseMidrow=function(i,s){var u=0;if((i===17||i===25)&&s>=32&&s<=47){if((u=i===17?1:2)!==this.currentChannel)return this.logger.log(It.ERROR,"Mismatch channel in midrow parsing"),!1;var c=this.channels[u];return!!c&&(c.ccMIDROW(s),this.logger.log(It.DEBUG,"MIDROW ("+Ln([i,s])+")"),!0)}return!1},d.parsePAC=function(i,s){var u,c=this.cmdHistory;if(!((i>=17&&i<=23||i>=25&&i<=31)&&s>=64&&s<=127||(i===16||i===24)&&s>=64&&s<=95))return!1;if(Ac(i,s,c))return zn(null,null,c),!0;var l=i<=23?1:2;u=s>=64&&s<=95?l===1?M0[i]:B0[i]:l===1?F0[i]:U0[i];var o=this.channels[l];return!!o&&(o.setPAC(this.interpretPAC(u,s)),zn(i,s,c),this.currentChannel=l,!0)},d.interpretPAC=function(i,s){var u,c={color:null,italics:!1,indent:null,underline:!1,row:i};return u=s>95?s-96:s-64,c.underline=(1&u)==1,u<=13?c.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(u/2)]:u<=15?(c.italics=!0,c.color="white"):c.indent=4*Math.floor((u-16)/2),c},d.parseChars=function(i,s){var u,c,l=null,o=null;if(i>=25?(u=2,o=i-8):(u=1,o=i),o>=17&&o<=19?(c=o===17?s+80:o===18?s+112:s+144,this.logger.log(It.INFO,"Special char '"+vc(c)+"' in channel "+u),l=[c]):i>=32&&i<=127&&(l=s===0?[i]:[i,s]),l){var h=Ln(l);this.logger.log(It.DEBUG,"Char codes =  "+h.join(",")),zn(i,s,this.cmdHistory)}return l},d.parseBackgroundAttributes=function(i,s){var u;if(!((i===16||i===24)&&s>=32&&s<=47||(i===23||i===31)&&s>=45&&s<=47))return!1;var c={};i===16||i===24?(u=Math.floor((s-32)/2),c.background=H0[u],s%2==1&&(c.background=c.background+"_semi")):s===45?c.background="transparent":(c.foreground="black",s===47&&(c.underline=!0));var l=i<=23?1:2;return this.channels[l].setBkgData(c),zn(i,s,this.cmdHistory),!0},d.reset=function(){for(var i=0;i<Object.keys(this.channels).length;i++){var s=this.channels[i];s&&s.reset()}this.cmdHistory={a:null,b:null}},d.cueSplitAtTime=function(i){for(var s=0;s<this.channels.length;s++){var u=this.channels[s];u&&u.cueSplitAtTime(i)}},T}();function zn(T,d,i){i.a=T,i.b=d}function Ac(T,d,i){return i.a===T&&i.b===d}const _c=j0;var vs=function(){function T(i,s){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=i,this.trackName=s}var d=T.prototype;return d.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},d.newCue=function(i,s,u){(this.startTime===null||this.startTime>i)&&(this.startTime=i),this.endTime=s,this.screen=u,this.timelineController.createCaptionsTrack(this.trackName)},d.reset=function(){this.cueRanges=[],this.startTime=null},T}();const Qa=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var T=["","lr","rl"],d=["start","middle","end","left","right"];function i(l,o){if(typeof o!="string"||!Array.isArray(l))return!1;var h=o.toLowerCase();return!!~l.indexOf(h)&&h}function s(l){return i(d,l)}function u(l){for(var o=arguments.length,h=new Array(o>1?o-1:0),g=1;g<o;g++)h[g-1]=arguments[g];for(var p=1;p<arguments.length;p++){var v=arguments[p];for(var S in v)l[S]=v[S]}return l}function c(l,o,h){var g=this,p={enumerable:!0};g.hasBeenReset=!1;var v="",S=!1,R=l,k=o,M=h,V=null,K="",Z=!0,de="auto",_e="start",Te=50,De="middle",ze=50,st="middle";Object.defineProperty(g,"id",u({},p,{get:function(){return v},set:function(Se){v=""+Se}})),Object.defineProperty(g,"pauseOnExit",u({},p,{get:function(){return S},set:function(Se){S=!!Se}})),Object.defineProperty(g,"startTime",u({},p,{get:function(){return R},set:function(Se){if(typeof Se!="number")throw new TypeError("Start time must be set to a number.");R=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"endTime",u({},p,{get:function(){return k},set:function(Se){if(typeof Se!="number")throw new TypeError("End time must be set to a number.");k=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"text",u({},p,{get:function(){return M},set:function(Se){M=""+Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"region",u({},p,{get:function(){return V},set:function(Se){V=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"vertical",u({},p,{get:function(){return K},set:function(Se){var Xe=function(Ve){return i(T,Ve)}(Se);if(Xe===!1)throw new SyntaxError("An invalid or illegal string was specified.");K=Xe,this.hasBeenReset=!0}})),Object.defineProperty(g,"snapToLines",u({},p,{get:function(){return Z},set:function(Se){Z=!!Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"line",u({},p,{get:function(){return de},set:function(Se){if(typeof Se!="number"&&Se!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");de=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"lineAlign",u({},p,{get:function(){return _e},set:function(Se){var Xe=s(Se);if(!Xe)throw new SyntaxError("An invalid or illegal string was specified.");_e=Xe,this.hasBeenReset=!0}})),Object.defineProperty(g,"position",u({},p,{get:function(){return Te},set:function(Se){if(Se<0||Se>100)throw new Error("Position must be between 0 and 100.");Te=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"positionAlign",u({},p,{get:function(){return De},set:function(Se){var Xe=s(Se);if(!Xe)throw new SyntaxError("An invalid or illegal string was specified.");De=Xe,this.hasBeenReset=!0}})),Object.defineProperty(g,"size",u({},p,{get:function(){return ze},set:function(Se){if(Se<0||Se>100)throw new Error("Size must be between 0 and 100.");ze=Se,this.hasBeenReset=!0}})),Object.defineProperty(g,"align",u({},p,{get:function(){return st},set:function(Se){var Xe=s(Se);if(!Xe)throw new SyntaxError("An invalid or illegal string was specified.");st=Xe,this.hasBeenReset=!0}})),g.displayState=void 0}return c.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},c}();var V0=function(){function T(){}return T.prototype.decode=function(d,i){if(!d)return"";if(typeof d!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(d))},T}();function Sc(T){function d(s,u,c,l){return 3600*(0|s)+60*(0|u)+(0|c)+parseFloat(l||0)}var i=T.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return i?parseFloat(i[2])>59?d(i[2],i[3],0,i[4]):d(i[1],i[2],i[3],i[4]):null}var q0=function(){function T(){this.values=Object.create(null)}var d=T.prototype;return d.set=function(i,s){this.get(i)||s===""||(this.values[i]=s)},d.get=function(i,s,u){return u?this.has(i)?this.values[i]:s[u]:this.has(i)?this.values[i]:s},d.has=function(i){return i in this.values},d.alt=function(i,s,u){for(var c=0;c<u.length;++c)if(s===u[c]){this.set(i,s);break}},d.integer=function(i,s){/^-?\d+$/.test(s)&&this.set(i,parseInt(s,10))},d.percent=function(i,s){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(s)){var u=parseFloat(s);if(u>=0&&u<=100)return this.set(i,u),!0}return!1},T}();function Ic(T,d,i,s){var u=s?T.split(s):[T];for(var c in u)if(typeof u[c]=="string"){var l=u[c].split(i);l.length===2&&d(l[0],l[1])}}var za=new Qa(0,0,""),bs=za.align==="middle"?"middle":"center";function W0(T,d,i){var s=T;function u(){var l=Sc(T);if(l===null)throw new Error("Malformed timestamp: "+s);return T=T.replace(/^[^\sa-zA-Z-]+/,""),l}function c(){T=T.replace(/^\s+/,"")}if(c(),d.startTime=u(),c(),T.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+s);T=T.slice(3),c(),d.endTime=u(),c(),function(l,o){var h=new q0;Ic(l,function(v,S){var R;switch(v){case"region":for(var k=i.length-1;k>=0;k--)if(i[k].id===S){h.set(v,i[k].region);break}break;case"vertical":h.alt(v,S,["rl","lr"]);break;case"line":R=S.split(","),h.integer(v,R[0]),h.percent(v,R[0])&&h.set("snapToLines",!1),h.alt(v,R[0],["auto"]),R.length===2&&h.alt("lineAlign",R[1],["start",bs,"end"]);break;case"position":R=S.split(","),h.percent(v,R[0]),R.length===2&&h.alt("positionAlign",R[1],["start",bs,"end","line-left","line-right","auto"]);break;case"size":h.percent(v,S);break;case"align":h.alt(v,S,["start",bs,"end","left","right"])}},/:/,/\s/),o.region=h.get("region",null),o.vertical=h.get("vertical","");var g=h.get("line","auto");g==="auto"&&za.line===-1&&(g=-1),o.line=g,o.lineAlign=h.get("lineAlign","start"),o.snapToLines=h.get("snapToLines",!0),o.size=h.get("size",100),o.align=h.get("align",bs);var p=h.get("position","auto");p==="auto"&&za.position===50&&(p=o.align==="start"||o.align==="left"?0:o.align==="end"||o.align==="right"?100:50),o.position=p}(T,d)}function Cc(T){return T.replace(/<br(?: \/)?>/gi,`
`)}var X0=function(){function T(){this.state="INITIAL",this.buffer="",this.decoder=new V0,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var d=T.prototype;return d.parse=function(i){var s=this;function u(){var g=s.buffer,p=0;for(g=Cc(g);p<g.length&&g[p]!=="\r"&&g[p]!==`
`;)++p;var v=g.slice(0,p);return g[p]==="\r"&&++p,g[p]===`
`&&++p,s.buffer=g.slice(p),v}i&&(s.buffer+=s.decoder.decode(i,{stream:!0}));try{var c="";if(s.state==="INITIAL"){if(!/\r\n|\n/.test(s.buffer))return this;var l=(c=u()).match(/^()?WEBVTT([ \t].*)?$/);if(!l||!l[0])throw new Error("Malformed WebVTT signature.");s.state="HEADER"}for(var o=!1;s.buffer;){if(!/\r\n|\n/.test(s.buffer))return this;switch(o?o=!1:c=u(),s.state){case"HEADER":/:/.test(c)?Ic(c,function(g,p){},/:/):c||(s.state="ID");continue;case"NOTE":c||(s.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(c)){s.state="NOTE";break}if(!c)continue;if(s.cue=new Qa(0,0,""),s.state="CUE",c.indexOf("-->")===-1){s.cue.id=c;continue}case"CUE":if(!s.cue){s.state="BADCUE";continue}try{W0(c,s.cue,s.regionList)}catch{s.cue=null,s.state="BADCUE";continue}s.state="CUETEXT";continue;case"CUETEXT":var h=c.indexOf("-->")!==-1;if(!c||h&&(o=!0)){s.oncue&&s.cue&&s.oncue(s.cue),s.cue=null,s.state="ID";continue}if(s.cue===null)continue;s.cue.text&&(s.cue.text+=`
`),s.cue.text+=c;continue;case"BADCUE":c||(s.state="ID")}}}catch{s.state==="CUETEXT"&&s.cue&&s.oncue&&s.oncue(s.cue),s.cue=null,s.state=s.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},d.flush=function(){var i=this;try{if((i.cue||i.state==="HEADER")&&(i.buffer+=`

`,i.parse()),i.state==="INITIAL"||i.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(s){i.onparsingerror&&i.onparsingerror(s)}return i.onflush&&i.onflush(),this},T}(),Lc=y(673),$0=y(524),Q0=/\r\n|\n\r|\n|\r/g,Ja=function(T,d,i){return i===void 0&&(i=0),T.slice(i,i+d.length)===d},Za=function(T){for(var d=5381,i=T.length;i;)d=33*d^T.charCodeAt(--i);return(d>>>0).toString()};function eo(T,d,i){return Za(T.toString())+Za(d.toString())+Za(i)}function to(){return to=Object.assign?Object.assign.bind():function(T){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(T[s]=i[s])}return T},to.apply(this,arguments)}var ro="stpp.ttml.im1t",Rc=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Dc=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,z0={left:"start",center:"center",right:"end",start:"start",end:"end"};function Nc(T,d,i,s,u){var c=(0,ve.findBox)(new Uint8Array(T),["mdat"]);if(c.length!==0){var l=c.map(function(h){return(0,Ue.utf8ArrayToStr)(h)}),o=(0,Lc.toTimescaleFromScale)(d,1,i);try{l.forEach(function(h){return s(function(g,p){var v=new DOMParser().parseFromString(g,"text/xml").getElementsByTagName("tt")[0];if(!v)throw new Error("Invalid ttml");var S={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},R=Object.keys(S).reduce(function(Z,de){return Z[de]=v.getAttribute("ttp:"+de)||S[de],Z},{}),k=v.getAttribute("xml:space")!=="preserve",M=Oc(no(v,"styling","style")),V=Oc(no(v,"layout","region")),K=no(v,"body","[begin]");return[].map.call(K,function(Z){var de=xc(Z,k);if(!de||!Z.hasAttribute("begin"))return null;var _e=so(Z.getAttribute("begin"),R),Te=so(Z.getAttribute("dur"),R),De=so(Z.getAttribute("end"),R);if(_e===null)throw kc(Z);if(De===null){if(Te===null)throw kc(Z);De=_e+Te}var ze=new Qa(_e-p,De-p,de);ze.id=eo(ze.startTime,ze.endTime,ze.text);var st=function(Ve,pt,kt){var vt="http://www.w3.org/ns/ttml#styling",St=null,Rt=Ve!=null&&Ve.hasAttribute("style")?Ve.getAttribute("style"):null;return Rt&&kt.hasOwnProperty(Rt)&&(St=kt[Rt]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function($t,Xt){var Gt=io(pt,vt,Xt)||io(Ve,vt,Xt)||io(St,vt,Xt);return Gt&&($t[Xt]=Gt),$t},{})}(V[Z.getAttribute("region")],M[Z.getAttribute("style")],M),Se=st.textAlign;if(Se){var Xe=z0[Se];Xe&&(ze.lineAlign=Xe),ze.align=Se}return to(ze,st),ze}).filter(function(Z){return Z!==null})}(h,o))})}catch(h){u(h)}}else u(new Error("Could not parse IMSC1 mdat"))}function no(T,d,i){var s=T.getElementsByTagName(d)[0];return s?[].slice.call(s.querySelectorAll(i)):[]}function Oc(T){return T.reduce(function(d,i){var s=i.getAttribute("xml:id");return s&&(d[s]=i),d},{})}function xc(T,d){return[].slice.call(T.childNodes).reduce(function(i,s,u){var c;return s.nodeName==="br"&&u?i+`
`:(c=s.childNodes)!==null&&c!==void 0&&c.length?xc(s,d):d?i+s.textContent.trim().replace(/\s+/g," "):i+s.textContent},"")}function io(T,d,i){return T&&T.hasAttributeNS(d,i)?T.getAttributeNS(d,i):null}function kc(T){return new Error("Could not parse ttml timestamp "+T)}function so(T,d){if(!T)return null;var i=Sc(T);return i===null&&(Rc.test(T)?i=function(s,u){var c=Rc.exec(s),l=(0|c[4])+(0|c[5])/u.subFrameRate;return 3600*(0|c[1])+60*(0|c[2])+(0|c[3])+l/u.frameRate}(T,d):Dc.test(T)&&(i=function(s,u){var c=Dc.exec(s),l=Number(c[1]);switch(c[2]){case"h":return 3600*l;case"m":return 60*l;case"ms":return 1e3*l;case"f":return l/u.frameRate;case"t":return l/u.tickRate}return l}(T,d))),i}var J0=function(){function T(i){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=i,this.config=i.config,this.Cues=i.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var s=new vs(this,"textTrack1"),u=new vs(this,"textTrack2"),c=new vs(this,"textTrack3"),l=new vs(this,"textTrack4");this.cea608Parser1=new _c(1,s,u),this.cea608Parser2=new _c(3,c,l)}i.on(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(b.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.on(b.Events.FRAG_LOADING,this.onFragLoading,this),i.on(b.Events.FRAG_LOADED,this.onFragLoaded,this),i.on(b.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),i.on(b.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),i.on(b.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.on(b.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),i.on(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var d=T.prototype;return d.destroy=function(){var i=this.hls;i.off(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(b.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.off(b.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.off(b.Events.FRAG_LOADING,this.onFragLoading,this),i.off(b.Events.FRAG_LOADED,this.onFragLoaded,this),i.off(b.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),i.off(b.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),i.off(b.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.off(b.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),i.off(b.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},d.addCues=function(i,s,u,c,l){for(var o,h,g,p,v=!1,S=l.length;S--;){var R=l[S],k=(o=R[0],h=R[1],g=s,p=u,Math.min(h,p)-Math.max(o,g));if(k>=0&&(R[0]=Math.min(R[0],s),R[1]=Math.max(R[1],u),v=!0,k/(u-s)>.5))return}if(v||l.push([s,u]),this.config.renderTextTracksNatively){var M=this.captionsTracks[i];this.Cues.newCue(M,s,u,c)}else{var V=this.Cues.newCue(null,s,u,c);this.hls.trigger(b.Events.CUES_PARSED,{type:"captions",cues:V,track:i})}},d.onInitPtsFound=function(i,s){var u=this,c=s.frag,l=s.id,o=s.initPTS,h=s.timescale,g=this.unparsedVttFrags;l==="main"&&(this.initPTS[c.cc]=o,this.timescale[c.cc]=h),g.length&&(this.unparsedVttFrags=[],g.forEach(function(p){u.onFragLoaded(b.Events.FRAG_LOADED,p)}))},d.getExistingTrack=function(i){var s=this.media;if(s)for(var u=0;u<s.textTracks.length;u++){var c=s.textTracks[u];if(c[i])return c}return null},d.createCaptionsTrack=function(i){this.config.renderTextTracksNatively?this.createNativeTrack(i):this.createNonNativeTrack(i)},d.createNativeTrack=function(i){if(!this.captionsTracks[i]){var s=this.captionsProperties,u=this.captionsTracks,c=this.media,l=s[i],o=l.label,h=l.languageCode,g=this.getExistingTrack(i);if(g)u[i]=g,Fe(u[i]),me(u[i],c);else{var p=this.createTextTrack("captions",o,h);p&&(p[i]=!0,u[i]=p)}}},d.createNonNativeTrack=function(i){if(!this.nonNativeCaptionsTracks[i]){var s=this.captionsProperties[i];if(s){var u={_id:i,label:s.label,kind:"captions",default:!!s.media&&!!s.media.default,closedCaptions:s.media};this.nonNativeCaptionsTracks[i]=u,this.hls.trigger(b.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[u]})}}},d.createTextTrack=function(i,s,u){var c=this.media;if(c)return c.addTextTrack(i,s,u)},d.onMediaAttaching=function(i,s){this.media=s.media,this._cleanTracks()},d.onMediaDetaching=function(){var i=this.captionsTracks;Object.keys(i).forEach(function(s){Fe(i[s]),delete i[s]}),this.nonNativeCaptionsTracks={}},d.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},d._cleanTracks=function(){var i=this.media;if(i){var s=i.textTracks;if(s)for(var u=0;u<s.length;u++)Fe(s[u])}},d.onSubtitleTracksUpdated=function(i,s){var u=this;this.textTracks=[];var c=s.subtitleTracks||[],l=c.some(function(p){return p.textCodec===ro});if(this.config.enableWebVTT||l&&this.config.enableIMSC1){var o=this.tracks&&c&&this.tracks.length===c.length;if(this.tracks=c||[],this.config.renderTextTracksNatively){var h=this.media?this.media.textTracks:[];this.tracks.forEach(function(p,v){var S;if(v<h.length){for(var R=null,k=0;k<h.length;k++)if(Z0(h[k],p)){R=h[k];break}R&&(S=R)}if(S)Fe(S);else{var M=u._captionsOrSubtitlesFromCharacteristics(p);(S=u.createTextTrack(M,p.name,p.lang))&&(S.mode="disabled")}S&&(S.groupId=p.groupId,u.textTracks.push(S))})}else if(!o&&this.tracks&&this.tracks.length){var g=this.tracks.map(function(p){return{label:p.name,kind:p.type.toLowerCase(),default:p.default,subtitleTrack:p}});this.hls.trigger(b.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:g})}}},d._captionsOrSubtitlesFromCharacteristics=function(i){var s;if((s=i.attrs)!==null&&s!==void 0&&s.CHARACTERISTICS){var u=/transcribes-spoken-dialog/gi.test(i.attrs.CHARACTERISTICS),c=/describes-music-and-sound/gi.test(i.attrs.CHARACTERISTICS);if(u&&c)return"captions"}return"subtitles"},d.onManifestLoaded=function(i,s){var u=this;this.config.enableCEA708Captions&&s.captions&&s.captions.forEach(function(c){var l=/(?:CC|SERVICE)([1-4])/.exec(c.instreamId);if(l){var o="textTrack"+l[1],h=u.captionsProperties[o];h&&(h.label=c.name,c.lang&&(h.languageCode=c.lang),h.media=c)}})},d.closedCaptionsForLevel=function(i){var s=this.hls.levels[i.level];return s==null?void 0:s.attrs["CLOSED-CAPTIONS"]},d.onFragLoading=function(i,s){var u=this.cea608Parser1,c=this.cea608Parser2,l=this.lastSn,o=this.lastPartIndex;if(this.enabled&&u&&c&&s.frag.type===x.PlaylistLevelType.MAIN){var h,g,p=s.frag.sn,v=(h=s==null||(g=s.part)===null||g===void 0?void 0:g.index)!=null?h:-1;p===l+1||p===l&&v===o+1||(u.reset(),c.reset()),this.lastSn=p,this.lastPartIndex=v}},d.onFragLoaded=function(i,s){var u=s.frag,c=s.payload,l=this.initPTS,o=this.unparsedVttFrags;if(u.type===x.PlaylistLevelType.SUBTITLE)if(c.byteLength){if(!(0,C.isFiniteNumber)(l[u.cc]))return o.push(s),void(l.length&&this.hls.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:u,error:new Error("Missing initial subtitle PTS")}));var h=u.decryptdata,g="stats"in s;if(h==null||!h.encrypted||g){var p=this.tracks[u.level],v=this.vttCCs;v[u.cc]||(v[u.cc]={start:u.start,prevCC:this.prevCC,new:!0},this.prevCC=u.cc),p&&p.textCodec===ro?this._parseIMSC1(u,c):this._parseVTTs(u,c,v)}}else this.hls.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:u,error:new Error("Empty subtitle payload")})},d._parseIMSC1=function(i,s){var u=this,c=this.hls;Nc(s,this.initPTS[i.cc],this.timescale[i.cc],function(l){u._appendCues(l,i.level),c.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},function(l){O.logger.log("Failed to parse IMSC1: "+l),c.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:l})})},d._parseVTTs=function(i,s,u){var c,l=this,o=this.hls;(function(h,g,p,v,S,R,k,M){var V,K=new X0,Z=(0,Ue.utf8ArrayToStr)(new Uint8Array(h)).trim().replace(Q0,`
`).split(`
`),de=[],_e=(0,Lc.toMpegTsClockFromTimescale)(g,p),Te="00:00.000",De=0,ze=0,st=!0;K.oncue=function(Se){var Xe=v[S],Ve=v.ccOffset,pt=(De-_e)/9e4;Xe!=null&&Xe.new&&(ze!==void 0?Ve=v.ccOffset=Xe.start:function(Rt,$t,Xt){var Gt=Rt[$t],Qt=Rt[Gt.prevCC];if(!Qt||!Qt.new&&Gt.new)return Rt.ccOffset=Rt.presentationOffset=Gt.start,void(Gt.new=!1);for(;(Er=Qt)!==null&&Er!==void 0&&Er.new;){var Er;Rt.ccOffset+=Gt.start-Qt.start,Gt.new=!1,Qt=Rt[(Gt=Qt).prevCC]}Rt.presentationOffset=Xt}(v,S,pt)),pt&&(Ve=pt-v.presentationOffset);var kt=Se.endTime-Se.startTime,vt=(0,$0.normalizePts)(9e4*(Se.startTime+Ve-ze),9e4*R)/9e4;Se.startTime=Math.max(vt,0),Se.endTime=Math.max(vt+kt,0);var St=Se.text.trim();Se.text=decodeURIComponent(encodeURIComponent(St)),Se.id||(Se.id=eo(Se.startTime,Se.endTime,St)),Se.endTime>0&&de.push(Se)},K.onparsingerror=function(Se){V=Se},K.onflush=function(){V?M(V):k(de)},Z.forEach(function(Se){if(st){if(Ja(Se,"X-TIMESTAMP-MAP=")){st=!1,Se.slice(16).split(",").forEach(function(Xe){Ja(Xe,"LOCAL:")?Te=Xe.slice(6):Ja(Xe,"MPEGTS:")&&(De=parseInt(Xe.slice(7)))});try{ze=function(Xe){var Ve=parseInt(Xe.slice(-3)),pt=parseInt(Xe.slice(-6,-4)),kt=parseInt(Xe.slice(-9,-7)),vt=Xe.length>9?parseInt(Xe.substring(0,Xe.indexOf(":"))):0;if(!((0,C.isFiniteNumber)(Ve)&&(0,C.isFiniteNumber)(pt)&&(0,C.isFiniteNumber)(kt)&&(0,C.isFiniteNumber)(vt)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+Xe);return Ve+=1e3*pt,(Ve+=6e4*kt)+36e5*vt}(Te)/1e3}catch(Xe){V=Xe}return}Se===""&&(st=!1)}K.parse(Se+`
`)}),K.flush()})((c=i.initSegment)!==null&&c!==void 0&&c.data?(0,ve.appendUint8Array)(i.initSegment.data,new Uint8Array(s)):s,this.initPTS[i.cc],this.timescale[i.cc],u,i.cc,i.start,function(h){l._appendCues(h,i.level),o.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},function(h){l._fallbackToIMSC1(i,s),O.logger.log("Failed to parse VTT cue: "+h),o.trigger(b.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:h})})},d._fallbackToIMSC1=function(i,s){var u=this,c=this.tracks[i.level];c.textCodec||Nc(s,this.initPTS[i.cc],this.timescale[i.cc],function(){c.textCodec=ro,u._parseIMSC1(i,s)},function(){c.textCodec="wvtt"})},d._appendCues=function(i,s){var u=this.hls;if(this.config.renderTextTracksNatively){var c=this.textTracks[s];if(!c||c.mode==="disabled")return;i.forEach(function(h){return Oe(c,h)})}else{var l=this.tracks[s];if(!l)return;var o=l.default?"default":"subtitles"+s;u.trigger(b.Events.CUES_PARSED,{type:"subtitles",cues:i,track:o})}},d.onFragDecrypted=function(i,s){var u=s.frag;if(u.type===x.PlaylistLevelType.SUBTITLE){if(!(0,C.isFiniteNumber)(this.initPTS[u.cc]))return void this.unparsedVttFrags.push(s);this.onFragLoaded(b.Events.FRAG_LOADED,s)}},d.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},d.onFragParsingUserdata=function(i,s){var u=this.cea608Parser1,c=this.cea608Parser2;if(this.enabled&&u&&c){var l=s.frag,o=s.samples;if(l.type!==x.PlaylistLevelType.MAIN||this.closedCaptionsForLevel(l)!=="NONE")for(var h=0;h<o.length;h++){var g=o[h].bytes;if(g){var p=this.extractCea608Data(g);u.addData(o[h].pts,p[0]),c.addData(o[h].pts,p[1])}}}},d.onBufferFlushing=function(i,s){var u=s.startOffset,c=s.endOffset,l=s.endOffsetSubtitles,o=s.type,h=this.media;if(h&&!(h.currentTime<c)){if(!o||o==="video"){var g=this.captionsTracks;Object.keys(g).forEach(function(v){return we(g[v],u,c)})}if(this.config.renderTextTracksNatively&&u===0&&l!==void 0){var p=this.textTracks;Object.keys(p).forEach(function(v){return we(p[v],u,l)})}}},d.extractCea608Data=function(i){for(var s=[[],[]],u=31&i[0],c=2,l=0;l<u;l++){var o=i[c++],h=127&i[c++],g=127&i[c++];if((h!==0||g!==0)&&4&o){var p=3&o;p!==0&&p!==1||(s[p].push(h),s[p].push(g))}}return s},T}();function Z0(T,d){return T&&T.label===d.name&&!(T.textTrack1||T.textTrack2)}function eg(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}const tg=function(){function T(u){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=u,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var d,i,s=T.prototype;return s.setStreamController=function(u){this.streamController=u},s.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},s.registerListeners=function(){var u=this.hls;u.on(b.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),u.on(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.on(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.on(b.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.on(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},s.unregisterListener=function(){var u=this.hls;u.off(b.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),u.off(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.off(b.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.off(b.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.off(b.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},s.onFpsDropLevelCapping=function(u,c){T.isLevelAllowed(c.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(c.droppedLevel)},s.onMediaAttaching=function(u,c){this.media=c.media instanceof HTMLVideoElement?c.media:null,this.clientRect=null},s.onManifestParsed=function(u,c){var l=this.hls;this.restrictedLevels=[],this.firstLevel=c.firstLevel,l.config.capLevelToPlayerSize&&c.video&&this.startCapping()},s.onBufferCodecs=function(u,c){this.hls.config.capLevelToPlayerSize&&c.video&&this.startCapping()},s.onMediaDetaching=function(){this.stopCapping()},s.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var u=this.hls.levels;if(u.length){var c=this.hls;c.autoLevelCapping=this.getMaxLevel(u.length-1),c.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=c.autoLevelCapping}}},s.getMaxLevel=function(u){var c=this,l=this.hls.levels;if(!l.length)return-1;var o=l.filter(function(h,g){return T.isLevelAllowed(g,c.restrictedLevels)&&g<=u});return this.clientRect=null,T.getMaxLevelByMediaSize(o,this.mediaWidth,this.mediaHeight)},s.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},s.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},s.getDimensions=function(){if(this.clientRect)return this.clientRect;var u=this.media,c={width:0,height:0};if(u){var l=u.getBoundingClientRect();c.width=l.width,c.height=l.height,c.width||c.height||(c.width=l.right-l.left||u.width||0,c.height=l.bottom-l.top||u.height||0)}return this.clientRect=c,c},T.isLevelAllowed=function(u,c){return c===void 0&&(c=[]),c.indexOf(u)===-1},T.getMaxLevelByMediaSize=function(u,c,l){if(!u||!u.length)return-1;for(var o,h,g=u.length-1,p=0;p<u.length;p+=1){var v=u[p];if((v.width>=c||v.height>=l)&&(o=v,!(h=u[p+1])||o.width!==h.width||o.height!==h.height)){g=p;break}}return g},d=T,(i=[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var u=1;if(!this.hls.config.ignoreDevicePixelRatio)try{u=self.devicePixelRatio}catch{}return u}}])&&eg(d.prototype,i),Object.defineProperty(d,"prototype",{writable:!1}),T}(),rg=function(){function T(i){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=i,this.registerListeners()}var d=T.prototype;return d.setStreamController=function(i){this.streamController=i},d.registerListeners=function(){this.hls.on(b.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},d.unregisterListeners=function(){this.hls.off(b.Events.MEDIA_ATTACHING,this.onMediaAttaching)},d.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},d.onMediaAttaching=function(i,s){var u=this.hls.config;if(u.capLevelOnFPSDrop){var c=s.media instanceof self.HTMLVideoElement?s.media:null;this.media=c,c&&typeof c.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),u.fpsDroppedMonitoringPeriod)}},d.checkFPS=function(i,s,u){var c=performance.now();if(s){if(this.lastTime){var l=c-this.lastTime,o=u-this.lastDroppedFrames,h=s-this.lastDecodedFrames,g=1e3*o/l,p=this.hls;if(p.trigger(b.Events.FPS_DROP,{currentDropped:o,currentDecoded:h,totalDroppedFrames:u}),g>0&&o>p.config.fpsDroppedMonitoringThreshold*h){var v=p.currentLevel;O.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+v),v>0&&(p.autoLevelCapping===-1||p.autoLevelCapping>=v)&&(v-=1,p.trigger(b.Events.FPS_DROP_LEVEL_CAPPING,{level:v,droppedLevel:p.currentLevel}),p.autoLevelCapping=v,this.streamController.nextLevelSwitch())}}this.lastTime=c,this.lastDroppedFrames=u,this.lastDecodedFrames=s}},d.checkFPSInterval=function(){var i=this.media;if(i)if(this.isVideoPlaybackQualityAvailable){var s=i.getVideoPlaybackQuality();this.checkFPS(i,s.totalVideoFrames,s.droppedVideoFrames)}else this.checkFPS(i,i.webkitDecodedFrameCount,i.webkitDroppedFrameCount)},T}();var Rn=y(300);function ao(T){var d=typeof Map=="function"?new Map:void 0;return ao=function(i){if(i===null||(s=i,Function.toString.call(s).indexOf("[native code]")===-1))return i;var s;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(d!==void 0){if(d.has(i))return d.get(i);d.set(i,u)}function u(){return oo(i,arguments,uo(this).constructor)}return u.prototype=Object.create(i.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),Di(u,i)},ao(T)}function oo(T,d,i){return oo=ng()?Reflect.construct.bind():function(s,u,c){var l=[null];l.push.apply(l,u);var o=new(Function.bind.apply(s,l));return c&&Di(o,c.prototype),o},oo.apply(null,arguments)}function ng(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Di(T,d){return Di=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Di(T,d)}function uo(T){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(d){return d.__proto__||Object.getPrototypeOf(d)},uo(T)}var ys="[eme]",Pc=function(){function T(i){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=T.CDMCleanupPromise?[T.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=O.logger.debug.bind(O.logger,ys),this.log=O.logger.log.bind(O.logger,ys),this.warn=O.logger.warn.bind(O.logger,ys),this.error=O.logger.error.bind(O.logger,ys),this.hls=i,this.config=i.config,this.registerListeners()}var d=T.prototype;return d.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null},d.registerListeners=function(){this.hls.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},d.unregisterListeners=function(){this.hls.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(b.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},d.getLicenseServerUrl=function(i){var s=this.config,u=s.drmSystems,c=s.widevineLicenseUrl,l=u[i];if(l)return l.licenseUrl;if(i===re.WIDEVINE&&c)return c;throw new Error('no license server URL configured for key-system "'+i+'"')},d.getServerCertificateUrl=function(i){var s=this.config.drmSystems[i];if(s)return s.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+i+'"]')},d.attemptKeySystemAccess=function(i){var s=this,u=this.hls.levels,c=function(h,g,p){return!!h&&p.indexOf(h)===g},l=u.map(function(h){return h.audioCodec}).filter(c),o=u.map(function(h){return h.videoCodec}).filter(c);return l.length+o.length===0&&o.push("avc1.42e01e"),new Promise(function(h,g){(function p(v){var S=v.shift();s.getMediaKeysPromise(S,l,o).then(function(R){return h({keySystem:S,mediaKeys:R})}).catch(function(R){v.length?p(v):g(R instanceof Lr?R:new Lr({type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:R,fatal:!0},R.message))})})(i)})},d.requestMediaKeySystemAccess=function(i,s){var u=this.config.requestMediaKeySystemAccessFunc;if(typeof u!="function"){var c="Configured requestMediaKeySystemAccess is not a function "+u;return Le===null&&self.location.protocol==="http:"&&(c="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(c))}return u(i,s)},d.getMediaKeysPromise=function(i,s,u){var c=this,l=function(p,v,S,R){var k;switch(p){case re.FAIRPLAY:k=["cenc","sinf"];break;case re.WIDEVINE:case re.PLAYREADY:k=["cenc"];break;case re.CLEARKEY:k=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+p)}return function(M,V,K,Z){return[{initDataTypes:M,persistentState:Z.persistentState||"not-allowed",distinctiveIdentifier:Z.distinctiveIdentifier||"not-allowed",sessionTypes:Z.sessionTypes||[Z.sessionType||"temporary"],audioCapabilities:V.map(function(de){return{contentType:'audio/mp4; codecs="'+de+'"',robustness:Z.audioRobustness||"",encryptionScheme:Z.audioEncryptionScheme||null}}),videoCapabilities:K.map(function(de){return{contentType:'video/mp4; codecs="'+de+'"',robustness:Z.videoRobustness||"",encryptionScheme:Z.videoEncryptionScheme||null}})}]}(k,v,S,R)}(i,s,u,this.config.drmSystemOptions),o=this.keySystemAccessPromises[i],h=o==null?void 0:o.keySystemAccess;if(!h){this.log('Requesting encrypted media "'+i+'" key-system access with config: '+JSON.stringify(l)),h=this.requestMediaKeySystemAccess(i,l);var g=this.keySystemAccessPromises[i]={keySystemAccess:h};return h.catch(function(p){c.log('Failed to obtain access to key-system "'+i+'": '+p)}),h.then(function(p){c.log('Access for key-system "'+p.keySystem+'" obtained');var v=c.fetchServerCertificate(i);return c.log('Create media-keys for "'+i+'"'),g.mediaKeys=p.createMediaKeys().then(function(S){return c.log('Media-keys created for "'+i+'"'),v.then(function(R){return R?c.setMediaKeysServerCertificate(S,i,R):S})}),g.mediaKeys.catch(function(S){c.error('Failed to create media-keys for "'+i+'"}: '+S)}),g.mediaKeys})}return h.then(function(){return o.mediaKeys})},d.createMediaKeySessionContext=function(i){var s=i.decryptdata,u=i.keySystem,c=i.mediaKeys;this.log('Creating key-system session "'+u+'" keyId: '+Rn.default.hexDump(s.keyId||[]));var l=c.createSession(),o={decryptdata:s,keySystem:u,mediaKeys:c,mediaKeysSession:l,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o},d.renewKeySession=function(i){var s=i.decryptdata;if(s.pssh){var u=this.createMediaKeySessionContext(i),c=this.getKeyIdString(s);this.keyIdToKeySessionPromise[c]=this.generateRequestWithPreferredKeySession(u,"cenc",s.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(i)},d.getKeyIdString=function(i){if(!i)throw new Error("Could not read keyId of undefined decryptdata");if(i.keyId===null)throw new Error("keyId is null");return Rn.default.hexDump(i.keyId)},d.updateKeySession=function(i,s){var u,c=i.mediaKeysSession;return this.log('Updating key-session "'+c.sessionId+'" for keyID '+Rn.default.hexDump(((u=i.decryptdata)===null||u===void 0?void 0:u.keyId)||[])+`
      } (data length: `+(s&&s.byteLength)+")"),c.update(s)},d.selectKeySystemFormat=function(i){var s=Object.keys(i.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+i.sn+" "+i.type+": "+i.level+") key formats "+s.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(s)),this.keyFormatPromise},d.getKeyFormatPromise=function(i){var s=this;return new Promise(function(u,c){var l=pe(s.config),o=i.map(Q).filter(function(h){return!!h&&l.indexOf(h)!==-1});return s.getKeySystemSelectionPromise(o).then(function(h){var g=h.keySystem,p=U(g);p?u(p):c(new Error('Unable to find format for key-system "'+g+'"'))}).catch(c)})},d.loadKey=function(i){var s=this,u=i.keyInfo.decryptdata,c=this.getKeyIdString(u),l="(keyId: "+c+' format: "'+u.keyFormat+'" method: '+u.method+" uri: "+u.uri+")";this.log("Starting session for key "+l);var o=this.keyIdToKeySessionPromise[c];return o||(o=this.keyIdToKeySessionPromise[c]=this.getKeySystemForKeyPromise(u).then(function(h){var g=h.keySystem,p=h.mediaKeys;return s.throwIfDestroyed(),s.log("Handle encrypted media sn: "+i.frag.sn+" "+i.frag.type+": "+i.frag.level+" using key "+l),s.attemptSetMediaKeys(g,p).then(function(){s.throwIfDestroyed();var v=s.createMediaKeySessionContext({keySystem:g,mediaKeys:p,decryptdata:u});return s.generateRequestWithPreferredKeySession(v,"cenc",u.pssh,"playlist-key")})})).catch(function(h){return s.handleError(h)}),o},d.throwIfDestroyed=function(i){if(!this.hls)throw new Error("invalid state")},d.handleError=function(i){this.hls&&(this.error(i.message),i instanceof Lr?this.hls.trigger(b.Events.ERROR,i.data):this.hls.trigger(b.Events.ERROR,{type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_NO_KEYS,error:i,fatal:!0}))},d.getKeySystemForKeyPromise=function(i){var s=this.getKeyIdString(i),u=this.keyIdToKeySessionPromise[s];if(!u){var c=Q(i.keyFormat),l=c?[c]:pe(this.config);return this.attemptKeySystemAccess(l)}return u},d.getKeySystemSelectionPromise=function(i){if(i.length||(i=pe(this.config)),i.length===0)throw new Lr({type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(i)},d._onMediaEncrypted=function(i){var s=this,u=i.initDataType,c=i.initData;if(this.debug('"'+i.type+'" event: init data type: "'+u+'"'),c!==null){var l,o;if(u==="sinf"&&this.config.drmSystems[re.FAIRPLAY]){var h=(0,ve.bin2str)(new Uint8Array(c));try{var g=ce(JSON.parse(h).sinf),p=(0,ve.parseSinf)(new Uint8Array(g));if(!p)return;l=p.subarray(8,24),o=re.FAIRPLAY}catch{return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{var v=(0,ve.parsePssh)(c);if(v===null)return;v.version===0&&v.systemId===Pe.WIDEVINE&&v.data&&(l=v.data.subarray(8,24)),o=function(de){if(de===Pe.WIDEVINE)return re.WIDEVINE}(v.systemId)}if(o&&l){for(var S=Rn.default.hexDump(l),R=this.keyIdToKeySessionPromise,k=this.mediaKeySessions,M=R[S],V=function(de){var _e=k[de],Te=_e.decryptdata;if(Te.pssh||!Te.keyId)return"continue";var De=Rn.default.hexDump(Te.keyId);return S===De||Te.uri.replace(/-/g,"").indexOf(S)!==-1?(M=R[De],delete R[De],Te.pssh=new Uint8Array(c),Te.keyId=l,M=R[S]=M.then(function(){return s.generateRequestWithPreferredKeySession(_e,u,c,"encrypted-event-key-match")}),"break"):void 0},K=0;K<k.length;K++){var Z=V(K);if(Z!=="continue"&&Z==="break")break}M||(M=R[S]=this.getKeySystemSelectionPromise([o]).then(function(de){var _e,Te=de.keySystem,De=de.mediaKeys;s.throwIfDestroyed();var ze=new We("ISO-23001-7",S,(_e=U(Te))!=null?_e:"");return ze.pssh=new Uint8Array(c),ze.keyId=l,s.attemptSetMediaKeys(Te,De).then(function(){s.throwIfDestroyed();var st=s.createMediaKeySessionContext({decryptdata:ze,keySystem:Te,mediaKeys:De});return s.generateRequestWithPreferredKeySession(st,u,c,"encrypted-event-no-match")})})),M.catch(function(de){return s.handleError(de)})}}},d._onWaitingForKey=function(i){this.log('"'+i.type+'" event')},d.attemptSetMediaKeys=function(i,s){var u=this,c=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+i+'"');var l=Promise.all(c).then(function(){if(!u.media)throw new Error("Attempted to set mediaKeys without media element attached");return u.media.setMediaKeys(s)});return this.setMediaKeysQueue.push(l),l.then(function(){u.log('Media-keys set for "'+i+'"'),c.push(l),u.setMediaKeysQueue=u.setMediaKeysQueue.filter(function(o){return c.indexOf(o)===-1})})},d.generateRequestWithPreferredKeySession=function(i,s,u,c){var l,o,h=this,g=(l=this.config.drmSystems)===null||l===void 0||(o=l[i.keySystem])===null||o===void 0?void 0:o.generateRequest;if(g)try{var p=g.call(this.hls,s,u,i);if(!p)throw new Error("Invalid response from configured generateRequest filter");s=p.initDataType,u=i.decryptdata.pssh=p.initData?new Uint8Array(p.initData):null}catch(M){var v;if(this.warn(M.message),(v=this.hls)!==null&&v!==void 0&&v.config.debug)throw M}if(u===null)return this.log('Skipping key-session request for "'+c+'" (no initData)'),Promise.resolve(i);var S=this.getKeyIdString(i.decryptdata);this.log('Generating key-session request for "'+c+'": '+S+" (init data type: "+s+" length: "+(u?u.byteLength:null)+")");var R=new(T0());i.mediaKeysSession.onmessage=function(M){var V=i.mediaKeysSession;if(V){var K=M.messageType,Z=M.message;h.log('"'+K+'" message event for session "'+V.sessionId+'" message size: '+Z.byteLength),K==="license-request"||K==="license-renewal"?h.renewLicense(i,Z).catch(function(de){h.handleError(de),R.emit("error",de)}):K==="license-release"?i.keySystem===re.FAIRPLAY&&(h.updateKeySession(i,P("acknowledged")),h.removeSession(i)):h.warn('unhandled media key message type "'+K+'"')}else R.emit("error",new Error("invalid state"))},i.mediaKeysSession.onkeystatuseschange=function(M){if(i.mediaKeysSession){h.onKeyStatusChange(i);var V=i.keyStatus;R.emit("keyStatus",V),V==="expired"&&(h.warn(i.keySystem+" expired for key "+S),h.renewKeySession(i))}else R.emit("error",new Error("invalid state"))};var k=new Promise(function(M,V){R.on("error",V),R.on("keyStatus",function(K){K.startsWith("usable")?M():K==="output-restricted"?V(new Lr({type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):K==="internal-error"?V(new Lr({type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+K+'"')):K==="expired"?V(new Error("key expired while generating request")):h.warn('unhandled key status change "'+K+'"')})});return i.mediaKeysSession.generateRequest(s,u).then(function(){var M;h.log('Request generated for key-session "'+((M=i.mediaKeysSession)===null||M===void 0?void 0:M.sessionId)+'" keyId: '+S)}).catch(function(M){throw new Lr({type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_NO_SESSION,error:M,fatal:!1},"Error generating key-session request: "+M)}).then(function(){return k}).catch(function(M){throw R.removeAllListeners(),h.removeSession(i),M}).then(function(){return R.removeAllListeners(),i})},d.onKeyStatusChange=function(i){var s=this;i.mediaKeysSession.keyStatuses.forEach(function(u,c){s.log('key status change "'+u+'" for keyStatuses keyId: '+Rn.default.hexDump("buffer"in c?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):new Uint8Array(c))+" session keyId: "+Rn.default.hexDump(new Uint8Array(i.decryptdata.keyId||[]))+" uri: "+i.decryptdata.uri),i.keyStatus=u})},d.fetchServerCertificate=function(i){var s=this;return new Promise(function(u,c){var l=s.getServerCertificateUrl(i);if(!l)return u();s.log('Fetching serverCertificate for "'+i+'"');var o=new XMLHttpRequest;o.open("GET",l,!0),o.responseType="arraybuffer",o.onreadystatechange=function(){o.readyState===XMLHttpRequest.DONE&&(o.status===200?u(o.response):c(new Lr({type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:o},'"'+i+'" certificate request XHR failed ('+l+"). Status: "+o.status+" ("+o.statusText+")")))},o.send()})},d.setMediaKeysServerCertificate=function(i,s,u){var c=this;return new Promise(function(l,o){i.setServerCertificate(u).then(function(h){c.log("setServerCertificate "+(h?"success":"not supported by CDM")+" ("+(u==null?void 0:u.byteLength)+') on "'+s+'"'),l(i)}).catch(function(h){o(new Lr({type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:h,fatal:!0},h.message))})})},d.renewLicense=function(i,s){var u=this;return this.requestLicense(i,new Uint8Array(s)).then(function(c){return u.updateKeySession(i,new Uint8Array(c)).catch(function(l){throw new Lr({type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:l,fatal:!0},l.message)})})},d.setupLicenseXHR=function(i,s,u,c){var l=this,o=this.config.licenseXhrSetup;return o?Promise.resolve().then(function(){if(!u.decryptdata)throw new Error("Key removed");return o.call(l.hls,i,s,u,c)}).catch(function(h){if(!u.decryptdata)throw h;return i.open("POST",s,!0),o.call(l.hls,i,s,u,c)}).then(function(h){return i.readyState||i.open("POST",s,!0),{xhr:i,licenseChallenge:h||c}}):(i.open("POST",s,!0),Promise.resolve({xhr:i,licenseChallenge:c}))},d.requestLicense=function(i,s){var u=this;return new Promise(function(c,l){var o=u.getLicenseServerUrl(i.keySystem);u.log("Sending license request to URL: "+o);var h=new XMLHttpRequest;h.responseType="arraybuffer",h.onreadystatechange=function(){if(!u.hls||!i.mediaKeysSession)return l(new Error("invalid state"));if(h.readyState===4)if(h.status===200){u._requestLicenseFailureCount=0;var g=h.response;u.log("License received "+(g instanceof ArrayBuffer?g.byteLength:g));var p=u.config.licenseResponseCallback;if(p)try{g=p.call(u.hls,h,o,i)}catch(S){u.error(S)}c(g)}else if(u._requestLicenseFailureCount++,u._requestLicenseFailureCount>3||h.status>=400&&h.status<500)l(new Lr({type:L.ErrorTypes.KEY_SYSTEM_ERROR,details:L.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:h},"License Request XHR failed ("+o+"). Status: "+h.status+" ("+h.statusText+")"));else{var v=3-u._requestLicenseFailureCount+1;u.warn("Retrying license request, "+v+" attempts left"),u.requestLicense(i,s).then(c,l)}},i.licenseXhr&&i.licenseXhr.readyState!==XMLHttpRequest.DONE&&i.licenseXhr.abort(),i.licenseXhr=h,u.setupLicenseXHR(h,o,i,s).then(function(g){var p=g.xhr,v=g.licenseChallenge;p.send(v)})})},d.onMediaAttached=function(i,s){if(this.config.emeEnabled){var u=s.media;this.media=u,u.addEventListener("encrypted",this.onMediaEncrypted),u.addEventListener("waitingforkey",this.onWaitingForKey)}},d.onMediaDetached=function(){var i=this,s=this.media,u=this.mediaKeySessions;s&&(s.removeEventListener("encrypted",this.onMediaEncrypted),s.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},We.clearKeyUriToKeyIdMap();var c=u.length;T.CDMCleanupPromise=Promise.all(u.map(function(l){return i.removeSession(l)}).concat(s==null?void 0:s.setMediaKeys(null).catch(function(l){i.log("Could not clear media keys: "+l+". media.src: "+(s==null?void 0:s.src))}))).then(function(){c&&(i.log("finished closing key sessions and clearing media keys"),u.length=0)}).catch(function(l){i.log("Could not close sessions and clear media keys: "+l+". media.src: "+(s==null?void 0:s.src))})},d.onManifestLoaded=function(i,s){var u=s.sessionKeys;if(u&&this.config.emeEnabled&&!this.keyFormatPromise){var c=u.reduce(function(l,o){return l.indexOf(o.keyFormat)===-1&&l.push(o.keyFormat),l},[]);this.log("Selecting key-system from session-keys "+c.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(c)}},d.removeSession=function(i){var s=this,u=i.mediaKeysSession,c=i.licenseXhr;if(u){this.log("Remove licenses and keys and close session "+u.sessionId),u.onmessage=null,u.onkeystatuseschange=null,c&&c.readyState!==XMLHttpRequest.DONE&&c.abort(),i.mediaKeysSession=i.decryptdata=i.licenseXhr=void 0;var l=this.mediaKeySessions.indexOf(i);return l>-1&&this.mediaKeySessions.splice(l,1),u.remove().catch(function(o){s.log("Could not remove session: "+o)}).then(function(){return u.close()}).catch(function(o){s.log("Could not close session: "+o)})}},T}();Pc.CDMCleanupPromise=void 0;var Lr=function(T){var d,i;function s(u,c){var l;return(l=T.call(this,c)||this).data=void 0,l.data=u,u.err=u.error,l}return i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,Di(d,i),s}(ao(Error));const ig=Pc;var nr,co,wc;function Mc(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}function Fc(T,d,i){return d&&Mc(T.prototype,d),i&&Mc(T,i),Object.defineProperty(T,"prototype",{writable:!1}),T}function Bc(T,d){var i=typeof Symbol<"u"&&T[Symbol.iterator]||T["@@iterator"];if(i)return(i=i.call(T)).next.bind(i);if(Array.isArray(T)||(i=function(u,c){if(u){if(typeof u=="string")return Uc(u,c);var l=Object.prototype.toString.call(u).slice(8,-1);return l==="Object"&&u.constructor&&(l=u.constructor.name),l==="Map"||l==="Set"?Array.from(u):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?Uc(u,c):void 0}}(T))||d&&T&&typeof T.length=="number"){i&&(T=i);var s=0;return function(){return s>=T.length?{done:!0}:{done:!1,value:T[s++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uc(T,d){(d==null||d>T.length)&&(d=T.length);for(var i=0,s=new Array(d);i<d;i++)s[i]=T[i];return s}function As(){return As=Object.assign?Object.assign.bind():function(T){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(T[s]=i[s])}return T},As.apply(this,arguments)}(function(T){T.MANIFEST="m",T.AUDIO="a",T.VIDEO="v",T.MUXED="av",T.INIT="i",T.CAPTION="c",T.TIMED_TEXT="tt",T.KEY="k",T.OTHER="o"})(nr||(nr={})),function(T){T.DASH="d",T.HLS="h",T.SMOOTH="s",T.OTHER="o"}(co||(co={})),function(T){T.VOD="v",T.LIVE="l"}(wc||(wc={}));var sg=function(){function T(i){var s=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){s.initialized&&(s.starved=!0),s.buffering=!0},this.onPlaying=function(){s.initialized||(s.initialized=!0),s.buffering=!1},this.applyPlaylistData=function(l){try{s.apply(l,{ot:nr.MANIFEST,su:!s.initialized})}catch(o){O.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=function(l){try{var o=l.frag,h=s.hls.levels[o.level],g=s.getObjectType(o),p={d:1e3*o.duration,ot:g};g!==nr.VIDEO&&g!==nr.AUDIO&&g!=nr.MUXED||(p.br=h.bitrate/1e3,p.tb=s.getTopBandwidth(g)/1e3,p.bl=s.getBufferLength(g)),s.apply(l,p)}catch(v){O.logger.warn("Could not generate segment CMCD data.",v)}},this.hls=i;var u=this.config=i.config,c=u.cmcd;c!=null&&(u.pLoader=this.createPlaylistLoader(),u.fLoader=this.createFragmentLoader(),this.sid=c.sessionId||T.uuid(),this.cid=c.contentId,this.useHeaders=c.useHeaders===!0,this.registerListeners())}var d=T.prototype;return d.registerListeners=function(){var i=this.hls;i.on(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(b.Events.MEDIA_DETACHED,this.onMediaDetached,this),i.on(b.Events.BUFFER_CREATED,this.onBufferCreated,this)},d.unregisterListeners=function(){var i=this.hls;i.off(b.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(b.Events.MEDIA_DETACHED,this.onMediaDetached,this),i.off(b.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},d.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},d.onMediaAttached=function(i,s){this.media=s.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},d.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},d.onBufferCreated=function(i,s){var u,c;this.audioBuffer=(u=s.tracks.audio)===null||u===void 0?void 0:u.buffer,this.videoBuffer=(c=s.tracks.video)===null||c===void 0?void 0:c.buffer},d.createData=function(){var i;return{v:1,sf:co.HLS,sid:this.sid,cid:this.cid,pr:(i=this.media)===null||i===void 0?void 0:i.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},d.apply=function(i,s){s===void 0&&(s={}),As(s,this.createData());var u=s.ot===nr.INIT||s.ot===nr.VIDEO||s.ot===nr.MUXED;if(this.starved&&u&&(s.bs=!0,s.su=!0,this.starved=!1),s.su==null&&(s.su=this.buffering),this.useHeaders){var c=T.toHeaders(s);if(!Object.keys(c).length)return;i.headers||(i.headers={}),As(i.headers,c)}else{var l=T.toQuery(s);if(!l)return;i.url=T.appendQueryToUri(i.url,l)}},d.getObjectType=function(i){var s=i.type;return s==="subtitle"?nr.TIMED_TEXT:i.sn==="initSegment"?nr.INIT:s==="audio"?nr.AUDIO:s==="main"?this.hls.audioTracks.length?nr.VIDEO:nr.MUXED:void 0},d.getTopBandwidth=function(i){var s,u=0,c=this.hls;if(i===nr.AUDIO)s=c.audioTracks;else{var l=c.maxAutoLevel,o=l>-1?l+1:c.levels.length;s=c.levels.slice(0,o)}for(var h,g=Bc(s);!(h=g()).done;){var p=h.value;p.bitrate>u&&(u=p.bitrate)}return u>0?u:NaN},d.getBufferLength=function(i){var s=this.hls.media,u=i===nr.AUDIO?this.audioBuffer:this.videoBuffer;return u&&s?1e3*Ht.bufferInfo(u,s.currentTime,this.config.maxBufferHole).len:NaN},d.createPlaylistLoader=function(){var i=this.config.pLoader,s=this.applyPlaylistData,u=i||this.config.loader;return function(){function c(o){this.loader=void 0,this.loader=new u(o)}var l=c.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(o,h,g){s(o),this.loader.load(o,h,g)},Fc(c,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),c}()},d.createFragmentLoader=function(){var i=this.config.fLoader,s=this.applyFragmentData,u=i||this.config.loader;return function(){function c(o){this.loader=void 0,this.loader=new u(o)}var l=c.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(o,h,g){s(o),this.loader.load(o,h,g)},Fc(c,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),c}()},T.uuid=function(){var i=URL.createObjectURL(new Blob),s=i.toString();return URL.revokeObjectURL(i),s.slice(s.lastIndexOf("/")+1)},T.serialize=function(i){for(var s,u=[],c=function(M){return!Number.isNaN(M)&&M!=null&&M!==""&&M!==!1},l=function(M){return Math.round(M)},o=function(M){return 100*l(M/100)},h={br:l,d:l,bl:o,dl:o,mtp:o,nor:function(M){return encodeURIComponent(M)},rtp:o,tb:l},g=Bc(Object.keys(i||{}).sort());!(s=g()).done;){var p=s.value,v=i[p];if(c(v)&&!(p==="v"&&v===1||p=="pr"&&v===1)){var S=h[p];S&&(v=S(v));var R,k=typeof v;R=p==="ot"||p==="sf"||p==="st"?p+"="+v:k==="boolean"?p:k==="number"?p+"="+v:p+"="+JSON.stringify(v),u.push(R)}}return u.join(",")},T.toHeaders=function(i){for(var s={},u=["Object","Request","Session","Status"],c=[{},{},{},{}],l={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},o=0,h=Object.keys(i);o<h.length;o++){var g=h[o];c[l[g]!=null?l[g]:1][g]=i[g]}for(var p=0;p<c.length;p++){var v=T.serialize(c[p]);v&&(s["CMCD-"+u[p]]=v)}return s},T.toQuery=function(i){return"CMCD="+encodeURIComponent(T.serialize(i))},T.appendQueryToUri=function(i,s){if(!s)return i;var u=i.includes("?")?"&":"?";return""+i+u+s},T}(),Hc=y(408),ag=/^age:\s*[\d.]+\s*$/m;const Gc=function(){function T(i){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=i?i.xhrSetup:null,this.stats=new Hc.LoadStats,this.retryDelay=0}var d=T.prototype;return d.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},d.abortInternal=function(){var i=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),i&&(i.onreadystatechange=null,i.onprogress=null,i.readyState!==4&&(this.stats.aborted=!0,i.abort()))},d.abort=function(){var i;this.abortInternal(),(i=this.callbacks)!==null&&i!==void 0&&i.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},d.load=function(i,s,u){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=i,this.config=s,this.callbacks=u,this.retryDelay=s.retryDelay,this.loadInternal()},d.loadInternal=function(){var i=this.config,s=this.context;if(i){var u=this.loader=new self.XMLHttpRequest,c=this.stats;c.loading.first=0,c.loaded=0;var l=this.xhrSetup;try{if(l)try{l(u,s.url)}catch{u.open("GET",s.url,!0),l(u,s.url)}u.readyState||u.open("GET",s.url,!0);var o=this.context.headers;if(o)for(var h in o)u.setRequestHeader(h,o[h])}catch(g){return void this.callbacks.onError({code:u.status,text:g.message},s,u)}s.rangeEnd&&u.setRequestHeader("Range","bytes="+s.rangeStart+"-"+(s.rangeEnd-1)),u.onreadystatechange=this.readystatechange.bind(this),u.onprogress=this.loadprogress.bind(this),u.responseType=s.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),u.send()}},d.readystatechange=function(){var i=this.context,s=this.loader,u=this.stats;if(i&&s){var c=s.readyState,l=this.config;if(!u.aborted&&c>=2)if(self.clearTimeout(this.requestTimeout),u.loading.first===0&&(u.loading.first=Math.max(self.performance.now(),u.loading.start)),c===4){s.onreadystatechange=null,s.onprogress=null;var o=s.status,h=s.responseType==="arraybuffer";if(o>=200&&o<300&&(h&&s.response||s.responseText!==null)){var g,p;if(u.loading.end=Math.max(self.performance.now(),u.loading.first),p=h?(g=s.response).byteLength:(g=s.responseText).length,u.loaded=u.total=p,!this.callbacks)return;var v=this.callbacks.onProgress;if(v&&v(u,i,g,s),!this.callbacks)return;var S={url:s.responseURL,data:g};this.callbacks.onSuccess(S,u,i,s)}else u.retry>=l.maxRetry||o>=400&&o<499?(O.logger.error(o+" while loading "+i.url),this.callbacks.onError({code:o,text:s.statusText},i,s)):(O.logger.warn(o+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,l.maxRetryDelay),u.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),l.timeout)}},d.loadtimeout=function(){O.logger.warn("timeout while loading "+this.context.url);var i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))},d.loadprogress=function(i){var s=this.stats;s.loaded=i.loaded,i.lengthComputable&&(s.total=i.total)},d.getCacheAge=function(){var i=null;if(this.loader&&ag.test(this.loader.getAllResponseHeaders())){var s=this.loader.getResponseHeader("age");i=s?parseFloat(s):null}return i},T}();function lo(T){var d=typeof Map=="function"?new Map:void 0;return lo=function(i){if(i===null||(s=i,Function.toString.call(s).indexOf("[native code]")===-1))return i;var s;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(d!==void 0){if(d.has(i))return d.get(i);d.set(i,u)}function u(){return ho(i,arguments,fo(this).constructor)}return u.prototype=Object.create(i.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),Ni(u,i)},lo(T)}function ho(T,d,i){return ho=og()?Reflect.construct.bind():function(s,u,c){var l=[null];l.push.apply(l,u);var o=new(Function.bind.apply(s,l));return c&&Ni(o,c.prototype),o},ho.apply(null,arguments)}function og(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ni(T,d){return Ni=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Ni(T,d)}function fo(T){return fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(d){return d.__proto__||Object.getPrototypeOf(d)},fo(T)}function go(){return go=Object.assign?Object.assign.bind():function(T){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(T[s]=i[s])}return T},go.apply(this,arguments)}var ug=function(){function T(i){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=i.fetchSetup||cg,this.controller=new self.AbortController,this.stats=new Hc.LoadStats}var d=T.prototype;return d.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},d.abortInternal=function(){var i=this.response;i&&i.ok||(this.stats.aborted=!0,this.controller.abort())},d.abort=function(){var i;this.abortInternal(),(i=this.callbacks)!==null&&i!==void 0&&i.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},d.load=function(i,s,u){var c=this,l=this.stats;if(l.loading.start)throw new Error("Loader can only be used once.");l.loading.start=self.performance.now();var o=function(v,S){var R={method:"GET",mode:"cors",credentials:"same-origin",signal:S,headers:new self.Headers(go({},v.headers))};return v.rangeEnd&&R.headers.set("Range","bytes="+v.rangeStart+"-"+String(v.rangeEnd-1)),R}(i,this.controller.signal),h=u.onProgress,g=i.responseType==="arraybuffer",p=g?"byteLength":"length";this.context=i,this.config=s,this.callbacks=u,this.request=this.fetchSetup(i,o),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){c.abortInternal(),u.onTimeout(l,i,c.response)},s.timeout),self.fetch(this.request).then(function(v){if(c.response=c.loader=v,!v.ok){var S=v.status,R=v.statusText;throw new lg(R||"fetch, bad network response",S,v)}return l.loading.first=Math.max(self.performance.now(),l.loading.start),l.total=parseInt(v.headers.get("Content-Length")||"0"),h&&(0,C.isFiniteNumber)(s.highWaterMark)?c.loadProgressively(v,l,i,s.highWaterMark,h):g?v.arrayBuffer():v.text()}).then(function(v){var S=c.response;self.clearTimeout(c.requestTimeout),l.loading.end=Math.max(self.performance.now(),l.loading.first);var R=v[p];R&&(l.loaded=l.total=R);var k={url:S.url,data:v};h&&!(0,C.isFiniteNumber)(s.highWaterMark)&&h(l,i,v,S),u.onSuccess(k,l,i,S)}).catch(function(v){if(self.clearTimeout(c.requestTimeout),!l.aborted){var S=v&&v.code||0,R=v?v.message:null;u.onError({code:S,text:R},i,v?v.details:null)}})},d.getCacheAge=function(){var i=null;if(this.response){var s=this.response.headers.get("age");i=s?parseFloat(s):null}return i},d.loadProgressively=function(i,s,u,c,l){c===void 0&&(c=0);var o=new mc,h=i.body.getReader();return function g(){return h.read().then(function(p){if(p.done)return o.dataLength&&l(s,u,o.flush(),i),Promise.resolve(new ArrayBuffer(0));var v=p.value,S=v.length;return s.loaded+=S,S<c||o.dataLength?(o.push(v),o.dataLength>=c&&l(s,u,o.flush(),i)):l(s,u,v,i),g()}).catch(function(){return Promise.reject()})}()},T}();function cg(T,d){return new self.Request(T.url,d)}var lg=function(T){var d,i;function s(u,c,l){var o;return(o=T.call(this,u)||this).code=void 0,o.details=void 0,o.code=c,o.details=l,o}return i=T,(d=s).prototype=Object.create(i.prototype),d.prototype.constructor=d,Ni(d,i),s}(lo(Error));const Kc=ug;var hg=/\s/;function mo(){return mo=Object.assign?Object.assign.bind():function(T){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(T[s]=i[s])}return T},mo.apply(this,arguments)}function Yc(T,d){var i=Object.keys(T);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(T);d&&(s=s.filter(function(u){return Object.getOwnPropertyDescriptor(T,u).enumerable})),i.push.apply(i,s)}return i}function jc(T){for(var d=1;d<arguments.length;d++){var i=arguments[d]!=null?arguments[d]:{};d%2?Yc(Object(i),!0).forEach(function(s){fg(T,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(i)):Yc(Object(i)).forEach(function(s){Object.defineProperty(T,s,Object.getOwnPropertyDescriptor(i,s))})}return T}function fg(T,d,i){return(d=function(s){var u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s,"string");return typeof u=="symbol"?u:String(u)}(d))in T?Object.defineProperty(T,d,{value:i,enumerable:!0,configurable:!0,writable:!0}):T[d]=i,T}var dg=jc(jc({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Gc,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:S0,bufferController:w0,capLevelController:tg,fpsController:rg,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Le,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},{cueHandler:{newCue:function(T,d,i,s){for(var u,c,l,o,h,g=[],p=self.VTTCue||self.TextTrackCue,v=0;v<s.rows.length;v++)if(l=!0,o=0,h="",!(u=s.rows[v]).isEmpty()){for(var S=0;S<u.chars.length;S++)hg.test(u.chars[S].uchar)&&l?o++:(h+=u.chars[S].uchar,l=!1);u.cueStartTime=d,d===i&&(i+=1e-4),o>=16?o--:o++;var R=Cc(h.trim()),k=eo(d,i,R);T&&T.cues&&T.cues.getCueById(k)||((c=new p(d,i,R)).id=k,c.line=v+1,c.align="left",c.position=10+Math.min(80,10*Math.floor(8*o/32)),g.push(c))}return T&&g.length&&(g.sort(function(M,V){return M.line==="auto"||V.line==="auto"?0:M.line>8&&V.line>8?V.line-M.line:M.line-V.line}),g.forEach(function(M){return Oe(T,M)})),g}},enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:N0,subtitleTrackController:k0,timelineController:J0,audioStreamController:C0,audioTrackController:R0,emeController:ig,cmcdController:sg});function Vc(T,d){for(var i=0;i<d.length;i++){var s=d[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(T,typeof(u=function(c,l){if(typeof c!="object"||c===null)return c;var o=c[Symbol.toPrimitive];if(o!==void 0){var h=o.call(c,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}(s.key,"string"))=="symbol"?u:String(u),s)}var u}var qc=function(){function T(c){c===void 0&&(c={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Ga.EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var l=this.config=function(Se,Xe){if((Xe.liveSyncDurationCount||Xe.liveMaxLatencyDurationCount)&&(Xe.liveSyncDuration||Xe.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(Xe.liveMaxLatencyDurationCount!==void 0&&(Xe.liveSyncDurationCount===void 0||Xe.liveMaxLatencyDurationCount<=Xe.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(Xe.liveMaxLatencyDuration!==void 0&&(Xe.liveSyncDuration===void 0||Xe.liveMaxLatencyDuration<=Xe.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return mo({},Se,Xe)}(T.DefaultConfig,c);this.userConfig=c,(0,O.enableLogs)(l.debug,"Hls instance"),this._autoLevelCapping=-1,l.progressive&&function(Se){var Xe=Se.loader;Xe!==Kc&&Xe!==Gc?(O.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),Se.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}()&&(Se.loader=Kc,Se.progressive=!0,Se.enableSoftwareAES=!0,O.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}(l);var o=l.abrController,h=l.bufferController,g=l.capLevelController,p=l.fpsController,v=this.abrController=new o(this),S=this.bufferController=new h(this),R=this.capLevelController=new g(this),k=new p(this),M=new ie(this),V=new et(this),K=this.levelController=new mt(this),Z=new Lt(this),de=new Sr(this.config),_e=this.streamController=new y0(this,Z,de);R.setStreamController(_e),k.setStreamController(_e);var Te=[M,K,_e];this.networkControllers=Te;var De=[v,S,R,k,V,Z];this.audioTrackController=this.createController(l.audioTrackController,Te);var ze=l.audioStreamController;ze&&Te.push(new ze(this,Z,de)),this.subtitleTrackController=this.createController(l.subtitleTrackController,Te);var st=l.subtitleStreamController;st&&Te.push(new st(this,Z,de)),this.createController(l.timelineController,De),de.emeController=this.emeController=this.createController(l.emeController,De),this.cmcdController=this.createController(l.cmcdController,De),this.latencyController=this.createController(ht,De),this.coreComponents=De}T.isSupported=function(){return function(){var c=Ua();if(!c)return!1;var l=lc(),o=c&&typeof c.isTypeSupported=="function"&&c.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),h=!l||l.prototype&&typeof l.prototype.appendBuffer=="function"&&typeof l.prototype.remove=="function";return!!o&&!!h}()};var d,i,s,u=T.prototype;return u.createController=function(c,l){if(c){var o=new c(this);return l&&l.push(o),o}return null},u.on=function(c,l,o){o===void 0&&(o=this),this._emitter.on(c,l,o)},u.once=function(c,l,o){o===void 0&&(o=this),this._emitter.once(c,l,o)},u.removeAllListeners=function(c){this._emitter.removeAllListeners(c)},u.off=function(c,l,o,h){o===void 0&&(o=this),this._emitter.off(c,l,o,h)},u.listeners=function(c){return this._emitter.listeners(c)},u.emit=function(c,l,o){return this._emitter.emit(c,l,o)},u.trigger=function(c,l){if(this.config.debug)return this.emit(c,c,l);try{return this.emit(c,c,l)}catch(o){O.logger.error("An internal error happened while handling event "+c+'. Error message: "'+o.message+'". Here is a stacktrace:',o),this.trigger(b.Events.ERROR,{type:L.ErrorTypes.OTHER_ERROR,details:L.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:c,error:o})}return!1},u.listenerCount=function(c){return this._emitter.listenerCount(c)},u.destroy=function(){O.logger.log("destroy"),this.trigger(b.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(c){return c.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(c){return c.destroy()}),this.coreComponents.length=0},u.attachMedia=function(c){O.logger.log("attachMedia"),this._media=c,this.trigger(b.Events.MEDIA_ATTACHING,{media:c})},u.detachMedia=function(){O.logger.log("detachMedia"),this.trigger(b.Events.MEDIA_DETACHING,void 0),this._media=null},u.loadSource=function(c){this.stopLoad();var l=this.media,o=this.url,h=this.url=I.buildAbsoluteURL(self.location.href,c,{alwaysNormalize:!0});O.logger.log("loadSource:"+h),l&&o&&o!==h&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(l)),this.trigger(b.Events.MANIFEST_LOADING,{url:c})},u.startLoad=function(c){c===void 0&&(c=-1),O.logger.log("startLoad("+c+")"),this.networkControllers.forEach(function(l){l.startLoad(c)})},u.stopLoad=function(){O.logger.log("stopLoad"),this.networkControllers.forEach(function(c){c.stopLoad()})},u.swapAudioCodec=function(){O.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},u.recoverMediaError=function(){O.logger.log("recoverMediaError");var c=this._media;this.detachMedia(),c&&this.attachMedia(c)},u.removeLevel=function(c,l){l===void 0&&(l=0),this.levelController.removeLevel(c,l)},d=T,s=[{key:"version",get:function(){return"1.3.1"}},{key:"Events",get:function(){return b.Events}},{key:"ErrorTypes",get:function(){return L.ErrorTypes}},{key:"ErrorDetails",get:function(){return L.ErrorDetails}},{key:"DefaultConfig",get:function(){return T.defaultConfig?T.defaultConfig:dg},set:function(c){T.defaultConfig=c}}],(i=[{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(c){O.logger.log("set currentLevel:"+c),this.loadLevel=c,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(c){O.logger.log("set nextLevel:"+c),this.levelController.manualLevel=c,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(c){O.logger.log("set loadLevel:"+c),this.levelController.manualLevel=c}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(c){this.levelController.nextLoadLevel=c}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(c){O.logger.log("set firstLevel:"+c),this.levelController.firstLevel=c}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(c){O.logger.log("set startLevel:"+c),c!==-1&&(c=Math.max(c,this.minAutoLevel)),this.levelController.startLevel=c}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(c){var l=!!c;l!==this.config.capLevelToPlayerSize&&(l?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=l)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(c){this._autoLevelCapping!==c&&(O.logger.log("set autoLevelCapping:"+c),this._autoLevelCapping=c)}},{key:"bandwidthEstimate",get:function(){var c=this.abrController.bwEstimator;return c?c.getEstimate():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(c){Bt.indexOf(c)>-1&&(this._maxHdcpLevel=c)}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var c=this.levels,l=this.config.minAutoBitrate;if(!c)return 0;for(var o=c.length,h=0;h<o;h++)if(c[h].maxBitrate>=l)return h;return 0}},{key:"maxAutoLevel",get:function(){var c,l=this.levels,o=this.autoLevelCapping,h=this.maxHdcpLevel;if(c=o===-1&&l&&l.length?l.length-1:o,h)for(var g=c;g--;){var p=l[g].attrs["HDCP-LEVEL"];if(p&&p<=h)return g}return c}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(c){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,c)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var c=this.audioTrackController;return c?c.audioTracks:[]}},{key:"audioTrack",get:function(){var c=this.audioTrackController;return c?c.audioTrack:-1},set:function(c){var l=this.audioTrackController;l&&(l.audioTrack=c)}},{key:"subtitleTracks",get:function(){var c=this.subtitleTrackController;return c?c.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var c=this.subtitleTrackController;return c?c.subtitleTrack:-1},set:function(c){var l=this.subtitleTrackController;l&&(l.subtitleTrack=c)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var c=this.subtitleTrackController;return!!c&&c.subtitleDisplay},set:function(c){var l=this.subtitleTrackController;l&&(l.subtitleDisplay=c)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(c){this.config.lowLatencyMode=c}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&Vc(d.prototype,i),s&&Vc(d,s),Object.defineProperty(d,"prototype",{writable:!1}),T}();qc.defaultConfig=void 0},923:(E,A,y)=>{y.r(A),y.d(A,{BaseSegment:()=>ee,ElementaryStreamTypes:()=>_,Fragment:()=>le,Part:()=>$});var _,I=y(965),C=y(945),b=y(408);function L(fe,ue){fe.prototype=Object.create(ue.prototype),fe.prototype.constructor=fe,O(fe,ue)}function O(fe,ue){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(se,re){return se.__proto__=re,se},O(fe,ue)}function oe(fe,ue){for(var se=0;se<ue.length;se++){var re=ue[se];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(fe,typeof(Ne=function(Pe,Ze){if(typeof Pe!="object"||Pe===null)return Pe;var ce=Pe[Symbol.toPrimitive];if(ce!==void 0){var P=ce.call(Pe,Ze);if(typeof P!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Pe)}(re.key,"string"))=="symbol"?Ne:String(Ne),re)}var Ne}function z(fe,ue,se){return ue&&oe(fe.prototype,ue),se&&oe(fe,se),Object.defineProperty(fe,"prototype",{writable:!1}),fe}(function(fe){fe.AUDIO="audio",fe.VIDEO="video",fe.AUDIOVIDEO="audiovideo"})(_||(_={}));var ee=function(){function fe(ue){var se;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((se={})[_.AUDIO]=null,se[_.VIDEO]=null,se[_.AUDIOVIDEO]=null,se),this.baseurl=ue}return fe.prototype.setByteRange=function(ue,se){var re=ue.split("@",2),Ne=[];re.length===1?Ne[0]=se?se.byteRangeEndOffset:0:Ne[0]=parseInt(re[1]),Ne[1]=parseInt(re[0])+Ne[0],this._byteRange=Ne},z(fe,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,C.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(ue){this._url=ue}}]),fe}(),le=function(fe){function ue(re,Ne){var Pe;return(Pe=fe.call(this,Ne)||this)._decryptdata=null,Pe.rawProgramDateTime=null,Pe.programDateTime=null,Pe.tagList=[],Pe.duration=0,Pe.sn=0,Pe.levelkeys=void 0,Pe.type=void 0,Pe.loader=null,Pe.keyLoader=null,Pe.level=-1,Pe.cc=0,Pe.startPTS=void 0,Pe.endPTS=void 0,Pe.appendedPTS=void 0,Pe.startDTS=void 0,Pe.endDTS=void 0,Pe.start=0,Pe.deltaPTS=void 0,Pe.maxStartPTS=void 0,Pe.minEndPTS=void 0,Pe.stats=new b.LoadStats,Pe.urlId=0,Pe.data=void 0,Pe.bitrateTest=!1,Pe.title=null,Pe.initSegment=null,Pe.endList=void 0,Pe.type=re,Pe}L(ue,fe);var se=ue.prototype;return se.setKeyFormat=function(re){if(this.levelkeys){var Ne=this.levelkeys[re];Ne&&!this._decryptdata&&(this._decryptdata=Ne.getDecryptData(this.sn))}},se.abortRequests=function(){var re,Ne;(re=this.loader)===null||re===void 0||re.abort(),(Ne=this.keyLoader)===null||Ne===void 0||Ne.abort()},se.setElementaryStreamInfo=function(re,Ne,Pe,Ze,ce,P){P===void 0&&(P=!1);var Q=this.elementaryStreams,U=Q[re];U?(U.startPTS=Math.min(U.startPTS,Ne),U.endPTS=Math.max(U.endPTS,Pe),U.startDTS=Math.min(U.startDTS,Ze),U.endDTS=Math.max(U.endDTS,ce)):Q[re]={startPTS:Ne,endPTS:Pe,startDTS:Ze,endDTS:ce,partial:P}},se.clearElementaryStreamInfo=function(){var re=this.elementaryStreams;re[_.AUDIO]=null,re[_.VIDEO]=null,re[_.AUDIOVIDEO]=null},z(ue,[{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var re=this.levelkeys.identity;if(re)this._decryptdata=re.getDecryptData(this.sn);else{var Ne=Object.keys(this.levelkeys);if(Ne.length===1)return this._decryptdata=this.levelkeys[Ne[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!(0,I.isFiniteNumber)(this.programDateTime))return null;var re=(0,I.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*re}},{key:"encrypted",get:function(){var re;if((re=this._decryptdata)!==null&&re!==void 0&&re.encrypted)return!0;if(this.levelkeys){var Ne=Object.keys(this.levelkeys),Pe=Ne.length;if(Pe>1||Pe===1&&this.levelkeys[Ne[0]].encrypted)return!0}return!1}}]),ue}(ee),$=function(fe){function ue(se,re,Ne,Pe,Ze){var ce;(ce=fe.call(this,Ne)||this).fragOffset=0,ce.duration=0,ce.gap=!1,ce.independent=!1,ce.relurl=void 0,ce.fragment=void 0,ce.index=void 0,ce.stats=new b.LoadStats,ce.duration=se.decimalFloatingPoint("DURATION"),ce.gap=se.bool("GAP"),ce.independent=se.bool("INDEPENDENT"),ce.relurl=se.enumeratedString("URI"),ce.fragment=re,ce.index=Pe;var P=se.enumeratedString("BYTERANGE");return P&&ce.setByteRange(P,Ze),Ze&&(ce.fragOffset=Ze.fragOffset+Ze.duration),ce}return L(ue,fe),z(ue,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var se=this.elementaryStreams;return!!(se.audio||se.video||se.audiovideo)}}]),ue}(ee)},408:(E,A,y)=>{y.r(A),y.d(A,{LoadStats:()=>_});var _=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},965:(E,A,y)=>{y.r(A),y.d(A,{MAX_SAFE_INTEGER:()=>I,isFiniteNumber:()=>_});var _=Number.isFinite||function(C){return typeof C=="number"&&isFinite(C)},I=Number.MAX_SAFE_INTEGER||9007199254740991},524:(E,A,y)=>{y.r(A),y.d(A,{default:()=>se,flushTextTrackMetadataCueSamples:()=>Ne,flushTextTrackUserdataCueSamples:()=>Pe,normalizePts:()=>re});var _=y(965);const I=function(){function P(){}return P.getSilentFrame=function(Q,U){if(Q==="mp4a.40.2"){if(U===1)return new Uint8Array([0,200,0,128,35,128]);if(U===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(U===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(U===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(U===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(U===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(U===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(U===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(U===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},P}();var C=Math.pow(2,32)-1,b=function(){function P(){}return P.init=function(){var Q;for(Q in P.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},P.types)P.types.hasOwnProperty(Q)&&(P.types[Q]=[Q.charCodeAt(0),Q.charCodeAt(1),Q.charCodeAt(2),Q.charCodeAt(3)]);var U=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),pe=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);P.HDLR_TYPES={video:U,audio:pe};var Le=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ve=new Uint8Array([0,0,0,0,0,0,0,0]);P.STTS=P.STSC=P.STCO=ve,P.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),P.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),P.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),P.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var Ee=new Uint8Array([105,115,111,109]),We=new Uint8Array([97,118,99,49]),Je=new Uint8Array([0,0,0,1]);P.FTYP=P.box(P.types.ftyp,Ee,Je,Ee,We),P.DINF=P.box(P.types.dinf,P.box(P.types.dref,Le))},P.box=function(Q){for(var U=8,pe=arguments.length,Le=new Array(pe>1?pe-1:0),ve=1;ve<pe;ve++)Le[ve-1]=arguments[ve];for(var Ee=Le.length,We=Ee;Ee--;)U+=Le[Ee].byteLength;var Je=new Uint8Array(U);for(Je[0]=U>>24&255,Je[1]=U>>16&255,Je[2]=U>>8&255,Je[3]=255&U,Je.set(Q,4),Ee=0,U=8;Ee<We;Ee++)Je.set(Le[Ee],U),U+=Le[Ee].byteLength;return Je},P.hdlr=function(Q){return P.box(P.types.hdlr,P.HDLR_TYPES[Q])},P.mdat=function(Q){return P.box(P.types.mdat,Q)},P.mdhd=function(Q,U){U*=Q;var pe=Math.floor(U/(C+1)),Le=Math.floor(U%(C+1));return P.box(P.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,Q>>24&255,Q>>16&255,Q>>8&255,255&Q,pe>>24,pe>>16&255,pe>>8&255,255&pe,Le>>24,Le>>16&255,Le>>8&255,255&Le,85,196,0,0]))},P.mdia=function(Q){return P.box(P.types.mdia,P.mdhd(Q.timescale,Q.duration),P.hdlr(Q.type),P.minf(Q))},P.mfhd=function(Q){return P.box(P.types.mfhd,new Uint8Array([0,0,0,0,Q>>24,Q>>16&255,Q>>8&255,255&Q]))},P.minf=function(Q){return Q.type==="audio"?P.box(P.types.minf,P.box(P.types.smhd,P.SMHD),P.DINF,P.stbl(Q)):P.box(P.types.minf,P.box(P.types.vmhd,P.VMHD),P.DINF,P.stbl(Q))},P.moof=function(Q,U,pe){return P.box(P.types.moof,P.mfhd(Q),P.traf(pe,U))},P.moov=function(Q){for(var U=Q.length,pe=[];U--;)pe[U]=P.trak(Q[U]);return P.box.apply(null,[P.types.moov,P.mvhd(Q[0].timescale,Q[0].duration)].concat(pe).concat(P.mvex(Q)))},P.mvex=function(Q){for(var U=Q.length,pe=[];U--;)pe[U]=P.trex(Q[U]);return P.box.apply(null,[P.types.mvex].concat(pe))},P.mvhd=function(Q,U){U*=Q;var pe=Math.floor(U/(C+1)),Le=Math.floor(U%(C+1)),ve=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,Q>>24&255,Q>>16&255,Q>>8&255,255&Q,pe>>24,pe>>16&255,pe>>8&255,255&pe,Le>>24,Le>>16&255,Le>>8&255,255&Le,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return P.box(P.types.mvhd,ve)},P.sdtp=function(Q){var U,pe,Le=Q.samples||[],ve=new Uint8Array(4+Le.length);for(U=0;U<Le.length;U++)pe=Le[U].flags,ve[U+4]=pe.dependsOn<<4|pe.isDependedOn<<2|pe.hasRedundancy;return P.box(P.types.sdtp,ve)},P.stbl=function(Q){return P.box(P.types.stbl,P.stsd(Q),P.box(P.types.stts,P.STTS),P.box(P.types.stsc,P.STSC),P.box(P.types.stsz,P.STSZ),P.box(P.types.stco,P.STCO))},P.avc1=function(Q){var U,pe,Le,ve=[],Ee=[];for(U=0;U<Q.sps.length;U++)Le=(pe=Q.sps[U]).byteLength,ve.push(Le>>>8&255),ve.push(255&Le),ve=ve.concat(Array.prototype.slice.call(pe));for(U=0;U<Q.pps.length;U++)Le=(pe=Q.pps[U]).byteLength,Ee.push(Le>>>8&255),Ee.push(255&Le),Ee=Ee.concat(Array.prototype.slice.call(pe));var We=P.box(P.types.avcC,new Uint8Array([1,ve[3],ve[4],ve[5],255,224|Q.sps.length].concat(ve).concat([Q.pps.length]).concat(Ee))),Je=Q.width,$e=Q.height,je=Q.pixelRatio[0],ct=Q.pixelRatio[1];return P.box(P.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Je>>8&255,255&Je,$e>>8&255,255&$e,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),We,P.box(P.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),P.box(P.types.pasp,new Uint8Array([je>>24,je>>16&255,je>>8&255,255&je,ct>>24,ct>>16&255,ct>>8&255,255&ct])))},P.esds=function(Q){var U=Q.config.length;return new Uint8Array([0,0,0,0,3,23+U,0,1,0,4,15+U,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([U]).concat(Q.config).concat([6,1,2]))},P.mp4a=function(Q){var U=Q.samplerate;return P.box(P.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,Q.channelCount,0,16,0,0,0,0,U>>8&255,255&U,0,0]),P.box(P.types.esds,P.esds(Q)))},P.mp3=function(Q){var U=Q.samplerate;return P.box(P.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,Q.channelCount,0,16,0,0,0,0,U>>8&255,255&U,0,0]))},P.stsd=function(Q){return Q.type==="audio"?Q.segmentCodec==="mp3"&&Q.codec==="mp3"?P.box(P.types.stsd,P.STSD,P.mp3(Q)):P.box(P.types.stsd,P.STSD,P.mp4a(Q)):P.box(P.types.stsd,P.STSD,P.avc1(Q))},P.tkhd=function(Q){var U=Q.id,pe=Q.duration*Q.timescale,Le=Q.width,ve=Q.height,Ee=Math.floor(pe/(C+1)),We=Math.floor(pe%(C+1));return P.box(P.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,U>>24&255,U>>16&255,U>>8&255,255&U,0,0,0,0,Ee>>24,Ee>>16&255,Ee>>8&255,255&Ee,We>>24,We>>16&255,We>>8&255,255&We,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,Le>>8&255,255&Le,0,0,ve>>8&255,255&ve,0,0]))},P.traf=function(Q,U){var pe=P.sdtp(Q),Le=Q.id,ve=Math.floor(U/(C+1)),Ee=Math.floor(U%(C+1));return P.box(P.types.traf,P.box(P.types.tfhd,new Uint8Array([0,0,0,0,Le>>24,Le>>16&255,Le>>8&255,255&Le])),P.box(P.types.tfdt,new Uint8Array([1,0,0,0,ve>>24,ve>>16&255,ve>>8&255,255&ve,Ee>>24,Ee>>16&255,Ee>>8&255,255&Ee])),P.trun(Q,pe.length+16+20+8+16+8+8),pe)},P.trak=function(Q){return Q.duration=Q.duration||4294967295,P.box(P.types.trak,P.tkhd(Q),P.mdia(Q))},P.trex=function(Q){var U=Q.id;return P.box(P.types.trex,new Uint8Array([0,0,0,0,U>>24,U>>16&255,U>>8&255,255&U,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},P.trun=function(Q,U){var pe,Le,ve,Ee,We,Je,$e=Q.samples||[],je=$e.length,ct=12+16*je,_t=new Uint8Array(ct);for(U+=8+ct,_t.set([Q.type==="video"?1:0,0,15,1,je>>>24&255,je>>>16&255,je>>>8&255,255&je,U>>>24&255,U>>>16&255,U>>>8&255,255&U],0),pe=0;pe<je;pe++)ve=(Le=$e[pe]).duration,Ee=Le.size,We=Le.flags,Je=Le.cts,_t.set([ve>>>24&255,ve>>>16&255,ve>>>8&255,255&ve,Ee>>>24&255,Ee>>>16&255,Ee>>>8&255,255&Ee,We.isLeading<<2|We.dependsOn,We.isDependedOn<<6|We.hasRedundancy<<4|We.paddingValue<<1|We.isNonSync,61440&We.degradPrio,15&We.degradPrio,Je>>>24&255,Je>>>16&255,Je>>>8&255,255&Je],12+16*pe);return P.box(P.types.trun,_t)},P.initSegment=function(Q){P.types||P.init();var U=P.moov(Q),pe=new Uint8Array(P.FTYP.byteLength+U.byteLength);return pe.set(P.FTYP),pe.set(U,P.FTYP.byteLength),pe},P}();b.types=void 0,b.HDLR_TYPES=void 0,b.STTS=void 0,b.STSC=void 0,b.STCO=void 0,b.STSZ=void 0,b.VMHD=void 0,b.SMHD=void 0,b.STSD=void 0,b.FTYP=void 0,b.DINF=void 0;const L=b;var O=y(851),oe=y(973),z=y(93),ee=y(308),le=y(673);function $(){return $=Object.assign?Object.assign.bind():function(P){for(var Q=1;Q<arguments.length;Q++){var U=arguments[Q];for(var pe in U)Object.prototype.hasOwnProperty.call(U,pe)&&(P[pe]=U[pe])}return P},$.apply(this,arguments)}var fe=null,ue=null,se=function(){function P(U,pe,Le,ve){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=U,this.config=pe,this.typeSupported=Le,this.ISGenerated=!1,fe===null){var Ee=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);fe=Ee?parseInt(Ee[1]):0}if(ue===null){var We=navigator.userAgent.match(/Safari\/(\d+)/i);ue=We?parseInt(We[1]):0}}var Q=P.prototype;return Q.destroy=function(){},Q.resetTimeStamp=function(U){z.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=U},Q.resetNextTimestamp=function(){z.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},Q.resetInitSegment=function(){z.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},Q.getVideoStartPts=function(U){var pe=!1,Le=U.reduce(function(ve,Ee){var We=Ee.pts-ve;return We<-4294967296?(pe=!0,re(ve,Ee.pts)):We>0?ve:Ee.pts},U[0].pts);return pe&&z.logger.debug("PTS rollover detected"),Le},Q.remux=function(U,pe,Le,ve,Ee,We,Je,$e){var je,ct,_t,B,J,q,ge=Ee,Ae=Ee,ke=U.pid>-1,Ie=pe.pid>-1,N=pe.samples.length,x=U.samples.length>0,j=Je&&N>0||N>1;if((!ke||x)&&(!Ie||j)||this.ISGenerated||Je){this.ISGenerated||(_t=this.generateIS(U,pe,Ee));var ie,me=this.isVideoContiguous,Oe=-1;if(j&&(Oe=function(Qe){for(var He=0;He<Qe.length;He++)if(Qe[He].key)return He;return-1}(pe.samples),!me&&this.config.forceKeyFrameOnDiscontinuity))if(q=!0,Oe>0){z.logger.warn("[mp4-remuxer]: Dropped "+Oe+" out of "+N+" video samples due to a missing keyframe");var Fe=this.getVideoStartPts(pe.samples);pe.samples=pe.samples.slice(Oe),pe.dropped+=Oe,ie=Ae+=(pe.samples[0].pts-Fe)/pe.inputTimeScale}else Oe===-1&&(z.logger.warn("[mp4-remuxer]: No keyframe found out of "+N+" video samples"),q=!1);if(this.ISGenerated){if(x&&j){var we=this.getVideoStartPts(pe.samples),Ue=(re(U.samples[0].pts,we)-we)/pe.inputTimeScale;ge+=Math.max(0,Ue),Ae+=Math.max(0,-Ue)}if(x){if(U.samplerate||(z.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),_t=this.generateIS(U,pe,Ee)),ct=this.remuxAudio(U,ge,this.isAudioContiguous,We,Ie||j||$e===ee.PlaylistLevelType.AUDIO?Ae:void 0),j){var Ce=ct?ct.endPTS-ct.startPTS:0;pe.inputTimeScale||(z.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),_t=this.generateIS(U,pe,Ee)),je=this.remuxVideo(pe,Ae,me,Ce)}}else j&&(je=this.remuxVideo(pe,Ae,me,0));je&&(je.firstKeyFrame=Oe,je.independent=Oe!==-1,je.firstKeyFramePTS=ie)}}return this.ISGenerated&&(Le.samples.length&&(J=Ne(Le,Ee,this._initPTS,this._initDTS)),ve.samples.length&&(B=Pe(ve,Ee,this._initPTS))),{audio:ct,video:je,initSegment:_t,independent:q,text:B,id3:J}},Q.generateIS=function(U,pe,Le){var ve,Ee,We,Je=U.samples,$e=pe.samples,je=this.typeSupported,ct={},_t=!(0,_.isFiniteNumber)(this._initPTS),B="audio/mp4";if(_t&&(ve=Ee=1/0),U.config&&Je.length&&(U.timescale=U.samplerate,U.segmentCodec==="mp3"&&(je.mpeg?(B="audio/mpeg",U.codec=""):je.mp3&&(U.codec="mp3")),ct.audio={id:"audio",container:B,codec:U.codec,initSegment:U.segmentCodec==="mp3"&&je.mpeg?new Uint8Array(0):L.initSegment([U]),metadata:{channelCount:U.channelCount}},_t&&(We=U.inputTimeScale,ve=Ee=Je[0].pts-Math.round(We*Le))),pe.sps&&pe.pps&&$e.length&&(pe.timescale=pe.inputTimeScale,ct.video={id:"main",container:"video/mp4",codec:pe.codec,initSegment:L.initSegment([pe]),metadata:{width:pe.width,height:pe.height}},_t)){We=pe.inputTimeScale;var J=this.getVideoStartPts($e),q=Math.round(We*Le);Ee=Math.min(Ee,re($e[0].dts,J)-q),ve=Math.min(ve,J-q)}if(Object.keys(ct).length)return this.ISGenerated=!0,_t&&(this._initPTS=ve,this._initDTS=Ee),{tracks:ct,initPTS:ve,timescale:We}},Q.remuxVideo=function(U,pe,Le,ve){var Ee,We,Je=U.inputTimeScale,$e=U.samples,je=[],ct=$e.length,_t=this._initPTS,B=this.nextAvcDts,J=8,q=this.videoSampleDuration,ge=Number.POSITIVE_INFINITY,Ae=Number.NEGATIVE_INFINITY,ke=!1;Le&&B!==null||(B=pe*Je-($e[0].pts-re($e[0].dts,$e[0].pts)));for(var Ie=0;Ie<ct;Ie++){var N=$e[Ie];N.pts=re(N.pts-_t,B),N.dts=re(N.dts-_t,B),N.dts<$e[Ie>0?Ie-1:Ie].dts&&(ke=!0)}ke&&$e.sort(function(zt,Sr){var Sn=zt.dts-Sr.dts,Ir=zt.pts-Sr.pts;return Sn||Ir}),Ee=$e[0].dts;var x=$e[$e.length-1].dts-Ee,j=x?Math.round(x/(ct-1)):q||U.inputTimeScale/30;if(Le){var ie=Ee-B,me=ie>j,Oe=ie<-1;if((me||Oe)&&(me?z.logger.warn("AVC: "+(0,le.toMsFromMpegTsClock)(ie,!0)+" ms ("+ie+"dts) hole between fragments detected, filling it"):z.logger.warn("AVC: "+(0,le.toMsFromMpegTsClock)(-ie,!0)+" ms ("+ie+"dts) overlapping between fragments detected"),!Oe||B>$e[0].pts)){Ee=B;var Fe=$e[0].pts-ie;$e[0].dts=Ee,$e[0].pts=Fe,z.logger.log("Video: First PTS/DTS adjusted: "+(0,le.toMsFromMpegTsClock)(Fe,!0)+"/"+(0,le.toMsFromMpegTsClock)(Ee,!0)+", delta: "+(0,le.toMsFromMpegTsClock)(ie,!0)+" ms")}}Ee=Math.max(0,Ee);for(var we=0,Ue=0,Ce=0;Ce<ct;Ce++){for(var Qe=$e[Ce],He=Qe.units,Ge=He.length,et=0,nt=0;nt<Ge;nt++)et+=He[nt].data.length;Ue+=et,we+=Ge,Qe.length=et,Qe.dts=Math.max(Qe.dts,Ee),ge=Math.min(Qe.pts,ge),Ae=Math.max(Qe.pts,Ae)}We=$e[ct-1].dts;var ht,ft=Ue+4*we+8;try{ht=new Uint8Array(ft)}catch{return void this.observer.emit(O.Events.ERROR,O.Events.ERROR,{type:oe.ErrorTypes.MUX_ERROR,details:oe.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ft,reason:"fail allocating video mdat "+ft})}var Tt=new DataView(ht.buffer);Tt.setUint32(0,ft),ht.set(L.types.mdat,4);for(var Bt=!1,ne=Number.POSITIVE_INFINITY,W=Number.POSITIVE_INFINITY,D=Number.NEGATIVE_INFINITY,G=Number.NEGATIVE_INFINITY,H=0;H<ct;H++){for(var X=$e[H],te=X.units,ae=0,ye=0,xe=te.length;ye<xe;ye++){var Me=te[ye],Ke=Me.data,tt=Me.data.byteLength;Tt.setUint32(J,tt),J+=4,ht.set(Ke,J),J+=tt,ae+=4+tt}var qe=void 0;if(H<ct-1)q=$e[H+1].dts-X.dts,qe=$e[H+1].pts-X.pts;else{var at=this.config,mt=H>0?X.dts-$e[H-1].dts:j;if(qe=H>0?X.pts-$e[H-1].pts:j,at.stretchShortVideoTrack&&this.nextAudioPts!==null){var Lt=Math.floor(at.maxBufferHole*Je),it=(ve?ge+ve*Je:this.nextAudioPts)-X.pts;it>Lt?((q=it-mt)<0?q=mt:Bt=!0,z.logger.log("[mp4-remuxer]: It is approximately "+it/90+" ms to the next segment; using duration "+q/90+" ms for the last video frame.")):q=mt}else q=mt}var Ot=Math.round(X.pts-X.dts);ne=Math.min(ne,q),D=Math.max(D,q),W=Math.min(W,qe),G=Math.max(G,qe),je.push(new Ze(X.key,q,ae,Ot))}if(je.length){if(fe){if(fe<70){var tr=je[0].flags;tr.dependsOn=2,tr.isNonSync=0}}else if(ue&&G-W<D-ne&&j/D<.025&&je[0].cts===0){z.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var jt=Ee,Ft=0,Wt=je.length;Ft<Wt;Ft++){var ot=jt+je[Ft].duration,cr=jt+je[Ft].cts;if(Ft<Wt-1){var $r=ot+je[Ft+1].cts;je[Ft].duration=$r-cr}else je[Ft].duration=Ft?je[Ft-1].duration:j;je[Ft].cts=0,jt=ot}}}q=Bt||!q?j:q,this.nextAvcDts=B=We+q,this.videoSampleDuration=q,this.isVideoContiguous=!0;var Vt={data1:L.moof(U.sequenceNumber++,Ee,$({},U,{samples:je})),data2:ht,startPTS:ge/Je,endPTS:(Ae+q)/Je,startDTS:Ee/Je,endDTS:B/Je,type:"video",hasAudio:!1,hasVideo:!0,nb:je.length,dropped:U.dropped};return U.samples=[],U.dropped=0,Vt},Q.remuxAudio=function(U,pe,Le,ve,Ee){var We=U.inputTimeScale,Je=We/(U.samplerate?U.samplerate:We),$e=U.segmentCodec==="aac"?1024:1152,je=$e*Je,ct=this._initPTS,_t=U.segmentCodec==="mp3"&&this.typeSupported.mpeg,B=[],J=Ee!==void 0,q=U.samples,ge=_t?0:8,Ae=this.nextAudioPts||-1,ke=pe*We;if(this.isAudioContiguous=Le=Le||q.length&&Ae>0&&(ve&&Math.abs(ke-Ae)<9e3||Math.abs(re(q[0].pts-ct,ke)-Ae)<20*je),q.forEach(function(ye){ye.pts=re(ye.pts-ct,ke)}),!Le||Ae<0){if(q=q.filter(function(ye){return ye.pts>=0}),!q.length)return;Ae=Ee===0?0:ve&&!J?Math.max(0,ke):q[0].pts}if(U.segmentCodec==="aac")for(var Ie=this.config.maxAudioFramesDrift,N=0,x=Ae;N<q.length;N++){var j=q[N],ie=j.pts,me=ie-x,Oe=Math.abs(1e3*me/We);if(me<=-Ie*je&&J)N===0&&(z.logger.warn("Audio frame @ "+(ie/We).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*me/We)+" ms."),this.nextAudioPts=Ae=x=ie);else if(me>=Ie*je&&Oe<1e4&&J){var Fe=Math.round(me/je);(x=ie-Fe*je)<0&&(Fe--,x+=je),N===0&&(this.nextAudioPts=Ae=x),z.logger.warn("[mp4-remuxer]: Injecting "+Fe+" audio frame @ "+(x/We).toFixed(3)+"s due to "+Math.round(1e3*me/We)+" ms gap.");for(var we=0;we<Fe;we++){var Ue=Math.max(x,0),Ce=I.getSilentFrame(U.manifestCodec||U.codec,U.channelCount);Ce||(z.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ce=j.unit.subarray()),q.splice(N,0,{unit:Ce,pts:Ue}),x+=je,N++}}j.pts=x,x+=je}for(var Qe,He=null,Ge=null,et=0,nt=q.length;nt--;)et+=q[nt].unit.byteLength;for(var ht=0,ft=q.length;ht<ft;ht++){var Tt=q[ht],Bt=Tt.unit,ne=Tt.pts;if(Ge!==null)B[ht-1].duration=Math.round((ne-Ge)/Je);else{if(Le&&U.segmentCodec==="aac"&&(ne=Ae),He=ne,!(et>0))return;et+=ge;try{Qe=new Uint8Array(et)}catch{return void this.observer.emit(O.Events.ERROR,O.Events.ERROR,{type:oe.ErrorTypes.MUX_ERROR,details:oe.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:et,reason:"fail allocating audio mdat "+et})}_t||(new DataView(Qe.buffer).setUint32(0,et),Qe.set(L.types.mdat,4))}Qe.set(Bt,ge);var W=Bt.byteLength;ge+=W,B.push(new Ze(!0,$e,W,0)),Ge=ne}var D=B.length;if(D){var G=B[B.length-1];this.nextAudioPts=Ae=Ge+Je*G.duration;var H=_t?new Uint8Array(0):L.moof(U.sequenceNumber++,He/Je,$({},U,{samples:B}));U.samples=[];var X=He/We,te=Ae/We,ae={data1:H,data2:Qe,startPTS:X,endPTS:te,startDTS:X,endDTS:te,type:"audio",hasAudio:!0,hasVideo:!1,nb:D};return this.isAudioContiguous=!0,ae}},Q.remuxEmptyAudio=function(U,pe,Le,ve){var Ee=U.inputTimeScale,We=Ee/(U.samplerate?U.samplerate:Ee),Je=this.nextAudioPts,$e=(Je!==null?Je:ve.startDTS*Ee)+this._initDTS,je=ve.endDTS*Ee+this._initDTS,ct=1024*We,_t=Math.ceil((je-$e)/ct),B=I.getSilentFrame(U.manifestCodec||U.codec,U.channelCount);if(z.logger.warn("[mp4-remuxer]: remux empty Audio"),B){for(var J=[],q=0;q<_t;q++){var ge=$e+q*ct;J.push({unit:B,pts:ge,dts:ge})}return U.samples=J,this.remuxAudio(U,pe,Le,!1)}z.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},P}();function re(P,Q){var U;if(Q===null)return P;for(U=Q<P?-8589934592:8589934592;Math.abs(P-Q)>4294967296;)P+=U;return P}function Ne(P,Q,U,pe){var Le=P.samples.length;if(Le){for(var ve=P.inputTimeScale,Ee=0;Ee<Le;Ee++){var We=P.samples[Ee];We.pts=re(We.pts-U,Q*ve)/ve,We.dts=re(We.dts-pe,Q*ve)/ve}var Je=P.samples;return P.samples=[],{samples:Je}}}function Pe(P,Q,U){var pe=P.samples.length;if(pe){for(var Le=P.inputTimeScale,ve=0;ve<pe;ve++){var Ee=P.samples[ve];Ee.pts=re(Ee.pts-U,Q*Le)/Le}P.samples.sort(function(Je,$e){return Je.pts-$e.pts});var We=P.samples;return P.samples=[],{samples:We}}}var Ze=function(P,Q,U,pe){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=Q,this.size=U,this.cts=pe,this.flags=new ce(P)},ce=function(P){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=P?2:1,this.isNonSync=P?0:1}},856:(E,A,y)=>{var _;y.r(A),y.d(A,{MetadataSchema:()=>_}),function(I){I.audioId3="org.id3",I.dateRange="com.apple.quicktime.HLS",I.emsg="https://aomedia.org/emsg/ID3"}(_||(_={}))},308:(E,A,y)=>{var _,I;y.r(A),y.d(A,{PlaylistContextType:()=>_,PlaylistLevelType:()=>I}),function(C){C.MANIFEST="manifest",C.LEVEL="level",C.AUDIO_TRACK="audioTrack",C.SUBTITLE_TRACK="subtitleTrack"}(_||(_={})),function(C){C.MAIN="main",C.AUDIO="audio",C.SUBTITLE="subtitle"}(I||(I={}))},300:(E,A,y)=>{y.r(A),y.d(A,{default:()=>_});const _={hexDump:function(I){for(var C="",b=0;b<I.length;b++){var L=I[b].toString(16);L.length<2&&(L="0"+L),C+=L}return C}}},93:(E,A,y)=>{y.r(A),y.d(A,{enableLogs:()=>L,logger:()=>O});var _=function(){},I={trace:_,debug:_,log:_,warn:_,info:_,error:_},C=I;function b(oe){var z=self.console[oe];return z?z.bind(self.console,"["+oe+"] >"):_}function L(oe,z){if(self.console&&oe===!0||typeof oe=="object"){(function(ee){for(var le=arguments.length,$=new Array(le>1?le-1:0),fe=1;fe<le;fe++)$[fe-1]=arguments[fe];$.forEach(function(ue){C[ue]=ee[ue]?ee[ue].bind(ee):b(ue)})})(oe,"debug","log","info","warn","error");try{C.log('Debug logs enabled for "'+z+'"')}catch{C=I}}else C=I}var O=I},63:(E,A,y)=>{y.r(A),y.d(A,{RemuxerTrackIdConfig:()=>z,appendUint8Array:()=>Le,bin2str:()=>ee,computeRawDurationFromSamples:()=>Q,discardEPB:()=>Je,findBox:()=>se,getDuration:()=>P,getStartDTS:()=>ce,mp4Box:()=>je,mp4pssh:()=>ct,offsetStartDTS:()=>U,parseEmsg:()=>$e,parseInitSegment:()=>Ne,parsePssh:()=>_t,parseSEIMessageFromNALu:()=>We,parseSamples:()=>ve,parseSegmentIndex:()=>re,parseSinf:()=>Ze,patchEncyptionData:()=>Pe,readSint32:()=>fe,readUint16:()=>le,readUint32:()=>$,segmentValidRange:()=>pe,writeUint32:()=>ue});var _=y(923),I=y(145),C=y(181),b=y(93),L=y(300),O=Math.pow(2,32)-1,oe=[].push,z={video:1,audio:2,id3:3,text:4};function ee(B){return String.fromCharCode.apply(null,B)}function le(B,J){var q=B[J]<<8|B[J+1];return q<0?65536+q:q}function $(B,J){var q=fe(B,J);return q<0?4294967296+q:q}function fe(B,J){return B[J]<<24|B[J+1]<<16|B[J+2]<<8|B[J+3]}function ue(B,J,q){B[J]=q>>24,B[J+1]=q>>16&255,B[J+2]=q>>8&255,B[J+3]=255&q}function se(B,J){var q=[];if(!J.length)return q;for(var ge=B.byteLength,Ae=0;Ae<ge;){var ke=$(B,Ae),Ie=ke>1?Ae+ke:ge;if(ee(B.subarray(Ae+4,Ae+8))===J[0])if(J.length===1)q.push(B.subarray(Ae+8,Ie));else{var N=se(B.subarray(Ae+8,Ie),J.slice(1));N.length&&oe.apply(q,N)}Ae=Ie}return q}function re(B){var J=[],q=B[0],ge=8,Ae=$(B,ge);ge+=4,ge+=q===0?8:16,ge+=2;var ke=B.length+0,Ie=le(B,ge);ge+=2;for(var N=0;N<Ie;N++){var x=ge,j=$(B,x);x+=4;var ie=2147483647&j;if((2147483648&j)>>>31==1)return console.warn("SIDX has hierarchical references (not supported)"),null;var me=$(B,x);x+=4,J.push({referenceSize:ie,subsegmentDuration:me,info:{duration:me/Ae,start:ke,end:ke+ie-1}}),ke+=ie,ge=x+=4}return{earliestPresentationTime:0,timescale:Ae,version:q,referencesCount:Ie,references:J}}function Ne(B){for(var J=[],q=se(B,["moov","trak"]),ge=0;ge<q.length;ge++){var Ae=q[ge],ke=se(Ae,["tkhd"])[0];if(ke){var Ie=ke[0],N=Ie===0?12:20,x=$(ke,N),j=se(Ae,["mdia","mdhd"])[0];if(j){var ie=$(j,N=(Ie=j[0])===0?12:20),me=se(Ae,["mdia","hdlr"])[0];if(me){var Oe=ee(me.subarray(8,12)),Fe={soun:_.ElementaryStreamTypes.AUDIO,vide:_.ElementaryStreamTypes.VIDEO}[Oe];if(Fe){var we=se(Ae,["mdia","minf","stbl","stsd"])[0],Ue=void 0;we&&(Ue=ee(we.subarray(12,16))),J[x]={timescale:ie,type:Fe},J[Fe]={timescale:ie,id:x,codec:Ue}}}}}}return se(B,["moov","mvex","trex"]).forEach(function(Ce){var Qe=$(Ce,4),He=J[Qe];He&&(He.default={duration:$(Ce,12),flags:$(Ce,20)})}),J}function Pe(B,J){if(!B||!J)return B;var q=J.keyId;return q&&J.isCommonEncryption&&se(B,["moov","trak"]).forEach(function(ge){var Ae=se(ge,["mdia","minf","stbl","stsd"])[0].subarray(8),ke=se(Ae,["enca"]),Ie=ke.length>0;Ie||(ke=se(Ae,["encv"])),ke.forEach(function(N){se(Ie?N.subarray(28):N.subarray(78),["sinf"]).forEach(function(x){var j=Ze(x);if(j){var ie=j.subarray(8,24);ie.some(function(me){return me!==0})||(b.logger.log("[eme] Patching keyId in 'enc"+(Ie?"a":"v")+">sinf>>tenc' box: "+L.default.hexDump(ie)+" -> "+L.default.hexDump(q)),j.set(q,8))}})})}),B}function Ze(B){var J=se(B,["schm"])[0];if(J){var q=ee(J.subarray(4,8));if(q==="cbcs"||q==="cenc")return se(B,["schi","tenc"])[0]}return b.logger.error("[eme] missing 'schm' box"),null}function ce(B,J){return se(J,["moof","traf"]).reduce(function(q,ge){var Ae=se(ge,["tfdt"])[0],ke=Ae[0],Ie=se(ge,["tfhd"]).reduce(function(N,x){var j=$(x,4),ie=B[j];if(ie){var me=$(Ae,4);ke===1&&(me*=Math.pow(2,32),me+=$(Ae,8));var Oe=me/(ie.timescale||9e4);if(isFinite(Oe)&&(N===null||Oe<N))return Oe}return N},null);return Ie!==null&&isFinite(Ie)&&(q===null||Ie<q)?Ie:q},null)||0}function P(B,J){for(var q=0,ge=0,Ae=0,ke=se(B,["moof","traf"]),Ie=0;Ie<ke.length;Ie++){var N=ke[Ie],x=se(N,["tfhd"])[0],j=J[$(x,4)];if(j){var ie=j.default,me=$(x,0)|(ie==null?void 0:ie.flags),Oe=ie==null?void 0:ie.duration;8&me&&(Oe=$(x,2&me?12:8));for(var Fe=j.timescale||9e4,we=se(N,["trun"]),Ue=0;Ue<we.length;Ue++)!(q=Q(we[Ue]))&&Oe&&(q=Oe*$(we[Ue],4)),j.type===_.ElementaryStreamTypes.VIDEO?ge+=q/Fe:j.type===_.ElementaryStreamTypes.AUDIO&&(Ae+=q/Fe)}}if(ge===0&&Ae===0){for(var Ce=0,Qe=se(B,["sidx"]),He=0;He<Qe.length;He++){var Ge=re(Qe[He]);Ge!=null&&Ge.references&&(Ce+=Ge.references.reduce(function(et,nt){return et+nt.info.duration||0},0))}return Ce}return ge||Ae}function Q(B){var J=$(B,0),q=8;1&J&&(q+=4),4&J&&(q+=4);for(var ge=0,Ae=$(B,4),ke=0;ke<Ae;ke++)256&J&&(ge+=$(B,q),q+=4),512&J&&(q+=4),1024&J&&(q+=4),2048&J&&(q+=4);return ge}function U(B,J,q){se(J,["moof","traf"]).forEach(function(ge){se(ge,["tfhd"]).forEach(function(Ae){var ke=$(Ae,4),Ie=B[ke];if(Ie){var N=Ie.timescale||9e4;se(ge,["tfdt"]).forEach(function(x){var j=x[0],ie=$(x,4);if(j===0)ie-=q*N,ue(x,4,ie=Math.max(ie,0));else{ie*=Math.pow(2,32),ie+=$(x,8),ie-=q*N,ie=Math.max(ie,0);var me=Math.floor(ie/(O+1)),Oe=Math.floor(ie%(O+1));ue(x,4,me),ue(x,8,Oe)}})}})})}function pe(B){var J={valid:null,remainder:null},q=se(B,["moof"]);if(!q)return J;if(q.length<2)return J.remainder=B,J;var ge=q[q.length-1];return J.valid=(0,I.sliceUint8)(B,0,ge.byteOffset-8),J.remainder=(0,I.sliceUint8)(B,ge.byteOffset-8),J}function Le(B,J){var q=new Uint8Array(B.length+J.length);return q.set(B),q.set(J,B.length),q}function ve(B,J){var q=[],ge=J.samples,Ae=J.timescale,ke=J.id,Ie=!1;return se(ge,["moof"]).map(function(N){var x=N.byteOffset-8;se(N,["traf"]).map(function(j){var ie=se(j,["tfdt"]).map(function(me){var Oe=me[0],Fe=$(me,4);return Oe===1&&(Fe*=Math.pow(2,32),Fe+=$(me,8)),Fe/Ae})[0];return ie!==void 0&&(B=ie),se(j,["tfhd"]).map(function(me){var Oe=$(me,4),Fe=16777215&$(me,0),we=0,Ue=(16&Fe)!=0,Ce=0,Qe=(32&Fe)!=0,He=8;Oe===ke&&(1&Fe&&(He+=8),2&Fe&&(He+=4),8&Fe&&(we=$(me,He),He+=4),Ue&&(Ce=$(me,He),He+=4),Qe&&(He+=4),J.type==="video"&&(Ie=function(Ge){if(!Ge)return!1;var et=Ge.indexOf("."),nt=et<0?Ge:Ge.substring(0,et);return nt==="hvc1"||nt==="hev1"||nt==="dvh1"||nt==="dvhe"}(J.codec)),se(j,["trun"]).map(function(Ge){var et=Ge[0],nt=16777215&$(Ge,0),ht=(1&nt)!=0,ft=0,Tt=(4&nt)!=0,Bt=(256&nt)!=0,ne=0,W=(512&nt)!=0,D=0,G=(1024&nt)!=0,H=(2048&nt)!=0,X=0,te=$(Ge,4),ae=8;ht&&(ft=$(Ge,ae),ae+=4),Tt&&(ae+=4);for(var ye=ft+x,xe=0;xe<te;xe++){if(Bt?(ne=$(Ge,ae),ae+=4):ne=we,W?(D=$(Ge,ae),ae+=4):D=Ce,G&&(ae+=4),H&&(X=et===0?$(Ge,ae):fe(Ge,ae),ae+=4),J.type===_.ElementaryStreamTypes.VIDEO)for(var Me=0;Me<D;){var Ke=$(ge,ye);Ee(Ie,ge[ye+=4])&&We(ge.subarray(ye,ye+Ke),Ie?2:1,B+X/Ae,q),ye+=Ke,Me+=Ke+4}B+=ne/Ae}}))})})}),q}function Ee(B,J){if(B){var q=J>>1&63;return q===39||q===40}return(31&J)==6}function We(B,J,q,ge){var Ae=Je(B),ke=0;ke+=J;for(var Ie=0,N=0,x=!1,j=0;ke<Ae.length;){Ie=0;do{if(ke>=Ae.length)break;Ie+=j=Ae[ke++]}while(j===255);N=0;do{if(ke>=Ae.length)break;N+=j=Ae[ke++]}while(j===255);var ie=Ae.length-ke;if(!x&&Ie===4&&ke<Ae.length){if(x=!0,Ae[ke++]===181){var me=le(Ae,ke);if(ke+=2,me===49){var Oe=$(Ae,ke);if(ke+=4,Oe===1195456820){var Fe=Ae[ke++];if(Fe===3){var we=Ae[ke++],Ue=64&we,Ce=Ue?2+3*(31&we):0,Qe=new Uint8Array(Ce);if(Ue){Qe[0]=we;for(var He=1;He<Ce;He++)Qe[He]=Ae[ke++]}ge.push({type:Fe,payloadType:Ie,pts:q,bytes:Qe})}}}}}else if(Ie===5&&N<ie){if(x=!0,N>16){for(var Ge=[],et=0;et<16;et++){var nt=Ae[ke++].toString(16);Ge.push(nt.length==1?"0"+nt:nt),et!==3&&et!==5&&et!==7&&et!==9||Ge.push("-")}for(var ht=N-16,ft=new Uint8Array(ht),Tt=0;Tt<ht;Tt++)ft[Tt]=Ae[ke++];ge.push({payloadType:Ie,pts:q,uuid:Ge.join(""),userData:(0,C.utf8ArrayToStr)(ft),userDataBytes:ft})}}else if(N<ie)ke+=N;else if(N>ie)break}}function Je(B){for(var J=B.byteLength,q=[],ge=1;ge<J-2;)B[ge]===0&&B[ge+1]===0&&B[ge+2]===3?(q.push(ge+2),ge+=2):ge++;if(q.length===0)return B;var Ae=J-q.length,ke=new Uint8Array(Ae),Ie=0;for(ge=0;ge<Ae;Ie++,ge++)Ie===q[0]&&(Ie++,q.shift()),ke[ge]=B[Ie];return ke}function $e(B){var J=B[0],q="",ge="",Ae=0,ke=0,Ie=0,N=0,x=0,j=0;if(J===0){for(;ee(B.subarray(j,j+1))!=="\0";)q+=ee(B.subarray(j,j+1)),j+=1;for(q+=ee(B.subarray(j,j+1)),j+=1;ee(B.subarray(j,j+1))!=="\0";)ge+=ee(B.subarray(j,j+1)),j+=1;ge+=ee(B.subarray(j,j+1)),j+=1,Ae=$(B,12),ke=$(B,16),N=$(B,20),x=$(B,24),j=28}else if(J===1){Ae=$(B,j+=4);var ie=$(B,j+=4),me=$(B,j+=4);for(j+=4,Ie=Math.pow(2,32)*ie+me,Number.isSafeInteger(Ie)||(Ie=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),N=$(B,j),x=$(B,j+=4),j+=4;ee(B.subarray(j,j+1))!=="\0";)q+=ee(B.subarray(j,j+1)),j+=1;for(q+=ee(B.subarray(j,j+1)),j+=1;ee(B.subarray(j,j+1))!=="\0";)ge+=ee(B.subarray(j,j+1)),j+=1;ge+=ee(B.subarray(j,j+1)),j+=1}return{schemeIdUri:q,value:ge,timeScale:Ae,presentationTime:Ie,presentationTimeDelta:ke,eventDuration:N,id:x,payload:B.subarray(j,B.byteLength)}}function je(B){for(var J=arguments.length,q=new Array(J>1?J-1:0),ge=1;ge<J;ge++)q[ge-1]=arguments[ge];for(var Ae=q.length,ke=8,Ie=Ae;Ie--;)ke+=q[Ie].byteLength;var N=new Uint8Array(ke);for(N[0]=ke>>24&255,N[1]=ke>>16&255,N[2]=ke>>8&255,N[3]=255&ke,N.set(B,4),Ie=0,ke=8;Ie<Ae;Ie++)N.set(q[Ie],ke),ke+=q[Ie].byteLength;return N}function ct(B,J,q){if(B.byteLength!==16)throw new RangeError("Invalid system id");var ge,Ae,ke;if(J){ge=1,Ae=new Uint8Array(16*J.length);for(var Ie=0;Ie<J.length;Ie++){var N=J[Ie];if(N.byteLength!==16)throw new RangeError("Invalid key");Ae.set(N,16*Ie)}}else ge=0,Ae=new Uint8Array;ge>0?(ke=new Uint8Array(4),J.length>0&&new DataView(ke.buffer).setUint32(0,J.length,!1)):ke=new Uint8Array;var x=new Uint8Array(4);return q&&q.byteLength>0&&new DataView(x.buffer).setUint32(0,q.byteLength,!1),je([112,115,115,104],new Uint8Array([ge,0,0,0]),B,ke,Ae,x,q||new Uint8Array)}function _t(B){if(!(B instanceof ArrayBuffer)||B.byteLength<32)return null;var J={version:0,systemId:"",kids:null,data:null},q=new DataView(B),ge=q.getUint32(0);if(B.byteLength!==ge&&ge>44||q.getUint32(4)!==1886614376||(J.version=q.getUint32(8)>>>24,J.version>1))return null;J.systemId=L.default.hexDump(new Uint8Array(B,12,16));var Ae=q.getUint32(28);if(J.version===0){if(ge-32<Ae)return null;J.data=new Uint8Array(B,32,Ae)}else if(J.version===1){J.kids=[];for(var ke=0;ke<Ae;ke++)J.kids.push(new Uint8Array(B,32+16*ke,16))}return J}},673:(E,A,y)=>{function _(L,O,oe,z){oe===void 0&&(oe=1),z===void 0&&(z=!1);var ee=L*O*oe;return z?Math.round(ee):ee}function I(L,O,oe,z){return oe===void 0&&(oe=1),z===void 0&&(z=!1),_(L,O,1/oe,z)}function C(L,O){return O===void 0&&(O=!1),_(L,1e3,11111111111111112e-21,O)}function b(L,O){return O===void 0&&(O=1),_(L,9e4,1/O)}y.r(A),y.d(A,{toMpegTsClockFromTimescale:()=>b,toMsFromMpegTsClock:()=>C,toTimescaleFromBase:()=>_,toTimescaleFromScale:()=>I})},145:(E,A,y)=>{function _(I,C,b){return Uint8Array.prototype.slice?I.slice(C,b):new Uint8Array(Array.prototype.slice.call(I,C,b))}y.r(A),y.d(A,{sliceUint8:()=>_})},729:E=>{var A=Object.prototype.hasOwnProperty,y="~";function _(){}function I(O,oe,z){this.fn=O,this.context=oe,this.once=z||!1}function C(O,oe,z,ee,le){if(typeof z!="function")throw new TypeError("The listener must be a function");var $=new I(z,ee||O,le),fe=y?y+oe:oe;return O._events[fe]?O._events[fe].fn?O._events[fe]=[O._events[fe],$]:O._events[fe].push($):(O._events[fe]=$,O._eventsCount++),O}function b(O,oe){--O._eventsCount==0?O._events=new _:delete O._events[oe]}function L(){this._events=new _,this._eventsCount=0}Object.create&&(_.prototype=Object.create(null),new _().__proto__||(y=!1)),L.prototype.eventNames=function(){var O,oe,z=[];if(this._eventsCount===0)return z;for(oe in O=this._events)A.call(O,oe)&&z.push(y?oe.slice(1):oe);return Object.getOwnPropertySymbols?z.concat(Object.getOwnPropertySymbols(O)):z},L.prototype.listeners=function(O){var oe=y?y+O:O,z=this._events[oe];if(!z)return[];if(z.fn)return[z.fn];for(var ee=0,le=z.length,$=new Array(le);ee<le;ee++)$[ee]=z[ee].fn;return $},L.prototype.listenerCount=function(O){var oe=y?y+O:O,z=this._events[oe];return z?z.fn?1:z.length:0},L.prototype.emit=function(O,oe,z,ee,le,$){var fe=y?y+O:O;if(!this._events[fe])return!1;var ue,se,re=this._events[fe],Ne=arguments.length;if(re.fn){switch(re.once&&this.removeListener(O,re.fn,void 0,!0),Ne){case 1:return re.fn.call(re.context),!0;case 2:return re.fn.call(re.context,oe),!0;case 3:return re.fn.call(re.context,oe,z),!0;case 4:return re.fn.call(re.context,oe,z,ee),!0;case 5:return re.fn.call(re.context,oe,z,ee,le),!0;case 6:return re.fn.call(re.context,oe,z,ee,le,$),!0}for(se=1,ue=new Array(Ne-1);se<Ne;se++)ue[se-1]=arguments[se];re.fn.apply(re.context,ue)}else{var Pe,Ze=re.length;for(se=0;se<Ze;se++)switch(re[se].once&&this.removeListener(O,re[se].fn,void 0,!0),Ne){case 1:re[se].fn.call(re[se].context);break;case 2:re[se].fn.call(re[se].context,oe);break;case 3:re[se].fn.call(re[se].context,oe,z);break;case 4:re[se].fn.call(re[se].context,oe,z,ee);break;default:if(!ue)for(Pe=1,ue=new Array(Ne-1);Pe<Ne;Pe++)ue[Pe-1]=arguments[Pe];re[se].fn.apply(re[se].context,ue)}}return!0},L.prototype.on=function(O,oe,z){return C(this,O,oe,z,!1)},L.prototype.once=function(O,oe,z){return C(this,O,oe,z,!0)},L.prototype.removeListener=function(O,oe,z,ee){var le=y?y+O:O;if(!this._events[le])return this;if(!oe)return b(this,le),this;var $=this._events[le];if($.fn)$.fn!==oe||ee&&!$.once||z&&$.context!==z||b(this,le);else{for(var fe=0,ue=[],se=$.length;fe<se;fe++)($[fe].fn!==oe||ee&&!$[fe].once||z&&$[fe].context!==z)&&ue.push($[fe]);ue.length?this._events[le]=ue.length===1?ue[0]:ue:b(this,le)}return this},L.prototype.removeAllListeners=function(O){var oe;return O?(oe=y?y+O:O,this._events[oe]&&b(this,oe)):(this._events=new _,this._eventsCount=0),this},L.prototype.off=L.prototype.removeListener,L.prototype.addListener=L.prototype.on,L.prefixed=y,L.EventEmitter=L,E.exports=L},945:function(E){var A,y,_,I,C;A=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,y=/^(?=([^\/?#]*))\1([^]*)$/,_=/(?:\/|^)\.(?=\/)/g,I=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,C={buildAbsoluteURL:function(b,L,O){if(O=O||{},b=b.trim(),!(L=L.trim())){if(!O.alwaysNormalize)return b;var oe=C.parseURL(b);if(!oe)throw new Error("Error trying to parse base URL.");return oe.path=C.normalizePath(oe.path),C.buildURLFromParts(oe)}var z=C.parseURL(L);if(!z)throw new Error("Error trying to parse relative URL.");if(z.scheme)return O.alwaysNormalize?(z.path=C.normalizePath(z.path),C.buildURLFromParts(z)):L;var ee=C.parseURL(b);if(!ee)throw new Error("Error trying to parse base URL.");if(!ee.netLoc&&ee.path&&ee.path[0]!=="/"){var le=y.exec(ee.path);ee.netLoc=le[1],ee.path=le[2]}ee.netLoc&&!ee.path&&(ee.path="/");var $={scheme:ee.scheme,netLoc:z.netLoc,path:null,params:z.params,query:z.query,fragment:z.fragment};if(!z.netLoc&&($.netLoc=ee.netLoc,z.path[0]!=="/"))if(z.path){var fe=ee.path,ue=fe.substring(0,fe.lastIndexOf("/")+1)+z.path;$.path=C.normalizePath(ue)}else $.path=ee.path,z.params||($.params=ee.params,z.query||($.query=ee.query));return $.path===null&&($.path=O.alwaysNormalize?C.normalizePath(z.path):z.path),C.buildURLFromParts($)},parseURL:function(b){var L=A.exec(b);return L?{scheme:L[1]||"",netLoc:L[2]||"",path:L[3]||"",params:L[4]||"",query:L[5]||"",fragment:L[6]||""}:null},normalizePath:function(b){for(b=b.split("").reverse().join("").replace(_,"");b.length!==(b=b.replace(I,"")).length;);return b.split("").reverse().join("")},buildURLFromParts:function(b){return b.scheme+b.netLoc+b.path+b.params+b.query+b.fragment}},E.exports=C}},n={};function a(E){var A=n[E];if(A!==void 0)return A.exports;var y=n[E]={exports:{}};return r[E].call(y.exports,y,y.exports,a),y.exports}a.m=r,a.n=E=>{var A=E&&E.__esModule?()=>E.default:()=>E;return a.d(A,{a:A}),A},a.d=(E,A)=>{for(var y in A)a.o(A,y)&&!a.o(E,y)&&Object.defineProperty(E,y,{enumerable:!0,get:A[y]})},a.o=(E,A)=>Object.prototype.hasOwnProperty.call(E,A),a.r=E=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(E,"__esModule",{value:!0})};var f=a(76);return f.default})())})(w_);const J_=tv(mu);export{hs as F,Y_ as a,_f as b,G_ as c,K_ as d,ls as e,of as f,ep as g,pr as h,B_ as i,tm as j,Us as k,nn as l,H_ as m,J_ as n,Jm as o,X_ as p,W_ as q,U_ as r,V_ as s,M_ as t,ci as u,j_ as v,F_ as w,q_ as x};
